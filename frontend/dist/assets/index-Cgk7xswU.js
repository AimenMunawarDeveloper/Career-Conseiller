(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();function h0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _u={exports:{}},Ms={},Ru={exports:{}},Ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Em;function sk(){if(Em)return Ne;Em=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function b(L){return L===null||typeof L!="object"?null:(L=y&&L[y]||L["@@iterator"],typeof L=="function"?L:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},k=Object.assign,T={};function C(L,W,ke){this.props=L,this.context=W,this.refs=T,this.updater=ke||S}C.prototype.isReactComponent={},C.prototype.setState=function(L,W){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,W,"setState")},C.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function w(){}w.prototype=C.prototype;function A(L,W,ke){this.props=L,this.context=W,this.refs=T,this.updater=ke||S}var P=A.prototype=new w;P.constructor=A,k(P,C.prototype),P.isPureReactComponent=!0;var E=Array.isArray,R=Object.prototype.hasOwnProperty,B={current:null},I={key:!0,ref:!0,__self:!0,__source:!0};function M(L,W,ke){var Ee,je={},Pe=null,ae=null;if(W!=null)for(Ee in W.ref!==void 0&&(ae=W.ref),W.key!==void 0&&(Pe=""+W.key),W)R.call(W,Ee)&&!I.hasOwnProperty(Ee)&&(je[Ee]=W[Ee]);var ye=arguments.length-2;if(ye===1)je.children=ke;else if(1<ye){for(var _e=Array(ye),zt=0;zt<ye;zt++)_e[zt]=arguments[zt+2];je.children=_e}if(L&&L.defaultProps)for(Ee in ye=L.defaultProps,ye)je[Ee]===void 0&&(je[Ee]=ye[Ee]);return{$$typeof:t,type:L,key:Pe,ref:ae,props:je,_owner:B.current}}function z(L,W){return{$$typeof:t,type:L.type,key:W,ref:L.ref,props:L.props,_owner:L._owner}}function K(L){return typeof L=="object"&&L!==null&&L.$$typeof===t}function Q(L){var W={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(ke){return W[ke]})}var ie=/\/+/g;function ce(L,W){return typeof L=="object"&&L!==null&&L.key!=null?Q(""+L.key):W.toString(36)}function Te(L,W,ke,Ee,je){var Pe=typeof L;(Pe==="undefined"||Pe==="boolean")&&(L=null);var ae=!1;if(L===null)ae=!0;else switch(Pe){case"string":case"number":ae=!0;break;case"object":switch(L.$$typeof){case t:case e:ae=!0}}if(ae)return ae=L,je=je(ae),L=Ee===""?"."+ce(ae,0):Ee,E(je)?(ke="",L!=null&&(ke=L.replace(ie,"$&/")+"/"),Te(je,W,ke,"",function(zt){return zt})):je!=null&&(K(je)&&(je=z(je,ke+(!je.key||ae&&ae.key===je.key?"":(""+je.key).replace(ie,"$&/")+"/")+L)),W.push(je)),1;if(ae=0,Ee=Ee===""?".":Ee+":",E(L))for(var ye=0;ye<L.length;ye++){Pe=L[ye];var _e=Ee+ce(Pe,ye);ae+=Te(Pe,W,ke,_e,je)}else if(_e=b(L),typeof _e=="function")for(L=_e.call(L),ye=0;!(Pe=L.next()).done;)Pe=Pe.value,_e=Ee+ce(Pe,ye++),ae+=Te(Pe,W,ke,_e,je);else if(Pe==="object")throw W=String(L),Error("Objects are not valid as a React child (found: "+(W==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":W)+"). If you meant to render a collection of children, use an array instead.");return ae}function Ae(L,W,ke){if(L==null)return L;var Ee=[],je=0;return Te(L,Ee,"","",function(Pe){return W.call(ke,Pe,je++)}),Ee}function Se(L){if(L._status===-1){var W=L._result;W=W(),W.then(function(ke){(L._status===0||L._status===-1)&&(L._status=1,L._result=ke)},function(ke){(L._status===0||L._status===-1)&&(L._status=2,L._result=ke)}),L._status===-1&&(L._status=0,L._result=W)}if(L._status===1)return L._result.default;throw L._result}var be={current:null},X={transition:null},pe={ReactCurrentDispatcher:be,ReactCurrentBatchConfig:X,ReactCurrentOwner:B};function oe(){throw Error("act(...) is not supported in production builds of React.")}return Ne.Children={map:Ae,forEach:function(L,W,ke){Ae(L,function(){W.apply(this,arguments)},ke)},count:function(L){var W=0;return Ae(L,function(){W++}),W},toArray:function(L){return Ae(L,function(W){return W})||[]},only:function(L){if(!K(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},Ne.Component=C,Ne.Fragment=n,Ne.Profiler=o,Ne.PureComponent=A,Ne.StrictMode=r,Ne.Suspense=d,Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pe,Ne.act=oe,Ne.cloneElement=function(L,W,ke){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var Ee=k({},L.props),je=L.key,Pe=L.ref,ae=L._owner;if(W!=null){if(W.ref!==void 0&&(Pe=W.ref,ae=B.current),W.key!==void 0&&(je=""+W.key),L.type&&L.type.defaultProps)var ye=L.type.defaultProps;for(_e in W)R.call(W,_e)&&!I.hasOwnProperty(_e)&&(Ee[_e]=W[_e]===void 0&&ye!==void 0?ye[_e]:W[_e])}var _e=arguments.length-2;if(_e===1)Ee.children=ke;else if(1<_e){ye=Array(_e);for(var zt=0;zt<_e;zt++)ye[zt]=arguments[zt+2];Ee.children=ye}return{$$typeof:t,type:L.type,key:je,ref:Pe,props:Ee,_owner:ae}},Ne.createContext=function(L){return L={$$typeof:l,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:a,_context:L},L.Consumer=L},Ne.createElement=M,Ne.createFactory=function(L){var W=M.bind(null,L);return W.type=L,W},Ne.createRef=function(){return{current:null}},Ne.forwardRef=function(L){return{$$typeof:u,render:L}},Ne.isValidElement=K,Ne.lazy=function(L){return{$$typeof:m,_payload:{_status:-1,_result:L},_init:Se}},Ne.memo=function(L,W){return{$$typeof:f,type:L,compare:W===void 0?null:W}},Ne.startTransition=function(L){var W=X.transition;X.transition={};try{L()}finally{X.transition=W}},Ne.unstable_act=oe,Ne.useCallback=function(L,W){return be.current.useCallback(L,W)},Ne.useContext=function(L){return be.current.useContext(L)},Ne.useDebugValue=function(){},Ne.useDeferredValue=function(L){return be.current.useDeferredValue(L)},Ne.useEffect=function(L,W){return be.current.useEffect(L,W)},Ne.useId=function(){return be.current.useId()},Ne.useImperativeHandle=function(L,W,ke){return be.current.useImperativeHandle(L,W,ke)},Ne.useInsertionEffect=function(L,W){return be.current.useInsertionEffect(L,W)},Ne.useLayoutEffect=function(L,W){return be.current.useLayoutEffect(L,W)},Ne.useMemo=function(L,W){return be.current.useMemo(L,W)},Ne.useReducer=function(L,W,ke){return be.current.useReducer(L,W,ke)},Ne.useRef=function(L){return be.current.useRef(L)},Ne.useState=function(L){return be.current.useState(L)},Ne.useSyncExternalStore=function(L,W,ke){return be.current.useSyncExternalStore(L,W,ke)},Ne.useTransition=function(){return be.current.useTransition()},Ne.version="18.3.1",Ne}var _m;function eh(){return _m||(_m=1,Ru.exports=sk()),Ru.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rm;function ok(){if(Rm)return Ms;Rm=1;var t=eh(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,o=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(u,d,f){var m,y={},b=null,S=null;f!==void 0&&(b=""+f),d.key!==void 0&&(b=""+d.key),d.ref!==void 0&&(S=d.ref);for(m in d)r.call(d,m)&&!a.hasOwnProperty(m)&&(y[m]=d[m]);if(u&&u.defaultProps)for(m in d=u.defaultProps,d)y[m]===void 0&&(y[m]=d[m]);return{$$typeof:e,type:u,key:b,ref:S,props:y,_owner:o.current}}return Ms.Fragment=n,Ms.jsx=l,Ms.jsxs=l,Ms}var Pm;function ak(){return Pm||(Pm=1,_u.exports=ok()),_u.exports}var p=ak(),N=eh();const Be=h0(N);var Ea={},Pu={exports:{}},At={},Nu={exports:{}},Iu={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nm;function lk(){return Nm||(Nm=1,function(t){function e(X,pe){var oe=X.length;X.push(pe);e:for(;0<oe;){var L=oe-1>>>1,W=X[L];if(0<o(W,pe))X[L]=pe,X[oe]=W,oe=L;else break e}}function n(X){return X.length===0?null:X[0]}function r(X){if(X.length===0)return null;var pe=X[0],oe=X.pop();if(oe!==pe){X[0]=oe;e:for(var L=0,W=X.length,ke=W>>>1;L<ke;){var Ee=2*(L+1)-1,je=X[Ee],Pe=Ee+1,ae=X[Pe];if(0>o(je,oe))Pe<W&&0>o(ae,je)?(X[L]=ae,X[Pe]=oe,L=Pe):(X[L]=je,X[Ee]=oe,L=Ee);else if(Pe<W&&0>o(ae,oe))X[L]=ae,X[Pe]=oe,L=Pe;else break e}}return pe}function o(X,pe){var oe=X.sortIndex-pe.sortIndex;return oe!==0?oe:X.id-pe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var d=[],f=[],m=1,y=null,b=3,S=!1,k=!1,T=!1,C=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,A=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(X){for(var pe=n(f);pe!==null;){if(pe.callback===null)r(f);else if(pe.startTime<=X)r(f),pe.sortIndex=pe.expirationTime,e(d,pe);else break;pe=n(f)}}function E(X){if(T=!1,P(X),!k)if(n(d)!==null)k=!0,Se(R);else{var pe=n(f);pe!==null&&be(E,pe.startTime-X)}}function R(X,pe){k=!1,T&&(T=!1,w(M),M=-1),S=!0;var oe=b;try{for(P(pe),y=n(d);y!==null&&(!(y.expirationTime>pe)||X&&!Q());){var L=y.callback;if(typeof L=="function"){y.callback=null,b=y.priorityLevel;var W=L(y.expirationTime<=pe);pe=t.unstable_now(),typeof W=="function"?y.callback=W:y===n(d)&&r(d),P(pe)}else r(d);y=n(d)}if(y!==null)var ke=!0;else{var Ee=n(f);Ee!==null&&be(E,Ee.startTime-pe),ke=!1}return ke}finally{y=null,b=oe,S=!1}}var B=!1,I=null,M=-1,z=5,K=-1;function Q(){return!(t.unstable_now()-K<z)}function ie(){if(I!==null){var X=t.unstable_now();K=X;var pe=!0;try{pe=I(!0,X)}finally{pe?ce():(B=!1,I=null)}}else B=!1}var ce;if(typeof A=="function")ce=function(){A(ie)};else if(typeof MessageChannel<"u"){var Te=new MessageChannel,Ae=Te.port2;Te.port1.onmessage=ie,ce=function(){Ae.postMessage(null)}}else ce=function(){C(ie,0)};function Se(X){I=X,B||(B=!0,ce())}function be(X,pe){M=C(function(){X(t.unstable_now())},pe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(X){X.callback=null},t.unstable_continueExecution=function(){k||S||(k=!0,Se(R))},t.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<X?Math.floor(1e3/X):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_getFirstCallbackNode=function(){return n(d)},t.unstable_next=function(X){switch(b){case 1:case 2:case 3:var pe=3;break;default:pe=b}var oe=b;b=pe;try{return X()}finally{b=oe}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(X,pe){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var oe=b;b=X;try{return pe()}finally{b=oe}},t.unstable_scheduleCallback=function(X,pe,oe){var L=t.unstable_now();switch(typeof oe=="object"&&oe!==null?(oe=oe.delay,oe=typeof oe=="number"&&0<oe?L+oe:L):oe=L,X){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=oe+W,X={id:m++,callback:pe,priorityLevel:X,startTime:oe,expirationTime:W,sortIndex:-1},oe>L?(X.sortIndex=oe,e(f,X),n(d)===null&&X===n(f)&&(T?(w(M),M=-1):T=!0,be(E,oe-L))):(X.sortIndex=W,e(d,X),k||S||(k=!0,Se(R))),X},t.unstable_shouldYield=Q,t.unstable_wrapCallback=function(X){var pe=b;return function(){var oe=b;b=pe;try{return X.apply(this,arguments)}finally{b=oe}}}}(Iu)),Iu}var Im;function ck(){return Im||(Im=1,Nu.exports=lk()),Nu.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jm;function uk(){if(jm)return At;jm=1;var t=eh(),e=ck();function n(i){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+i,c=1;c<arguments.length;c++)s+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,o={};function a(i,s){l(i,s),l(i+"Capture",s)}function l(i,s){for(o[i]=s,i=0;i<s.length;i++)r.add(s[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function b(i){return d.call(y,i)?!0:d.call(m,i)?!1:f.test(i)?y[i]=!0:(m[i]=!0,!1)}function S(i,s,c,h){if(c!==null&&c.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function k(i,s,c,h){if(s===null||typeof s>"u"||S(i,s,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function T(i,s,c,h,g,v,x){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=h,this.attributeNamespace=g,this.mustUseProperty=c,this.propertyName=i,this.type=s,this.sanitizeURL=v,this.removeEmptyString=x}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){C[i]=new T(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var s=i[0];C[s]=new T(s,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){C[i]=new T(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){C[i]=new T(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){C[i]=new T(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){C[i]=new T(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){C[i]=new T(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){C[i]=new T(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){C[i]=new T(i,5,!1,i.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function A(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var s=i.replace(w,A);C[s]=new T(s,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var s=i.replace(w,A);C[s]=new T(s,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var s=i.replace(w,A);C[s]=new T(s,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){C[i]=new T(i,1,!1,i.toLowerCase(),null,!1,!1)}),C.xlinkHref=new T("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){C[i]=new T(i,1,!1,i.toLowerCase(),null,!0,!0)});function P(i,s,c,h){var g=C.hasOwnProperty(s)?C[s]:null;(g!==null?g.type!==0:h||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(k(s,c,g,h)&&(c=null),h||g===null?b(s)&&(c===null?i.removeAttribute(s):i.setAttribute(s,""+c)):g.mustUseProperty?i[g.propertyName]=c===null?g.type===3?!1:"":c:(s=g.attributeName,h=g.attributeNamespace,c===null?i.removeAttribute(s):(g=g.type,c=g===3||g===4&&c===!0?"":""+c,h?i.setAttributeNS(h,s,c):i.setAttribute(s,c))))}var E=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),B=Symbol.for("react.portal"),I=Symbol.for("react.fragment"),M=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),K=Symbol.for("react.provider"),Q=Symbol.for("react.context"),ie=Symbol.for("react.forward_ref"),ce=Symbol.for("react.suspense"),Te=Symbol.for("react.suspense_list"),Ae=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),be=Symbol.for("react.offscreen"),X=Symbol.iterator;function pe(i){return i===null||typeof i!="object"?null:(i=X&&i[X]||i["@@iterator"],typeof i=="function"?i:null)}var oe=Object.assign,L;function W(i){if(L===void 0)try{throw Error()}catch(c){var s=c.stack.trim().match(/\n( *(at )?)/);L=s&&s[1]||""}return`
`+L+i}var ke=!1;function Ee(i,s){if(!i||ke)return"";ke=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(V){var h=V}Reflect.construct(i,[],s)}else{try{s.call()}catch(V){h=V}i.call(s.prototype)}else{try{throw Error()}catch(V){h=V}i()}}catch(V){if(V&&h&&typeof V.stack=="string"){for(var g=V.stack.split(`
`),v=h.stack.split(`
`),x=g.length-1,_=v.length-1;1<=x&&0<=_&&g[x]!==v[_];)_--;for(;1<=x&&0<=_;x--,_--)if(g[x]!==v[_]){if(x!==1||_!==1)do if(x--,_--,0>_||g[x]!==v[_]){var O=`
`+g[x].replace(" at new "," at ");return i.displayName&&O.includes("<anonymous>")&&(O=O.replace("<anonymous>",i.displayName)),O}while(1<=x&&0<=_);break}}}finally{ke=!1,Error.prepareStackTrace=c}return(i=i?i.displayName||i.name:"")?W(i):""}function je(i){switch(i.tag){case 5:return W(i.type);case 16:return W("Lazy");case 13:return W("Suspense");case 19:return W("SuspenseList");case 0:case 2:case 15:return i=Ee(i.type,!1),i;case 11:return i=Ee(i.type.render,!1),i;case 1:return i=Ee(i.type,!0),i;default:return""}}function Pe(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case I:return"Fragment";case B:return"Portal";case z:return"Profiler";case M:return"StrictMode";case ce:return"Suspense";case Te:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case Q:return(i.displayName||"Context")+".Consumer";case K:return(i._context.displayName||"Context")+".Provider";case ie:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ae:return s=i.displayName||null,s!==null?s:Pe(i.type)||"Memo";case Se:s=i._payload,i=i._init;try{return Pe(i(s))}catch{}}return null}function ae(i){var s=i.type;switch(i.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=s.render,i=i.displayName||i.name||"",s.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pe(s);case 8:return s===M?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function ye(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function _e(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function zt(i){var s=_e(i)?"checked":"value",c=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),h=""+i[s];if(!i.hasOwnProperty(s)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var g=c.get,v=c.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return g.call(this)},set:function(x){h=""+x,v.call(this,x)}}),Object.defineProperty(i,s,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(x){h=""+x},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function go(i){i._valueTracker||(i._valueTracker=zt(i))}function Ih(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var c=s.getValue(),h="";return i&&(h=_e(i)?i.checked?"true":"false":i.value),i=h,i!==c?(s.setValue(i),!0):!1}function vo(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Al(i,s){var c=s.checked;return oe({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??i._wrapperState.initialChecked})}function jh(i,s){var c=s.defaultValue==null?"":s.defaultValue,h=s.checked!=null?s.checked:s.defaultChecked;c=ye(s.value!=null?s.value:c),i._wrapperState={initialChecked:h,initialValue:c,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function Oh(i,s){s=s.checked,s!=null&&P(i,"checked",s,!1)}function Dl(i,s){Oh(i,s);var c=ye(s.value),h=s.type;if(c!=null)h==="number"?(c===0&&i.value===""||i.value!=c)&&(i.value=""+c):i.value!==""+c&&(i.value=""+c);else if(h==="submit"||h==="reset"){i.removeAttribute("value");return}s.hasOwnProperty("value")?Ll(i,s.type,c):s.hasOwnProperty("defaultValue")&&Ll(i,s.type,ye(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(i.defaultChecked=!!s.defaultChecked)}function Ah(i,s,c){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var h=s.type;if(!(h!=="submit"&&h!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+i._wrapperState.initialValue,c||s===i.value||(i.value=s),i.defaultValue=s}c=i.name,c!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,c!==""&&(i.name=c)}function Ll(i,s,c){(s!=="number"||vo(i.ownerDocument)!==i)&&(c==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+c&&(i.defaultValue=""+c))}var Xr=Array.isArray;function ar(i,s,c,h){if(i=i.options,s){s={};for(var g=0;g<c.length;g++)s["$"+c[g]]=!0;for(c=0;c<i.length;c++)g=s.hasOwnProperty("$"+i[c].value),i[c].selected!==g&&(i[c].selected=g),g&&h&&(i[c].defaultSelected=!0)}else{for(c=""+ye(c),s=null,g=0;g<i.length;g++){if(i[g].value===c){i[g].selected=!0,h&&(i[g].defaultSelected=!0);return}s!==null||i[g].disabled||(s=i[g])}s!==null&&(s.selected=!0)}}function Ml(i,s){if(s.dangerouslySetInnerHTML!=null)throw Error(n(91));return oe({},s,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Dh(i,s){var c=s.value;if(c==null){if(c=s.children,s=s.defaultValue,c!=null){if(s!=null)throw Error(n(92));if(Xr(c)){if(1<c.length)throw Error(n(93));c=c[0]}s=c}s==null&&(s=""),c=s}i._wrapperState={initialValue:ye(c)}}function Lh(i,s){var c=ye(s.value),h=ye(s.defaultValue);c!=null&&(c=""+c,c!==i.value&&(i.value=c),s.defaultValue==null&&i.defaultValue!==c&&(i.defaultValue=c)),h!=null&&(i.defaultValue=""+h)}function Mh(i){var s=i.textContent;s===i._wrapperState.initialValue&&s!==""&&s!==null&&(i.value=s)}function Uh(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ul(i,s){return i==null||i==="http://www.w3.org/1999/xhtml"?Uh(s):i==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var yo,Fh=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,c,h,g){MSApp.execUnsafeLocalFunction(function(){return i(s,c,h,g)})}:i}(function(i,s){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=s;else{for(yo=yo||document.createElement("div"),yo.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=yo.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;s.firstChild;)i.appendChild(s.firstChild)}});function Zr(i,s){if(s){var c=i.firstChild;if(c&&c===i.lastChild&&c.nodeType===3){c.nodeValue=s;return}}i.textContent=s}var es={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cb=["Webkit","ms","Moz","O"];Object.keys(es).forEach(function(i){cb.forEach(function(s){s=s+i.charAt(0).toUpperCase()+i.substring(1),es[s]=es[i]})});function Bh(i,s,c){return s==null||typeof s=="boolean"||s===""?"":c||typeof s!="number"||s===0||es.hasOwnProperty(i)&&es[i]?(""+s).trim():s+"px"}function zh(i,s){i=i.style;for(var c in s)if(s.hasOwnProperty(c)){var h=c.indexOf("--")===0,g=Bh(c,s[c],h);c==="float"&&(c="cssFloat"),h?i.setProperty(c,g):i[c]=g}}var ub=oe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Fl(i,s){if(s){if(ub[i]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(n(137,i));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(n(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(n(61))}if(s.style!=null&&typeof s.style!="object")throw Error(n(62))}}function Bl(i,s){if(i.indexOf("-")===-1)return typeof s.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zl=null;function Vl(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ql=null,lr=null,cr=null;function Vh(i){if(i=Ss(i)){if(typeof ql!="function")throw Error(n(280));var s=i.stateNode;s&&(s=zo(s),ql(i.stateNode,i.type,s))}}function qh(i){lr?cr?cr.push(i):cr=[i]:lr=i}function Hh(){if(lr){var i=lr,s=cr;if(cr=lr=null,Vh(i),s)for(i=0;i<s.length;i++)Vh(s[i])}}function $h(i,s){return i(s)}function Wh(){}var Hl=!1;function Gh(i,s,c){if(Hl)return i(s,c);Hl=!0;try{return $h(i,s,c)}finally{Hl=!1,(lr!==null||cr!==null)&&(Wh(),Hh())}}function ts(i,s){var c=i.stateNode;if(c===null)return null;var h=zo(c);if(h===null)return null;c=h[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(c&&typeof c!="function")throw Error(n(231,s,typeof c));return c}var $l=!1;if(u)try{var ns={};Object.defineProperty(ns,"passive",{get:function(){$l=!0}}),window.addEventListener("test",ns,ns),window.removeEventListener("test",ns,ns)}catch{$l=!1}function db(i,s,c,h,g,v,x,_,O){var V=Array.prototype.slice.call(arguments,3);try{s.apply(c,V)}catch(Y){this.onError(Y)}}var is=!1,bo=null,xo=!1,Wl=null,hb={onError:function(i){is=!0,bo=i}};function fb(i,s,c,h,g,v,x,_,O){is=!1,bo=null,db.apply(hb,arguments)}function pb(i,s,c,h,g,v,x,_,O){if(fb.apply(this,arguments),is){if(is){var V=bo;is=!1,bo=null}else throw Error(n(198));xo||(xo=!0,Wl=V)}}function Oi(i){var s=i,c=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(c=s.return),i=s.return;while(i)}return s.tag===3?c:null}function Kh(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function Jh(i){if(Oi(i)!==i)throw Error(n(188))}function mb(i){var s=i.alternate;if(!s){if(s=Oi(i),s===null)throw Error(n(188));return s!==i?null:i}for(var c=i,h=s;;){var g=c.return;if(g===null)break;var v=g.alternate;if(v===null){if(h=g.return,h!==null){c=h;continue}break}if(g.child===v.child){for(v=g.child;v;){if(v===c)return Jh(g),i;if(v===h)return Jh(g),s;v=v.sibling}throw Error(n(188))}if(c.return!==h.return)c=g,h=v;else{for(var x=!1,_=g.child;_;){if(_===c){x=!0,c=g,h=v;break}if(_===h){x=!0,h=g,c=v;break}_=_.sibling}if(!x){for(_=v.child;_;){if(_===c){x=!0,c=v,h=g;break}if(_===h){x=!0,h=v,c=g;break}_=_.sibling}if(!x)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?i:s}function Qh(i){return i=mb(i),i!==null?Yh(i):null}function Yh(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var s=Yh(i);if(s!==null)return s;i=i.sibling}return null}var Xh=e.unstable_scheduleCallback,Zh=e.unstable_cancelCallback,gb=e.unstable_shouldYield,vb=e.unstable_requestPaint,rt=e.unstable_now,yb=e.unstable_getCurrentPriorityLevel,Gl=e.unstable_ImmediatePriority,ef=e.unstable_UserBlockingPriority,ko=e.unstable_NormalPriority,bb=e.unstable_LowPriority,tf=e.unstable_IdlePriority,So=null,yn=null;function xb(i){if(yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(So,i,void 0,(i.current.flags&128)===128)}catch{}}var nn=Math.clz32?Math.clz32:Tb,kb=Math.log,Sb=Math.LN2;function Tb(i){return i>>>=0,i===0?32:31-(kb(i)/Sb|0)|0}var To=64,Co=4194304;function rs(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function wo(i,s){var c=i.pendingLanes;if(c===0)return 0;var h=0,g=i.suspendedLanes,v=i.pingedLanes,x=c&268435455;if(x!==0){var _=x&~g;_!==0?h=rs(_):(v&=x,v!==0&&(h=rs(v)))}else x=c&~g,x!==0?h=rs(x):v!==0&&(h=rs(v));if(h===0)return 0;if(s!==0&&s!==h&&(s&g)===0&&(g=h&-h,v=s&-s,g>=v||g===16&&(v&4194240)!==0))return s;if((h&4)!==0&&(h|=c&16),s=i.entangledLanes,s!==0)for(i=i.entanglements,s&=h;0<s;)c=31-nn(s),g=1<<c,h|=i[c],s&=~g;return h}function Cb(i,s){switch(i){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wb(i,s){for(var c=i.suspendedLanes,h=i.pingedLanes,g=i.expirationTimes,v=i.pendingLanes;0<v;){var x=31-nn(v),_=1<<x,O=g[x];O===-1?((_&c)===0||(_&h)!==0)&&(g[x]=Cb(_,s)):O<=s&&(i.expiredLanes|=_),v&=~_}}function Kl(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function nf(){var i=To;return To<<=1,(To&4194240)===0&&(To=64),i}function Jl(i){for(var s=[],c=0;31>c;c++)s.push(i);return s}function ss(i,s,c){i.pendingLanes|=s,s!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,s=31-nn(s),i[s]=c}function Eb(i,s){var c=i.pendingLanes&~s;i.pendingLanes=s,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=s,i.mutableReadLanes&=s,i.entangledLanes&=s,s=i.entanglements;var h=i.eventTimes;for(i=i.expirationTimes;0<c;){var g=31-nn(c),v=1<<g;s[g]=0,h[g]=-1,i[g]=-1,c&=~v}}function Ql(i,s){var c=i.entangledLanes|=s;for(i=i.entanglements;c;){var h=31-nn(c),g=1<<h;g&s|i[h]&s&&(i[h]|=s),c&=~g}}var Ve=0;function rf(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var sf,Yl,of,af,lf,Xl=!1,Eo=[],ni=null,ii=null,ri=null,os=new Map,as=new Map,si=[],_b="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function cf(i,s){switch(i){case"focusin":case"focusout":ni=null;break;case"dragenter":case"dragleave":ii=null;break;case"mouseover":case"mouseout":ri=null;break;case"pointerover":case"pointerout":os.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":as.delete(s.pointerId)}}function ls(i,s,c,h,g,v){return i===null||i.nativeEvent!==v?(i={blockedOn:s,domEventName:c,eventSystemFlags:h,nativeEvent:v,targetContainers:[g]},s!==null&&(s=Ss(s),s!==null&&Yl(s)),i):(i.eventSystemFlags|=h,s=i.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),i)}function Rb(i,s,c,h,g){switch(s){case"focusin":return ni=ls(ni,i,s,c,h,g),!0;case"dragenter":return ii=ls(ii,i,s,c,h,g),!0;case"mouseover":return ri=ls(ri,i,s,c,h,g),!0;case"pointerover":var v=g.pointerId;return os.set(v,ls(os.get(v)||null,i,s,c,h,g)),!0;case"gotpointercapture":return v=g.pointerId,as.set(v,ls(as.get(v)||null,i,s,c,h,g)),!0}return!1}function uf(i){var s=Ai(i.target);if(s!==null){var c=Oi(s);if(c!==null){if(s=c.tag,s===13){if(s=Kh(c),s!==null){i.blockedOn=s,lf(i.priority,function(){of(c)});return}}else if(s===3&&c.stateNode.current.memoizedState.isDehydrated){i.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}i.blockedOn=null}function _o(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var c=ec(i.domEventName,i.eventSystemFlags,s[0],i.nativeEvent);if(c===null){c=i.nativeEvent;var h=new c.constructor(c.type,c);zl=h,c.target.dispatchEvent(h),zl=null}else return s=Ss(c),s!==null&&Yl(s),i.blockedOn=c,!1;s.shift()}return!0}function df(i,s,c){_o(i)&&c.delete(s)}function Pb(){Xl=!1,ni!==null&&_o(ni)&&(ni=null),ii!==null&&_o(ii)&&(ii=null),ri!==null&&_o(ri)&&(ri=null),os.forEach(df),as.forEach(df)}function cs(i,s){i.blockedOn===s&&(i.blockedOn=null,Xl||(Xl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Pb)))}function us(i){function s(g){return cs(g,i)}if(0<Eo.length){cs(Eo[0],i);for(var c=1;c<Eo.length;c++){var h=Eo[c];h.blockedOn===i&&(h.blockedOn=null)}}for(ni!==null&&cs(ni,i),ii!==null&&cs(ii,i),ri!==null&&cs(ri,i),os.forEach(s),as.forEach(s),c=0;c<si.length;c++)h=si[c],h.blockedOn===i&&(h.blockedOn=null);for(;0<si.length&&(c=si[0],c.blockedOn===null);)uf(c),c.blockedOn===null&&si.shift()}var ur=E.ReactCurrentBatchConfig,Ro=!0;function Nb(i,s,c,h){var g=Ve,v=ur.transition;ur.transition=null;try{Ve=1,Zl(i,s,c,h)}finally{Ve=g,ur.transition=v}}function Ib(i,s,c,h){var g=Ve,v=ur.transition;ur.transition=null;try{Ve=4,Zl(i,s,c,h)}finally{Ve=g,ur.transition=v}}function Zl(i,s,c,h){if(Ro){var g=ec(i,s,c,h);if(g===null)vc(i,s,h,Po,c),cf(i,h);else if(Rb(g,i,s,c,h))h.stopPropagation();else if(cf(i,h),s&4&&-1<_b.indexOf(i)){for(;g!==null;){var v=Ss(g);if(v!==null&&sf(v),v=ec(i,s,c,h),v===null&&vc(i,s,h,Po,c),v===g)break;g=v}g!==null&&h.stopPropagation()}else vc(i,s,h,null,c)}}var Po=null;function ec(i,s,c,h){if(Po=null,i=Vl(h),i=Ai(i),i!==null)if(s=Oi(i),s===null)i=null;else if(c=s.tag,c===13){if(i=Kh(s),i!==null)return i;i=null}else if(c===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null);return Po=i,null}function hf(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(yb()){case Gl:return 1;case ef:return 4;case ko:case bb:return 16;case tf:return 536870912;default:return 16}default:return 16}}var oi=null,tc=null,No=null;function ff(){if(No)return No;var i,s=tc,c=s.length,h,g="value"in oi?oi.value:oi.textContent,v=g.length;for(i=0;i<c&&s[i]===g[i];i++);var x=c-i;for(h=1;h<=x&&s[c-h]===g[v-h];h++);return No=g.slice(i,1<h?1-h:void 0)}function Io(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function jo(){return!0}function pf(){return!1}function Vt(i){function s(c,h,g,v,x){this._reactName=c,this._targetInst=g,this.type=h,this.nativeEvent=v,this.target=x,this.currentTarget=null;for(var _ in i)i.hasOwnProperty(_)&&(c=i[_],this[_]=c?c(v):v[_]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?jo:pf,this.isPropagationStopped=pf,this}return oe(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=jo)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=jo)},persist:function(){},isPersistent:jo}),s}var dr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nc=Vt(dr),ds=oe({},dr,{view:0,detail:0}),jb=Vt(ds),ic,rc,hs,Oo=oe({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:oc,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==hs&&(hs&&i.type==="mousemove"?(ic=i.screenX-hs.screenX,rc=i.screenY-hs.screenY):rc=ic=0,hs=i),ic)},movementY:function(i){return"movementY"in i?i.movementY:rc}}),mf=Vt(Oo),Ob=oe({},Oo,{dataTransfer:0}),Ab=Vt(Ob),Db=oe({},ds,{relatedTarget:0}),sc=Vt(Db),Lb=oe({},dr,{animationName:0,elapsedTime:0,pseudoElement:0}),Mb=Vt(Lb),Ub=oe({},dr,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Fb=Vt(Ub),Bb=oe({},dr,{data:0}),gf=Vt(Bb),zb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Vb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hb(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=qb[i])?!!s[i]:!1}function oc(){return Hb}var $b=oe({},ds,{key:function(i){if(i.key){var s=zb[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Io(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Vb[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:oc,charCode:function(i){return i.type==="keypress"?Io(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Io(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Wb=Vt($b),Gb=oe({},Oo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),vf=Vt(Gb),Kb=oe({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:oc}),Jb=Vt(Kb),Qb=oe({},dr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yb=Vt(Qb),Xb=oe({},Oo,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zb=Vt(Xb),ex=[9,13,27,32],ac=u&&"CompositionEvent"in window,fs=null;u&&"documentMode"in document&&(fs=document.documentMode);var tx=u&&"TextEvent"in window&&!fs,yf=u&&(!ac||fs&&8<fs&&11>=fs),bf=" ",xf=!1;function kf(i,s){switch(i){case"keyup":return ex.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sf(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var hr=!1;function nx(i,s){switch(i){case"compositionend":return Sf(s);case"keypress":return s.which!==32?null:(xf=!0,bf);case"textInput":return i=s.data,i===bf&&xf?null:i;default:return null}}function ix(i,s){if(hr)return i==="compositionend"||!ac&&kf(i,s)?(i=ff(),No=tc=oi=null,hr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return yf&&s.locale!=="ko"?null:s.data;default:return null}}var rx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tf(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!rx[i.type]:s==="textarea"}function Cf(i,s,c,h){qh(h),s=Uo(s,"onChange"),0<s.length&&(c=new nc("onChange","change",null,c,h),i.push({event:c,listeners:s}))}var ps=null,ms=null;function sx(i){Vf(i,0)}function Ao(i){var s=vr(i);if(Ih(s))return i}function ox(i,s){if(i==="change")return s}var wf=!1;if(u){var lc;if(u){var cc="oninput"in document;if(!cc){var Ef=document.createElement("div");Ef.setAttribute("oninput","return;"),cc=typeof Ef.oninput=="function"}lc=cc}else lc=!1;wf=lc&&(!document.documentMode||9<document.documentMode)}function _f(){ps&&(ps.detachEvent("onpropertychange",Rf),ms=ps=null)}function Rf(i){if(i.propertyName==="value"&&Ao(ms)){var s=[];Cf(s,ms,i,Vl(i)),Gh(sx,s)}}function ax(i,s,c){i==="focusin"?(_f(),ps=s,ms=c,ps.attachEvent("onpropertychange",Rf)):i==="focusout"&&_f()}function lx(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ao(ms)}function cx(i,s){if(i==="click")return Ao(s)}function ux(i,s){if(i==="input"||i==="change")return Ao(s)}function dx(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var rn=typeof Object.is=="function"?Object.is:dx;function gs(i,s){if(rn(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var c=Object.keys(i),h=Object.keys(s);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var g=c[h];if(!d.call(s,g)||!rn(i[g],s[g]))return!1}return!0}function Pf(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Nf(i,s){var c=Pf(i);i=0;for(var h;c;){if(c.nodeType===3){if(h=i+c.textContent.length,i<=s&&h>=s)return{node:c,offset:s-i};i=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Pf(c)}}function If(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?If(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function jf(){for(var i=window,s=vo();s instanceof i.HTMLIFrameElement;){try{var c=typeof s.contentWindow.location.href=="string"}catch{c=!1}if(c)i=s.contentWindow;else break;s=vo(i.document)}return s}function uc(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}function hx(i){var s=jf(),c=i.focusedElem,h=i.selectionRange;if(s!==c&&c&&c.ownerDocument&&If(c.ownerDocument.documentElement,c)){if(h!==null&&uc(c)){if(s=h.start,i=h.end,i===void 0&&(i=s),"selectionStart"in c)c.selectionStart=s,c.selectionEnd=Math.min(i,c.value.length);else if(i=(s=c.ownerDocument||document)&&s.defaultView||window,i.getSelection){i=i.getSelection();var g=c.textContent.length,v=Math.min(h.start,g);h=h.end===void 0?v:Math.min(h.end,g),!i.extend&&v>h&&(g=h,h=v,v=g),g=Nf(c,v);var x=Nf(c,h);g&&x&&(i.rangeCount!==1||i.anchorNode!==g.node||i.anchorOffset!==g.offset||i.focusNode!==x.node||i.focusOffset!==x.offset)&&(s=s.createRange(),s.setStart(g.node,g.offset),i.removeAllRanges(),v>h?(i.addRange(s),i.extend(x.node,x.offset)):(s.setEnd(x.node,x.offset),i.addRange(s)))}}for(s=[],i=c;i=i.parentNode;)i.nodeType===1&&s.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<s.length;c++)i=s[c],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var fx=u&&"documentMode"in document&&11>=document.documentMode,fr=null,dc=null,vs=null,hc=!1;function Of(i,s,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;hc||fr==null||fr!==vo(h)||(h=fr,"selectionStart"in h&&uc(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),vs&&gs(vs,h)||(vs=h,h=Uo(dc,"onSelect"),0<h.length&&(s=new nc("onSelect","select",null,s,c),i.push({event:s,listeners:h}),s.target=fr)))}function Do(i,s){var c={};return c[i.toLowerCase()]=s.toLowerCase(),c["Webkit"+i]="webkit"+s,c["Moz"+i]="moz"+s,c}var pr={animationend:Do("Animation","AnimationEnd"),animationiteration:Do("Animation","AnimationIteration"),animationstart:Do("Animation","AnimationStart"),transitionend:Do("Transition","TransitionEnd")},fc={},Af={};u&&(Af=document.createElement("div").style,"AnimationEvent"in window||(delete pr.animationend.animation,delete pr.animationiteration.animation,delete pr.animationstart.animation),"TransitionEvent"in window||delete pr.transitionend.transition);function Lo(i){if(fc[i])return fc[i];if(!pr[i])return i;var s=pr[i],c;for(c in s)if(s.hasOwnProperty(c)&&c in Af)return fc[i]=s[c];return i}var Df=Lo("animationend"),Lf=Lo("animationiteration"),Mf=Lo("animationstart"),Uf=Lo("transitionend"),Ff=new Map,Bf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ai(i,s){Ff.set(i,s),a(s,[i])}for(var pc=0;pc<Bf.length;pc++){var mc=Bf[pc],px=mc.toLowerCase(),mx=mc[0].toUpperCase()+mc.slice(1);ai(px,"on"+mx)}ai(Df,"onAnimationEnd"),ai(Lf,"onAnimationIteration"),ai(Mf,"onAnimationStart"),ai("dblclick","onDoubleClick"),ai("focusin","onFocus"),ai("focusout","onBlur"),ai(Uf,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ys="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gx=new Set("cancel close invalid load scroll toggle".split(" ").concat(ys));function zf(i,s,c){var h=i.type||"unknown-event";i.currentTarget=c,pb(h,s,void 0,i),i.currentTarget=null}function Vf(i,s){s=(s&4)!==0;for(var c=0;c<i.length;c++){var h=i[c],g=h.event;h=h.listeners;e:{var v=void 0;if(s)for(var x=h.length-1;0<=x;x--){var _=h[x],O=_.instance,V=_.currentTarget;if(_=_.listener,O!==v&&g.isPropagationStopped())break e;zf(g,_,V),v=O}else for(x=0;x<h.length;x++){if(_=h[x],O=_.instance,V=_.currentTarget,_=_.listener,O!==v&&g.isPropagationStopped())break e;zf(g,_,V),v=O}}}if(xo)throw i=Wl,xo=!1,Wl=null,i}function We(i,s){var c=s[Tc];c===void 0&&(c=s[Tc]=new Set);var h=i+"__bubble";c.has(h)||(qf(s,i,2,!1),c.add(h))}function gc(i,s,c){var h=0;s&&(h|=4),qf(c,i,h,s)}var Mo="_reactListening"+Math.random().toString(36).slice(2);function bs(i){if(!i[Mo]){i[Mo]=!0,r.forEach(function(c){c!=="selectionchange"&&(gx.has(c)||gc(c,!1,i),gc(c,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[Mo]||(s[Mo]=!0,gc("selectionchange",!1,s))}}function qf(i,s,c,h){switch(hf(s)){case 1:var g=Nb;break;case 4:g=Ib;break;default:g=Zl}c=g.bind(null,s,c,i),g=void 0,!$l||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?i.addEventListener(s,c,{capture:!0,passive:g}):i.addEventListener(s,c,!0):g!==void 0?i.addEventListener(s,c,{passive:g}):i.addEventListener(s,c,!1)}function vc(i,s,c,h,g){var v=h;if((s&1)===0&&(s&2)===0&&h!==null)e:for(;;){if(h===null)return;var x=h.tag;if(x===3||x===4){var _=h.stateNode.containerInfo;if(_===g||_.nodeType===8&&_.parentNode===g)break;if(x===4)for(x=h.return;x!==null;){var O=x.tag;if((O===3||O===4)&&(O=x.stateNode.containerInfo,O===g||O.nodeType===8&&O.parentNode===g))return;x=x.return}for(;_!==null;){if(x=Ai(_),x===null)return;if(O=x.tag,O===5||O===6){h=v=x;continue e}_=_.parentNode}}h=h.return}Gh(function(){var V=v,Y=Vl(c),Z=[];e:{var J=Ff.get(i);if(J!==void 0){var le=nc,de=i;switch(i){case"keypress":if(Io(c)===0)break e;case"keydown":case"keyup":le=Wb;break;case"focusin":de="focus",le=sc;break;case"focusout":de="blur",le=sc;break;case"beforeblur":case"afterblur":le=sc;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":le=mf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":le=Ab;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":le=Jb;break;case Df:case Lf:case Mf:le=Mb;break;case Uf:le=Yb;break;case"scroll":le=jb;break;case"wheel":le=Zb;break;case"copy":case"cut":case"paste":le=Fb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":le=vf}var he=(s&4)!==0,st=!he&&i==="scroll",U=he?J!==null?J+"Capture":null:J;he=[];for(var D=V,F;D!==null;){F=D;var te=F.stateNode;if(F.tag===5&&te!==null&&(F=te,U!==null&&(te=ts(D,U),te!=null&&he.push(xs(D,te,F)))),st)break;D=D.return}0<he.length&&(J=new le(J,de,null,c,Y),Z.push({event:J,listeners:he}))}}if((s&7)===0){e:{if(J=i==="mouseover"||i==="pointerover",le=i==="mouseout"||i==="pointerout",J&&c!==zl&&(de=c.relatedTarget||c.fromElement)&&(Ai(de)||de[An]))break e;if((le||J)&&(J=Y.window===Y?Y:(J=Y.ownerDocument)?J.defaultView||J.parentWindow:window,le?(de=c.relatedTarget||c.toElement,le=V,de=de?Ai(de):null,de!==null&&(st=Oi(de),de!==st||de.tag!==5&&de.tag!==6)&&(de=null)):(le=null,de=V),le!==de)){if(he=mf,te="onMouseLeave",U="onMouseEnter",D="mouse",(i==="pointerout"||i==="pointerover")&&(he=vf,te="onPointerLeave",U="onPointerEnter",D="pointer"),st=le==null?J:vr(le),F=de==null?J:vr(de),J=new he(te,D+"leave",le,c,Y),J.target=st,J.relatedTarget=F,te=null,Ai(Y)===V&&(he=new he(U,D+"enter",de,c,Y),he.target=F,he.relatedTarget=st,te=he),st=te,le&&de)t:{for(he=le,U=de,D=0,F=he;F;F=mr(F))D++;for(F=0,te=U;te;te=mr(te))F++;for(;0<D-F;)he=mr(he),D--;for(;0<F-D;)U=mr(U),F--;for(;D--;){if(he===U||U!==null&&he===U.alternate)break t;he=mr(he),U=mr(U)}he=null}else he=null;le!==null&&Hf(Z,J,le,he,!1),de!==null&&st!==null&&Hf(Z,st,de,he,!0)}}e:{if(J=V?vr(V):window,le=J.nodeName&&J.nodeName.toLowerCase(),le==="select"||le==="input"&&J.type==="file")var fe=ox;else if(Tf(J))if(wf)fe=ux;else{fe=lx;var ge=ax}else(le=J.nodeName)&&le.toLowerCase()==="input"&&(J.type==="checkbox"||J.type==="radio")&&(fe=cx);if(fe&&(fe=fe(i,V))){Cf(Z,fe,c,Y);break e}ge&&ge(i,J,V),i==="focusout"&&(ge=J._wrapperState)&&ge.controlled&&J.type==="number"&&Ll(J,"number",J.value)}switch(ge=V?vr(V):window,i){case"focusin":(Tf(ge)||ge.contentEditable==="true")&&(fr=ge,dc=V,vs=null);break;case"focusout":vs=dc=fr=null;break;case"mousedown":hc=!0;break;case"contextmenu":case"mouseup":case"dragend":hc=!1,Of(Z,c,Y);break;case"selectionchange":if(fx)break;case"keydown":case"keyup":Of(Z,c,Y)}var ve;if(ac)e:{switch(i){case"compositionstart":var xe="onCompositionStart";break e;case"compositionend":xe="onCompositionEnd";break e;case"compositionupdate":xe="onCompositionUpdate";break e}xe=void 0}else hr?kf(i,c)&&(xe="onCompositionEnd"):i==="keydown"&&c.keyCode===229&&(xe="onCompositionStart");xe&&(yf&&c.locale!=="ko"&&(hr||xe!=="onCompositionStart"?xe==="onCompositionEnd"&&hr&&(ve=ff()):(oi=Y,tc="value"in oi?oi.value:oi.textContent,hr=!0)),ge=Uo(V,xe),0<ge.length&&(xe=new gf(xe,i,null,c,Y),Z.push({event:xe,listeners:ge}),ve?xe.data=ve:(ve=Sf(c),ve!==null&&(xe.data=ve)))),(ve=tx?nx(i,c):ix(i,c))&&(V=Uo(V,"onBeforeInput"),0<V.length&&(Y=new gf("onBeforeInput","beforeinput",null,c,Y),Z.push({event:Y,listeners:V}),Y.data=ve))}Vf(Z,s)})}function xs(i,s,c){return{instance:i,listener:s,currentTarget:c}}function Uo(i,s){for(var c=s+"Capture",h=[];i!==null;){var g=i,v=g.stateNode;g.tag===5&&v!==null&&(g=v,v=ts(i,c),v!=null&&h.unshift(xs(i,v,g)),v=ts(i,s),v!=null&&h.push(xs(i,v,g))),i=i.return}return h}function mr(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Hf(i,s,c,h,g){for(var v=s._reactName,x=[];c!==null&&c!==h;){var _=c,O=_.alternate,V=_.stateNode;if(O!==null&&O===h)break;_.tag===5&&V!==null&&(_=V,g?(O=ts(c,v),O!=null&&x.unshift(xs(c,O,_))):g||(O=ts(c,v),O!=null&&x.push(xs(c,O,_)))),c=c.return}x.length!==0&&i.push({event:s,listeners:x})}var vx=/\r\n?/g,yx=/\u0000|\uFFFD/g;function $f(i){return(typeof i=="string"?i:""+i).replace(vx,`
`).replace(yx,"")}function Fo(i,s,c){if(s=$f(s),$f(i)!==s&&c)throw Error(n(425))}function Bo(){}var yc=null,bc=null;function xc(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var kc=typeof setTimeout=="function"?setTimeout:void 0,bx=typeof clearTimeout=="function"?clearTimeout:void 0,Wf=typeof Promise=="function"?Promise:void 0,xx=typeof queueMicrotask=="function"?queueMicrotask:typeof Wf<"u"?function(i){return Wf.resolve(null).then(i).catch(kx)}:kc;function kx(i){setTimeout(function(){throw i})}function Sc(i,s){var c=s,h=0;do{var g=c.nextSibling;if(i.removeChild(c),g&&g.nodeType===8)if(c=g.data,c==="/$"){if(h===0){i.removeChild(g),us(s);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=g}while(c);us(s)}function li(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return i}function Gf(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="$"||c==="$!"||c==="$?"){if(s===0)return i;s--}else c==="/$"&&s++}i=i.previousSibling}return null}var gr=Math.random().toString(36).slice(2),bn="__reactFiber$"+gr,ks="__reactProps$"+gr,An="__reactContainer$"+gr,Tc="__reactEvents$"+gr,Sx="__reactListeners$"+gr,Tx="__reactHandles$"+gr;function Ai(i){var s=i[bn];if(s)return s;for(var c=i.parentNode;c;){if(s=c[An]||c[bn]){if(c=s.alternate,s.child!==null||c!==null&&c.child!==null)for(i=Gf(i);i!==null;){if(c=i[bn])return c;i=Gf(i)}return s}i=c,c=i.parentNode}return null}function Ss(i){return i=i[bn]||i[An],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function vr(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(n(33))}function zo(i){return i[ks]||null}var Cc=[],yr=-1;function ci(i){return{current:i}}function Ge(i){0>yr||(i.current=Cc[yr],Cc[yr]=null,yr--)}function $e(i,s){yr++,Cc[yr]=i.current,i.current=s}var ui={},xt=ci(ui),Pt=ci(!1),Di=ui;function br(i,s){var c=i.type.contextTypes;if(!c)return ui;var h=i.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===s)return h.__reactInternalMemoizedMaskedChildContext;var g={},v;for(v in c)g[v]=s[v];return h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=s,i.__reactInternalMemoizedMaskedChildContext=g),g}function Nt(i){return i=i.childContextTypes,i!=null}function Vo(){Ge(Pt),Ge(xt)}function Kf(i,s,c){if(xt.current!==ui)throw Error(n(168));$e(xt,s),$e(Pt,c)}function Jf(i,s,c){var h=i.stateNode;if(s=s.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var g in h)if(!(g in s))throw Error(n(108,ae(i)||"Unknown",g));return oe({},c,h)}function qo(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ui,Di=xt.current,$e(xt,i),$e(Pt,Pt.current),!0}function Qf(i,s,c){var h=i.stateNode;if(!h)throw Error(n(169));c?(i=Jf(i,s,Di),h.__reactInternalMemoizedMergedChildContext=i,Ge(Pt),Ge(xt),$e(xt,i)):Ge(Pt),$e(Pt,c)}var Dn=null,Ho=!1,wc=!1;function Yf(i){Dn===null?Dn=[i]:Dn.push(i)}function Cx(i){Ho=!0,Yf(i)}function di(){if(!wc&&Dn!==null){wc=!0;var i=0,s=Ve;try{var c=Dn;for(Ve=1;i<c.length;i++){var h=c[i];do h=h(!0);while(h!==null)}Dn=null,Ho=!1}catch(g){throw Dn!==null&&(Dn=Dn.slice(i+1)),Xh(Gl,di),g}finally{Ve=s,wc=!1}}return null}var xr=[],kr=0,$o=null,Wo=0,Qt=[],Yt=0,Li=null,Ln=1,Mn="";function Mi(i,s){xr[kr++]=Wo,xr[kr++]=$o,$o=i,Wo=s}function Xf(i,s,c){Qt[Yt++]=Ln,Qt[Yt++]=Mn,Qt[Yt++]=Li,Li=i;var h=Ln;i=Mn;var g=32-nn(h)-1;h&=~(1<<g),c+=1;var v=32-nn(s)+g;if(30<v){var x=g-g%5;v=(h&(1<<x)-1).toString(32),h>>=x,g-=x,Ln=1<<32-nn(s)+g|c<<g|h,Mn=v+i}else Ln=1<<v|c<<g|h,Mn=i}function Ec(i){i.return!==null&&(Mi(i,1),Xf(i,1,0))}function _c(i){for(;i===$o;)$o=xr[--kr],xr[kr]=null,Wo=xr[--kr],xr[kr]=null;for(;i===Li;)Li=Qt[--Yt],Qt[Yt]=null,Mn=Qt[--Yt],Qt[Yt]=null,Ln=Qt[--Yt],Qt[Yt]=null}var qt=null,Ht=null,Je=!1,sn=null;function Zf(i,s){var c=tn(5,null,null,0);c.elementType="DELETED",c.stateNode=s,c.return=i,s=i.deletions,s===null?(i.deletions=[c],i.flags|=16):s.push(c)}function ep(i,s){switch(i.tag){case 5:var c=i.type;return s=s.nodeType!==1||c.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(i.stateNode=s,qt=i,Ht=li(s.firstChild),!0):!1;case 6:return s=i.pendingProps===""||s.nodeType!==3?null:s,s!==null?(i.stateNode=s,qt=i,Ht=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(c=Li!==null?{id:Ln,overflow:Mn}:null,i.memoizedState={dehydrated:s,treeContext:c,retryLane:1073741824},c=tn(18,null,null,0),c.stateNode=s,c.return=i,i.child=c,qt=i,Ht=null,!0):!1;default:return!1}}function Rc(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Pc(i){if(Je){var s=Ht;if(s){var c=s;if(!ep(i,s)){if(Rc(i))throw Error(n(418));s=li(c.nextSibling);var h=qt;s&&ep(i,s)?Zf(h,c):(i.flags=i.flags&-4097|2,Je=!1,qt=i)}}else{if(Rc(i))throw Error(n(418));i.flags=i.flags&-4097|2,Je=!1,qt=i}}}function tp(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;qt=i}function Go(i){if(i!==qt)return!1;if(!Je)return tp(i),Je=!0,!1;var s;if((s=i.tag!==3)&&!(s=i.tag!==5)&&(s=i.type,s=s!=="head"&&s!=="body"&&!xc(i.type,i.memoizedProps)),s&&(s=Ht)){if(Rc(i))throw np(),Error(n(418));for(;s;)Zf(i,s),s=li(s.nextSibling)}if(tp(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8){var c=i.data;if(c==="/$"){if(s===0){Ht=li(i.nextSibling);break e}s--}else c!=="$"&&c!=="$!"&&c!=="$?"||s++}i=i.nextSibling}Ht=null}}else Ht=qt?li(i.stateNode.nextSibling):null;return!0}function np(){for(var i=Ht;i;)i=li(i.nextSibling)}function Sr(){Ht=qt=null,Je=!1}function Nc(i){sn===null?sn=[i]:sn.push(i)}var wx=E.ReactCurrentBatchConfig;function Ts(i,s,c){if(i=c.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(n(309));var h=c.stateNode}if(!h)throw Error(n(147,i));var g=h,v=""+i;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===v?s.ref:(s=function(x){var _=g.refs;x===null?delete _[v]:_[v]=x},s._stringRef=v,s)}if(typeof i!="string")throw Error(n(284));if(!c._owner)throw Error(n(290,i))}return i}function Ko(i,s){throw i=Object.prototype.toString.call(s),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i))}function ip(i){var s=i._init;return s(i._payload)}function rp(i){function s(U,D){if(i){var F=U.deletions;F===null?(U.deletions=[D],U.flags|=16):F.push(D)}}function c(U,D){if(!i)return null;for(;D!==null;)s(U,D),D=D.sibling;return null}function h(U,D){for(U=new Map;D!==null;)D.key!==null?U.set(D.key,D):U.set(D.index,D),D=D.sibling;return U}function g(U,D){return U=bi(U,D),U.index=0,U.sibling=null,U}function v(U,D,F){return U.index=F,i?(F=U.alternate,F!==null?(F=F.index,F<D?(U.flags|=2,D):F):(U.flags|=2,D)):(U.flags|=1048576,D)}function x(U){return i&&U.alternate===null&&(U.flags|=2),U}function _(U,D,F,te){return D===null||D.tag!==6?(D=ku(F,U.mode,te),D.return=U,D):(D=g(D,F),D.return=U,D)}function O(U,D,F,te){var fe=F.type;return fe===I?Y(U,D,F.props.children,te,F.key):D!==null&&(D.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===Se&&ip(fe)===D.type)?(te=g(D,F.props),te.ref=Ts(U,D,F),te.return=U,te):(te=ya(F.type,F.key,F.props,null,U.mode,te),te.ref=Ts(U,D,F),te.return=U,te)}function V(U,D,F,te){return D===null||D.tag!==4||D.stateNode.containerInfo!==F.containerInfo||D.stateNode.implementation!==F.implementation?(D=Su(F,U.mode,te),D.return=U,D):(D=g(D,F.children||[]),D.return=U,D)}function Y(U,D,F,te,fe){return D===null||D.tag!==7?(D=$i(F,U.mode,te,fe),D.return=U,D):(D=g(D,F),D.return=U,D)}function Z(U,D,F){if(typeof D=="string"&&D!==""||typeof D=="number")return D=ku(""+D,U.mode,F),D.return=U,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case R:return F=ya(D.type,D.key,D.props,null,U.mode,F),F.ref=Ts(U,null,D),F.return=U,F;case B:return D=Su(D,U.mode,F),D.return=U,D;case Se:var te=D._init;return Z(U,te(D._payload),F)}if(Xr(D)||pe(D))return D=$i(D,U.mode,F,null),D.return=U,D;Ko(U,D)}return null}function J(U,D,F,te){var fe=D!==null?D.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return fe!==null?null:_(U,D,""+F,te);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case R:return F.key===fe?O(U,D,F,te):null;case B:return F.key===fe?V(U,D,F,te):null;case Se:return fe=F._init,J(U,D,fe(F._payload),te)}if(Xr(F)||pe(F))return fe!==null?null:Y(U,D,F,te,null);Ko(U,F)}return null}function le(U,D,F,te,fe){if(typeof te=="string"&&te!==""||typeof te=="number")return U=U.get(F)||null,_(D,U,""+te,fe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case R:return U=U.get(te.key===null?F:te.key)||null,O(D,U,te,fe);case B:return U=U.get(te.key===null?F:te.key)||null,V(D,U,te,fe);case Se:var ge=te._init;return le(U,D,F,ge(te._payload),fe)}if(Xr(te)||pe(te))return U=U.get(F)||null,Y(D,U,te,fe,null);Ko(D,te)}return null}function de(U,D,F,te){for(var fe=null,ge=null,ve=D,xe=D=0,pt=null;ve!==null&&xe<F.length;xe++){ve.index>xe?(pt=ve,ve=null):pt=ve.sibling;var Fe=J(U,ve,F[xe],te);if(Fe===null){ve===null&&(ve=pt);break}i&&ve&&Fe.alternate===null&&s(U,ve),D=v(Fe,D,xe),ge===null?fe=Fe:ge.sibling=Fe,ge=Fe,ve=pt}if(xe===F.length)return c(U,ve),Je&&Mi(U,xe),fe;if(ve===null){for(;xe<F.length;xe++)ve=Z(U,F[xe],te),ve!==null&&(D=v(ve,D,xe),ge===null?fe=ve:ge.sibling=ve,ge=ve);return Je&&Mi(U,xe),fe}for(ve=h(U,ve);xe<F.length;xe++)pt=le(ve,U,xe,F[xe],te),pt!==null&&(i&&pt.alternate!==null&&ve.delete(pt.key===null?xe:pt.key),D=v(pt,D,xe),ge===null?fe=pt:ge.sibling=pt,ge=pt);return i&&ve.forEach(function(xi){return s(U,xi)}),Je&&Mi(U,xe),fe}function he(U,D,F,te){var fe=pe(F);if(typeof fe!="function")throw Error(n(150));if(F=fe.call(F),F==null)throw Error(n(151));for(var ge=fe=null,ve=D,xe=D=0,pt=null,Fe=F.next();ve!==null&&!Fe.done;xe++,Fe=F.next()){ve.index>xe?(pt=ve,ve=null):pt=ve.sibling;var xi=J(U,ve,Fe.value,te);if(xi===null){ve===null&&(ve=pt);break}i&&ve&&xi.alternate===null&&s(U,ve),D=v(xi,D,xe),ge===null?fe=xi:ge.sibling=xi,ge=xi,ve=pt}if(Fe.done)return c(U,ve),Je&&Mi(U,xe),fe;if(ve===null){for(;!Fe.done;xe++,Fe=F.next())Fe=Z(U,Fe.value,te),Fe!==null&&(D=v(Fe,D,xe),ge===null?fe=Fe:ge.sibling=Fe,ge=Fe);return Je&&Mi(U,xe),fe}for(ve=h(U,ve);!Fe.done;xe++,Fe=F.next())Fe=le(ve,U,xe,Fe.value,te),Fe!==null&&(i&&Fe.alternate!==null&&ve.delete(Fe.key===null?xe:Fe.key),D=v(Fe,D,xe),ge===null?fe=Fe:ge.sibling=Fe,ge=Fe);return i&&ve.forEach(function(rk){return s(U,rk)}),Je&&Mi(U,xe),fe}function st(U,D,F,te){if(typeof F=="object"&&F!==null&&F.type===I&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case R:e:{for(var fe=F.key,ge=D;ge!==null;){if(ge.key===fe){if(fe=F.type,fe===I){if(ge.tag===7){c(U,ge.sibling),D=g(ge,F.props.children),D.return=U,U=D;break e}}else if(ge.elementType===fe||typeof fe=="object"&&fe!==null&&fe.$$typeof===Se&&ip(fe)===ge.type){c(U,ge.sibling),D=g(ge,F.props),D.ref=Ts(U,ge,F),D.return=U,U=D;break e}c(U,ge);break}else s(U,ge);ge=ge.sibling}F.type===I?(D=$i(F.props.children,U.mode,te,F.key),D.return=U,U=D):(te=ya(F.type,F.key,F.props,null,U.mode,te),te.ref=Ts(U,D,F),te.return=U,U=te)}return x(U);case B:e:{for(ge=F.key;D!==null;){if(D.key===ge)if(D.tag===4&&D.stateNode.containerInfo===F.containerInfo&&D.stateNode.implementation===F.implementation){c(U,D.sibling),D=g(D,F.children||[]),D.return=U,U=D;break e}else{c(U,D);break}else s(U,D);D=D.sibling}D=Su(F,U.mode,te),D.return=U,U=D}return x(U);case Se:return ge=F._init,st(U,D,ge(F._payload),te)}if(Xr(F))return de(U,D,F,te);if(pe(F))return he(U,D,F,te);Ko(U,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,D!==null&&D.tag===6?(c(U,D.sibling),D=g(D,F),D.return=U,U=D):(c(U,D),D=ku(F,U.mode,te),D.return=U,U=D),x(U)):c(U,D)}return st}var Tr=rp(!0),sp=rp(!1),Jo=ci(null),Qo=null,Cr=null,Ic=null;function jc(){Ic=Cr=Qo=null}function Oc(i){var s=Jo.current;Ge(Jo),i._currentValue=s}function Ac(i,s,c){for(;i!==null;){var h=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),i===c)break;i=i.return}}function wr(i,s){Qo=i,Ic=Cr=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&s)!==0&&(It=!0),i.firstContext=null)}function Xt(i){var s=i._currentValue;if(Ic!==i)if(i={context:i,memoizedValue:s,next:null},Cr===null){if(Qo===null)throw Error(n(308));Cr=i,Qo.dependencies={lanes:0,firstContext:i}}else Cr=Cr.next=i;return s}var Ui=null;function Dc(i){Ui===null?Ui=[i]:Ui.push(i)}function op(i,s,c,h){var g=s.interleaved;return g===null?(c.next=c,Dc(s)):(c.next=g.next,g.next=c),s.interleaved=c,Un(i,h)}function Un(i,s){i.lanes|=s;var c=i.alternate;for(c!==null&&(c.lanes|=s),c=i,i=i.return;i!==null;)i.childLanes|=s,c=i.alternate,c!==null&&(c.childLanes|=s),c=i,i=i.return;return c.tag===3?c.stateNode:null}var hi=!1;function Lc(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ap(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Fn(i,s){return{eventTime:i,lane:s,tag:0,payload:null,callback:null,next:null}}function fi(i,s,c){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Ue&2)!==0){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,Un(i,c)}return g=h.interleaved,g===null?(s.next=s,Dc(h)):(s.next=g.next,g.next=s),h.interleaved=s,Un(i,c)}function Yo(i,s,c){if(s=s.updateQueue,s!==null&&(s=s.shared,(c&4194240)!==0)){var h=s.lanes;h&=i.pendingLanes,c|=h,s.lanes=c,Ql(i,c)}}function lp(i,s){var c=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var g=null,v=null;if(c=c.firstBaseUpdate,c!==null){do{var x={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};v===null?g=v=x:v=v.next=x,c=c.next}while(c!==null);v===null?g=v=s:v=v.next=s}else g=v=s;c={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:v,shared:h.shared,effects:h.effects},i.updateQueue=c;return}i=c.lastBaseUpdate,i===null?c.firstBaseUpdate=s:i.next=s,c.lastBaseUpdate=s}function Xo(i,s,c,h){var g=i.updateQueue;hi=!1;var v=g.firstBaseUpdate,x=g.lastBaseUpdate,_=g.shared.pending;if(_!==null){g.shared.pending=null;var O=_,V=O.next;O.next=null,x===null?v=V:x.next=V,x=O;var Y=i.alternate;Y!==null&&(Y=Y.updateQueue,_=Y.lastBaseUpdate,_!==x&&(_===null?Y.firstBaseUpdate=V:_.next=V,Y.lastBaseUpdate=O))}if(v!==null){var Z=g.baseState;x=0,Y=V=O=null,_=v;do{var J=_.lane,le=_.eventTime;if((h&J)===J){Y!==null&&(Y=Y.next={eventTime:le,lane:0,tag:_.tag,payload:_.payload,callback:_.callback,next:null});e:{var de=i,he=_;switch(J=s,le=c,he.tag){case 1:if(de=he.payload,typeof de=="function"){Z=de.call(le,Z,J);break e}Z=de;break e;case 3:de.flags=de.flags&-65537|128;case 0:if(de=he.payload,J=typeof de=="function"?de.call(le,Z,J):de,J==null)break e;Z=oe({},Z,J);break e;case 2:hi=!0}}_.callback!==null&&_.lane!==0&&(i.flags|=64,J=g.effects,J===null?g.effects=[_]:J.push(_))}else le={eventTime:le,lane:J,tag:_.tag,payload:_.payload,callback:_.callback,next:null},Y===null?(V=Y=le,O=Z):Y=Y.next=le,x|=J;if(_=_.next,_===null){if(_=g.shared.pending,_===null)break;J=_,_=J.next,J.next=null,g.lastBaseUpdate=J,g.shared.pending=null}}while(!0);if(Y===null&&(O=Z),g.baseState=O,g.firstBaseUpdate=V,g.lastBaseUpdate=Y,s=g.shared.interleaved,s!==null){g=s;do x|=g.lane,g=g.next;while(g!==s)}else v===null&&(g.shared.lanes=0);zi|=x,i.lanes=x,i.memoizedState=Z}}function cp(i,s,c){if(i=s.effects,s.effects=null,i!==null)for(s=0;s<i.length;s++){var h=i[s],g=h.callback;if(g!==null){if(h.callback=null,h=c,typeof g!="function")throw Error(n(191,g));g.call(h)}}}var Cs={},xn=ci(Cs),ws=ci(Cs),Es=ci(Cs);function Fi(i){if(i===Cs)throw Error(n(174));return i}function Mc(i,s){switch($e(Es,s),$e(ws,i),$e(xn,Cs),i=s.nodeType,i){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Ul(null,"");break;default:i=i===8?s.parentNode:s,s=i.namespaceURI||null,i=i.tagName,s=Ul(s,i)}Ge(xn),$e(xn,s)}function Er(){Ge(xn),Ge(ws),Ge(Es)}function up(i){Fi(Es.current);var s=Fi(xn.current),c=Ul(s,i.type);s!==c&&($e(ws,i),$e(xn,c))}function Uc(i){ws.current===i&&(Ge(xn),Ge(ws))}var Ye=ci(0);function Zo(i){for(var s=i;s!==null;){if(s.tag===13){var c=s.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Fc=[];function Bc(){for(var i=0;i<Fc.length;i++)Fc[i]._workInProgressVersionPrimary=null;Fc.length=0}var ea=E.ReactCurrentDispatcher,zc=E.ReactCurrentBatchConfig,Bi=0,Xe=null,ct=null,ht=null,ta=!1,_s=!1,Rs=0,Ex=0;function kt(){throw Error(n(321))}function Vc(i,s){if(s===null)return!1;for(var c=0;c<s.length&&c<i.length;c++)if(!rn(i[c],s[c]))return!1;return!0}function qc(i,s,c,h,g,v){if(Bi=v,Xe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,ea.current=i===null||i.memoizedState===null?Nx:Ix,i=c(h,g),_s){v=0;do{if(_s=!1,Rs=0,25<=v)throw Error(n(301));v+=1,ht=ct=null,s.updateQueue=null,ea.current=jx,i=c(h,g)}while(_s)}if(ea.current=ra,s=ct!==null&&ct.next!==null,Bi=0,ht=ct=Xe=null,ta=!1,s)throw Error(n(300));return i}function Hc(){var i=Rs!==0;return Rs=0,i}function kn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?Xe.memoizedState=ht=i:ht=ht.next=i,ht}function Zt(){if(ct===null){var i=Xe.alternate;i=i!==null?i.memoizedState:null}else i=ct.next;var s=ht===null?Xe.memoizedState:ht.next;if(s!==null)ht=s,ct=i;else{if(i===null)throw Error(n(310));ct=i,i={memoizedState:ct.memoizedState,baseState:ct.baseState,baseQueue:ct.baseQueue,queue:ct.queue,next:null},ht===null?Xe.memoizedState=ht=i:ht=ht.next=i}return ht}function Ps(i,s){return typeof s=="function"?s(i):s}function $c(i){var s=Zt(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var h=ct,g=h.baseQueue,v=c.pending;if(v!==null){if(g!==null){var x=g.next;g.next=v.next,v.next=x}h.baseQueue=g=v,c.pending=null}if(g!==null){v=g.next,h=h.baseState;var _=x=null,O=null,V=v;do{var Y=V.lane;if((Bi&Y)===Y)O!==null&&(O=O.next={lane:0,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null}),h=V.hasEagerState?V.eagerState:i(h,V.action);else{var Z={lane:Y,action:V.action,hasEagerState:V.hasEagerState,eagerState:V.eagerState,next:null};O===null?(_=O=Z,x=h):O=O.next=Z,Xe.lanes|=Y,zi|=Y}V=V.next}while(V!==null&&V!==v);O===null?x=h:O.next=_,rn(h,s.memoizedState)||(It=!0),s.memoizedState=h,s.baseState=x,s.baseQueue=O,c.lastRenderedState=h}if(i=c.interleaved,i!==null){g=i;do v=g.lane,Xe.lanes|=v,zi|=v,g=g.next;while(g!==i)}else g===null&&(c.lanes=0);return[s.memoizedState,c.dispatch]}function Wc(i){var s=Zt(),c=s.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=i;var h=c.dispatch,g=c.pending,v=s.memoizedState;if(g!==null){c.pending=null;var x=g=g.next;do v=i(v,x.action),x=x.next;while(x!==g);rn(v,s.memoizedState)||(It=!0),s.memoizedState=v,s.baseQueue===null&&(s.baseState=v),c.lastRenderedState=v}return[v,h]}function dp(){}function hp(i,s){var c=Xe,h=Zt(),g=s(),v=!rn(h.memoizedState,g);if(v&&(h.memoizedState=g,It=!0),h=h.queue,Gc(mp.bind(null,c,h,i),[i]),h.getSnapshot!==s||v||ht!==null&&ht.memoizedState.tag&1){if(c.flags|=2048,Ns(9,pp.bind(null,c,h,g,s),void 0,null),ft===null)throw Error(n(349));(Bi&30)!==0||fp(c,s,g)}return g}function fp(i,s,c){i.flags|=16384,i={getSnapshot:s,value:c},s=Xe.updateQueue,s===null?(s={lastEffect:null,stores:null},Xe.updateQueue=s,s.stores=[i]):(c=s.stores,c===null?s.stores=[i]:c.push(i))}function pp(i,s,c,h){s.value=c,s.getSnapshot=h,gp(s)&&vp(i)}function mp(i,s,c){return c(function(){gp(s)&&vp(i)})}function gp(i){var s=i.getSnapshot;i=i.value;try{var c=s();return!rn(i,c)}catch{return!0}}function vp(i){var s=Un(i,1);s!==null&&cn(s,i,1,-1)}function yp(i){var s=kn();return typeof i=="function"&&(i=i()),s.memoizedState=s.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ps,lastRenderedState:i},s.queue=i,i=i.dispatch=Px.bind(null,Xe,i),[s.memoizedState,i]}function Ns(i,s,c,h){return i={tag:i,create:s,destroy:c,deps:h,next:null},s=Xe.updateQueue,s===null?(s={lastEffect:null,stores:null},Xe.updateQueue=s,s.lastEffect=i.next=i):(c=s.lastEffect,c===null?s.lastEffect=i.next=i:(h=c.next,c.next=i,i.next=h,s.lastEffect=i)),i}function bp(){return Zt().memoizedState}function na(i,s,c,h){var g=kn();Xe.flags|=i,g.memoizedState=Ns(1|s,c,void 0,h===void 0?null:h)}function ia(i,s,c,h){var g=Zt();h=h===void 0?null:h;var v=void 0;if(ct!==null){var x=ct.memoizedState;if(v=x.destroy,h!==null&&Vc(h,x.deps)){g.memoizedState=Ns(s,c,v,h);return}}Xe.flags|=i,g.memoizedState=Ns(1|s,c,v,h)}function xp(i,s){return na(8390656,8,i,s)}function Gc(i,s){return ia(2048,8,i,s)}function kp(i,s){return ia(4,2,i,s)}function Sp(i,s){return ia(4,4,i,s)}function Tp(i,s){if(typeof s=="function")return i=i(),s(i),function(){s(null)};if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function Cp(i,s,c){return c=c!=null?c.concat([i]):null,ia(4,4,Tp.bind(null,s,i),c)}function Kc(){}function wp(i,s){var c=Zt();s=s===void 0?null:s;var h=c.memoizedState;return h!==null&&s!==null&&Vc(s,h[1])?h[0]:(c.memoizedState=[i,s],i)}function Ep(i,s){var c=Zt();s=s===void 0?null:s;var h=c.memoizedState;return h!==null&&s!==null&&Vc(s,h[1])?h[0]:(i=i(),c.memoizedState=[i,s],i)}function _p(i,s,c){return(Bi&21)===0?(i.baseState&&(i.baseState=!1,It=!0),i.memoizedState=c):(rn(c,s)||(c=nf(),Xe.lanes|=c,zi|=c,i.baseState=!0),s)}function _x(i,s){var c=Ve;Ve=c!==0&&4>c?c:4,i(!0);var h=zc.transition;zc.transition={};try{i(!1),s()}finally{Ve=c,zc.transition=h}}function Rp(){return Zt().memoizedState}function Rx(i,s,c){var h=vi(i);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},Pp(i))Np(s,c);else if(c=op(i,s,c,h),c!==null){var g=Et();cn(c,i,h,g),Ip(c,s,h)}}function Px(i,s,c){var h=vi(i),g={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(Pp(i))Np(s,g);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=s.lastRenderedReducer,v!==null))try{var x=s.lastRenderedState,_=v(x,c);if(g.hasEagerState=!0,g.eagerState=_,rn(_,x)){var O=s.interleaved;O===null?(g.next=g,Dc(s)):(g.next=O.next,O.next=g),s.interleaved=g;return}}catch{}finally{}c=op(i,s,g,h),c!==null&&(g=Et(),cn(c,i,h,g),Ip(c,s,h))}}function Pp(i){var s=i.alternate;return i===Xe||s!==null&&s===Xe}function Np(i,s){_s=ta=!0;var c=i.pending;c===null?s.next=s:(s.next=c.next,c.next=s),i.pending=s}function Ip(i,s,c){if((c&4194240)!==0){var h=s.lanes;h&=i.pendingLanes,c|=h,s.lanes=c,Ql(i,c)}}var ra={readContext:Xt,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},Nx={readContext:Xt,useCallback:function(i,s){return kn().memoizedState=[i,s===void 0?null:s],i},useContext:Xt,useEffect:xp,useImperativeHandle:function(i,s,c){return c=c!=null?c.concat([i]):null,na(4194308,4,Tp.bind(null,s,i),c)},useLayoutEffect:function(i,s){return na(4194308,4,i,s)},useInsertionEffect:function(i,s){return na(4,2,i,s)},useMemo:function(i,s){var c=kn();return s=s===void 0?null:s,i=i(),c.memoizedState=[i,s],i},useReducer:function(i,s,c){var h=kn();return s=c!==void 0?c(s):s,h.memoizedState=h.baseState=s,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:s},h.queue=i,i=i.dispatch=Rx.bind(null,Xe,i),[h.memoizedState,i]},useRef:function(i){var s=kn();return i={current:i},s.memoizedState=i},useState:yp,useDebugValue:Kc,useDeferredValue:function(i){return kn().memoizedState=i},useTransition:function(){var i=yp(!1),s=i[0];return i=_x.bind(null,i[1]),kn().memoizedState=i,[s,i]},useMutableSource:function(){},useSyncExternalStore:function(i,s,c){var h=Xe,g=kn();if(Je){if(c===void 0)throw Error(n(407));c=c()}else{if(c=s(),ft===null)throw Error(n(349));(Bi&30)!==0||fp(h,s,c)}g.memoizedState=c;var v={value:c,getSnapshot:s};return g.queue=v,xp(mp.bind(null,h,v,i),[i]),h.flags|=2048,Ns(9,pp.bind(null,h,v,c,s),void 0,null),c},useId:function(){var i=kn(),s=ft.identifierPrefix;if(Je){var c=Mn,h=Ln;c=(h&~(1<<32-nn(h)-1)).toString(32)+c,s=":"+s+"R"+c,c=Rs++,0<c&&(s+="H"+c.toString(32)),s+=":"}else c=Ex++,s=":"+s+"r"+c.toString(32)+":";return i.memoizedState=s},unstable_isNewReconciler:!1},Ix={readContext:Xt,useCallback:wp,useContext:Xt,useEffect:Gc,useImperativeHandle:Cp,useInsertionEffect:kp,useLayoutEffect:Sp,useMemo:Ep,useReducer:$c,useRef:bp,useState:function(){return $c(Ps)},useDebugValue:Kc,useDeferredValue:function(i){var s=Zt();return _p(s,ct.memoizedState,i)},useTransition:function(){var i=$c(Ps)[0],s=Zt().memoizedState;return[i,s]},useMutableSource:dp,useSyncExternalStore:hp,useId:Rp,unstable_isNewReconciler:!1},jx={readContext:Xt,useCallback:wp,useContext:Xt,useEffect:Gc,useImperativeHandle:Cp,useInsertionEffect:kp,useLayoutEffect:Sp,useMemo:Ep,useReducer:Wc,useRef:bp,useState:function(){return Wc(Ps)},useDebugValue:Kc,useDeferredValue:function(i){var s=Zt();return ct===null?s.memoizedState=i:_p(s,ct.memoizedState,i)},useTransition:function(){var i=Wc(Ps)[0],s=Zt().memoizedState;return[i,s]},useMutableSource:dp,useSyncExternalStore:hp,useId:Rp,unstable_isNewReconciler:!1};function on(i,s){if(i&&i.defaultProps){s=oe({},s),i=i.defaultProps;for(var c in i)s[c]===void 0&&(s[c]=i[c]);return s}return s}function Jc(i,s,c,h){s=i.memoizedState,c=c(h,s),c=c==null?s:oe({},s,c),i.memoizedState=c,i.lanes===0&&(i.updateQueue.baseState=c)}var sa={isMounted:function(i){return(i=i._reactInternals)?Oi(i)===i:!1},enqueueSetState:function(i,s,c){i=i._reactInternals;var h=Et(),g=vi(i),v=Fn(h,g);v.payload=s,c!=null&&(v.callback=c),s=fi(i,v,g),s!==null&&(cn(s,i,g,h),Yo(s,i,g))},enqueueReplaceState:function(i,s,c){i=i._reactInternals;var h=Et(),g=vi(i),v=Fn(h,g);v.tag=1,v.payload=s,c!=null&&(v.callback=c),s=fi(i,v,g),s!==null&&(cn(s,i,g,h),Yo(s,i,g))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var c=Et(),h=vi(i),g=Fn(c,h);g.tag=2,s!=null&&(g.callback=s),s=fi(i,g,h),s!==null&&(cn(s,i,h,c),Yo(s,i,h))}};function jp(i,s,c,h,g,v,x){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,v,x):s.prototype&&s.prototype.isPureReactComponent?!gs(c,h)||!gs(g,v):!0}function Op(i,s,c){var h=!1,g=ui,v=s.contextType;return typeof v=="object"&&v!==null?v=Xt(v):(g=Nt(s)?Di:xt.current,h=s.contextTypes,v=(h=h!=null)?br(i,g):ui),s=new s(c,v),i.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=sa,i.stateNode=s,s._reactInternals=i,h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=g,i.__reactInternalMemoizedMaskedChildContext=v),s}function Ap(i,s,c,h){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(c,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(c,h),s.state!==i&&sa.enqueueReplaceState(s,s.state,null)}function Qc(i,s,c,h){var g=i.stateNode;g.props=c,g.state=i.memoizedState,g.refs={},Lc(i);var v=s.contextType;typeof v=="object"&&v!==null?g.context=Xt(v):(v=Nt(s)?Di:xt.current,g.context=br(i,v)),g.state=i.memoizedState,v=s.getDerivedStateFromProps,typeof v=="function"&&(Jc(i,s,v,c),g.state=i.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof g.getSnapshotBeforeUpdate=="function"||typeof g.UNSAFE_componentWillMount!="function"&&typeof g.componentWillMount!="function"||(s=g.state,typeof g.componentWillMount=="function"&&g.componentWillMount(),typeof g.UNSAFE_componentWillMount=="function"&&g.UNSAFE_componentWillMount(),s!==g.state&&sa.enqueueReplaceState(g,g.state,null),Xo(i,c,g,h),g.state=i.memoizedState),typeof g.componentDidMount=="function"&&(i.flags|=4194308)}function _r(i,s){try{var c="",h=s;do c+=je(h),h=h.return;while(h);var g=c}catch(v){g=`
Error generating stack: `+v.message+`
`+v.stack}return{value:i,source:s,stack:g,digest:null}}function Yc(i,s,c){return{value:i,source:null,stack:c??null,digest:s??null}}function Xc(i,s){try{console.error(s.value)}catch(c){setTimeout(function(){throw c})}}var Ox=typeof WeakMap=="function"?WeakMap:Map;function Dp(i,s,c){c=Fn(-1,c),c.tag=3,c.payload={element:null};var h=s.value;return c.callback=function(){ha||(ha=!0,fu=h),Xc(i,s)},c}function Lp(i,s,c){c=Fn(-1,c),c.tag=3;var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var g=s.value;c.payload=function(){return h(g)},c.callback=function(){Xc(i,s)}}var v=i.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(c.callback=function(){Xc(i,s),typeof h!="function"&&(mi===null?mi=new Set([this]):mi.add(this));var x=s.stack;this.componentDidCatch(s.value,{componentStack:x!==null?x:""})}),c}function Mp(i,s,c){var h=i.pingCache;if(h===null){h=i.pingCache=new Ox;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(c)||(g.add(c),i=Gx.bind(null,i,s,c),s.then(i,i))}function Up(i){do{var s;if((s=i.tag===13)&&(s=i.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return i;i=i.return}while(i!==null);return null}function Fp(i,s,c,h,g){return(i.mode&1)===0?(i===s?i.flags|=65536:(i.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(s=Fn(-1,1),s.tag=2,fi(c,s,1))),c.lanes|=1),i):(i.flags|=65536,i.lanes=g,i)}var Ax=E.ReactCurrentOwner,It=!1;function wt(i,s,c,h){s.child=i===null?sp(s,null,c,h):Tr(s,i.child,c,h)}function Bp(i,s,c,h,g){c=c.render;var v=s.ref;return wr(s,g),h=qc(i,s,c,h,v,g),c=Hc(),i!==null&&!It?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~g,Bn(i,s,g)):(Je&&c&&Ec(s),s.flags|=1,wt(i,s,h,g),s.child)}function zp(i,s,c,h,g){if(i===null){var v=c.type;return typeof v=="function"&&!xu(v)&&v.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(s.tag=15,s.type=v,Vp(i,s,v,h,g)):(i=ya(c.type,null,h,s,s.mode,g),i.ref=s.ref,i.return=s,s.child=i)}if(v=i.child,(i.lanes&g)===0){var x=v.memoizedProps;if(c=c.compare,c=c!==null?c:gs,c(x,h)&&i.ref===s.ref)return Bn(i,s,g)}return s.flags|=1,i=bi(v,h),i.ref=s.ref,i.return=s,s.child=i}function Vp(i,s,c,h,g){if(i!==null){var v=i.memoizedProps;if(gs(v,h)&&i.ref===s.ref)if(It=!1,s.pendingProps=h=v,(i.lanes&g)!==0)(i.flags&131072)!==0&&(It=!0);else return s.lanes=i.lanes,Bn(i,s,g)}return Zc(i,s,c,h,g)}function qp(i,s,c){var h=s.pendingProps,g=h.children,v=i!==null?i.memoizedState:null;if(h.mode==="hidden")if((s.mode&1)===0)s.memoizedState={baseLanes:0,cachePool:null,transitions:null},$e(Pr,$t),$t|=c;else{if((c&1073741824)===0)return i=v!==null?v.baseLanes|c:c,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:i,cachePool:null,transitions:null},s.updateQueue=null,$e(Pr,$t),$t|=i,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=v!==null?v.baseLanes:c,$e(Pr,$t),$t|=h}else v!==null?(h=v.baseLanes|c,s.memoizedState=null):h=c,$e(Pr,$t),$t|=h;return wt(i,s,g,c),s.child}function Hp(i,s){var c=s.ref;(i===null&&c!==null||i!==null&&i.ref!==c)&&(s.flags|=512,s.flags|=2097152)}function Zc(i,s,c,h,g){var v=Nt(c)?Di:xt.current;return v=br(s,v),wr(s,g),c=qc(i,s,c,h,v,g),h=Hc(),i!==null&&!It?(s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~g,Bn(i,s,g)):(Je&&h&&Ec(s),s.flags|=1,wt(i,s,c,g),s.child)}function $p(i,s,c,h,g){if(Nt(c)){var v=!0;qo(s)}else v=!1;if(wr(s,g),s.stateNode===null)aa(i,s),Op(s,c,h),Qc(s,c,h,g),h=!0;else if(i===null){var x=s.stateNode,_=s.memoizedProps;x.props=_;var O=x.context,V=c.contextType;typeof V=="object"&&V!==null?V=Xt(V):(V=Nt(c)?Di:xt.current,V=br(s,V));var Y=c.getDerivedStateFromProps,Z=typeof Y=="function"||typeof x.getSnapshotBeforeUpdate=="function";Z||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(_!==h||O!==V)&&Ap(s,x,h,V),hi=!1;var J=s.memoizedState;x.state=J,Xo(s,h,x,g),O=s.memoizedState,_!==h||J!==O||Pt.current||hi?(typeof Y=="function"&&(Jc(s,c,Y,h),O=s.memoizedState),(_=hi||jp(s,c,_,h,J,O,V))?(Z||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(s.flags|=4194308)):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=O),x.props=h,x.state=O,x.context=V,h=_):(typeof x.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{x=s.stateNode,ap(i,s),_=s.memoizedProps,V=s.type===s.elementType?_:on(s.type,_),x.props=V,Z=s.pendingProps,J=x.context,O=c.contextType,typeof O=="object"&&O!==null?O=Xt(O):(O=Nt(c)?Di:xt.current,O=br(s,O));var le=c.getDerivedStateFromProps;(Y=typeof le=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(_!==Z||J!==O)&&Ap(s,x,h,O),hi=!1,J=s.memoizedState,x.state=J,Xo(s,h,x,g);var de=s.memoizedState;_!==Z||J!==de||Pt.current||hi?(typeof le=="function"&&(Jc(s,c,le,h),de=s.memoizedState),(V=hi||jp(s,c,V,h,J,de,O)||!1)?(Y||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,de,O),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,de,O)),typeof x.componentDidUpdate=="function"&&(s.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof x.componentDidUpdate!="function"||_===i.memoizedProps&&J===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||_===i.memoizedProps&&J===i.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=de),x.props=h,x.state=de,x.context=O,h=V):(typeof x.componentDidUpdate!="function"||_===i.memoizedProps&&J===i.memoizedState||(s.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||_===i.memoizedProps&&J===i.memoizedState||(s.flags|=1024),h=!1)}return eu(i,s,c,h,v,g)}function eu(i,s,c,h,g,v){Hp(i,s);var x=(s.flags&128)!==0;if(!h&&!x)return g&&Qf(s,c,!1),Bn(i,s,v);h=s.stateNode,Ax.current=s;var _=x&&typeof c.getDerivedStateFromError!="function"?null:h.render();return s.flags|=1,i!==null&&x?(s.child=Tr(s,i.child,null,v),s.child=Tr(s,null,_,v)):wt(i,s,_,v),s.memoizedState=h.state,g&&Qf(s,c,!0),s.child}function Wp(i){var s=i.stateNode;s.pendingContext?Kf(i,s.pendingContext,s.pendingContext!==s.context):s.context&&Kf(i,s.context,!1),Mc(i,s.containerInfo)}function Gp(i,s,c,h,g){return Sr(),Nc(g),s.flags|=256,wt(i,s,c,h),s.child}var tu={dehydrated:null,treeContext:null,retryLane:0};function nu(i){return{baseLanes:i,cachePool:null,transitions:null}}function Kp(i,s,c){var h=s.pendingProps,g=Ye.current,v=!1,x=(s.flags&128)!==0,_;if((_=x)||(_=i!==null&&i.memoizedState===null?!1:(g&2)!==0),_?(v=!0,s.flags&=-129):(i===null||i.memoizedState!==null)&&(g|=1),$e(Ye,g&1),i===null)return Pc(s),i=s.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((s.mode&1)===0?s.lanes=1:i.data==="$!"?s.lanes=8:s.lanes=1073741824,null):(x=h.children,i=h.fallback,v?(h=s.mode,v=s.child,x={mode:"hidden",children:x},(h&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=x):v=ba(x,h,0,null),i=$i(i,h,c,null),v.return=s,i.return=s,v.sibling=i,s.child=v,s.child.memoizedState=nu(c),s.memoizedState=tu,i):iu(s,x));if(g=i.memoizedState,g!==null&&(_=g.dehydrated,_!==null))return Dx(i,s,x,h,_,g,c);if(v){v=h.fallback,x=s.mode,g=i.child,_=g.sibling;var O={mode:"hidden",children:h.children};return(x&1)===0&&s.child!==g?(h=s.child,h.childLanes=0,h.pendingProps=O,s.deletions=null):(h=bi(g,O),h.subtreeFlags=g.subtreeFlags&14680064),_!==null?v=bi(_,v):(v=$i(v,x,c,null),v.flags|=2),v.return=s,h.return=s,h.sibling=v,s.child=h,h=v,v=s.child,x=i.child.memoizedState,x=x===null?nu(c):{baseLanes:x.baseLanes|c,cachePool:null,transitions:x.transitions},v.memoizedState=x,v.childLanes=i.childLanes&~c,s.memoizedState=tu,h}return v=i.child,i=v.sibling,h=bi(v,{mode:"visible",children:h.children}),(s.mode&1)===0&&(h.lanes=c),h.return=s,h.sibling=null,i!==null&&(c=s.deletions,c===null?(s.deletions=[i],s.flags|=16):c.push(i)),s.child=h,s.memoizedState=null,h}function iu(i,s){return s=ba({mode:"visible",children:s},i.mode,0,null),s.return=i,i.child=s}function oa(i,s,c,h){return h!==null&&Nc(h),Tr(s,i.child,null,c),i=iu(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function Dx(i,s,c,h,g,v,x){if(c)return s.flags&256?(s.flags&=-257,h=Yc(Error(n(422))),oa(i,s,x,h)):s.memoizedState!==null?(s.child=i.child,s.flags|=128,null):(v=h.fallback,g=s.mode,h=ba({mode:"visible",children:h.children},g,0,null),v=$i(v,g,x,null),v.flags|=2,h.return=s,v.return=s,h.sibling=v,s.child=h,(s.mode&1)!==0&&Tr(s,i.child,null,x),s.child.memoizedState=nu(x),s.memoizedState=tu,v);if((s.mode&1)===0)return oa(i,s,x,null);if(g.data==="$!"){if(h=g.nextSibling&&g.nextSibling.dataset,h)var _=h.dgst;return h=_,v=Error(n(419)),h=Yc(v,h,void 0),oa(i,s,x,h)}if(_=(x&i.childLanes)!==0,It||_){if(h=ft,h!==null){switch(x&-x){case 4:g=2;break;case 16:g=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:g=32;break;case 536870912:g=268435456;break;default:g=0}g=(g&(h.suspendedLanes|x))!==0?0:g,g!==0&&g!==v.retryLane&&(v.retryLane=g,Un(i,g),cn(h,i,g,-1))}return bu(),h=Yc(Error(n(421))),oa(i,s,x,h)}return g.data==="$?"?(s.flags|=128,s.child=i.child,s=Kx.bind(null,i),g._reactRetry=s,null):(i=v.treeContext,Ht=li(g.nextSibling),qt=s,Je=!0,sn=null,i!==null&&(Qt[Yt++]=Ln,Qt[Yt++]=Mn,Qt[Yt++]=Li,Ln=i.id,Mn=i.overflow,Li=s),s=iu(s,h.children),s.flags|=4096,s)}function Jp(i,s,c){i.lanes|=s;var h=i.alternate;h!==null&&(h.lanes|=s),Ac(i.return,s,c)}function ru(i,s,c,h,g){var v=i.memoizedState;v===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:g}:(v.isBackwards=s,v.rendering=null,v.renderingStartTime=0,v.last=h,v.tail=c,v.tailMode=g)}function Qp(i,s,c){var h=s.pendingProps,g=h.revealOrder,v=h.tail;if(wt(i,s,h.children,c),h=Ye.current,(h&2)!==0)h=h&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Jp(i,c,s);else if(i.tag===19)Jp(i,c,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}if($e(Ye,h),(s.mode&1)===0)s.memoizedState=null;else switch(g){case"forwards":for(c=s.child,g=null;c!==null;)i=c.alternate,i!==null&&Zo(i)===null&&(g=c),c=c.sibling;c=g,c===null?(g=s.child,s.child=null):(g=c.sibling,c.sibling=null),ru(s,!1,g,c,v);break;case"backwards":for(c=null,g=s.child,s.child=null;g!==null;){if(i=g.alternate,i!==null&&Zo(i)===null){s.child=g;break}i=g.sibling,g.sibling=c,c=g,g=i}ru(s,!0,c,null,v);break;case"together":ru(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function aa(i,s){(s.mode&1)===0&&i!==null&&(i.alternate=null,s.alternate=null,s.flags|=2)}function Bn(i,s,c){if(i!==null&&(s.dependencies=i.dependencies),zi|=s.lanes,(c&s.childLanes)===0)return null;if(i!==null&&s.child!==i.child)throw Error(n(153));if(s.child!==null){for(i=s.child,c=bi(i,i.pendingProps),s.child=c,c.return=s;i.sibling!==null;)i=i.sibling,c=c.sibling=bi(i,i.pendingProps),c.return=s;c.sibling=null}return s.child}function Lx(i,s,c){switch(s.tag){case 3:Wp(s),Sr();break;case 5:up(s);break;case 1:Nt(s.type)&&qo(s);break;case 4:Mc(s,s.stateNode.containerInfo);break;case 10:var h=s.type._context,g=s.memoizedProps.value;$e(Jo,h._currentValue),h._currentValue=g;break;case 13:if(h=s.memoizedState,h!==null)return h.dehydrated!==null?($e(Ye,Ye.current&1),s.flags|=128,null):(c&s.child.childLanes)!==0?Kp(i,s,c):($e(Ye,Ye.current&1),i=Bn(i,s,c),i!==null?i.sibling:null);$e(Ye,Ye.current&1);break;case 19:if(h=(c&s.childLanes)!==0,(i.flags&128)!==0){if(h)return Qp(i,s,c);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),$e(Ye,Ye.current),h)break;return null;case 22:case 23:return s.lanes=0,qp(i,s,c)}return Bn(i,s,c)}var Yp,su,Xp,Zp;Yp=function(i,s){for(var c=s.child;c!==null;){if(c.tag===5||c.tag===6)i.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===s)break;for(;c.sibling===null;){if(c.return===null||c.return===s)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},su=function(){},Xp=function(i,s,c,h){var g=i.memoizedProps;if(g!==h){i=s.stateNode,Fi(xn.current);var v=null;switch(c){case"input":g=Al(i,g),h=Al(i,h),v=[];break;case"select":g=oe({},g,{value:void 0}),h=oe({},h,{value:void 0}),v=[];break;case"textarea":g=Ml(i,g),h=Ml(i,h),v=[];break;default:typeof g.onClick!="function"&&typeof h.onClick=="function"&&(i.onclick=Bo)}Fl(c,h);var x;c=null;for(V in g)if(!h.hasOwnProperty(V)&&g.hasOwnProperty(V)&&g[V]!=null)if(V==="style"){var _=g[V];for(x in _)_.hasOwnProperty(x)&&(c||(c={}),c[x]="")}else V!=="dangerouslySetInnerHTML"&&V!=="children"&&V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&V!=="autoFocus"&&(o.hasOwnProperty(V)?v||(v=[]):(v=v||[]).push(V,null));for(V in h){var O=h[V];if(_=g?.[V],h.hasOwnProperty(V)&&O!==_&&(O!=null||_!=null))if(V==="style")if(_){for(x in _)!_.hasOwnProperty(x)||O&&O.hasOwnProperty(x)||(c||(c={}),c[x]="");for(x in O)O.hasOwnProperty(x)&&_[x]!==O[x]&&(c||(c={}),c[x]=O[x])}else c||(v||(v=[]),v.push(V,c)),c=O;else V==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,_=_?_.__html:void 0,O!=null&&_!==O&&(v=v||[]).push(V,O)):V==="children"?typeof O!="string"&&typeof O!="number"||(v=v||[]).push(V,""+O):V!=="suppressContentEditableWarning"&&V!=="suppressHydrationWarning"&&(o.hasOwnProperty(V)?(O!=null&&V==="onScroll"&&We("scroll",i),v||_===O||(v=[])):(v=v||[]).push(V,O))}c&&(v=v||[]).push("style",c);var V=v;(s.updateQueue=V)&&(s.flags|=4)}},Zp=function(i,s,c,h){c!==h&&(s.flags|=4)};function Is(i,s){if(!Je)switch(i.tailMode){case"hidden":s=i.tail;for(var c=null;s!==null;)s.alternate!==null&&(c=s),s=s.sibling;c===null?i.tail=null:c.sibling=null;break;case"collapsed":c=i.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function St(i){var s=i.alternate!==null&&i.alternate.child===i.child,c=0,h=0;if(s)for(var g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags&14680064,h|=g.flags&14680064,g.return=i,g=g.sibling;else for(g=i.child;g!==null;)c|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=i,g=g.sibling;return i.subtreeFlags|=h,i.childLanes=c,s}function Mx(i,s,c){var h=s.pendingProps;switch(_c(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return St(s),null;case 1:return Nt(s.type)&&Vo(),St(s),null;case 3:return h=s.stateNode,Er(),Ge(Pt),Ge(xt),Bc(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(Go(s)?s.flags|=4:i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,sn!==null&&(gu(sn),sn=null))),su(i,s),St(s),null;case 5:Uc(s);var g=Fi(Es.current);if(c=s.type,i!==null&&s.stateNode!=null)Xp(i,s,c,h,g),i.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!h){if(s.stateNode===null)throw Error(n(166));return St(s),null}if(i=Fi(xn.current),Go(s)){h=s.stateNode,c=s.type;var v=s.memoizedProps;switch(h[bn]=s,h[ks]=v,i=(s.mode&1)!==0,c){case"dialog":We("cancel",h),We("close",h);break;case"iframe":case"object":case"embed":We("load",h);break;case"video":case"audio":for(g=0;g<ys.length;g++)We(ys[g],h);break;case"source":We("error",h);break;case"img":case"image":case"link":We("error",h),We("load",h);break;case"details":We("toggle",h);break;case"input":jh(h,v),We("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!v.multiple},We("invalid",h);break;case"textarea":Dh(h,v),We("invalid",h)}Fl(c,v),g=null;for(var x in v)if(v.hasOwnProperty(x)){var _=v[x];x==="children"?typeof _=="string"?h.textContent!==_&&(v.suppressHydrationWarning!==!0&&Fo(h.textContent,_,i),g=["children",_]):typeof _=="number"&&h.textContent!==""+_&&(v.suppressHydrationWarning!==!0&&Fo(h.textContent,_,i),g=["children",""+_]):o.hasOwnProperty(x)&&_!=null&&x==="onScroll"&&We("scroll",h)}switch(c){case"input":go(h),Ah(h,v,!0);break;case"textarea":go(h),Mh(h);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(h.onclick=Bo)}h=g,s.updateQueue=h,h!==null&&(s.flags|=4)}else{x=g.nodeType===9?g:g.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Uh(c)),i==="http://www.w3.org/1999/xhtml"?c==="script"?(i=x.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof h.is=="string"?i=x.createElement(c,{is:h.is}):(i=x.createElement(c),c==="select"&&(x=i,h.multiple?x.multiple=!0:h.size&&(x.size=h.size))):i=x.createElementNS(i,c),i[bn]=s,i[ks]=h,Yp(i,s,!1,!1),s.stateNode=i;e:{switch(x=Bl(c,h),c){case"dialog":We("cancel",i),We("close",i),g=h;break;case"iframe":case"object":case"embed":We("load",i),g=h;break;case"video":case"audio":for(g=0;g<ys.length;g++)We(ys[g],i);g=h;break;case"source":We("error",i),g=h;break;case"img":case"image":case"link":We("error",i),We("load",i),g=h;break;case"details":We("toggle",i),g=h;break;case"input":jh(i,h),g=Al(i,h),We("invalid",i);break;case"option":g=h;break;case"select":i._wrapperState={wasMultiple:!!h.multiple},g=oe({},h,{value:void 0}),We("invalid",i);break;case"textarea":Dh(i,h),g=Ml(i,h),We("invalid",i);break;default:g=h}Fl(c,g),_=g;for(v in _)if(_.hasOwnProperty(v)){var O=_[v];v==="style"?zh(i,O):v==="dangerouslySetInnerHTML"?(O=O?O.__html:void 0,O!=null&&Fh(i,O)):v==="children"?typeof O=="string"?(c!=="textarea"||O!=="")&&Zr(i,O):typeof O=="number"&&Zr(i,""+O):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(o.hasOwnProperty(v)?O!=null&&v==="onScroll"&&We("scroll",i):O!=null&&P(i,v,O,x))}switch(c){case"input":go(i),Ah(i,h,!1);break;case"textarea":go(i),Mh(i);break;case"option":h.value!=null&&i.setAttribute("value",""+ye(h.value));break;case"select":i.multiple=!!h.multiple,v=h.value,v!=null?ar(i,!!h.multiple,v,!1):h.defaultValue!=null&&ar(i,!!h.multiple,h.defaultValue,!0);break;default:typeof g.onClick=="function"&&(i.onclick=Bo)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return St(s),null;case 6:if(i&&s.stateNode!=null)Zp(i,s,i.memoizedProps,h);else{if(typeof h!="string"&&s.stateNode===null)throw Error(n(166));if(c=Fi(Es.current),Fi(xn.current),Go(s)){if(h=s.stateNode,c=s.memoizedProps,h[bn]=s,(v=h.nodeValue!==c)&&(i=qt,i!==null))switch(i.tag){case 3:Fo(h.nodeValue,c,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Fo(h.nodeValue,c,(i.mode&1)!==0)}v&&(s.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[bn]=s,s.stateNode=h}return St(s),null;case 13:if(Ge(Ye),h=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Je&&Ht!==null&&(s.mode&1)!==0&&(s.flags&128)===0)np(),Sr(),s.flags|=98560,v=!1;else if(v=Go(s),h!==null&&h.dehydrated!==null){if(i===null){if(!v)throw Error(n(318));if(v=s.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(n(317));v[bn]=s}else Sr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;St(s),v=!1}else sn!==null&&(gu(sn),sn=null),v=!0;if(!v)return s.flags&65536?s:null}return(s.flags&128)!==0?(s.lanes=c,s):(h=h!==null,h!==(i!==null&&i.memoizedState!==null)&&h&&(s.child.flags|=8192,(s.mode&1)!==0&&(i===null||(Ye.current&1)!==0?ut===0&&(ut=3):bu())),s.updateQueue!==null&&(s.flags|=4),St(s),null);case 4:return Er(),su(i,s),i===null&&bs(s.stateNode.containerInfo),St(s),null;case 10:return Oc(s.type._context),St(s),null;case 17:return Nt(s.type)&&Vo(),St(s),null;case 19:if(Ge(Ye),v=s.memoizedState,v===null)return St(s),null;if(h=(s.flags&128)!==0,x=v.rendering,x===null)if(h)Is(v,!1);else{if(ut!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(x=Zo(i),x!==null){for(s.flags|=128,Is(v,!1),h=x.updateQueue,h!==null&&(s.updateQueue=h,s.flags|=4),s.subtreeFlags=0,h=c,c=s.child;c!==null;)v=c,i=h,v.flags&=14680066,x=v.alternate,x===null?(v.childLanes=0,v.lanes=i,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=x.childLanes,v.lanes=x.lanes,v.child=x.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=x.memoizedProps,v.memoizedState=x.memoizedState,v.updateQueue=x.updateQueue,v.type=x.type,i=x.dependencies,v.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),c=c.sibling;return $e(Ye,Ye.current&1|2),s.child}i=i.sibling}v.tail!==null&&rt()>Nr&&(s.flags|=128,h=!0,Is(v,!1),s.lanes=4194304)}else{if(!h)if(i=Zo(x),i!==null){if(s.flags|=128,h=!0,c=i.updateQueue,c!==null&&(s.updateQueue=c,s.flags|=4),Is(v,!0),v.tail===null&&v.tailMode==="hidden"&&!x.alternate&&!Je)return St(s),null}else 2*rt()-v.renderingStartTime>Nr&&c!==1073741824&&(s.flags|=128,h=!0,Is(v,!1),s.lanes=4194304);v.isBackwards?(x.sibling=s.child,s.child=x):(c=v.last,c!==null?c.sibling=x:s.child=x,v.last=x)}return v.tail!==null?(s=v.tail,v.rendering=s,v.tail=s.sibling,v.renderingStartTime=rt(),s.sibling=null,c=Ye.current,$e(Ye,h?c&1|2:c&1),s):(St(s),null);case 22:case 23:return yu(),h=s.memoizedState!==null,i!==null&&i.memoizedState!==null!==h&&(s.flags|=8192),h&&(s.mode&1)!==0?($t&1073741824)!==0&&(St(s),s.subtreeFlags&6&&(s.flags|=8192)):St(s),null;case 24:return null;case 25:return null}throw Error(n(156,s.tag))}function Ux(i,s){switch(_c(s),s.tag){case 1:return Nt(s.type)&&Vo(),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return Er(),Ge(Pt),Ge(xt),Bc(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 5:return Uc(s),null;case 13:if(Ge(Ye),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(n(340));Sr()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return Ge(Ye),null;case 4:return Er(),null;case 10:return Oc(s.type._context),null;case 22:case 23:return yu(),null;case 24:return null;default:return null}}var la=!1,Tt=!1,Fx=typeof WeakSet=="function"?WeakSet:Set,ue=null;function Rr(i,s){var c=i.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){et(i,s,h)}else c.current=null}function ou(i,s,c){try{c()}catch(h){et(i,s,h)}}var em=!1;function Bx(i,s){if(yc=Ro,i=jf(),uc(i)){if("selectionStart"in i)var c={start:i.selectionStart,end:i.selectionEnd};else e:{c=(c=i.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var g=h.anchorOffset,v=h.focusNode;h=h.focusOffset;try{c.nodeType,v.nodeType}catch{c=null;break e}var x=0,_=-1,O=-1,V=0,Y=0,Z=i,J=null;t:for(;;){for(var le;Z!==c||g!==0&&Z.nodeType!==3||(_=x+g),Z!==v||h!==0&&Z.nodeType!==3||(O=x+h),Z.nodeType===3&&(x+=Z.nodeValue.length),(le=Z.firstChild)!==null;)J=Z,Z=le;for(;;){if(Z===i)break t;if(J===c&&++V===g&&(_=x),J===v&&++Y===h&&(O=x),(le=Z.nextSibling)!==null)break;Z=J,J=Z.parentNode}Z=le}c=_===-1||O===-1?null:{start:_,end:O}}else c=null}c=c||{start:0,end:0}}else c=null;for(bc={focusedElem:i,selectionRange:c},Ro=!1,ue=s;ue!==null;)if(s=ue,i=s.child,(s.subtreeFlags&1028)!==0&&i!==null)i.return=s,ue=i;else for(;ue!==null;){s=ue;try{var de=s.alternate;if((s.flags&1024)!==0)switch(s.tag){case 0:case 11:case 15:break;case 1:if(de!==null){var he=de.memoizedProps,st=de.memoizedState,U=s.stateNode,D=U.getSnapshotBeforeUpdate(s.elementType===s.type?he:on(s.type,he),st);U.__reactInternalSnapshotBeforeUpdate=D}break;case 3:var F=s.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(te){et(s,s.return,te)}if(i=s.sibling,i!==null){i.return=s.return,ue=i;break}ue=s.return}return de=em,em=!1,de}function js(i,s,c){var h=s.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var g=h=h.next;do{if((g.tag&i)===i){var v=g.destroy;g.destroy=void 0,v!==void 0&&ou(s,c,v)}g=g.next}while(g!==h)}}function ca(i,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var c=s=s.next;do{if((c.tag&i)===i){var h=c.create;c.destroy=h()}c=c.next}while(c!==s)}}function au(i){var s=i.ref;if(s!==null){var c=i.stateNode;switch(i.tag){case 5:i=c;break;default:i=c}typeof s=="function"?s(i):s.current=i}}function tm(i){var s=i.alternate;s!==null&&(i.alternate=null,tm(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&(delete s[bn],delete s[ks],delete s[Tc],delete s[Sx],delete s[Tx])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function nm(i){return i.tag===5||i.tag===3||i.tag===4}function im(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||nm(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function lu(i,s,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?c.nodeType===8?c.parentNode.insertBefore(i,s):c.insertBefore(i,s):(c.nodeType===8?(s=c.parentNode,s.insertBefore(i,c)):(s=c,s.appendChild(i)),c=c._reactRootContainer,c!=null||s.onclick!==null||(s.onclick=Bo));else if(h!==4&&(i=i.child,i!==null))for(lu(i,s,c),i=i.sibling;i!==null;)lu(i,s,c),i=i.sibling}function cu(i,s,c){var h=i.tag;if(h===5||h===6)i=i.stateNode,s?c.insertBefore(i,s):c.appendChild(i);else if(h!==4&&(i=i.child,i!==null))for(cu(i,s,c),i=i.sibling;i!==null;)cu(i,s,c),i=i.sibling}var vt=null,an=!1;function pi(i,s,c){for(c=c.child;c!==null;)rm(i,s,c),c=c.sibling}function rm(i,s,c){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(So,c)}catch{}switch(c.tag){case 5:Tt||Rr(c,s);case 6:var h=vt,g=an;vt=null,pi(i,s,c),vt=h,an=g,vt!==null&&(an?(i=vt,c=c.stateNode,i.nodeType===8?i.parentNode.removeChild(c):i.removeChild(c)):vt.removeChild(c.stateNode));break;case 18:vt!==null&&(an?(i=vt,c=c.stateNode,i.nodeType===8?Sc(i.parentNode,c):i.nodeType===1&&Sc(i,c),us(i)):Sc(vt,c.stateNode));break;case 4:h=vt,g=an,vt=c.stateNode.containerInfo,an=!0,pi(i,s,c),vt=h,an=g;break;case 0:case 11:case 14:case 15:if(!Tt&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){g=h=h.next;do{var v=g,x=v.destroy;v=v.tag,x!==void 0&&((v&2)!==0||(v&4)!==0)&&ou(c,s,x),g=g.next}while(g!==h)}pi(i,s,c);break;case 1:if(!Tt&&(Rr(c,s),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(_){et(c,s,_)}pi(i,s,c);break;case 21:pi(i,s,c);break;case 22:c.mode&1?(Tt=(h=Tt)||c.memoizedState!==null,pi(i,s,c),Tt=h):pi(i,s,c);break;default:pi(i,s,c)}}function sm(i){var s=i.updateQueue;if(s!==null){i.updateQueue=null;var c=i.stateNode;c===null&&(c=i.stateNode=new Fx),s.forEach(function(h){var g=Jx.bind(null,i,h);c.has(h)||(c.add(h),h.then(g,g))})}}function ln(i,s){var c=s.deletions;if(c!==null)for(var h=0;h<c.length;h++){var g=c[h];try{var v=i,x=s,_=x;e:for(;_!==null;){switch(_.tag){case 5:vt=_.stateNode,an=!1;break e;case 3:vt=_.stateNode.containerInfo,an=!0;break e;case 4:vt=_.stateNode.containerInfo,an=!0;break e}_=_.return}if(vt===null)throw Error(n(160));rm(v,x,g),vt=null,an=!1;var O=g.alternate;O!==null&&(O.return=null),g.return=null}catch(V){et(g,s,V)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)om(s,i),s=s.sibling}function om(i,s){var c=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ln(s,i),Sn(i),h&4){try{js(3,i,i.return),ca(3,i)}catch(he){et(i,i.return,he)}try{js(5,i,i.return)}catch(he){et(i,i.return,he)}}break;case 1:ln(s,i),Sn(i),h&512&&c!==null&&Rr(c,c.return);break;case 5:if(ln(s,i),Sn(i),h&512&&c!==null&&Rr(c,c.return),i.flags&32){var g=i.stateNode;try{Zr(g,"")}catch(he){et(i,i.return,he)}}if(h&4&&(g=i.stateNode,g!=null)){var v=i.memoizedProps,x=c!==null?c.memoizedProps:v,_=i.type,O=i.updateQueue;if(i.updateQueue=null,O!==null)try{_==="input"&&v.type==="radio"&&v.name!=null&&Oh(g,v),Bl(_,x);var V=Bl(_,v);for(x=0;x<O.length;x+=2){var Y=O[x],Z=O[x+1];Y==="style"?zh(g,Z):Y==="dangerouslySetInnerHTML"?Fh(g,Z):Y==="children"?Zr(g,Z):P(g,Y,Z,V)}switch(_){case"input":Dl(g,v);break;case"textarea":Lh(g,v);break;case"select":var J=g._wrapperState.wasMultiple;g._wrapperState.wasMultiple=!!v.multiple;var le=v.value;le!=null?ar(g,!!v.multiple,le,!1):J!==!!v.multiple&&(v.defaultValue!=null?ar(g,!!v.multiple,v.defaultValue,!0):ar(g,!!v.multiple,v.multiple?[]:"",!1))}g[ks]=v}catch(he){et(i,i.return,he)}}break;case 6:if(ln(s,i),Sn(i),h&4){if(i.stateNode===null)throw Error(n(162));g=i.stateNode,v=i.memoizedProps;try{g.nodeValue=v}catch(he){et(i,i.return,he)}}break;case 3:if(ln(s,i),Sn(i),h&4&&c!==null&&c.memoizedState.isDehydrated)try{us(s.containerInfo)}catch(he){et(i,i.return,he)}break;case 4:ln(s,i),Sn(i);break;case 13:ln(s,i),Sn(i),g=i.child,g.flags&8192&&(v=g.memoizedState!==null,g.stateNode.isHidden=v,!v||g.alternate!==null&&g.alternate.memoizedState!==null||(hu=rt())),h&4&&sm(i);break;case 22:if(Y=c!==null&&c.memoizedState!==null,i.mode&1?(Tt=(V=Tt)||Y,ln(s,i),Tt=V):ln(s,i),Sn(i),h&8192){if(V=i.memoizedState!==null,(i.stateNode.isHidden=V)&&!Y&&(i.mode&1)!==0)for(ue=i,Y=i.child;Y!==null;){for(Z=ue=Y;ue!==null;){switch(J=ue,le=J.child,J.tag){case 0:case 11:case 14:case 15:js(4,J,J.return);break;case 1:Rr(J,J.return);var de=J.stateNode;if(typeof de.componentWillUnmount=="function"){h=J,c=J.return;try{s=h,de.props=s.memoizedProps,de.state=s.memoizedState,de.componentWillUnmount()}catch(he){et(h,c,he)}}break;case 5:Rr(J,J.return);break;case 22:if(J.memoizedState!==null){cm(Z);continue}}le!==null?(le.return=J,ue=le):cm(Z)}Y=Y.sibling}e:for(Y=null,Z=i;;){if(Z.tag===5){if(Y===null){Y=Z;try{g=Z.stateNode,V?(v=g.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(_=Z.stateNode,O=Z.memoizedProps.style,x=O!=null&&O.hasOwnProperty("display")?O.display:null,_.style.display=Bh("display",x))}catch(he){et(i,i.return,he)}}}else if(Z.tag===6){if(Y===null)try{Z.stateNode.nodeValue=V?"":Z.memoizedProps}catch(he){et(i,i.return,he)}}else if((Z.tag!==22&&Z.tag!==23||Z.memoizedState===null||Z===i)&&Z.child!==null){Z.child.return=Z,Z=Z.child;continue}if(Z===i)break e;for(;Z.sibling===null;){if(Z.return===null||Z.return===i)break e;Y===Z&&(Y=null),Z=Z.return}Y===Z&&(Y=null),Z.sibling.return=Z.return,Z=Z.sibling}}break;case 19:ln(s,i),Sn(i),h&4&&sm(i);break;case 21:break;default:ln(s,i),Sn(i)}}function Sn(i){var s=i.flags;if(s&2){try{e:{for(var c=i.return;c!==null;){if(nm(c)){var h=c;break e}c=c.return}throw Error(n(160))}switch(h.tag){case 5:var g=h.stateNode;h.flags&32&&(Zr(g,""),h.flags&=-33);var v=im(i);cu(i,v,g);break;case 3:case 4:var x=h.stateNode.containerInfo,_=im(i);lu(i,_,x);break;default:throw Error(n(161))}}catch(O){et(i,i.return,O)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function zx(i,s,c){ue=i,am(i)}function am(i,s,c){for(var h=(i.mode&1)!==0;ue!==null;){var g=ue,v=g.child;if(g.tag===22&&h){var x=g.memoizedState!==null||la;if(!x){var _=g.alternate,O=_!==null&&_.memoizedState!==null||Tt;_=la;var V=Tt;if(la=x,(Tt=O)&&!V)for(ue=g;ue!==null;)x=ue,O=x.child,x.tag===22&&x.memoizedState!==null?um(g):O!==null?(O.return=x,ue=O):um(g);for(;v!==null;)ue=v,am(v),v=v.sibling;ue=g,la=_,Tt=V}lm(i)}else(g.subtreeFlags&8772)!==0&&v!==null?(v.return=g,ue=v):lm(i)}}function lm(i){for(;ue!==null;){var s=ue;if((s.flags&8772)!==0){var c=s.alternate;try{if((s.flags&8772)!==0)switch(s.tag){case 0:case 11:case 15:Tt||ca(5,s);break;case 1:var h=s.stateNode;if(s.flags&4&&!Tt)if(c===null)h.componentDidMount();else{var g=s.elementType===s.type?c.memoizedProps:on(s.type,c.memoizedProps);h.componentDidUpdate(g,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var v=s.updateQueue;v!==null&&cp(s,v,h);break;case 3:var x=s.updateQueue;if(x!==null){if(c=null,s.child!==null)switch(s.child.tag){case 5:c=s.child.stateNode;break;case 1:c=s.child.stateNode}cp(s,x,c)}break;case 5:var _=s.stateNode;if(c===null&&s.flags&4){c=_;var O=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":O.autoFocus&&c.focus();break;case"img":O.src&&(c.src=O.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var V=s.alternate;if(V!==null){var Y=V.memoizedState;if(Y!==null){var Z=Y.dehydrated;Z!==null&&us(Z)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Tt||s.flags&512&&au(s)}catch(J){et(s,s.return,J)}}if(s===i){ue=null;break}if(c=s.sibling,c!==null){c.return=s.return,ue=c;break}ue=s.return}}function cm(i){for(;ue!==null;){var s=ue;if(s===i){ue=null;break}var c=s.sibling;if(c!==null){c.return=s.return,ue=c;break}ue=s.return}}function um(i){for(;ue!==null;){var s=ue;try{switch(s.tag){case 0:case 11:case 15:var c=s.return;try{ca(4,s)}catch(O){et(s,c,O)}break;case 1:var h=s.stateNode;if(typeof h.componentDidMount=="function"){var g=s.return;try{h.componentDidMount()}catch(O){et(s,g,O)}}var v=s.return;try{au(s)}catch(O){et(s,v,O)}break;case 5:var x=s.return;try{au(s)}catch(O){et(s,x,O)}}}catch(O){et(s,s.return,O)}if(s===i){ue=null;break}var _=s.sibling;if(_!==null){_.return=s.return,ue=_;break}ue=s.return}}var Vx=Math.ceil,ua=E.ReactCurrentDispatcher,uu=E.ReactCurrentOwner,en=E.ReactCurrentBatchConfig,Ue=0,ft=null,at=null,yt=0,$t=0,Pr=ci(0),ut=0,Os=null,zi=0,da=0,du=0,As=null,jt=null,hu=0,Nr=1/0,zn=null,ha=!1,fu=null,mi=null,fa=!1,gi=null,pa=0,Ds=0,pu=null,ma=-1,ga=0;function Et(){return(Ue&6)!==0?rt():ma!==-1?ma:ma=rt()}function vi(i){return(i.mode&1)===0?1:(Ue&2)!==0&&yt!==0?yt&-yt:wx.transition!==null?(ga===0&&(ga=nf()),ga):(i=Ve,i!==0||(i=window.event,i=i===void 0?16:hf(i.type)),i)}function cn(i,s,c,h){if(50<Ds)throw Ds=0,pu=null,Error(n(185));ss(i,c,h),((Ue&2)===0||i!==ft)&&(i===ft&&((Ue&2)===0&&(da|=c),ut===4&&yi(i,yt)),Ot(i,h),c===1&&Ue===0&&(s.mode&1)===0&&(Nr=rt()+500,Ho&&di()))}function Ot(i,s){var c=i.callbackNode;wb(i,s);var h=wo(i,i===ft?yt:0);if(h===0)c!==null&&Zh(c),i.callbackNode=null,i.callbackPriority=0;else if(s=h&-h,i.callbackPriority!==s){if(c!=null&&Zh(c),s===1)i.tag===0?Cx(hm.bind(null,i)):Yf(hm.bind(null,i)),xx(function(){(Ue&6)===0&&di()}),c=null;else{switch(rf(h)){case 1:c=Gl;break;case 4:c=ef;break;case 16:c=ko;break;case 536870912:c=tf;break;default:c=ko}c=xm(c,dm.bind(null,i))}i.callbackPriority=s,i.callbackNode=c}}function dm(i,s){if(ma=-1,ga=0,(Ue&6)!==0)throw Error(n(327));var c=i.callbackNode;if(Ir()&&i.callbackNode!==c)return null;var h=wo(i,i===ft?yt:0);if(h===0)return null;if((h&30)!==0||(h&i.expiredLanes)!==0||s)s=va(i,h);else{s=h;var g=Ue;Ue|=2;var v=pm();(ft!==i||yt!==s)&&(zn=null,Nr=rt()+500,qi(i,s));do try{$x();break}catch(_){fm(i,_)}while(!0);jc(),ua.current=v,Ue=g,at!==null?s=0:(ft=null,yt=0,s=ut)}if(s!==0){if(s===2&&(g=Kl(i),g!==0&&(h=g,s=mu(i,g))),s===1)throw c=Os,qi(i,0),yi(i,h),Ot(i,rt()),c;if(s===6)yi(i,h);else{if(g=i.current.alternate,(h&30)===0&&!qx(g)&&(s=va(i,h),s===2&&(v=Kl(i),v!==0&&(h=v,s=mu(i,v))),s===1))throw c=Os,qi(i,0),yi(i,h),Ot(i,rt()),c;switch(i.finishedWork=g,i.finishedLanes=h,s){case 0:case 1:throw Error(n(345));case 2:Hi(i,jt,zn);break;case 3:if(yi(i,h),(h&130023424)===h&&(s=hu+500-rt(),10<s)){if(wo(i,0)!==0)break;if(g=i.suspendedLanes,(g&h)!==h){Et(),i.pingedLanes|=i.suspendedLanes&g;break}i.timeoutHandle=kc(Hi.bind(null,i,jt,zn),s);break}Hi(i,jt,zn);break;case 4:if(yi(i,h),(h&4194240)===h)break;for(s=i.eventTimes,g=-1;0<h;){var x=31-nn(h);v=1<<x,x=s[x],x>g&&(g=x),h&=~v}if(h=g,h=rt()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*Vx(h/1960))-h,10<h){i.timeoutHandle=kc(Hi.bind(null,i,jt,zn),h);break}Hi(i,jt,zn);break;case 5:Hi(i,jt,zn);break;default:throw Error(n(329))}}}return Ot(i,rt()),i.callbackNode===c?dm.bind(null,i):null}function mu(i,s){var c=As;return i.current.memoizedState.isDehydrated&&(qi(i,s).flags|=256),i=va(i,s),i!==2&&(s=jt,jt=c,s!==null&&gu(s)),i}function gu(i){jt===null?jt=i:jt.push.apply(jt,i)}function qx(i){for(var s=i;;){if(s.flags&16384){var c=s.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var g=c[h],v=g.getSnapshot;g=g.value;try{if(!rn(v(),g))return!1}catch{return!1}}}if(c=s.child,s.subtreeFlags&16384&&c!==null)c.return=s,s=c;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function yi(i,s){for(s&=~du,s&=~da,i.suspendedLanes|=s,i.pingedLanes&=~s,i=i.expirationTimes;0<s;){var c=31-nn(s),h=1<<c;i[c]=-1,s&=~h}}function hm(i){if((Ue&6)!==0)throw Error(n(327));Ir();var s=wo(i,0);if((s&1)===0)return Ot(i,rt()),null;var c=va(i,s);if(i.tag!==0&&c===2){var h=Kl(i);h!==0&&(s=h,c=mu(i,h))}if(c===1)throw c=Os,qi(i,0),yi(i,s),Ot(i,rt()),c;if(c===6)throw Error(n(345));return i.finishedWork=i.current.alternate,i.finishedLanes=s,Hi(i,jt,zn),Ot(i,rt()),null}function vu(i,s){var c=Ue;Ue|=1;try{return i(s)}finally{Ue=c,Ue===0&&(Nr=rt()+500,Ho&&di())}}function Vi(i){gi!==null&&gi.tag===0&&(Ue&6)===0&&Ir();var s=Ue;Ue|=1;var c=en.transition,h=Ve;try{if(en.transition=null,Ve=1,i)return i()}finally{Ve=h,en.transition=c,Ue=s,(Ue&6)===0&&di()}}function yu(){$t=Pr.current,Ge(Pr)}function qi(i,s){i.finishedWork=null,i.finishedLanes=0;var c=i.timeoutHandle;if(c!==-1&&(i.timeoutHandle=-1,bx(c)),at!==null)for(c=at.return;c!==null;){var h=c;switch(_c(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Vo();break;case 3:Er(),Ge(Pt),Ge(xt),Bc();break;case 5:Uc(h);break;case 4:Er();break;case 13:Ge(Ye);break;case 19:Ge(Ye);break;case 10:Oc(h.type._context);break;case 22:case 23:yu()}c=c.return}if(ft=i,at=i=bi(i.current,null),yt=$t=s,ut=0,Os=null,du=da=zi=0,jt=As=null,Ui!==null){for(s=0;s<Ui.length;s++)if(c=Ui[s],h=c.interleaved,h!==null){c.interleaved=null;var g=h.next,v=c.pending;if(v!==null){var x=v.next;v.next=g,h.next=x}c.pending=h}Ui=null}return i}function fm(i,s){do{var c=at;try{if(jc(),ea.current=ra,ta){for(var h=Xe.memoizedState;h!==null;){var g=h.queue;g!==null&&(g.pending=null),h=h.next}ta=!1}if(Bi=0,ht=ct=Xe=null,_s=!1,Rs=0,uu.current=null,c===null||c.return===null){ut=1,Os=s,at=null;break}e:{var v=i,x=c.return,_=c,O=s;if(s=yt,_.flags|=32768,O!==null&&typeof O=="object"&&typeof O.then=="function"){var V=O,Y=_,Z=Y.tag;if((Y.mode&1)===0&&(Z===0||Z===11||Z===15)){var J=Y.alternate;J?(Y.updateQueue=J.updateQueue,Y.memoizedState=J.memoizedState,Y.lanes=J.lanes):(Y.updateQueue=null,Y.memoizedState=null)}var le=Up(x);if(le!==null){le.flags&=-257,Fp(le,x,_,v,s),le.mode&1&&Mp(v,V,s),s=le,O=V;var de=s.updateQueue;if(de===null){var he=new Set;he.add(O),s.updateQueue=he}else de.add(O);break e}else{if((s&1)===0){Mp(v,V,s),bu();break e}O=Error(n(426))}}else if(Je&&_.mode&1){var st=Up(x);if(st!==null){(st.flags&65536)===0&&(st.flags|=256),Fp(st,x,_,v,s),Nc(_r(O,_));break e}}v=O=_r(O,_),ut!==4&&(ut=2),As===null?As=[v]:As.push(v),v=x;do{switch(v.tag){case 3:v.flags|=65536,s&=-s,v.lanes|=s;var U=Dp(v,O,s);lp(v,U);break e;case 1:_=O;var D=v.type,F=v.stateNode;if((v.flags&128)===0&&(typeof D.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(mi===null||!mi.has(F)))){v.flags|=65536,s&=-s,v.lanes|=s;var te=Lp(v,_,s);lp(v,te);break e}}v=v.return}while(v!==null)}gm(c)}catch(fe){s=fe,at===c&&c!==null&&(at=c=c.return);continue}break}while(!0)}function pm(){var i=ua.current;return ua.current=ra,i===null?ra:i}function bu(){(ut===0||ut===3||ut===2)&&(ut=4),ft===null||(zi&268435455)===0&&(da&268435455)===0||yi(ft,yt)}function va(i,s){var c=Ue;Ue|=2;var h=pm();(ft!==i||yt!==s)&&(zn=null,qi(i,s));do try{Hx();break}catch(g){fm(i,g)}while(!0);if(jc(),Ue=c,ua.current=h,at!==null)throw Error(n(261));return ft=null,yt=0,ut}function Hx(){for(;at!==null;)mm(at)}function $x(){for(;at!==null&&!gb();)mm(at)}function mm(i){var s=bm(i.alternate,i,$t);i.memoizedProps=i.pendingProps,s===null?gm(i):at=s,uu.current=null}function gm(i){var s=i;do{var c=s.alternate;if(i=s.return,(s.flags&32768)===0){if(c=Mx(c,s,$t),c!==null){at=c;return}}else{if(c=Ux(c,s),c!==null){c.flags&=32767,at=c;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{ut=6,at=null;return}}if(s=s.sibling,s!==null){at=s;return}at=s=i}while(s!==null);ut===0&&(ut=5)}function Hi(i,s,c){var h=Ve,g=en.transition;try{en.transition=null,Ve=1,Wx(i,s,c,h)}finally{en.transition=g,Ve=h}return null}function Wx(i,s,c,h){do Ir();while(gi!==null);if((Ue&6)!==0)throw Error(n(327));c=i.finishedWork;var g=i.finishedLanes;if(c===null)return null;if(i.finishedWork=null,i.finishedLanes=0,c===i.current)throw Error(n(177));i.callbackNode=null,i.callbackPriority=0;var v=c.lanes|c.childLanes;if(Eb(i,v),i===ft&&(at=ft=null,yt=0),(c.subtreeFlags&2064)===0&&(c.flags&2064)===0||fa||(fa=!0,xm(ko,function(){return Ir(),null})),v=(c.flags&15990)!==0,(c.subtreeFlags&15990)!==0||v){v=en.transition,en.transition=null;var x=Ve;Ve=1;var _=Ue;Ue|=4,uu.current=null,Bx(i,c),om(c,i),hx(bc),Ro=!!yc,bc=yc=null,i.current=c,zx(c),vb(),Ue=_,Ve=x,en.transition=v}else i.current=c;if(fa&&(fa=!1,gi=i,pa=g),v=i.pendingLanes,v===0&&(mi=null),xb(c.stateNode),Ot(i,rt()),s!==null)for(h=i.onRecoverableError,c=0;c<s.length;c++)g=s[c],h(g.value,{componentStack:g.stack,digest:g.digest});if(ha)throw ha=!1,i=fu,fu=null,i;return(pa&1)!==0&&i.tag!==0&&Ir(),v=i.pendingLanes,(v&1)!==0?i===pu?Ds++:(Ds=0,pu=i):Ds=0,di(),null}function Ir(){if(gi!==null){var i=rf(pa),s=en.transition,c=Ve;try{if(en.transition=null,Ve=16>i?16:i,gi===null)var h=!1;else{if(i=gi,gi=null,pa=0,(Ue&6)!==0)throw Error(n(331));var g=Ue;for(Ue|=4,ue=i.current;ue!==null;){var v=ue,x=v.child;if((ue.flags&16)!==0){var _=v.deletions;if(_!==null){for(var O=0;O<_.length;O++){var V=_[O];for(ue=V;ue!==null;){var Y=ue;switch(Y.tag){case 0:case 11:case 15:js(8,Y,v)}var Z=Y.child;if(Z!==null)Z.return=Y,ue=Z;else for(;ue!==null;){Y=ue;var J=Y.sibling,le=Y.return;if(tm(Y),Y===V){ue=null;break}if(J!==null){J.return=le,ue=J;break}ue=le}}}var de=v.alternate;if(de!==null){var he=de.child;if(he!==null){de.child=null;do{var st=he.sibling;he.sibling=null,he=st}while(he!==null)}}ue=v}}if((v.subtreeFlags&2064)!==0&&x!==null)x.return=v,ue=x;else e:for(;ue!==null;){if(v=ue,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:js(9,v,v.return)}var U=v.sibling;if(U!==null){U.return=v.return,ue=U;break e}ue=v.return}}var D=i.current;for(ue=D;ue!==null;){x=ue;var F=x.child;if((x.subtreeFlags&2064)!==0&&F!==null)F.return=x,ue=F;else e:for(x=D;ue!==null;){if(_=ue,(_.flags&2048)!==0)try{switch(_.tag){case 0:case 11:case 15:ca(9,_)}}catch(fe){et(_,_.return,fe)}if(_===x){ue=null;break e}var te=_.sibling;if(te!==null){te.return=_.return,ue=te;break e}ue=_.return}}if(Ue=g,di(),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(So,i)}catch{}h=!0}return h}finally{Ve=c,en.transition=s}}return!1}function vm(i,s,c){s=_r(c,s),s=Dp(i,s,1),i=fi(i,s,1),s=Et(),i!==null&&(ss(i,1,s),Ot(i,s))}function et(i,s,c){if(i.tag===3)vm(i,i,c);else for(;s!==null;){if(s.tag===3){vm(s,i,c);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(mi===null||!mi.has(h))){i=_r(c,i),i=Lp(s,i,1),s=fi(s,i,1),i=Et(),s!==null&&(ss(s,1,i),Ot(s,i));break}}s=s.return}}function Gx(i,s,c){var h=i.pingCache;h!==null&&h.delete(s),s=Et(),i.pingedLanes|=i.suspendedLanes&c,ft===i&&(yt&c)===c&&(ut===4||ut===3&&(yt&130023424)===yt&&500>rt()-hu?qi(i,0):du|=c),Ot(i,s)}function ym(i,s){s===0&&((i.mode&1)===0?s=1:(s=Co,Co<<=1,(Co&130023424)===0&&(Co=4194304)));var c=Et();i=Un(i,s),i!==null&&(ss(i,s,c),Ot(i,c))}function Kx(i){var s=i.memoizedState,c=0;s!==null&&(c=s.retryLane),ym(i,c)}function Jx(i,s){var c=0;switch(i.tag){case 13:var h=i.stateNode,g=i.memoizedState;g!==null&&(c=g.retryLane);break;case 19:h=i.stateNode;break;default:throw Error(n(314))}h!==null&&h.delete(s),ym(i,c)}var bm;bm=function(i,s,c){if(i!==null)if(i.memoizedProps!==s.pendingProps||Pt.current)It=!0;else{if((i.lanes&c)===0&&(s.flags&128)===0)return It=!1,Lx(i,s,c);It=(i.flags&131072)!==0}else It=!1,Je&&(s.flags&1048576)!==0&&Xf(s,Wo,s.index);switch(s.lanes=0,s.tag){case 2:var h=s.type;aa(i,s),i=s.pendingProps;var g=br(s,xt.current);wr(s,c),g=qc(null,s,h,i,g,c);var v=Hc();return s.flags|=1,typeof g=="object"&&g!==null&&typeof g.render=="function"&&g.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,Nt(h)?(v=!0,qo(s)):v=!1,s.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,Lc(s),g.updater=sa,s.stateNode=g,g._reactInternals=s,Qc(s,h,i,c),s=eu(null,s,h,!0,v,c)):(s.tag=0,Je&&v&&Ec(s),wt(null,s,g,c),s=s.child),s;case 16:h=s.elementType;e:{switch(aa(i,s),i=s.pendingProps,g=h._init,h=g(h._payload),s.type=h,g=s.tag=Yx(h),i=on(h,i),g){case 0:s=Zc(null,s,h,i,c);break e;case 1:s=$p(null,s,h,i,c);break e;case 11:s=Bp(null,s,h,i,c);break e;case 14:s=zp(null,s,h,on(h.type,i),c);break e}throw Error(n(306,h,""))}return s;case 0:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:on(h,g),Zc(i,s,h,g,c);case 1:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:on(h,g),$p(i,s,h,g,c);case 3:e:{if(Wp(s),i===null)throw Error(n(387));h=s.pendingProps,v=s.memoizedState,g=v.element,ap(i,s),Xo(s,h,null,c);var x=s.memoizedState;if(h=x.element,v.isDehydrated)if(v={element:h,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},s.updateQueue.baseState=v,s.memoizedState=v,s.flags&256){g=_r(Error(n(423)),s),s=Gp(i,s,h,c,g);break e}else if(h!==g){g=_r(Error(n(424)),s),s=Gp(i,s,h,c,g);break e}else for(Ht=li(s.stateNode.containerInfo.firstChild),qt=s,Je=!0,sn=null,c=sp(s,null,h,c),s.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(Sr(),h===g){s=Bn(i,s,c);break e}wt(i,s,h,c)}s=s.child}return s;case 5:return up(s),i===null&&Pc(s),h=s.type,g=s.pendingProps,v=i!==null?i.memoizedProps:null,x=g.children,xc(h,g)?x=null:v!==null&&xc(h,v)&&(s.flags|=32),Hp(i,s),wt(i,s,x,c),s.child;case 6:return i===null&&Pc(s),null;case 13:return Kp(i,s,c);case 4:return Mc(s,s.stateNode.containerInfo),h=s.pendingProps,i===null?s.child=Tr(s,null,h,c):wt(i,s,h,c),s.child;case 11:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:on(h,g),Bp(i,s,h,g,c);case 7:return wt(i,s,s.pendingProps,c),s.child;case 8:return wt(i,s,s.pendingProps.children,c),s.child;case 12:return wt(i,s,s.pendingProps.children,c),s.child;case 10:e:{if(h=s.type._context,g=s.pendingProps,v=s.memoizedProps,x=g.value,$e(Jo,h._currentValue),h._currentValue=x,v!==null)if(rn(v.value,x)){if(v.children===g.children&&!Pt.current){s=Bn(i,s,c);break e}}else for(v=s.child,v!==null&&(v.return=s);v!==null;){var _=v.dependencies;if(_!==null){x=v.child;for(var O=_.firstContext;O!==null;){if(O.context===h){if(v.tag===1){O=Fn(-1,c&-c),O.tag=2;var V=v.updateQueue;if(V!==null){V=V.shared;var Y=V.pending;Y===null?O.next=O:(O.next=Y.next,Y.next=O),V.pending=O}}v.lanes|=c,O=v.alternate,O!==null&&(O.lanes|=c),Ac(v.return,c,s),_.lanes|=c;break}O=O.next}}else if(v.tag===10)x=v.type===s.type?null:v.child;else if(v.tag===18){if(x=v.return,x===null)throw Error(n(341));x.lanes|=c,_=x.alternate,_!==null&&(_.lanes|=c),Ac(x,c,s),x=v.sibling}else x=v.child;if(x!==null)x.return=v;else for(x=v;x!==null;){if(x===s){x=null;break}if(v=x.sibling,v!==null){v.return=x.return,x=v;break}x=x.return}v=x}wt(i,s,g.children,c),s=s.child}return s;case 9:return g=s.type,h=s.pendingProps.children,wr(s,c),g=Xt(g),h=h(g),s.flags|=1,wt(i,s,h,c),s.child;case 14:return h=s.type,g=on(h,s.pendingProps),g=on(h.type,g),zp(i,s,h,g,c);case 15:return Vp(i,s,s.type,s.pendingProps,c);case 17:return h=s.type,g=s.pendingProps,g=s.elementType===h?g:on(h,g),aa(i,s),s.tag=1,Nt(h)?(i=!0,qo(s)):i=!1,wr(s,c),Op(s,h,g),Qc(s,h,g,c),eu(null,s,h,!0,i,c);case 19:return Qp(i,s,c);case 22:return qp(i,s,c)}throw Error(n(156,s.tag))};function xm(i,s){return Xh(i,s)}function Qx(i,s,c,h){this.tag=i,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(i,s,c,h){return new Qx(i,s,c,h)}function xu(i){return i=i.prototype,!(!i||!i.isReactComponent)}function Yx(i){if(typeof i=="function")return xu(i)?1:0;if(i!=null){if(i=i.$$typeof,i===ie)return 11;if(i===Ae)return 14}return 2}function bi(i,s){var c=i.alternate;return c===null?(c=tn(i.tag,s,i.key,i.mode),c.elementType=i.elementType,c.type=i.type,c.stateNode=i.stateNode,c.alternate=i,i.alternate=c):(c.pendingProps=s,c.type=i.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=i.flags&14680064,c.childLanes=i.childLanes,c.lanes=i.lanes,c.child=i.child,c.memoizedProps=i.memoizedProps,c.memoizedState=i.memoizedState,c.updateQueue=i.updateQueue,s=i.dependencies,c.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},c.sibling=i.sibling,c.index=i.index,c.ref=i.ref,c}function ya(i,s,c,h,g,v){var x=2;if(h=i,typeof i=="function")xu(i)&&(x=1);else if(typeof i=="string")x=5;else e:switch(i){case I:return $i(c.children,g,v,s);case M:x=8,g|=8;break;case z:return i=tn(12,c,s,g|2),i.elementType=z,i.lanes=v,i;case ce:return i=tn(13,c,s,g),i.elementType=ce,i.lanes=v,i;case Te:return i=tn(19,c,s,g),i.elementType=Te,i.lanes=v,i;case be:return ba(c,g,v,s);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case K:x=10;break e;case Q:x=9;break e;case ie:x=11;break e;case Ae:x=14;break e;case Se:x=16,h=null;break e}throw Error(n(130,i==null?i:typeof i,""))}return s=tn(x,c,s,g),s.elementType=i,s.type=h,s.lanes=v,s}function $i(i,s,c,h){return i=tn(7,i,h,s),i.lanes=c,i}function ba(i,s,c,h){return i=tn(22,i,h,s),i.elementType=be,i.lanes=c,i.stateNode={isHidden:!1},i}function ku(i,s,c){return i=tn(6,i,null,s),i.lanes=c,i}function Su(i,s,c){return s=tn(4,i.children!==null?i.children:[],i.key,s),s.lanes=c,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}function Xx(i,s,c,h,g){this.tag=s,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jl(0),this.expirationTimes=Jl(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jl(0),this.identifierPrefix=h,this.onRecoverableError=g,this.mutableSourceEagerHydrationData=null}function Tu(i,s,c,h,g,v,x,_,O){return i=new Xx(i,s,c,_,O),s===1?(s=1,v===!0&&(s|=8)):s=0,v=tn(3,null,null,s),i.current=v,v.stateNode=i,v.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},Lc(v),i}function Zx(i,s,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:h==null?null:""+h,children:i,containerInfo:s,implementation:c}}function km(i){if(!i)return ui;i=i._reactInternals;e:{if(Oi(i)!==i||i.tag!==1)throw Error(n(170));var s=i;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(Nt(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(n(171))}if(i.tag===1){var c=i.type;if(Nt(c))return Jf(i,c,s)}return s}function Sm(i,s,c,h,g,v,x,_,O){return i=Tu(c,h,!0,i,g,v,x,_,O),i.context=km(null),c=i.current,h=Et(),g=vi(c),v=Fn(h,g),v.callback=s??null,fi(c,v,g),i.current.lanes=g,ss(i,g,h),Ot(i,h),i}function xa(i,s,c,h){var g=s.current,v=Et(),x=vi(g);return c=km(c),s.context===null?s.context=c:s.pendingContext=c,s=Fn(v,x),s.payload={element:i},h=h===void 0?null:h,h!==null&&(s.callback=h),i=fi(g,s,x),i!==null&&(cn(i,g,x,v),Yo(i,g,x)),x}function ka(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Tm(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var c=i.retryLane;i.retryLane=c!==0&&c<s?c:s}}function Cu(i,s){Tm(i,s),(i=i.alternate)&&Tm(i,s)}function ek(){return null}var Cm=typeof reportError=="function"?reportError:function(i){console.error(i)};function wu(i){this._internalRoot=i}Sa.prototype.render=wu.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(n(409));xa(i,s,null,null)},Sa.prototype.unmount=wu.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Vi(function(){xa(null,i,null,null)}),s[An]=null}};function Sa(i){this._internalRoot=i}Sa.prototype.unstable_scheduleHydration=function(i){if(i){var s=af();i={blockedOn:null,target:i,priority:s};for(var c=0;c<si.length&&s!==0&&s<si[c].priority;c++);si.splice(c,0,i),c===0&&uf(i)}};function Eu(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Ta(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function wm(){}function tk(i,s,c,h,g){if(g){if(typeof h=="function"){var v=h;h=function(){var V=ka(x);v.call(V)}}var x=Sm(s,h,i,0,null,!1,!1,"",wm);return i._reactRootContainer=x,i[An]=x.current,bs(i.nodeType===8?i.parentNode:i),Vi(),x}for(;g=i.lastChild;)i.removeChild(g);if(typeof h=="function"){var _=h;h=function(){var V=ka(O);_.call(V)}}var O=Tu(i,0,!1,null,null,!1,!1,"",wm);return i._reactRootContainer=O,i[An]=O.current,bs(i.nodeType===8?i.parentNode:i),Vi(function(){xa(s,O,c,h)}),O}function Ca(i,s,c,h,g){var v=c._reactRootContainer;if(v){var x=v;if(typeof g=="function"){var _=g;g=function(){var O=ka(x);_.call(O)}}xa(s,x,i,g)}else x=tk(c,s,i,g,h);return ka(x)}sf=function(i){switch(i.tag){case 3:var s=i.stateNode;if(s.current.memoizedState.isDehydrated){var c=rs(s.pendingLanes);c!==0&&(Ql(s,c|1),Ot(s,rt()),(Ue&6)===0&&(Nr=rt()+500,di()))}break;case 13:Vi(function(){var h=Un(i,1);if(h!==null){var g=Et();cn(h,i,1,g)}}),Cu(i,1)}},Yl=function(i){if(i.tag===13){var s=Un(i,134217728);if(s!==null){var c=Et();cn(s,i,134217728,c)}Cu(i,134217728)}},of=function(i){if(i.tag===13){var s=vi(i),c=Un(i,s);if(c!==null){var h=Et();cn(c,i,s,h)}Cu(i,s)}},af=function(){return Ve},lf=function(i,s){var c=Ve;try{return Ve=i,s()}finally{Ve=c}},ql=function(i,s,c){switch(s){case"input":if(Dl(i,c),s=c.name,c.type==="radio"&&s!=null){for(c=i;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<c.length;s++){var h=c[s];if(h!==i&&h.form===i.form){var g=zo(h);if(!g)throw Error(n(90));Ih(h),Dl(h,g)}}}break;case"textarea":Lh(i,c);break;case"select":s=c.value,s!=null&&ar(i,!!c.multiple,s,!1)}},$h=vu,Wh=Vi;var nk={usingClientEntryPoint:!1,Events:[Ss,vr,zo,qh,Hh,vu]},Ls={findFiberByHostInstance:Ai,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ik={bundleType:Ls.bundleType,version:Ls.version,rendererPackageName:Ls.rendererPackageName,rendererConfig:Ls.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Qh(i),i===null?null:i.stateNode},findFiberByHostInstance:Ls.findFiberByHostInstance||ek,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wa.isDisabled&&wa.supportsFiber)try{So=wa.inject(ik),yn=wa}catch{}}return At.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nk,At.createPortal=function(i,s){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Eu(s))throw Error(n(200));return Zx(i,s,null,c)},At.createRoot=function(i,s){if(!Eu(i))throw Error(n(299));var c=!1,h="",g=Cm;return s!=null&&(s.unstable_strictMode===!0&&(c=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onRecoverableError!==void 0&&(g=s.onRecoverableError)),s=Tu(i,1,!1,null,null,c,!1,h,g),i[An]=s.current,bs(i.nodeType===8?i.parentNode:i),new wu(s)},At.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=Qh(s),i=i===null?null:i.stateNode,i},At.flushSync=function(i){return Vi(i)},At.hydrate=function(i,s,c){if(!Ta(s))throw Error(n(200));return Ca(null,i,s,!0,c)},At.hydrateRoot=function(i,s,c){if(!Eu(i))throw Error(n(405));var h=c!=null&&c.hydratedSources||null,g=!1,v="",x=Cm;if(c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(v=c.identifierPrefix),c.onRecoverableError!==void 0&&(x=c.onRecoverableError)),s=Sm(s,null,i,1,c??null,g,!1,v,x),i[An]=s.current,bs(i),h)for(i=0;i<h.length;i++)c=h[i],g=c._getVersion,g=g(c._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[c,g]:s.mutableSourceEagerHydrationData.push(c,g);return new Sa(s)},At.render=function(i,s,c){if(!Ta(s))throw Error(n(200));return Ca(null,i,s,!1,c)},At.unmountComponentAtNode=function(i){if(!Ta(i))throw Error(n(40));return i._reactRootContainer?(Vi(function(){Ca(null,null,i,!1,function(){i._reactRootContainer=null,i[An]=null})}),!0):!1},At.unstable_batchedUpdates=vu,At.unstable_renderSubtreeIntoContainer=function(i,s,c,h){if(!Ta(c))throw Error(n(200));if(i==null||i._reactInternals===void 0)throw Error(n(38));return Ca(i,s,c,!1,h)},At.version="18.3.1-next-f1338f8080-20240426",At}var Om;function dk(){if(Om)return Pu.exports;Om=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Pu.exports=uk(),Pu.exports}var Am;function hk(){if(Am)return Ea;Am=1;var t=dk();return Ea.createRoot=t.createRoot,Ea.hydrateRoot=t.hydrateRoot,Ea}var fk=hk();const pk="/assets/logov2-TcXW0OwV.png";var f0={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Dm=Be.createContext&&Be.createContext(f0),mk=["attr","size","title"];function gk(t,e){if(t==null)return{};var n=vk(t,e),r,o;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(o=0;o<a.length;o++)r=a[o],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function vk(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Xa(){return Xa=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Xa.apply(this,arguments)}function Lm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(t,o).enumerable})),n.push.apply(n,r)}return n}function Za(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Lm(Object(n),!0).forEach(function(r){yk(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lm(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function yk(t,e,n){return e=bk(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bk(t){var e=xk(t,"string");return typeof e=="symbol"?e:e+""}function xk(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function p0(t){return t&&t.map((e,n)=>Be.createElement(e.tag,Za({key:n},e.attr),p0(e.child)))}function Le(t){return e=>Be.createElement(kk,Xa({attr:Za({},t.attr)},e),p0(t.child))}function kk(t){var e=n=>{var{attr:r,size:o,title:a}=t,l=gk(t,mk),u=o||n.size||"1em",d;return n.className&&(d=n.className),t.className&&(d=(d?d+" ":"")+t.className),Be.createElement("svg",Xa({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,r,l,{className:d,style:Za(Za({color:t.color||n.color},n.style),t.style),height:u,width:u,xmlns:"http://www.w3.org/2000/svg"}),a&&Be.createElement("title",null,a),t.children)};return Dm!==void 0?Be.createElement(Dm.Consumer,null,n=>e(n)):e(f0)}function Sk(t){return Le({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M15.98 1.804a1 1 0 0 0-1.96 0l-.24 1.192a1 1 0 0 1-.784.785l-1.192.238a1 1 0 0 0 0 1.962l1.192.238a1 1 0 0 1 .785.785l.238 1.192a1 1 0 0 0 1.962 0l.238-1.192a1 1 0 0 1 .785-.785l1.192-.238a1 1 0 0 0 0-1.962l-1.192-.238a1 1 0 0 1-.785-.785l-.238-1.192ZM6.949 5.684a1 1 0 0 0-1.898 0l-.683 2.051a1 1 0 0 1-.633.633l-2.051.683a1 1 0 0 0 0 1.898l2.051.684a1 1 0 0 1 .633.632l.683 2.051a1 1 0 0 0 1.898 0l.683-2.051a1 1 0 0 1 .633-.633l2.051-.683a1 1 0 0 0 0-1.898l-2.051-.683a1 1 0 0 1-.633-.633L6.95 5.684ZM13.949 13.684a1 1 0 0 0-1.898 0l-.184.551a1 1 0 0 1-.632.633l-.551.183a1 1 0 0 0 0 1.898l.551.183a1 1 0 0 1 .633.633l.183.551a1 1 0 0 0 1.898 0l.184-.551a1 1 0 0 1 .632-.633l.551-.183a1 1 0 0 0 0-1.898l-.551-.184a1 1 0 0 1-.633-.632l-.183-.551Z"},child:[]}]})(t)}function Tk(t){return Le({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M439 32v165h18V32h-18zm-18 12.99L327.6 80l93.4 35V44.99zM165.9 103c-5 0-10.2 2.3-15.3 7-6.2 5.8-11.5 15.1-13.8 26.3-2.3 11.3-1 22 2.5 29.7 3.5 7.8 8.6 12.3 14.6 13.5 6 1.3 12.4-.9 18.7-6.6 6.1-5.8 11.5-15.1 13.8-26.4 2.2-11.3.9-22-2.5-29.7-3.5-7.8-8.6-12.2-14.6-13.5-1.1-.2-2.3-.3-3.4-.3zm-38.4 78.5c-3.4 1.2-6.9 2.5-10.7 4.1-24.85 15.7-42.2 31.2-59.84 55.7-11.19 15.5-11.74 42-12.58 61.5l20.8 9.2c.87-27.8.36-39.3 13.27-55.3 9.83-12.2 19.33-25 37.55-28.9 1.6 28.9-2.6 73.7-14 119.6 20.5 2.8 37.6-.7 57-6.3 50.7-25.3 74.1-3.8 109.3 45.7l20.5-32.1c-24.6-28.9-48.5-75.1-117.2-57.3 5-27.3 5.6-45.4 8.6-72.6.6-12 .8-23.9 1.1-35.7-8.9 6.8-19.9 10.4-31 8.1-9.5-2-17.3-7.9-22.8-15.7zm144.2 7.3c-18.2 17.8-22.2 31-50.2 38.4l-22.5-24c-.4 12.8-.8 25.9-1.9 39.2 9.5 8.7 19.2 15.7 22.7 14.6 31.3-9.4 40.3-20.3 61.4-41.9l-9.5-26.3zM409 215v96h-96v96h-96v78.1c102.3.2 167.8 1.1 270 1.8V215h-78zM140.7 363.9c-13.6 2.5-27.8 3.3-43.44.9-10.89 37.5-26.76 74.3-48.51 102.5l38.63 15.3c27.02-37.9 36.82-70.6 53.32-118.7z"},child:[]}]})(t)}function Ck(t){return Le({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(t)}function nd(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-5h2v5zm4 0h-2v-3h2v3zm0-5h-2v-2h2v2zm4 5h-2V7h2v10z"},child:[]}]})(t)}function wk(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"},child:[]}]})(t)}function m0(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 12h-2v-2h2v2zm0-4h-2V6h2v4z"},child:[]}]})(t)}function g0(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1zm-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1z"},child:[]}]})(t)}function id(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M23 8c0 1.1-.9 2-2 2a1.7 1.7 0 0 1-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56A1.7 1.7 0 0 1 19 8c0-1.1.9-2 2-2s2 .9 2 2z"},child:[]}]})(t)}function Js(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"m16 6 2.29 2.29-4.88 4.88-4-4L2 16.59 3.41 18l6-6 4 4 6.3-6.29L22 12V6z"},child:[]}]})(t)}function Qs(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M20 6h-4V4c0-1.11-.89-2-2-2h-4c-1.11 0-2 .89-2 2v2H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-6 0h-4V4h4v2z"},child:[]}]})(t)}function v0(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M9 1h6v2H9zM19.03 7.39l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42A8.962 8.962 0 0 0 12 4a9 9 0 0 0-9 9c0 4.97 4.02 9 9 9a8.994 8.994 0 0 0 7.03-14.61zM13 14h-2V8h2v6z"},child:[]}]})(t)}function rd(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{d:"M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3 1 9l11 6 9-4.91V17h2V9L12 3z"},child:[]}]})(t)}function Mm(t){return Le({attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5a2.5 2.5 0 0 1 5 0v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5a2.5 2.5 0 0 0 5 0V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"},child:[]}]})(t)}var Us={},Um;function Ek(){if(Um)return Us;Um=1,Object.defineProperty(Us,"__esModule",{value:!0}),Us.parse=l,Us.serialize=f;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,o=Object.prototype.toString,a=(()=>{const b=function(){};return b.prototype=Object.create(null),b})();function l(b,S){const k=new a,T=b.length;if(T<2)return k;const C=S?.decode||m;let w=0;do{const A=b.indexOf("=",w);if(A===-1)break;const P=b.indexOf(";",w),E=P===-1?T:P;if(A>E){w=b.lastIndexOf(";",A-1)+1;continue}const R=u(b,w,A),B=d(b,A,R),I=b.slice(R,B);if(k[I]===void 0){let M=u(b,A+1,E),z=d(b,E,M);const K=C(b.slice(M,z));k[I]=K}w=E+1}while(w<T);return k}function u(b,S,k){do{const T=b.charCodeAt(S);if(T!==32&&T!==9)return S}while(++S<k);return k}function d(b,S,k){for(;S>k;){const T=b.charCodeAt(--S);if(T!==32&&T!==9)return S+1}return k}function f(b,S,k){const T=k?.encode||encodeURIComponent;if(!t.test(b))throw new TypeError(`argument name is invalid: ${b}`);const C=T(S);if(!e.test(C))throw new TypeError(`argument val is invalid: ${S}`);let w=b+"="+C;if(!k)return w;if(k.maxAge!==void 0){if(!Number.isInteger(k.maxAge))throw new TypeError(`option maxAge is invalid: ${k.maxAge}`);w+="; Max-Age="+k.maxAge}if(k.domain){if(!n.test(k.domain))throw new TypeError(`option domain is invalid: ${k.domain}`);w+="; Domain="+k.domain}if(k.path){if(!r.test(k.path))throw new TypeError(`option path is invalid: ${k.path}`);w+="; Path="+k.path}if(k.expires){if(!y(k.expires)||!Number.isFinite(k.expires.valueOf()))throw new TypeError(`option expires is invalid: ${k.expires}`);w+="; Expires="+k.expires.toUTCString()}if(k.httpOnly&&(w+="; HttpOnly"),k.secure&&(w+="; Secure"),k.partitioned&&(w+="; Partitioned"),k.priority)switch(typeof k.priority=="string"?k.priority.toLowerCase():void 0){case"low":w+="; Priority=Low";break;case"medium":w+="; Priority=Medium";break;case"high":w+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${k.priority}`)}if(k.sameSite)switch(typeof k.sameSite=="string"?k.sameSite.toLowerCase():k.sameSite){case!0:case"strict":w+="; SameSite=Strict";break;case"lax":w+="; SameSite=Lax";break;case"none":w+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${k.sameSite}`)}return w}function m(b){if(b.indexOf("%")===-1)return b;try{return decodeURIComponent(b)}catch{return b}}function y(b){return o.call(b)==="[object Date]"}return Us}Ek();var Fm="popstate";function _k(t={}){function e(r,o){let{pathname:a,search:l,hash:u}=r.location;return sd("",{pathname:a,search:l,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function n(r,o){return typeof o=="string"?o:to(o)}return Pk(e,n,null,t)}function Ze(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Pn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Rk(){return Math.random().toString(36).substring(2,10)}function Bm(t,e){return{usr:t.state,key:t.key,idx:e}}function sd(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Kr(e):e,state:n,key:e&&e.key||r||Rk()}}function to({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Kr(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function Pk(t,e,n,r={}){let{window:o=document.defaultView,v5Compat:a=!1}=r,l=o.history,u="POP",d=null,f=m();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function m(){return(l.state||{idx:null}).idx}function y(){u="POP";let C=m(),w=C==null?null:C-f;f=C,d&&d({action:u,location:T.location,delta:w})}function b(C,w){u="PUSH";let A=sd(T.location,C,w);f=m()+1;let P=Bm(A,f),E=T.createHref(A);try{l.pushState(P,"",E)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;o.location.assign(E)}a&&d&&d({action:u,location:T.location,delta:1})}function S(C,w){u="REPLACE";let A=sd(T.location,C,w);f=m();let P=Bm(A,f),E=T.createHref(A);l.replaceState(P,"",E),a&&d&&d({action:u,location:T.location,delta:0})}function k(C){return Nk(C)}let T={get action(){return u},get location(){return t(o,l)},listen(C){if(d)throw new Error("A history only accepts one active listener");return o.addEventListener(Fm,y),d=C,()=>{o.removeEventListener(Fm,y),d=null}},createHref(C){return e(o,C)},createURL:k,encodeLocation(C){let w=k(C);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:b,replace:S,go(C){return l.go(C)}};return T}function Nk(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Ze(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:to(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function y0(t,e,n="/"){return Ik(t,e,n,!1)}function Ik(t,e,n,r){let o=typeof e=="string"?Kr(e):e,a=Yn(o.pathname||"/",n);if(a==null)return null;let l=b0(t);jk(l);let u=null;for(let d=0;u==null&&d<l.length;++d){let f=qk(a);u=zk(l[d],f,r)}return u}function b0(t,e=[],n=[],r=""){let o=(a,l,u)=>{let d={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};d.relativePath.startsWith("/")&&(Ze(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length));let f=Qn([r,d.relativePath]),m=n.concat(d);a.children&&a.children.length>0&&(Ze(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),b0(a.children,e,m,f)),!(a.path==null&&!a.index)&&e.push({path:f,score:Fk(f,a.index),routesMeta:m})};return t.forEach((a,l)=>{if(a.path===""||!a.path?.includes("?"))o(a,l);else for(let u of x0(a.path))o(a,l,u)}),e}function x0(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,o=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return o?[a,""]:[a];let l=x0(r.join("/")),u=[];return u.push(...l.map(d=>d===""?a:[a,d].join("/"))),o&&u.push(...l),u.map(d=>t.startsWith("/")&&d===""?"/":d)}function jk(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:Bk(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var Ok=/^:[\w-]+$/,Ak=3,Dk=2,Lk=1,Mk=10,Uk=-2,zm=t=>t==="*";function Fk(t,e){let n=t.split("/"),r=n.length;return n.some(zm)&&(r+=Uk),e&&(r+=Dk),n.filter(o=>!zm(o)).reduce((o,a)=>o+(Ok.test(a)?Ak:a===""?Lk:Mk),r)}function Bk(t,e){return t.length===e.length&&t.slice(0,-1).every((r,o)=>r===e[o])?t[t.length-1]-e[e.length-1]:0}function zk(t,e,n=!1){let{routesMeta:r}=t,o={},a="/",l=[];for(let u=0;u<r.length;++u){let d=r[u],f=u===r.length-1,m=a==="/"?e:e.slice(a.length)||"/",y=el({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},m),b=d.route;if(!y&&f&&n&&!r[r.length-1].route.index&&(y=el({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},m)),!y)return null;Object.assign(o,y.params),l.push({params:o,pathname:Qn([a,y.pathname]),pathnameBase:Gk(Qn([a,y.pathnameBase])),route:b}),y.pathnameBase!=="/"&&(a=Qn([a,y.pathnameBase]))}return l}function el(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Vk(t.path,t.caseSensitive,t.end),o=e.match(n);if(!o)return null;let a=o[0],l=a.replace(/(.)\/+$/,"$1"),u=o.slice(1);return{params:r.reduce((f,{paramName:m,isOptional:y},b)=>{if(m==="*"){let k=u[b]||"";l=a.slice(0,a.length-k.length).replace(/(.)\/+$/,"$1")}const S=u[b];return y&&!S?f[m]=void 0:f[m]=(S||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:t}}function Vk(t,e=!1,n=!0){Pn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,d)=>(r.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,e?void 0:"i"),r]}function qk(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Pn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Yn(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Hk(t,e="/"){let{pathname:n,search:r="",hash:o=""}=typeof t=="string"?Kr(t):t;return{pathname:n?n.startsWith("/")?n:$k(n,e):e,search:Kk(r),hash:Jk(o)}}function $k(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?n.length>1&&n.pop():o!=="."&&n.push(o)}),n.length>1?n.join("/"):"/"}function ju(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Wk(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function k0(t){let e=Wk(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function S0(t,e,n,r=!1){let o;typeof t=="string"?o=Kr(t):(o={...t},Ze(!o.pathname||!o.pathname.includes("?"),ju("?","pathname","search",o)),Ze(!o.pathname||!o.pathname.includes("#"),ju("#","pathname","hash",o)),Ze(!o.search||!o.search.includes("#"),ju("#","search","hash",o)));let a=t===""||o.pathname==="",l=a?"/":o.pathname,u;if(l==null)u=n;else{let y=e.length-1;if(!r&&l.startsWith("..")){let b=l.split("/");for(;b[0]==="..";)b.shift(),y-=1;o.pathname=b.join("/")}u=y>=0?e[y]:"/"}let d=Hk(o,u),f=l&&l!=="/"&&l.endsWith("/"),m=(a||l===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(f||m)&&(d.pathname+="/"),d}var Qn=t=>t.join("/").replace(/\/\/+/g,"/"),Gk=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Kk=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Jk=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Qk(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var T0=["POST","PUT","PATCH","DELETE"];new Set(T0);var Yk=["GET",...T0];new Set(Yk);var Jr=N.createContext(null);Jr.displayName="DataRouter";var pl=N.createContext(null);pl.displayName="DataRouterState";var C0=N.createContext({isTransitioning:!1});C0.displayName="ViewTransition";var Xk=N.createContext(new Map);Xk.displayName="Fetchers";var Zk=N.createContext(null);Zk.displayName="Await";var jn=N.createContext(null);jn.displayName="Navigation";var ao=N.createContext(null);ao.displayName="Location";var ti=N.createContext({outlet:null,matches:[],isDataRoute:!1});ti.displayName="Route";var th=N.createContext(null);th.displayName="RouteError";function e1(t,{relative:e}={}){Ze(lo(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=N.useContext(jn),{hash:o,pathname:a,search:l}=co(t,{relative:e}),u=a;return n!=="/"&&(u=a==="/"?n:Qn([n,a])),r.createHref({pathname:u,search:l,hash:o})}function lo(){return N.useContext(ao)!=null}function ir(){return Ze(lo(),"useLocation() may be used only in the context of a <Router> component."),N.useContext(ao).location}var w0="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function E0(t){N.useContext(jn).static||N.useLayoutEffect(t)}function nh(){let{isDataRoute:t}=N.useContext(ti);return t?f1():t1()}function t1(){Ze(lo(),"useNavigate() may be used only in the context of a <Router> component.");let t=N.useContext(Jr),{basename:e,navigator:n}=N.useContext(jn),{matches:r}=N.useContext(ti),{pathname:o}=ir(),a=JSON.stringify(k0(r)),l=N.useRef(!1);return E0(()=>{l.current=!0}),N.useCallback((d,f={})=>{if(Pn(l.current,w0),!l.current)return;if(typeof d=="number"){n.go(d);return}let m=S0(d,JSON.parse(a),o,f.relative==="path");t==null&&e!=="/"&&(m.pathname=m.pathname==="/"?e:Qn([e,m.pathname])),(f.replace?n.replace:n.push)(m,f.state,f)},[e,n,a,o,t])}N.createContext(null);function co(t,{relative:e}={}){let{matches:n}=N.useContext(ti),{pathname:r}=ir(),o=JSON.stringify(k0(n));return N.useMemo(()=>S0(t,JSON.parse(o),r,e==="path"),[t,o,r,e])}function n1(t,e){return _0(t,e)}function _0(t,e,n,r){Ze(lo(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=N.useContext(jn),{matches:a}=N.useContext(ti),l=a[a.length-1],u=l?l.params:{},d=l?l.pathname:"/",f=l?l.pathnameBase:"/",m=l&&l.route;{let w=m&&m.path||"";R0(d,!m||w.endsWith("*")||w.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${w}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${w}"> to <Route path="${w==="/"?"*":`${w}/*`}">.`)}let y=ir(),b;if(e){let w=typeof e=="string"?Kr(e):e;Ze(f==="/"||w.pathname?.startsWith(f),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${f}" but pathname "${w.pathname}" was given in the \`location\` prop.`),b=w}else b=y;let S=b.pathname||"/",k=S;if(f!=="/"){let w=f.replace(/^\//,"").split("/");k="/"+S.replace(/^\//,"").split("/").slice(w.length).join("/")}let T=y0(t,{pathname:k});Pn(m||T!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Pn(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let C=a1(T&&T.map(w=>Object.assign({},w,{params:Object.assign({},u,w.params),pathname:Qn([f,o.encodeLocation?o.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?f:Qn([f,o.encodeLocation?o.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),a,n,r);return e&&C?N.createElement(ao.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},C):C}function i1(){let t=h1(),e=Qk(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",t),l=N.createElement(N.Fragment,null,N.createElement("p",null," Hey developer "),N.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",N.createElement("code",{style:a},"ErrorBoundary")," or"," ",N.createElement("code",{style:a},"errorElement")," prop on your route.")),N.createElement(N.Fragment,null,N.createElement("h2",null,"Unexpected Application Error!"),N.createElement("h3",{style:{fontStyle:"italic"}},e),n?N.createElement("pre",{style:o},n):null,l)}var r1=N.createElement(i1,null),s1=class extends N.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?N.createElement(ti.Provider,{value:this.props.routeContext},N.createElement(th.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function o1({routeContext:t,match:e,children:n}){let r=N.useContext(Jr);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),N.createElement(ti.Provider,{value:t},n)}function a1(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,a=n?.errors;if(a!=null){let d=o.findIndex(f=>f.route.id&&a?.[f.route.id]!==void 0);Ze(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),o=o.slice(0,Math.min(o.length,d+1))}let l=!1,u=-1;if(n)for(let d=0;d<o.length;d++){let f=o[d];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=d),f.route.id){let{loaderData:m,errors:y}=n,b=f.route.loader&&!m.hasOwnProperty(f.route.id)&&(!y||y[f.route.id]===void 0);if(f.route.lazy||b){l=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,f,m)=>{let y,b=!1,S=null,k=null;n&&(y=a&&f.route.id?a[f.route.id]:void 0,S=f.route.errorElement||r1,l&&(u<0&&m===0?(R0("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,k=null):u===m&&(b=!0,k=f.route.hydrateFallbackElement||null)));let T=e.concat(o.slice(0,m+1)),C=()=>{let w;return y?w=S:b?w=k:f.route.Component?w=N.createElement(f.route.Component,null):f.route.element?w=f.route.element:w=d,N.createElement(o1,{match:f,routeContext:{outlet:d,matches:T,isDataRoute:n!=null},children:w})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?N.createElement(s1,{location:n.location,revalidation:n.revalidation,component:S,error:y,children:C(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):C()},null)}function ih(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function l1(t){let e=N.useContext(Jr);return Ze(e,ih(t)),e}function c1(t){let e=N.useContext(pl);return Ze(e,ih(t)),e}function u1(t){let e=N.useContext(ti);return Ze(e,ih(t)),e}function rh(t){let e=u1(t),n=e.matches[e.matches.length-1];return Ze(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function d1(){return rh("useRouteId")}function h1(){let t=N.useContext(th),e=c1("useRouteError"),n=rh("useRouteError");return t!==void 0?t:e.errors?.[n]}function f1(){let{router:t}=l1("useNavigate"),e=rh("useNavigate"),n=N.useRef(!1);return E0(()=>{n.current=!0}),N.useCallback(async(o,a={})=>{Pn(n.current,w0),n.current&&(typeof o=="number"?t.navigate(o):await t.navigate(o,{fromRouteId:e,...a}))},[t,e])}var Vm={};function R0(t,e,n){!e&&!Vm[t]&&(Vm[t]=!0,Pn(!1,n))}N.memo(p1);function p1({routes:t,future:e,state:n}){return _0(t,void 0,n,e)}function Cn(t){Ze(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function m1({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:o,static:a=!1}){Ze(!lo(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),u=N.useMemo(()=>({basename:l,navigator:o,static:a,future:{}}),[l,o,a]);typeof n=="string"&&(n=Kr(n));let{pathname:d="/",search:f="",hash:m="",state:y=null,key:b="default"}=n,S=N.useMemo(()=>{let k=Yn(d,l);return k==null?null:{location:{pathname:k,search:f,hash:m,state:y,key:b},navigationType:r}},[l,d,f,m,y,b,r]);return Pn(S!=null,`<Router basename="${l}"> is not able to match the URL "${d}${f}${m}" because it does not start with the basename, so the <Router> won't render anything.`),S==null?null:N.createElement(jn.Provider,{value:u},N.createElement(ao.Provider,{children:e,value:S}))}function g1({children:t,location:e}){return n1(od(t),e)}function od(t,e=[]){let n=[];return N.Children.forEach(t,(r,o)=>{if(!N.isValidElement(r))return;let a=[...e,o];if(r.type===N.Fragment){n.push.apply(n,od(r.props.children,a));return}Ze(r.type===Cn,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ze(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=od(r.props.children,a)),n.push(l)}),n}var Ia="get",ja="application/x-www-form-urlencoded";function ml(t){return t!=null&&typeof t.tagName=="string"}function v1(t){return ml(t)&&t.tagName.toLowerCase()==="button"}function y1(t){return ml(t)&&t.tagName.toLowerCase()==="form"}function b1(t){return ml(t)&&t.tagName.toLowerCase()==="input"}function x1(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function k1(t,e){return t.button===0&&(!e||e==="_self")&&!x1(t)}var _a=null;function S1(){if(_a===null)try{new FormData(document.createElement("form"),0),_a=!1}catch{_a=!0}return _a}var T1=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ou(t){return t!=null&&!T1.has(t)?(Pn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${ja}"`),null):t}function C1(t,e){let n,r,o,a,l;if(y1(t)){let u=t.getAttribute("action");r=u?Yn(u,e):null,n=t.getAttribute("method")||Ia,o=Ou(t.getAttribute("enctype"))||ja,a=new FormData(t)}else if(v1(t)||b1(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||u.getAttribute("action");if(r=d?Yn(d,e):null,n=t.getAttribute("formmethod")||u.getAttribute("method")||Ia,o=Ou(t.getAttribute("formenctype"))||Ou(u.getAttribute("enctype"))||ja,a=new FormData(u,t),!S1()){let{name:f,type:m,value:y}=t;if(m==="image"){let b=f?`${f}.`:"";a.append(`${b}x`,"0"),a.append(`${b}y`,"0")}else f&&a.append(f,y)}}else{if(ml(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ia,r=null,o=ja,l=t}return a&&o==="text/plain"&&(l=a,a=void 0),{action:r,method:n.toLowerCase(),encType:o,formData:a,body:l}}function sh(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function w1(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function E1(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function _1(t,e,n){let r=await Promise.all(t.map(async o=>{let a=e.routes[o.route.id];if(a){let l=await w1(a,n);return l.links?l.links():[]}return[]}));return I1(r.flat(1).filter(E1).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function qm(t,e,n,r,o,a){let l=(d,f)=>n[f]?d.route.id!==n[f].route.id:!0,u=(d,f)=>n[f].pathname!==d.pathname||n[f].route.path?.endsWith("*")&&n[f].params["*"]!==d.params["*"];return a==="assets"?e.filter((d,f)=>l(d,f)||u(d,f)):a==="data"?e.filter((d,f)=>{let m=r.routes[d.route.id];if(!m||!m.hasLoader)return!1;if(l(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function R1(t,e,{includeHydrateFallback:n}={}){return P1(t.map(r=>{let o=e.routes[r.route.id];if(!o)return[];let a=[o.module];return o.clientActionModule&&(a=a.concat(o.clientActionModule)),o.clientLoaderModule&&(a=a.concat(o.clientLoaderModule)),n&&o.hydrateFallbackModule&&(a=a.concat(o.hydrateFallbackModule)),o.imports&&(a=a.concat(o.imports)),a}).flat(1))}function P1(t){return[...new Set(t)]}function N1(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function I1(t,e){let n=new Set;return new Set(e),t.reduce((r,o)=>{let a=JSON.stringify(N1(o));return n.has(a)||(n.add(a),r.push({key:a,link:o})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var j1=new Set([100,101,204,205]);function O1(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&Yn(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function P0(){let t=N.useContext(Jr);return sh(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function A1(){let t=N.useContext(pl);return sh(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var oh=N.createContext(void 0);oh.displayName="FrameworkContext";function N0(){let t=N.useContext(oh);return sh(t,"You must render this element inside a <HydratedRouter> element"),t}function D1(t,e){let n=N.useContext(oh),[r,o]=N.useState(!1),[a,l]=N.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:m,onTouchStart:y}=e,b=N.useRef(null);N.useEffect(()=>{if(t==="render"&&l(!0),t==="viewport"){let T=w=>{w.forEach(A=>{l(A.isIntersecting)})},C=new IntersectionObserver(T,{threshold:.5});return b.current&&C.observe(b.current),()=>{C.disconnect()}}},[t]),N.useEffect(()=>{if(r){let T=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(T)}}},[r]);let S=()=>{o(!0)},k=()=>{o(!1),l(!1)};return n?t!=="intent"?[a,b,{}]:[a,b,{onFocus:Fs(u,S),onBlur:Fs(d,k),onMouseEnter:Fs(f,S),onMouseLeave:Fs(m,k),onTouchStart:Fs(y,S)}]:[!1,b,{}]}function Fs(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function L1({page:t,...e}){let{router:n}=P0(),r=N.useMemo(()=>y0(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?N.createElement(U1,{page:t,matches:r,...e}):null}function M1(t){let{manifest:e,routeModules:n}=N0(),[r,o]=N.useState([]);return N.useEffect(()=>{let a=!1;return _1(t,e,n).then(l=>{a||o(l)}),()=>{a=!0}},[t,e,n]),r}function U1({page:t,matches:e,...n}){let r=ir(),{manifest:o,routeModules:a}=N0(),{basename:l}=P0(),{loaderData:u,matches:d}=A1(),f=N.useMemo(()=>qm(t,e,d,o,r,"data"),[t,e,d,o,r]),m=N.useMemo(()=>qm(t,e,d,o,r,"assets"),[t,e,d,o,r]),y=N.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let k=new Set,T=!1;if(e.forEach(w=>{let A=o.routes[w.route.id];!A||!A.hasLoader||(!f.some(P=>P.route.id===w.route.id)&&w.route.id in u&&a[w.route.id]?.shouldRevalidate||A.hasClientLoader?T=!0:k.add(w.route.id))}),k.size===0)return[];let C=O1(t,l);return T&&k.size>0&&C.searchParams.set("_routes",e.filter(w=>k.has(w.route.id)).map(w=>w.route.id).join(",")),[C.pathname+C.search]},[l,u,r,o,f,e,t,a]),b=N.useMemo(()=>R1(m,o),[m,o]),S=M1(m);return N.createElement(N.Fragment,null,y.map(k=>N.createElement("link",{key:k,rel:"prefetch",as:"fetch",href:k,...n})),b.map(k=>N.createElement("link",{key:k,rel:"modulepreload",href:k,...n})),S.map(({key:k,link:T})=>N.createElement("link",{key:k,...T})))}function F1(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var I0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{I0&&(window.__reactRouterVersion="7.6.3")}catch{}function B1({basename:t,children:e,window:n}){let r=N.useRef();r.current==null&&(r.current=_k({window:n,v5Compat:!0}));let o=r.current,[a,l]=N.useState({action:o.action,location:o.location}),u=N.useCallback(d=>{N.startTransition(()=>l(d))},[l]);return N.useLayoutEffect(()=>o.listen(u),[o,u]),N.createElement(m1,{basename:t,children:e,location:a.location,navigationType:a.action,navigator:o})}var j0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,O0=N.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:o,reloadDocument:a,replace:l,state:u,target:d,to:f,preventScrollReset:m,viewTransition:y,...b},S){let{basename:k}=N.useContext(jn),T=typeof f=="string"&&j0.test(f),C,w=!1;if(typeof f=="string"&&T&&(C=f,I0))try{let z=new URL(window.location.href),K=f.startsWith("//")?new URL(z.protocol+f):new URL(f),Q=Yn(K.pathname,k);K.origin===z.origin&&Q!=null?f=Q+K.search+K.hash:w=!0}catch{Pn(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let A=e1(f,{relative:o}),[P,E,R]=D1(r,b),B=H1(f,{replace:l,state:u,target:d,preventScrollReset:m,relative:o,viewTransition:y});function I(z){e&&e(z),z.defaultPrevented||B(z)}let M=N.createElement("a",{...b,...R,href:C||A,onClick:w||a?e:I,ref:F1(S,E),target:d,"data-discover":!T&&n==="render"?"true":void 0});return P&&!T?N.createElement(N.Fragment,null,M,N.createElement(L1,{page:A})):M});O0.displayName="Link";var z1=N.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:o=!1,style:a,to:l,viewTransition:u,children:d,...f},m){let y=co(l,{relative:f.relative}),b=ir(),S=N.useContext(pl),{navigator:k,basename:T}=N.useContext(jn),C=S!=null&&J1(y)&&u===!0,w=k.encodeLocation?k.encodeLocation(y).pathname:y.pathname,A=b.pathname,P=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;n||(A=A.toLowerCase(),P=P?P.toLowerCase():null,w=w.toLowerCase()),P&&T&&(P=Yn(P,T)||P);const E=w!=="/"&&w.endsWith("/")?w.length-1:w.length;let R=A===w||!o&&A.startsWith(w)&&A.charAt(E)==="/",B=P!=null&&(P===w||!o&&P.startsWith(w)&&P.charAt(w.length)==="/"),I={isActive:R,isPending:B,isTransitioning:C},M=R?e:void 0,z;typeof r=="function"?z=r(I):z=[r,R?"active":null,B?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let K=typeof a=="function"?a(I):a;return N.createElement(O0,{...f,"aria-current":M,className:z,ref:m,style:K,to:l,viewTransition:u},typeof d=="function"?d(I):d)});z1.displayName="NavLink";var V1=N.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:o,state:a,method:l=Ia,action:u,onSubmit:d,relative:f,preventScrollReset:m,viewTransition:y,...b},S)=>{let k=G1(),T=K1(u,{relative:f}),C=l.toLowerCase()==="get"?"get":"post",w=typeof u=="string"&&j0.test(u),A=P=>{if(d&&d(P),P.defaultPrevented)return;P.preventDefault();let E=P.nativeEvent.submitter,R=E?.getAttribute("formmethod")||l;k(E||P.currentTarget,{fetcherKey:e,method:R,navigate:n,replace:o,state:a,relative:f,preventScrollReset:m,viewTransition:y})};return N.createElement("form",{ref:S,method:C,action:T,onSubmit:r?d:A,...b,"data-discover":!w&&t==="render"?"true":void 0})});V1.displayName="Form";function q1(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function A0(t){let e=N.useContext(Jr);return Ze(e,q1(t)),e}function H1(t,{target:e,replace:n,state:r,preventScrollReset:o,relative:a,viewTransition:l}={}){let u=nh(),d=ir(),f=co(t,{relative:a});return N.useCallback(m=>{if(k1(m,e)){m.preventDefault();let y=n!==void 0?n:to(d)===to(f);u(t,{replace:y,state:r,preventScrollReset:o,relative:a,viewTransition:l})}},[d,u,f,n,r,e,t,o,a,l])}var $1=0,W1=()=>`__${String(++$1)}__`;function G1(){let{router:t}=A0("useSubmit"),{basename:e}=N.useContext(jn),n=d1();return N.useCallback(async(r,o={})=>{let{action:a,method:l,encType:u,formData:d,body:f}=C1(r,e);if(o.navigate===!1){let m=o.fetcherKey||W1();await t.fetch(m,n,o.action||a,{preventScrollReset:o.preventScrollReset,formData:d,body:f,formMethod:o.method||l,formEncType:o.encType||u,flushSync:o.flushSync})}else await t.navigate(o.action||a,{preventScrollReset:o.preventScrollReset,formData:d,body:f,formMethod:o.method||l,formEncType:o.encType||u,replace:o.replace,state:o.state,fromRouteId:n,flushSync:o.flushSync,viewTransition:o.viewTransition})},[t,e,n])}function K1(t,{relative:e}={}){let{basename:n}=N.useContext(jn),r=N.useContext(ti);Ze(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),a={...co(t||".",{relative:e})},l=ir();if(t==null){a.search=l.search;let u=new URLSearchParams(a.search),d=u.getAll("index");if(d.some(m=>m==="")){u.delete("index"),d.filter(y=>y).forEach(y=>u.append("index",y));let m=u.toString();a.search=m?`?${m}`:""}}return(!t||t===".")&&o.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Qn([n,a.pathname])),to(a)}function J1(t,e={}){let n=N.useContext(C0);Ze(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=A0("useViewTransitionState"),o=co(t,{relative:e.relative});if(!n.isTransitioning)return!1;let a=Yn(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=Yn(n.nextLocation.pathname,r)||n.nextLocation.pathname;return el(o.pathname,l)!=null||el(o.pathname,a)!=null}[...j1];function Q1(){const t=nh();return p.jsx("div",{className:"h-full w-full p-4 md:p-6",children:p.jsxs("div",{className:"w-full flex flex-col h-full",children:[p.jsx("div",{className:"w-full flex justify-center mb-6",children:p.jsx("img",{src:pk,alt:"logo",className:"w-3/4 max-w-[120px] md:max-w-[140px] lg:max-w-[160px]"})}),p.jsxs("div",{className:"flex-1 flex flex-col gap-3 md:gap-4",children:[p.jsxs("div",{className:"w-full flex items-center gap-3 md:gap-4 hover:bg-purple-600 rounded-md p-2 md:p-3 cursor-pointer transition-colors duration-200",onClick:()=>t("/AlChat"),children:[p.jsx(Sk,{className:"text-xl md:text-2xl flex-shrink-0"}),p.jsx("div",{className:"text-sm md:text-base lg:text-lg font-medium truncate",children:"AI Chat"})]}),p.jsxs("div",{className:"w-full flex items-center gap-3 md:gap-4 hover:bg-purple-600 rounded-md p-2 md:p-3 cursor-pointer transition-colors duration-200",onClick:()=>t("/CareerRoadmap"),children:[p.jsx(id,{className:"text-xl md:text-2xl flex-shrink-0"}),p.jsx("div",{className:"text-sm md:text-base lg:text-lg font-medium truncate",children:"Career Roadmap"})]}),p.jsxs("div",{className:"w-full flex items-center gap-3 md:gap-4 hover:bg-purple-600 rounded-md p-2 md:p-3 cursor-pointer transition-colors duration-200",onClick:()=>t("/SkillGapAnalyzer"),children:[p.jsx(nd,{className:"text-xl md:text-2xl flex-shrink-0"}),p.jsx("div",{className:"text-sm md:text-base lg:text-lg font-medium truncate",children:"Skill Gap Analyzer"})]}),p.jsxs("div",{className:"w-full flex items-center gap-3 md:gap-4 hover:bg-purple-600 rounded-md p-2 md:p-3 cursor-pointer transition-colors duration-200",onClick:()=>t("/MockInterview"),children:[p.jsx(g0,{className:"text-xl md:text-2xl flex-shrink-0"}),p.jsx("div",{className:"text-sm md:text-base lg:text-lg font-medium truncate",children:"Mock Interview"})]}),p.jsxs("div",{className:"w-full flex items-center gap-3 md:gap-4 hover:bg-purple-600 rounded-md p-2 md:p-3 cursor-pointer transition-colors duration-200",onClick:()=>t("/ResumeAnalyzer"),children:[p.jsx(wk,{className:"text-xl md:text-2xl flex-shrink-0"}),p.jsx("div",{className:"text-sm md:text-base lg:text-lg font-medium truncate",children:"Resume Analyzer"})]}),p.jsxs("div",{className:"w-full flex items-center gap-3 md:gap-4 hover:bg-purple-600 rounded-md p-2 md:p-3 cursor-pointer transition-colors duration-200",onClick:()=>t("/LatestJobs"),children:[p.jsx(Tk,{className:"text-xl md:text-2xl flex-shrink-0"}),p.jsx("div",{className:"text-sm md:text-base lg:text-lg font-medium truncate",children:"Latest Jobs"})]}),p.jsxs("div",{className:"w-full flex items-center gap-3 md:gap-4 hover:bg-purple-600 rounded-md p-2 md:p-3 cursor-pointer transition-colors duration-200",onClick:()=>t("/SkillsInformation"),children:[p.jsx(Ck,{className:"text-xl md:text-2xl flex-shrink-0"}),p.jsx("div",{className:"text-sm md:text-base lg:text-lg font-medium truncate",children:"Skills Information"})]})]})]})})}function Y1(t){return Le({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M256 112v288m144-144H112"},child:[]}]})(t)}function D0(t){return Le({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(t)}function X1(t){return Le({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"44",d:"M358.62 129.28 86.49 402.08 70 442l39.92-16.49 272.8-272.13-24.1-24.1zm54.45-54.44-11.79 11.78 24.1 24.1 11.79-11.79a16.51 16.51 0 0 0 0-23.34l-.75-.75a16.51 16.51 0 0 0-23.35 0z"},child:[]}]})(t)}function Z1(t){return Le({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m476.59 227.05-.16-.07L49.35 49.84A23.56 23.56 0 0 0 27.14 52 24.65 24.65 0 0 0 16 72.59v113.29a24 24 0 0 0 19.52 23.57l232.93 43.07a4 4 0 0 1 0 7.86L35.53 303.45A24 24 0 0 0 16 327v113.31A23.57 23.57 0 0 0 26.59 460a23.94 23.94 0 0 0 13.22 4 24.55 24.55 0 0 0 9.52-1.93L476.4 285.94l.19-.09a32 32 0 0 0 0-58.8z"},child:[]}]})(t)}function eS(t){return Le({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208 208-93.13 208-208S370.87 48 256 48zm96 240h-96a16 16 0 0 1-16-16V128a16 16 0 0 1 32 0v128h80a16 16 0 0 1 0 32z"},child:[]}]})(t)}function tS(t){return Le({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",d:"M296 64h-80a7.91 7.91 0 0 0-8 8v24h96V72a7.91 7.91 0 0 0-8-8z"},child:[]},{tag:"path",attr:{d:"M432 96h-96V72a40 40 0 0 0-40-40h-80a40 40 0 0 0-40 40v24H80a16 16 0 0 0 0 32h17l19 304.92c1.42 26.85 22 47.08 48 47.08h184c26.13 0 46.3-19.78 48-47l19-305h17a16 16 0 0 0 0-32zM192.57 416H192a16 16 0 0 1-16-15.43l-8-224a16 16 0 1 1 32-1.14l8 224A16 16 0 0 1 192.57 416zM272 400a16 16 0 0 1-32 0V176a16 16 0 0 1 32 0zm32-304h-96V72a7.91 7.91 0 0 1 8-8h80a7.91 7.91 0 0 1 8 8zm32 304.57A16 16 0 0 1 320 416h-.58A16 16 0 0 1 304 399.43l8-224a16 16 0 1 1 32 1.14z"},child:[]}]})(t)}const L0=N.createContext({user:null,token:null,login:()=>{},logout:()=>{}}),nS=({children:t})=>{const[e,n]=N.useState(null),[r,o]=N.useState(null),[a,l]=N.useState(!0);N.useEffect(()=>{const m=localStorage.getItem("user"),y=localStorage.getItem("token");m&&y&&(n(JSON.parse(m)),o(y))},[]);const u=(m,y)=>{console.log("in context",m,y),n(m),o(y),localStorage.setItem("user",JSON.stringify(m)),localStorage.setItem("token",y)},d=()=>{n(null),o(null),localStorage.removeItem("token"),localStorage.removeItem("user")},f=()=>{l(!a)};return p.jsx(L0.Provider,{value:{user:e,token:r,login:u,logout:d,isOpen:a,toggleSidebar:f},children:t})},tl=()=>{const t=N.useContext(L0);if(!t)throw new Error("useApp must be used within an AppProvider");return t};function iS(t){return Le({attr:{viewBox:"0 0 15 15",fill:"none"},child:[{tag:"path",attr:{fillRule:"evenodd",clipRule:"evenodd",d:"M1.5 3C1.22386 3 1 3.22386 1 3.5C1 3.77614 1.22386 4 1.5 4H13.5C13.7761 4 14 3.77614 14 3.5C14 3.22386 13.7761 3 13.5 3H1.5ZM1 7.5C1 7.22386 1.22386 7 1.5 7H13.5C13.7761 7 14 7.22386 14 7.5C14 7.77614 13.7761 8 13.5 8H1.5C1.22386 8 1 7.77614 1 7.5ZM1 11.5C1 11.2239 1.22386 11 1.5 11H13.5C13.7761 11 14 11.2239 14 11.5C14 11.7761 13.7761 12 13.5 12H1.5C1.22386 12 1 11.7761 1 11.5Z",fill:"currentColor"},child:[]}]})(t)}function rS(){const{user:t}=tl(),{toggleSidebar:e}=tl();return p.jsxs("div",{className:"h-16 w-full bg-purple-500 border-b-2 border-black flex items-center justify-between px-4 md:px-6 lg:px-8",children:[p.jsx("div",{className:"flex items-center gap-3 md:gap-6 flex-1 max-w-md",children:p.jsx(iS,{className:"cursor-pointer text-xl md:text-2xl hover:text-purple-200 transition-colors duration-200",onClick:()=>e()})}),p.jsx("div",{className:"flex items-center gap-2 md:gap-3",children:p.jsxs("div",{className:"hidden sm:block",children:[p.jsx("h2",{className:"text-md md:text-lg font-medium text-center",children:t?.username}),p.jsx("h4",{className:"text-sm md:text-base text-white/80",children:t?.email})]})})]})}function Gt({children:t}){const{isOpen:e}=tl();return p.jsxs("div",{className:"w-full h-screen flex flex-row overflow-hidden",children:[p.jsx("div",{className:`h-screen bg-purple-500 border-r-2 border-black transition-all duration-300 ease-in-out ${e?"w-64 md:w-72 lg:w-80":"w-0"}`,children:e&&p.jsx(Q1,{})}),p.jsxs("div",{className:`h-screen flex flex-col transition-all duration-300 ease-in-out ${e?"flex-1":"w-full"}`,children:[p.jsx(rS,{}),p.jsx("div",{className:"flex-1 overflow-auto p-6",children:t})]})]})}function sS(){return p.jsx(Gt,{children:p.jsxs("div",{className:"max-w-6xl mx-auto",children:[p.jsxs("div",{className:"mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Welcome to Career Counselor"}),p.jsx("p",{className:"text-gray-600",children:"Your AI-powered career development companion. Get personalized advice, build your roadmap, and advance your career."})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200",children:[p.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"AI Chat"}),p.jsx("p",{className:"text-gray-600",children:"Get instant career advice and guidance from our AI counselor."})]}),p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200",children:[p.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Career Roadmap"}),p.jsx("p",{className:"text-gray-600",children:"Create personalized career development plans and track your progress."})]}),p.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md border border-gray-200",children:[p.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-3",children:"Skill Analysis"}),p.jsx("p",{className:"text-gray-600",children:"Identify skill gaps and get recommendations for improvement."})]})]})]})})}function M0(t,e){return function(){return t.apply(e,arguments)}}const{toString:oS}=Object.prototype,{getPrototypeOf:ah}=Object,{iterator:gl,toStringTag:U0}=Symbol,vl=(t=>e=>{const n=oS.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),vn=t=>(t=t.toLowerCase(),e=>vl(e)===t),yl=t=>e=>typeof e===t,{isArray:Qr}=Array,no=yl("undefined");function aS(t){return t!==null&&!no(t)&&t.constructor!==null&&!no(t.constructor)&&Ut(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const F0=vn("ArrayBuffer");function lS(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&F0(t.buffer),e}const cS=yl("string"),Ut=yl("function"),B0=yl("number"),bl=t=>t!==null&&typeof t=="object",uS=t=>t===!0||t===!1,Oa=t=>{if(vl(t)!=="object")return!1;const e=ah(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(U0 in t)&&!(gl in t)},dS=vn("Date"),hS=vn("File"),fS=vn("Blob"),pS=vn("FileList"),mS=t=>bl(t)&&Ut(t.pipe),gS=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Ut(t.append)&&((e=vl(t))==="formdata"||e==="object"&&Ut(t.toString)&&t.toString()==="[object FormData]"))},vS=vn("URLSearchParams"),[yS,bS,xS,kS]=["ReadableStream","Request","Response","Headers"].map(vn),SS=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function uo(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,o;if(typeof t!="object"&&(t=[t]),Qr(t))for(r=0,o=t.length;r<o;r++)e.call(null,t[r],r,t);else{const a=n?Object.getOwnPropertyNames(t):Object.keys(t),l=a.length;let u;for(r=0;r<l;r++)u=a[r],e.call(null,t[u],u,t)}}function z0(t,e){e=e.toLowerCase();const n=Object.keys(t);let r=n.length,o;for(;r-- >0;)if(o=n[r],e===o.toLowerCase())return o;return null}const Gi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,V0=t=>!no(t)&&t!==Gi;function ad(){const{caseless:t}=V0(this)&&this||{},e={},n=(r,o)=>{const a=t&&z0(e,o)||o;Oa(e[a])&&Oa(r)?e[a]=ad(e[a],r):Oa(r)?e[a]=ad({},r):Qr(r)?e[a]=r.slice():e[a]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&uo(arguments[r],n);return e}const TS=(t,e,n,{allOwnKeys:r}={})=>(uo(e,(o,a)=>{n&&Ut(o)?t[a]=M0(o,n):t[a]=o},{allOwnKeys:r}),t),CS=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),wS=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},ES=(t,e,n,r)=>{let o,a,l;const u={};if(e=e||{},t==null)return e;do{for(o=Object.getOwnPropertyNames(t),a=o.length;a-- >0;)l=o[a],(!r||r(l,t,e))&&!u[l]&&(e[l]=t[l],u[l]=!0);t=n!==!1&&ah(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},_S=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},RS=t=>{if(!t)return null;if(Qr(t))return t;let e=t.length;if(!B0(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},PS=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&ah(Uint8Array)),NS=(t,e)=>{const r=(t&&t[gl]).call(t);let o;for(;(o=r.next())&&!o.done;){const a=o.value;e.call(t,a[0],a[1])}},IS=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},jS=vn("HTMLFormElement"),OS=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,o){return r.toUpperCase()+o}),Hm=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),AS=vn("RegExp"),q0=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};uo(n,(o,a)=>{let l;(l=e(o,a,t))!==!1&&(r[a]=l||o)}),Object.defineProperties(t,r)},DS=t=>{q0(t,(e,n)=>{if(Ut(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Ut(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},LS=(t,e)=>{const n={},r=o=>{o.forEach(a=>{n[a]=!0})};return Qr(t)?r(t):r(String(t).split(e)),n},MS=()=>{},US=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function FS(t){return!!(t&&Ut(t.append)&&t[U0]==="FormData"&&t[gl])}const BS=t=>{const e=new Array(10),n=(r,o)=>{if(bl(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[o]=r;const a=Qr(r)?[]:{};return uo(r,(l,u)=>{const d=n(l,o+1);!no(d)&&(a[u]=d)}),e[o]=void 0,a}}return r};return n(t,0)},zS=vn("AsyncFunction"),VS=t=>t&&(bl(t)||Ut(t))&&Ut(t.then)&&Ut(t.catch),H0=((t,e)=>t?setImmediate:e?((n,r)=>(Gi.addEventListener("message",({source:o,data:a})=>{o===Gi&&a===n&&r.length&&r.shift()()},!1),o=>{r.push(o),Gi.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Ut(Gi.postMessage)),qS=typeof queueMicrotask<"u"?queueMicrotask.bind(Gi):typeof process<"u"&&process.nextTick||H0,HS=t=>t!=null&&Ut(t[gl]),H={isArray:Qr,isArrayBuffer:F0,isBuffer:aS,isFormData:gS,isArrayBufferView:lS,isString:cS,isNumber:B0,isBoolean:uS,isObject:bl,isPlainObject:Oa,isReadableStream:yS,isRequest:bS,isResponse:xS,isHeaders:kS,isUndefined:no,isDate:dS,isFile:hS,isBlob:fS,isRegExp:AS,isFunction:Ut,isStream:mS,isURLSearchParams:vS,isTypedArray:PS,isFileList:pS,forEach:uo,merge:ad,extend:TS,trim:SS,stripBOM:CS,inherits:wS,toFlatObject:ES,kindOf:vl,kindOfTest:vn,endsWith:_S,toArray:RS,forEachEntry:NS,matchAll:IS,isHTMLForm:jS,hasOwnProperty:Hm,hasOwnProp:Hm,reduceDescriptors:q0,freezeMethods:DS,toObjectSet:LS,toCamelCase:OS,noop:MS,toFiniteNumber:US,findKey:z0,global:Gi,isContextDefined:V0,isSpecCompliantForm:FS,toJSONObject:BS,isAsyncFn:zS,isThenable:VS,setImmediate:H0,asap:qS,isIterable:HS};function Ce(t,e,n,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}H.inherits(Ce,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const $0=Ce.prototype,W0={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{W0[t]={value:t}});Object.defineProperties(Ce,W0);Object.defineProperty($0,"isAxiosError",{value:!0});Ce.from=(t,e,n,r,o,a)=>{const l=Object.create($0);return H.toFlatObject(t,l,function(d){return d!==Error.prototype},u=>u!=="isAxiosError"),Ce.call(l,t.message,e,n,r,o),l.cause=t,l.name=t.name,a&&Object.assign(l,a),l};const $S=null;function ld(t){return H.isPlainObject(t)||H.isArray(t)}function G0(t){return H.endsWith(t,"[]")?t.slice(0,-2):t}function $m(t,e,n){return t?t.concat(e).map(function(o,a){return o=G0(o),!n&&a?"["+o+"]":o}).join(n?".":""):e}function WS(t){return H.isArray(t)&&!t.some(ld)}const GS=H.toFlatObject(H,{},null,function(e){return/^is[A-Z]/.test(e)});function xl(t,e,n){if(!H.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=H.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(T,C){return!H.isUndefined(C[T])});const r=n.metaTokens,o=n.visitor||m,a=n.dots,l=n.indexes,d=(n.Blob||typeof Blob<"u"&&Blob)&&H.isSpecCompliantForm(e);if(!H.isFunction(o))throw new TypeError("visitor must be a function");function f(k){if(k===null)return"";if(H.isDate(k))return k.toISOString();if(H.isBoolean(k))return k.toString();if(!d&&H.isBlob(k))throw new Ce("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(k)||H.isTypedArray(k)?d&&typeof Blob=="function"?new Blob([k]):Buffer.from(k):k}function m(k,T,C){let w=k;if(k&&!C&&typeof k=="object"){if(H.endsWith(T,"{}"))T=r?T:T.slice(0,-2),k=JSON.stringify(k);else if(H.isArray(k)&&WS(k)||(H.isFileList(k)||H.endsWith(T,"[]"))&&(w=H.toArray(k)))return T=G0(T),w.forEach(function(P,E){!(H.isUndefined(P)||P===null)&&e.append(l===!0?$m([T],E,a):l===null?T:T+"[]",f(P))}),!1}return ld(k)?!0:(e.append($m(C,T,a),f(k)),!1)}const y=[],b=Object.assign(GS,{defaultVisitor:m,convertValue:f,isVisitable:ld});function S(k,T){if(!H.isUndefined(k)){if(y.indexOf(k)!==-1)throw Error("Circular reference detected in "+T.join("."));y.push(k),H.forEach(k,function(w,A){(!(H.isUndefined(w)||w===null)&&o.call(e,w,H.isString(A)?A.trim():A,T,b))===!0&&S(w,T?T.concat(A):[A])}),y.pop()}}if(!H.isObject(t))throw new TypeError("data must be an object");return S(t),e}function Wm(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function lh(t,e){this._pairs=[],t&&xl(t,this,e)}const K0=lh.prototype;K0.append=function(e,n){this._pairs.push([e,n])};K0.toString=function(e){const n=e?function(r){return e.call(this,r,Wm)}:Wm;return this._pairs.map(function(o){return n(o[0])+"="+n(o[1])},"").join("&")};function KS(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function J0(t,e,n){if(!e)return t;const r=n&&n.encode||KS;H.isFunction(n)&&(n={serialize:n});const o=n&&n.serialize;let a;if(o?a=o(e,n):a=H.isURLSearchParams(e)?e.toString():new lh(e,n).toString(r),a){const l=t.indexOf("#");l!==-1&&(t=t.slice(0,l)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class Gm{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){H.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Q0={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},JS=typeof URLSearchParams<"u"?URLSearchParams:lh,QS=typeof FormData<"u"?FormData:null,YS=typeof Blob<"u"?Blob:null,XS={isBrowser:!0,classes:{URLSearchParams:JS,FormData:QS,Blob:YS},protocols:["http","https","file","blob","url","data"]},ch=typeof window<"u"&&typeof document<"u",cd=typeof navigator=="object"&&navigator||void 0,ZS=ch&&(!cd||["ReactNative","NativeScript","NS"].indexOf(cd.product)<0),eT=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",tT=ch&&window.location.href||"http://localhost",nT=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ch,hasStandardBrowserEnv:ZS,hasStandardBrowserWebWorkerEnv:eT,navigator:cd,origin:tT},Symbol.toStringTag,{value:"Module"})),Ct={...nT,...XS};function iT(t,e){return xl(t,new Ct.classes.URLSearchParams,Object.assign({visitor:function(n,r,o,a){return Ct.isNode&&H.isBuffer(n)?(this.append(r,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},e))}function rT(t){return H.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function sT(t){const e={},n=Object.keys(t);let r;const o=n.length;let a;for(r=0;r<o;r++)a=n[r],e[a]=t[a];return e}function Y0(t){function e(n,r,o,a){let l=n[a++];if(l==="__proto__")return!0;const u=Number.isFinite(+l),d=a>=n.length;return l=!l&&H.isArray(o)?o.length:l,d?(H.hasOwnProp(o,l)?o[l]=[o[l],r]:o[l]=r,!u):((!o[l]||!H.isObject(o[l]))&&(o[l]=[]),e(n,r,o[l],a)&&H.isArray(o[l])&&(o[l]=sT(o[l])),!u)}if(H.isFormData(t)&&H.isFunction(t.entries)){const n={};return H.forEachEntry(t,(r,o)=>{e(rT(r),o,n,0)}),n}return null}function oT(t,e,n){if(H.isString(t))try{return(e||JSON.parse)(t),H.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const ho={transitional:Q0,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",o=r.indexOf("application/json")>-1,a=H.isObject(e);if(a&&H.isHTMLForm(e)&&(e=new FormData(e)),H.isFormData(e))return o?JSON.stringify(Y0(e)):e;if(H.isArrayBuffer(e)||H.isBuffer(e)||H.isStream(e)||H.isFile(e)||H.isBlob(e)||H.isReadableStream(e))return e;if(H.isArrayBufferView(e))return e.buffer;if(H.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let u;if(a){if(r.indexOf("application/x-www-form-urlencoded")>-1)return iT(e,this.formSerializer).toString();if((u=H.isFileList(e))||r.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return xl(u?{"files[]":e}:e,d&&new d,this.formSerializer)}}return a||o?(n.setContentType("application/json",!1),oT(e)):e}],transformResponse:[function(e){const n=this.transitional||ho.transitional,r=n&&n.forcedJSONParsing,o=this.responseType==="json";if(H.isResponse(e)||H.isReadableStream(e))return e;if(e&&H.isString(e)&&(r&&!this.responseType||o)){const l=!(n&&n.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(u){if(l)throw u.name==="SyntaxError"?Ce.from(u,Ce.ERR_BAD_RESPONSE,this,null,this.response):u}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ct.classes.FormData,Blob:Ct.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],t=>{ho.headers[t]={}});const aT=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),lT=t=>{const e={};let n,r,o;return t&&t.split(`
`).forEach(function(l){o=l.indexOf(":"),n=l.substring(0,o).trim().toLowerCase(),r=l.substring(o+1).trim(),!(!n||e[n]&&aT[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},Km=Symbol("internals");function Bs(t){return t&&String(t).trim().toLowerCase()}function Aa(t){return t===!1||t==null?t:H.isArray(t)?t.map(Aa):String(t)}function cT(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const uT=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Au(t,e,n,r,o){if(H.isFunction(r))return r.call(this,e,n);if(o&&(e=n),!!H.isString(e)){if(H.isString(r))return e.indexOf(r)!==-1;if(H.isRegExp(r))return r.test(e)}}function dT(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function hT(t,e){const n=H.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(o,a,l){return this[r].call(this,e,o,a,l)},configurable:!0})})}let Ft=class{constructor(e){e&&this.set(e)}set(e,n,r){const o=this;function a(u,d,f){const m=Bs(d);if(!m)throw new Error("header name must be a non-empty string");const y=H.findKey(o,m);(!y||o[y]===void 0||f===!0||f===void 0&&o[y]!==!1)&&(o[y||d]=Aa(u))}const l=(u,d)=>H.forEach(u,(f,m)=>a(f,m,d));if(H.isPlainObject(e)||e instanceof this.constructor)l(e,n);else if(H.isString(e)&&(e=e.trim())&&!uT(e))l(lT(e),n);else if(H.isObject(e)&&H.isIterable(e)){let u={},d,f;for(const m of e){if(!H.isArray(m))throw TypeError("Object iterator must return a key-value pair");u[f=m[0]]=(d=u[f])?H.isArray(d)?[...d,m[1]]:[d,m[1]]:m[1]}l(u,n)}else e!=null&&a(n,e,r);return this}get(e,n){if(e=Bs(e),e){const r=H.findKey(this,e);if(r){const o=this[r];if(!n)return o;if(n===!0)return cT(o);if(H.isFunction(n))return n.call(this,o,r);if(H.isRegExp(n))return n.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Bs(e),e){const r=H.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Au(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let o=!1;function a(l){if(l=Bs(l),l){const u=H.findKey(r,l);u&&(!n||Au(r,r[u],u,n))&&(delete r[u],o=!0)}}return H.isArray(e)?e.forEach(a):a(e),o}clear(e){const n=Object.keys(this);let r=n.length,o=!1;for(;r--;){const a=n[r];(!e||Au(this,this[a],a,e,!0))&&(delete this[a],o=!0)}return o}normalize(e){const n=this,r={};return H.forEach(this,(o,a)=>{const l=H.findKey(r,a);if(l){n[l]=Aa(o),delete n[a];return}const u=e?dT(a):String(a).trim();u!==a&&delete n[a],n[u]=Aa(o),r[u]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return H.forEach(this,(r,o)=>{r!=null&&r!==!1&&(n[o]=e&&H.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(o=>r.set(o)),r}static accessor(e){const r=(this[Km]=this[Km]={accessors:{}}).accessors,o=this.prototype;function a(l){const u=Bs(l);r[u]||(hT(o,l),r[u]=!0)}return H.isArray(e)?e.forEach(a):a(e),this}};Ft.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);H.reduceDescriptors(Ft.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});H.freezeMethods(Ft);function Du(t,e){const n=this||ho,r=e||n,o=Ft.from(r.headers);let a=r.data;return H.forEach(t,function(u){a=u.call(n,a,o.normalize(),e?e.status:void 0)}),o.normalize(),a}function X0(t){return!!(t&&t.__CANCEL__)}function Yr(t,e,n){Ce.call(this,t??"canceled",Ce.ERR_CANCELED,e,n),this.name="CanceledError"}H.inherits(Yr,Ce,{__CANCEL__:!0});function Z0(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new Ce("Request failed with status code "+n.status,[Ce.ERR_BAD_REQUEST,Ce.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function fT(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function pT(t,e){t=t||10;const n=new Array(t),r=new Array(t);let o=0,a=0,l;return e=e!==void 0?e:1e3,function(d){const f=Date.now(),m=r[a];l||(l=f),n[o]=d,r[o]=f;let y=a,b=0;for(;y!==o;)b+=n[y++],y=y%t;if(o=(o+1)%t,o===a&&(a=(a+1)%t),f-l<e)return;const S=m&&f-m;return S?Math.round(b*1e3/S):void 0}}function mT(t,e){let n=0,r=1e3/e,o,a;const l=(f,m=Date.now())=>{n=m,o=null,a&&(clearTimeout(a),a=null),t.apply(null,f)};return[(...f)=>{const m=Date.now(),y=m-n;y>=r?l(f,m):(o=f,a||(a=setTimeout(()=>{a=null,l(o)},r-y)))},()=>o&&l(o)]}const nl=(t,e,n=3)=>{let r=0;const o=pT(50,250);return mT(a=>{const l=a.loaded,u=a.lengthComputable?a.total:void 0,d=l-r,f=o(d),m=l<=u;r=l;const y={loaded:l,total:u,progress:u?l/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&m?(u-l)/f:void 0,event:a,lengthComputable:u!=null,[e?"download":"upload"]:!0};t(y)},n)},Jm=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},Qm=t=>(...e)=>H.asap(()=>t(...e)),gT=Ct.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Ct.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Ct.origin),Ct.navigator&&/(msie|trident)/i.test(Ct.navigator.userAgent)):()=>!0,vT=Ct.hasStandardBrowserEnv?{write(t,e,n,r,o,a){const l=[t+"="+encodeURIComponent(e)];H.isNumber(n)&&l.push("expires="+new Date(n).toGMTString()),H.isString(r)&&l.push("path="+r),H.isString(o)&&l.push("domain="+o),a===!0&&l.push("secure"),document.cookie=l.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function yT(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function bT(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function ev(t,e,n){let r=!yT(e);return t&&(r||n==!1)?bT(t,e):e}const Ym=t=>t instanceof Ft?{...t}:t;function Xi(t,e){e=e||{};const n={};function r(f,m,y,b){return H.isPlainObject(f)&&H.isPlainObject(m)?H.merge.call({caseless:b},f,m):H.isPlainObject(m)?H.merge({},m):H.isArray(m)?m.slice():m}function o(f,m,y,b){if(H.isUndefined(m)){if(!H.isUndefined(f))return r(void 0,f,y,b)}else return r(f,m,y,b)}function a(f,m){if(!H.isUndefined(m))return r(void 0,m)}function l(f,m){if(H.isUndefined(m)){if(!H.isUndefined(f))return r(void 0,f)}else return r(void 0,m)}function u(f,m,y){if(y in e)return r(f,m);if(y in t)return r(void 0,f)}const d={url:a,method:a,data:a,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:u,headers:(f,m,y)=>o(Ym(f),Ym(m),y,!0)};return H.forEach(Object.keys(Object.assign({},t,e)),function(m){const y=d[m]||o,b=y(t[m],e[m],m);H.isUndefined(b)&&y!==u||(n[m]=b)}),n}const tv=t=>{const e=Xi({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:a,headers:l,auth:u}=e;e.headers=l=Ft.from(l),e.url=J0(ev(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),u&&l.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):"")));let d;if(H.isFormData(n)){if(Ct.hasStandardBrowserEnv||Ct.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((d=l.getContentType())!==!1){const[f,...m]=d?d.split(";").map(y=>y.trim()).filter(Boolean):[];l.setContentType([f||"multipart/form-data",...m].join("; "))}}if(Ct.hasStandardBrowserEnv&&(r&&H.isFunction(r)&&(r=r(e)),r||r!==!1&&gT(e.url))){const f=o&&a&&vT.read(a);f&&l.set(o,f)}return e},xT=typeof XMLHttpRequest<"u",kT=xT&&function(t){return new Promise(function(n,r){const o=tv(t);let a=o.data;const l=Ft.from(o.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=o,m,y,b,S,k;function T(){S&&S(),k&&k(),o.cancelToken&&o.cancelToken.unsubscribe(m),o.signal&&o.signal.removeEventListener("abort",m)}let C=new XMLHttpRequest;C.open(o.method.toUpperCase(),o.url,!0),C.timeout=o.timeout;function w(){if(!C)return;const P=Ft.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),R={data:!u||u==="text"||u==="json"?C.responseText:C.response,status:C.status,statusText:C.statusText,headers:P,config:t,request:C};Z0(function(I){n(I),T()},function(I){r(I),T()},R),C=null}"onloadend"in C?C.onloadend=w:C.onreadystatechange=function(){!C||C.readyState!==4||C.status===0&&!(C.responseURL&&C.responseURL.indexOf("file:")===0)||setTimeout(w)},C.onabort=function(){C&&(r(new Ce("Request aborted",Ce.ECONNABORTED,t,C)),C=null)},C.onerror=function(){r(new Ce("Network Error",Ce.ERR_NETWORK,t,C)),C=null},C.ontimeout=function(){let E=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const R=o.transitional||Q0;o.timeoutErrorMessage&&(E=o.timeoutErrorMessage),r(new Ce(E,R.clarifyTimeoutError?Ce.ETIMEDOUT:Ce.ECONNABORTED,t,C)),C=null},a===void 0&&l.setContentType(null),"setRequestHeader"in C&&H.forEach(l.toJSON(),function(E,R){C.setRequestHeader(R,E)}),H.isUndefined(o.withCredentials)||(C.withCredentials=!!o.withCredentials),u&&u!=="json"&&(C.responseType=o.responseType),f&&([b,k]=nl(f,!0),C.addEventListener("progress",b)),d&&C.upload&&([y,S]=nl(d),C.upload.addEventListener("progress",y),C.upload.addEventListener("loadend",S)),(o.cancelToken||o.signal)&&(m=P=>{C&&(r(!P||P.type?new Yr(null,t,C):P),C.abort(),C=null)},o.cancelToken&&o.cancelToken.subscribe(m),o.signal&&(o.signal.aborted?m():o.signal.addEventListener("abort",m)));const A=fT(o.url);if(A&&Ct.protocols.indexOf(A)===-1){r(new Ce("Unsupported protocol "+A+":",Ce.ERR_BAD_REQUEST,t));return}C.send(a||null)})},ST=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,o;const a=function(f){if(!o){o=!0,u();const m=f instanceof Error?f:this.reason;r.abort(m instanceof Ce?m:new Yr(m instanceof Error?m.message:m))}};let l=e&&setTimeout(()=>{l=null,a(new Ce(`timeout ${e} of ms exceeded`,Ce.ETIMEDOUT))},e);const u=()=>{t&&(l&&clearTimeout(l),l=null,t.forEach(f=>{f.unsubscribe?f.unsubscribe(a):f.removeEventListener("abort",a)}),t=null)};t.forEach(f=>f.addEventListener("abort",a));const{signal:d}=r;return d.unsubscribe=()=>H.asap(u),d}},TT=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let r=0,o;for(;r<n;)o=r+e,yield t.slice(r,o),r=o},CT=async function*(t,e){for await(const n of wT(t))yield*TT(n,e)},wT=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},Xm=(t,e,n,r)=>{const o=CT(t,e);let a=0,l,u=d=>{l||(l=!0,r&&r(d))};return new ReadableStream({async pull(d){try{const{done:f,value:m}=await o.next();if(f){u(),d.close();return}let y=m.byteLength;if(n){let b=a+=y;n(b)}d.enqueue(new Uint8Array(m))}catch(f){throw u(f),f}},cancel(d){return u(d),o.return()}},{highWaterMark:2})},kl=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",nv=kl&&typeof ReadableStream=="function",ET=kl&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),iv=(t,...e)=>{try{return!!t(...e)}catch{return!1}},_T=nv&&iv(()=>{let t=!1;const e=new Request(Ct.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),Zm=64*1024,ud=nv&&iv(()=>H.isReadableStream(new Response("").body)),il={stream:ud&&(t=>t.body)};kl&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!il[e]&&(il[e]=H.isFunction(t[e])?n=>n[e]():(n,r)=>{throw new Ce(`Response type '${e}' is not supported`,Ce.ERR_NOT_SUPPORT,r)})})})(new Response);const RT=async t=>{if(t==null)return 0;if(H.isBlob(t))return t.size;if(H.isSpecCompliantForm(t))return(await new Request(Ct.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(H.isArrayBufferView(t)||H.isArrayBuffer(t))return t.byteLength;if(H.isURLSearchParams(t)&&(t=t+""),H.isString(t))return(await ET(t)).byteLength},PT=async(t,e)=>{const n=H.toFiniteNumber(t.getContentLength());return n??RT(e)},NT=kl&&(async t=>{let{url:e,method:n,data:r,signal:o,cancelToken:a,timeout:l,onDownloadProgress:u,onUploadProgress:d,responseType:f,headers:m,withCredentials:y="same-origin",fetchOptions:b}=tv(t);f=f?(f+"").toLowerCase():"text";let S=ST([o,a&&a.toAbortSignal()],l),k;const T=S&&S.unsubscribe&&(()=>{S.unsubscribe()});let C;try{if(d&&_T&&n!=="get"&&n!=="head"&&(C=await PT(m,r))!==0){let R=new Request(e,{method:"POST",body:r,duplex:"half"}),B;if(H.isFormData(r)&&(B=R.headers.get("content-type"))&&m.setContentType(B),R.body){const[I,M]=Jm(C,nl(Qm(d)));r=Xm(R.body,Zm,I,M)}}H.isString(y)||(y=y?"include":"omit");const w="credentials"in Request.prototype;k=new Request(e,{...b,signal:S,method:n.toUpperCase(),headers:m.normalize().toJSON(),body:r,duplex:"half",credentials:w?y:void 0});let A=await fetch(k,b);const P=ud&&(f==="stream"||f==="response");if(ud&&(u||P&&T)){const R={};["status","statusText","headers"].forEach(z=>{R[z]=A[z]});const B=H.toFiniteNumber(A.headers.get("content-length")),[I,M]=u&&Jm(B,nl(Qm(u),!0))||[];A=new Response(Xm(A.body,Zm,I,()=>{M&&M(),T&&T()}),R)}f=f||"text";let E=await il[H.findKey(il,f)||"text"](A,t);return!P&&T&&T(),await new Promise((R,B)=>{Z0(R,B,{data:E,headers:Ft.from(A.headers),status:A.status,statusText:A.statusText,config:t,request:k})})}catch(w){throw T&&T(),w&&w.name==="TypeError"&&/Load failed|fetch/i.test(w.message)?Object.assign(new Ce("Network Error",Ce.ERR_NETWORK,t,k),{cause:w.cause||w}):Ce.from(w,w&&w.code,t,k)}}),dd={http:$S,xhr:kT,fetch:NT};H.forEach(dd,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const eg=t=>`- ${t}`,IT=t=>H.isFunction(t)||t===null||t===!1,rv={getAdapter:t=>{t=H.isArray(t)?t:[t];const{length:e}=t;let n,r;const o={};for(let a=0;a<e;a++){n=t[a];let l;if(r=n,!IT(n)&&(r=dd[(l=String(n)).toLowerCase()],r===void 0))throw new Ce(`Unknown adapter '${l}'`);if(r)break;o[l||"#"+a]=r}if(!r){const a=Object.entries(o).map(([u,d])=>`adapter ${u} `+(d===!1?"is not supported by the environment":"is not available in the build"));let l=e?a.length>1?`since :
`+a.map(eg).join(`
`):" "+eg(a[0]):"as no adapter specified";throw new Ce("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:dd};function Lu(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Yr(null,t)}function tg(t){return Lu(t),t.headers=Ft.from(t.headers),t.data=Du.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),rv.getAdapter(t.adapter||ho.adapter)(t).then(function(r){return Lu(t),r.data=Du.call(t,t.transformResponse,r),r.headers=Ft.from(r.headers),r},function(r){return X0(r)||(Lu(t),r&&r.response&&(r.response.data=Du.call(t,t.transformResponse,r.response),r.response.headers=Ft.from(r.response.headers))),Promise.reject(r)})}const sv="1.10.0",Sl={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Sl[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const ng={};Sl.transitional=function(e,n,r){function o(a,l){return"[Axios v"+sv+"] Transitional option '"+a+"'"+l+(r?". "+r:"")}return(a,l,u)=>{if(e===!1)throw new Ce(o(l," has been removed"+(n?" in "+n:"")),Ce.ERR_DEPRECATED);return n&&!ng[l]&&(ng[l]=!0,console.warn(o(l," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(a,l,u):!0}};Sl.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function jT(t,e,n){if(typeof t!="object")throw new Ce("options must be an object",Ce.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let o=r.length;for(;o-- >0;){const a=r[o],l=e[a];if(l){const u=t[a],d=u===void 0||l(u,a,t);if(d!==!0)throw new Ce("option "+a+" must be "+d,Ce.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new Ce("Unknown option "+a,Ce.ERR_BAD_OPTION)}}const Da={assertOptions:jT,validators:Sl},Tn=Da.validators;let Ji=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Gm,response:new Gm}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const a=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?a&&!String(r.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+a):r.stack=a}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Xi(this.defaults,n);const{transitional:r,paramsSerializer:o,headers:a}=n;r!==void 0&&Da.assertOptions(r,{silentJSONParsing:Tn.transitional(Tn.boolean),forcedJSONParsing:Tn.transitional(Tn.boolean),clarifyTimeoutError:Tn.transitional(Tn.boolean)},!1),o!=null&&(H.isFunction(o)?n.paramsSerializer={serialize:o}:Da.assertOptions(o,{encode:Tn.function,serialize:Tn.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Da.assertOptions(n,{baseUrl:Tn.spelling("baseURL"),withXsrfToken:Tn.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=a&&H.merge(a.common,a[n.method]);a&&H.forEach(["delete","get","head","post","put","patch","common"],k=>{delete a[k]}),n.headers=Ft.concat(l,a);const u=[];let d=!0;this.interceptors.request.forEach(function(T){typeof T.runWhen=="function"&&T.runWhen(n)===!1||(d=d&&T.synchronous,u.unshift(T.fulfilled,T.rejected))});const f=[];this.interceptors.response.forEach(function(T){f.push(T.fulfilled,T.rejected)});let m,y=0,b;if(!d){const k=[tg.bind(this),void 0];for(k.unshift.apply(k,u),k.push.apply(k,f),b=k.length,m=Promise.resolve(n);y<b;)m=m.then(k[y++],k[y++]);return m}b=u.length;let S=n;for(y=0;y<b;){const k=u[y++],T=u[y++];try{S=k(S)}catch(C){T.call(this,C);break}}try{m=tg.call(this,S)}catch(k){return Promise.reject(k)}for(y=0,b=f.length;y<b;)m=m.then(f[y++],f[y++]);return m}getUri(e){e=Xi(this.defaults,e);const n=ev(e.baseURL,e.url,e.allowAbsoluteUrls);return J0(n,e.params,e.paramsSerializer)}};H.forEach(["delete","get","head","options"],function(e){Ji.prototype[e]=function(n,r){return this.request(Xi(r||{},{method:e,url:n,data:(r||{}).data}))}});H.forEach(["post","put","patch"],function(e){function n(r){return function(a,l,u){return this.request(Xi(u||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:a,data:l}))}}Ji.prototype[e]=n(),Ji.prototype[e+"Form"]=n(!0)});let OT=class ov{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const r=this;this.promise.then(o=>{if(!r._listeners)return;let a=r._listeners.length;for(;a-- >0;)r._listeners[a](o);r._listeners=null}),this.promise.then=o=>{let a;const l=new Promise(u=>{r.subscribe(u),a=u}).then(o);return l.cancel=function(){r.unsubscribe(a)},l},e(function(a,l,u){r.reason||(r.reason=new Yr(a,l,u),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new ov(function(o){e=o}),cancel:e}}};function AT(t){return function(n){return t.apply(null,n)}}function DT(t){return H.isObject(t)&&t.isAxiosError===!0}const hd={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(hd).forEach(([t,e])=>{hd[e]=t});function av(t){const e=new Ji(t),n=M0(Ji.prototype.request,e);return H.extend(n,Ji.prototype,e,{allOwnKeys:!0}),H.extend(n,e,null,{allOwnKeys:!0}),n.create=function(o){return av(Xi(t,o))},n}const we=av(ho);we.Axios=Ji;we.CanceledError=Yr;we.CancelToken=OT;we.isCancel=X0;we.VERSION=sv;we.toFormData=xl;we.AxiosError=Ce;we.Cancel=we.CanceledError;we.all=function(e){return Promise.all(e)};we.spread=AT;we.isAxiosError=DT;we.mergeConfig=Xi;we.AxiosHeaders=Ft;we.formToJSON=t=>Y0(H.isHTMLForm(t)?new FormData(t):t);we.getAdapter=rv.getAdapter;we.HttpStatusCode=hd;we.default=we;const{Axios:SP,AxiosError:TP,CanceledError:CP,isCancel:wP,CancelToken:EP,VERSION:_P,all:RP,Cancel:PP,isAxiosError:NP,spread:IP,toFormData:jP,AxiosHeaders:OP,HttpStatusCode:AP,formToJSON:DP,getAdapter:LP,mergeConfig:MP}=we;function lv(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var o=t.length;for(e=0;e<o;e++)t[e]&&(n=lv(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Qi(){for(var t,e,n=0,r="",o=arguments.length;n<o;n++)(t=arguments[n])&&(e=lv(t))&&(r&&(r+=" "),r+=e);return r}function LT(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}LT(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var fo=t=>typeof t=="number"&&!isNaN(t),Zi=t=>typeof t=="string",Xn=t=>typeof t=="function",MT=t=>Zi(t)||fo(t),fd=t=>Zi(t)||Xn(t)?t:null,UT=(t,e)=>t===!1||fo(t)&&t>0?t:e,pd=t=>N.isValidElement(t)||Zi(t)||Xn(t)||fo(t);function FT(t,e,n=300){let{scrollHeight:r,style:o}=t;requestAnimationFrame(()=>{o.minHeight="initial",o.height=r+"px",o.transition=`all ${n}ms`,requestAnimationFrame(()=>{o.height="0",o.padding="0",o.margin="0",setTimeout(e,n)})})}function BT({enter:t,exit:e,appendPosition:n=!1,collapse:r=!0,collapseDuration:o=300}){return function({children:a,position:l,preventExitTransition:u,done:d,nodeRef:f,isIn:m,playToast:y}){let b=n?`${t}--${l}`:t,S=n?`${e}--${l}`:e,k=N.useRef(0);return N.useLayoutEffect(()=>{let T=f.current,C=b.split(" "),w=A=>{A.target===f.current&&(y(),T.removeEventListener("animationend",w),T.removeEventListener("animationcancel",w),k.current===0&&A.type!=="animationcancel"&&T.classList.remove(...C))};T.classList.add(...C),T.addEventListener("animationend",w),T.addEventListener("animationcancel",w)},[]),N.useEffect(()=>{let T=f.current,C=()=>{T.removeEventListener("animationend",C),r?FT(T,d,o):d()};m||(u?C():(k.current=1,T.className+=` ${S}`,T.addEventListener("animationend",C)))},[m]),Be.createElement(Be.Fragment,null,a)}}function ig(t,e){return{content:cv(t.content,t.props),containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,reason:t.removalReason,status:e}}function cv(t,e,n=!1){return N.isValidElement(t)&&!Zi(t.type)?N.cloneElement(t,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:n}):Xn(t)?t({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:n}):t}function zT({closeToast:t,theme:e,ariaLabel:n="close"}){return Be.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:r=>{r.stopPropagation(),t(!0)},"aria-label":n},Be.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},Be.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function VT({delay:t,isRunning:e,closeToast:n,type:r="default",hide:o,className:a,controlledProgress:l,progress:u,rtl:d,isIn:f,theme:m}){let y=o||l&&u===0,b={animationDuration:`${t}ms`,animationPlayState:e?"running":"paused"};l&&(b.transform=`scaleX(${u})`);let S=Qi("Toastify__progress-bar",l?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${m}`,`Toastify__progress-bar--${r}`,{"Toastify__progress-bar--rtl":d}),k=Xn(a)?a({rtl:d,type:r,defaultClassName:S}):Qi(S,a),T={[l&&u>=1?"onTransitionEnd":"onAnimationEnd"]:l&&u<1?null:()=>{f&&n()}};return Be.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":y},Be.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${m} Toastify__progress-bar--${r}`}),Be.createElement("div",{role:"progressbar","aria-hidden":y?"true":"false","aria-label":"notification timer",className:k,style:b,...T}))}var qT=1,uv=()=>`${qT++}`;function HT(t,e,n){let r=1,o=0,a=[],l=[],u=e,d=new Map,f=new Set,m=A=>(f.add(A),()=>f.delete(A)),y=()=>{l=Array.from(d.values()),f.forEach(A=>A())},b=({containerId:A,toastId:P,updateId:E})=>{let R=A?A!==t:t!==1,B=d.has(P)&&E==null;return R||B},S=(A,P)=>{d.forEach(E=>{var R;(P==null||P===E.props.toastId)&&((R=E.toggle)==null||R.call(E,A))})},k=A=>{var P,E;(E=(P=A.props)==null?void 0:P.onClose)==null||E.call(P,A.removalReason),A.isActive=!1},T=A=>{if(A==null)d.forEach(k);else{let P=d.get(A);P&&k(P)}y()},C=()=>{o-=a.length,a=[]},w=A=>{var P,E;let{toastId:R,updateId:B}=A.props,I=B==null;A.staleId&&d.delete(A.staleId),A.isActive=!0,d.set(R,A),y(),n(ig(A,I?"added":"updated")),I&&((E=(P=A.props).onOpen)==null||E.call(P))};return{id:t,props:u,observe:m,toggle:S,removeToast:T,toasts:d,clearQueue:C,buildToast:(A,P)=>{if(b(P))return;let{toastId:E,updateId:R,data:B,staleId:I,delay:M}=P,z=R==null;z&&o++;let K={...u,style:u.toastStyle,key:r++,...Object.fromEntries(Object.entries(P).filter(([ie,ce])=>ce!=null)),toastId:E,updateId:R,data:B,isIn:!1,className:fd(P.className||u.toastClassName),progressClassName:fd(P.progressClassName||u.progressClassName),autoClose:P.isLoading?!1:UT(P.autoClose,u.autoClose),closeToast(ie){d.get(E).removalReason=ie,T(E)},deleteToast(){let ie=d.get(E);if(ie!=null){if(n(ig(ie,"removed")),d.delete(E),o--,o<0&&(o=0),a.length>0){w(a.shift());return}y()}}};K.closeButton=u.closeButton,P.closeButton===!1||pd(P.closeButton)?K.closeButton=P.closeButton:P.closeButton===!0&&(K.closeButton=pd(u.closeButton)?u.closeButton:!0);let Q={content:A,props:K,staleId:I};u.limit&&u.limit>0&&o>u.limit&&z?a.push(Q):fo(M)?setTimeout(()=>{w(Q)},M):w(Q)},setProps(A){u=A},setToggle:(A,P)=>{let E=d.get(A);E&&(E.toggle=P)},isToastActive:A=>{var P;return(P=d.get(A))==null?void 0:P.isActive},getSnapshot:()=>l}}var _t=new Map,io=[],md=new Set,$T=t=>md.forEach(e=>e(t)),dv=()=>_t.size>0;function WT(){io.forEach(t=>fv(t.content,t.options)),io=[]}var GT=(t,{containerId:e})=>{var n;return(n=_t.get(e||1))==null?void 0:n.toasts.get(t)};function hv(t,e){var n;if(e)return!!((n=_t.get(e))!=null&&n.isToastActive(t));let r=!1;return _t.forEach(o=>{o.isToastActive(t)&&(r=!0)}),r}function KT(t){if(!dv()){io=io.filter(e=>t!=null&&e.options.toastId!==t);return}if(t==null||MT(t))_t.forEach(e=>{e.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){let e=_t.get(t.containerId);e?e.removeToast(t.id):_t.forEach(n=>{n.removeToast(t.id)})}}var JT=(t={})=>{_t.forEach(e=>{e.props.limit&&(!t.containerId||e.id===t.containerId)&&e.clearQueue()})};function fv(t,e){pd(t)&&(dv()||io.push({content:t,options:e}),_t.forEach(n=>{n.buildToast(t,e)}))}function QT(t){var e;(e=_t.get(t.containerId||1))==null||e.setToggle(t.id,t.fn)}function pv(t,e){_t.forEach(n=>{(e==null||!(e!=null&&e.containerId)||e?.containerId===n.id)&&n.toggle(t,e?.id)})}function YT(t){let e=t.containerId||1;return{subscribe(n){let r=HT(e,t,$T);_t.set(e,r);let o=r.observe(n);return WT(),()=>{o(),_t.delete(e)}},setProps(n){var r;(r=_t.get(e))==null||r.setProps(n)},getSnapshot(){var n;return(n=_t.get(e))==null?void 0:n.getSnapshot()}}}function XT(t){return md.add(t),()=>{md.delete(t)}}function ZT(t){return t&&(Zi(t.toastId)||fo(t.toastId))?t.toastId:uv()}function po(t,e){return fv(t,e),e.toastId}function Tl(t,e){return{...e,type:e&&e.type||t,toastId:ZT(e)}}function Cl(t){return(e,n)=>po(e,Tl(t,n))}function Ie(t,e){return po(t,Tl("default",e))}Ie.loading=(t,e)=>po(t,Tl("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function eC(t,{pending:e,error:n,success:r},o){let a;e&&(a=Zi(e)?Ie.loading(e,o):Ie.loading(e.render,{...o,...e}));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},u=(f,m,y)=>{if(m==null){Ie.dismiss(a);return}let b={type:f,...l,...o,data:y},S=Zi(m)?{render:m}:m;return a?Ie.update(a,{...b,...S}):Ie(S.render,{...b,...S}),y},d=Xn(t)?t():t;return d.then(f=>u("success",r,f)).catch(f=>u("error",n,f)),d}Ie.promise=eC;Ie.success=Cl("success");Ie.info=Cl("info");Ie.error=Cl("error");Ie.warning=Cl("warning");Ie.warn=Ie.warning;Ie.dark=(t,e)=>po(t,Tl("default",{theme:"dark",...e}));function tC(t){KT(t)}Ie.dismiss=tC;Ie.clearWaitingQueue=JT;Ie.isActive=hv;Ie.update=(t,e={})=>{let n=GT(t,e);if(n){let{props:r,content:o}=n,a={delay:100,...r,...e,toastId:e.toastId||t,updateId:uv()};a.toastId!==t&&(a.staleId=t);let l=a.render||o;delete a.render,po(l,a)}};Ie.done=t=>{Ie.update(t,{progress:1})};Ie.onChange=XT;Ie.play=t=>pv(!0,t);Ie.pause=t=>pv(!1,t);function nC(t){var e;let{subscribe:n,getSnapshot:r,setProps:o}=N.useRef(YT(t)).current;o(t);let a=(e=N.useSyncExternalStore(n,r,r))==null?void 0:e.slice();function l(u){if(!a)return[];let d=new Map;return t.newestOnTop&&a.reverse(),a.forEach(f=>{let{position:m}=f.props;d.has(m)||d.set(m,[]),d.get(m).push(f)}),Array.from(d,f=>u(f[0],f[1]))}return{getToastToRender:l,isToastActive:hv,count:a?.length}}function iC(t){let[e,n]=N.useState(!1),[r,o]=N.useState(!1),a=N.useRef(null),l=N.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:u,pauseOnHover:d,closeToast:f,onClick:m,closeOnClick:y}=t;QT({id:t.toastId,containerId:t.containerId,fn:n}),N.useEffect(()=>{if(t.pauseOnFocusLoss)return b(),()=>{S()}},[t.pauseOnFocusLoss]);function b(){document.hasFocus()||w(),window.addEventListener("focus",C),window.addEventListener("blur",w)}function S(){window.removeEventListener("focus",C),window.removeEventListener("blur",w)}function k(I){if(t.draggable===!0||t.draggable===I.pointerType){A();let M=a.current;l.canCloseOnClick=!0,l.canDrag=!0,M.style.transition="none",t.draggableDirection==="x"?(l.start=I.clientX,l.removalDistance=M.offsetWidth*(t.draggablePercent/100)):(l.start=I.clientY,l.removalDistance=M.offsetHeight*(t.draggablePercent===80?t.draggablePercent*1.5:t.draggablePercent)/100)}}function T(I){let{top:M,bottom:z,left:K,right:Q}=a.current.getBoundingClientRect();I.nativeEvent.type!=="touchend"&&t.pauseOnHover&&I.clientX>=K&&I.clientX<=Q&&I.clientY>=M&&I.clientY<=z?w():C()}function C(){n(!0)}function w(){n(!1)}function A(){l.didMove=!1,document.addEventListener("pointermove",E),document.addEventListener("pointerup",R)}function P(){document.removeEventListener("pointermove",E),document.removeEventListener("pointerup",R)}function E(I){let M=a.current;if(l.canDrag&&M){l.didMove=!0,e&&w(),t.draggableDirection==="x"?l.delta=I.clientX-l.start:l.delta=I.clientY-l.start,l.start!==I.clientX&&(l.canCloseOnClick=!1);let z=t.draggableDirection==="x"?`${l.delta}px, var(--y)`:`0, calc(${l.delta}px + var(--y))`;M.style.transform=`translate3d(${z},0)`,M.style.opacity=`${1-Math.abs(l.delta/l.removalDistance)}`}}function R(){P();let I=a.current;if(l.canDrag&&l.didMove&&I){if(l.canDrag=!1,Math.abs(l.delta)>l.removalDistance){o(!0),t.closeToast(!0),t.collapseAll();return}I.style.transition="transform 0.2s, opacity 0.2s",I.style.removeProperty("transform"),I.style.removeProperty("opacity")}}let B={onPointerDown:k,onPointerUp:T};return u&&d&&(B.onMouseEnter=w,t.stacked||(B.onMouseLeave=C)),y&&(B.onClick=I=>{m&&m(I),l.canCloseOnClick&&f(!0)}),{playToast:C,pauseToast:w,isRunning:e,preventExitTransition:r,toastRef:a,eventHandlers:B}}var rC=typeof window<"u"?N.useLayoutEffect:N.useEffect,wl=({theme:t,type:e,isLoading:n,...r})=>Be.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...r});function sC(t){return Be.createElement(wl,{...t},Be.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function oC(t){return Be.createElement(wl,{...t},Be.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function aC(t){return Be.createElement(wl,{...t},Be.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function lC(t){return Be.createElement(wl,{...t},Be.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function cC(){return Be.createElement("div",{className:"Toastify__spinner"})}var gd={info:oC,warning:sC,success:aC,error:lC,spinner:cC},uC=t=>t in gd;function dC({theme:t,type:e,isLoading:n,icon:r}){let o=null,a={theme:t,type:e};return r===!1||(Xn(r)?o=r({...a,isLoading:n}):N.isValidElement(r)?o=N.cloneElement(r,a):n?o=gd.spinner():uC(e)&&(o=gd[e](a))),o}var hC=t=>{let{isRunning:e,preventExitTransition:n,toastRef:r,eventHandlers:o,playToast:a}=iC(t),{closeButton:l,children:u,autoClose:d,onClick:f,type:m,hideProgressBar:y,closeToast:b,transition:S,position:k,className:T,style:C,progressClassName:w,updateId:A,role:P,progress:E,rtl:R,toastId:B,deleteToast:I,isIn:M,isLoading:z,closeOnClick:K,theme:Q,ariaLabel:ie}=t,ce=Qi("Toastify__toast",`Toastify__toast-theme--${Q}`,`Toastify__toast--${m}`,{"Toastify__toast--rtl":R},{"Toastify__toast--close-on-click":K}),Te=Xn(T)?T({rtl:R,position:k,type:m,defaultClassName:ce}):Qi(ce,T),Ae=dC(t),Se=!!E||!d,be={closeToast:b,type:m,theme:Q},X=null;return l===!1||(Xn(l)?X=l(be):N.isValidElement(l)?X=N.cloneElement(l,be):X=zT(be)),Be.createElement(S,{isIn:M,done:I,position:k,preventExitTransition:n,nodeRef:r,playToast:a},Be.createElement("div",{id:B,tabIndex:0,onClick:f,"data-in":M,className:Te,...o,style:C,ref:r,...M&&{role:P,"aria-label":ie}},Ae!=null&&Be.createElement("div",{className:Qi("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!z})},Ae),cv(u,t,!e),X,!t.customProgressBar&&Be.createElement(VT,{...A&&!Se?{key:`p-${A}`}:{},rtl:R,theme:Q,delay:d,isRunning:e,isIn:M,closeToast:b,hide:y,type:m,className:w,controlledProgress:Se,progress:E||0})))},fC=(t,e=!1)=>({enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}),pC=BT(fC("bounce",!0)),mC={position:"top-right",transition:pC,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:t=>t.altKey&&t.code==="KeyT"};function gC(t){let e={...mC,...t},n=t.stacked,[r,o]=N.useState(!0),a=N.useRef(null),{getToastToRender:l,isToastActive:u,count:d}=nC(e),{className:f,style:m,rtl:y,containerId:b,hotKeys:S}=e;function k(C){let w=Qi("Toastify__toast-container",`Toastify__toast-container--${C}`,{"Toastify__toast-container--rtl":y});return Xn(f)?f({position:C,rtl:y,defaultClassName:w}):Qi(w,fd(f))}function T(){n&&(o(!0),Ie.play())}return rC(()=>{var C;if(n){let w=a.current.querySelectorAll('[data-in="true"]'),A=12,P=(C=e.position)==null?void 0:C.includes("top"),E=0,R=0;Array.from(w).reverse().forEach((B,I)=>{let M=B;M.classList.add("Toastify__toast--stacked"),I>0&&(M.dataset.collapsed=`${r}`),M.dataset.pos||(M.dataset.pos=P?"top":"bot");let z=E*(r?.2:1)+(r?0:A*I);M.style.setProperty("--y",`${P?z:z*-1}px`),M.style.setProperty("--g",`${A}`),M.style.setProperty("--s",`${1-(r?R:0)}`),E+=M.offsetHeight,R+=.025})}},[r,d,n]),N.useEffect(()=>{function C(w){var A;let P=a.current;S(w)&&((A=P.querySelector('[tabIndex="0"]'))==null||A.focus(),o(!1),Ie.pause()),w.key==="Escape"&&(document.activeElement===P||P!=null&&P.contains(document.activeElement))&&(o(!0),Ie.play())}return document.addEventListener("keydown",C),()=>{document.removeEventListener("keydown",C)}},[S]),Be.createElement("section",{ref:a,className:"Toastify",id:b,onMouseEnter:()=>{n&&(o(!1),Ie.pause())},onMouseLeave:T,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},l((C,w)=>{let A=w.length?{...m}:{...m,pointerEvents:"none"};return Be.createElement("div",{tabIndex:-1,className:k(C),"data-stacked":n,style:A,key:`c-${C}`},w.map(({content:P,props:E})=>Be.createElement(hC,{...E,stacked:n,collapseAll:T,isIn:u(E.toastId,E.containerId),key:`t-${E.key}`},P)))}))}const vC="/assets/loginsignup-35wzhWKU.svg",yC="/assets/logo-BGMZNETY.png";function bC(){const[t,e]=N.useState(!1),[n,r]=N.useState(""),[o,a]=N.useState(""),[l,u]=N.useState(""),d=nh(),{login:f}=tl();console.log("in login signup",f),N.useEffect(()=>{const S=document.createElement("script");return S.src="https://accounts.google.com/gsi/client",S.async=!0,S.defer=!0,document.body.appendChild(S),()=>{document.body.removeChild(S)}},[]),N.useEffect(()=>{window.handleGoogleSignIn=async S=>{try{const k=await we.post("http://localhost:8080/api/user/google-signin",{credential:S.credential});console.log(k.data.user,k.data.token),f(k.data.user,k.data.token),Ie.success("Successfully signed in with Google",{onClose:()=>d("/Home"),autoClose:3e3})}catch(k){Ie.error(k.response?.data?.message||"Google sign-in failed")}}},[d]);function m(){e(!t)}function y(S){if(S.preventDefault(),!n){Ie.error("Please enter your username");return}if(!o){Ie.error("Please enter your email");return}if(!l){Ie.error("Please enter your password");return}we.post("http://localhost:8080/api/user/register",{username:n,email:o,password:l}).then(k=>{f(k.data.user,k.data.token),Ie.success(k.data.message,{onClose:()=>d("/Home"),autoClose:3e3})}).catch(k=>{Ie.error(k.response?.data?.message||"Signup failed")})}function b(S){if(S.preventDefault(),!o){Ie.error("Please enter your email");return}if(!l){Ie.error("Please enter your password");return}we.post("http://localhost:8080/api/user/login",{email:o,password:l}).then(k=>{f(k.data.user,k.data.token),Ie.success(k.data.message,{onClose:()=>d("/Home"),autoClose:3e3})}).catch(k=>{Ie.error(k.response?.data?.message||"Login failed")})}return p.jsxs("div",{className:"w-full h-screen flex flex-row",children:[p.jsxs("div",{className:"w-1/2 h-screen flex flex-col p-4",children:[p.jsx("div",{className:"w-full flex justify-start items-start pt-4 pb-6",children:p.jsx("img",{src:yC,alt:"logo",className:"w-32 h-auto"})}),t?p.jsxs("div",{className:"w-full flex flex-col items-center justify-start gap-4 px-24",children:[p.jsx("h1",{className:"w-full text-black text-3xl font-bold mb-6",children:"Welcome Back"}),p.jsxs("form",{onSubmit:b,className:"w-full flex flex-col items-center justify-center gap-4",children:[p.jsx("label",{className:"text-black w-full",children:"Email"}),p.jsx("input",{type:"email",placeholder:"Email",value:o,onChange:S=>a(S.target.value),className:"w-full p-2 rounded-md border-2 border-gray-300"}),p.jsx("label",{className:"text-black w-full",children:"Password"}),p.jsx("input",{type:"password",placeholder:"Password",value:l,onChange:S=>u(S.target.value),className:"w-full p-2 rounded-md border-2 border-gray-200"}),p.jsx("button",{type:"submit",className:"bg-purple-500 text-white p-3 rounded-md w-full hover:bg-purple-600 transition-all duration-300 cursor-pointer flex items-center justify-center",style:{height:"40px"},children:"Login"})]}),p.jsx("div",{id:"g_id_onload","data-client_id":"738593158652-gfrr5c4rkjnitlv60rtsiv8d7o1agp8c.apps.googleusercontent.com","data-callback":"handleGoogleSignIn","data-auto_prompt":"false",className:"w-full"}),p.jsx("div",{className:"g_id_signin w-full rounded-md","data-type":"standard","data-size":"large","data-theme":"outline","data-text":"continue_with","data-shape":"rectangular","data-logo_alignment":"left","data-width":"100%"}),p.jsx("button",{onClick:m,className:"underline hover:text-blue-500",children:"Don't have an account?"})]}):p.jsxs("div",{className:"w-full flex flex-col items-center justify-start gap-4 px-24",children:[p.jsx("h1",{className:"w-full text-black text-3xl font-bold mb-6",children:"Create an account"}),p.jsxs("form",{onSubmit:y,className:"w-full flex flex-col items-center justify-center gap-4",children:[p.jsx("label",{className:"text-black w-full",children:"Username"}),p.jsx("input",{type:"text",placeholder:"Username",value:n,onChange:S=>r(S.target.value),className:"w-full p-2 rounded-md border-2 border-gray-300"}),p.jsx("label",{className:"w-full",children:"Email"}),p.jsx("input",{type:"email",placeholder:"Email",value:o,onChange:S=>a(S.target.value),className:"w-full p-2 rounded-md border-2 border-gray-200"}),p.jsx("label",{className:"w-full",children:"Password"}),p.jsx("input",{type:"password",placeholder:"Password",value:l,onChange:S=>u(S.target.value),className:"w-full p-2 rounded-md border-2 border-gray-200"}),p.jsx("button",{type:"submit",className:"bg-purple-500 text-white p-3 rounded-md w-full hover:bg-purple-600 transition-all duration-300 cursor-pointer flex items-center justify-center",style:{height:"40px"},children:"Signup"})]}),p.jsx("div",{id:"g_id_onload","data-client_id":"738593158652-gfrr5c4rkjnitlv60rtsiv8d7o1agp8c.apps.googleusercontent.com","data-callback":"handleGoogleSignIn","data-auto_prompt":"false",className:"w-full"}),p.jsx("div",{className:"g_id_signin w-full rounded-md","data-type":"standard","data-size":"large","data-theme":"outline","data-text":"continue_with","data-shape":"rectangular","data-logo_alignment":"left","data-width":"100%"}),p.jsx("button",{onClick:m,className:"underline hover:text-blue-500",children:"Already have an account?"})]})]}),p.jsx("div",{className:"w-1/2 h-screen flex items-center justify-center bg-purple-500",children:p.jsx("img",{src:vC,alt:"loginsignup",className:"h-3/4 w-full"})}),p.jsx(gC,{})]})}function xC(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41m-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9"},child:[]},{tag:"path",attr:{fillRule:"evenodd",d:"M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5 5 0 0 0 8 3M3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9z"},child:[]}]})(t)}function $n(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M1 8a.5.5 0 0 1 .5-.5h11.793l-3.147-3.146a.5.5 0 0 1 .708-.708l4 4a.5.5 0 0 1 0 .708l-4 4a.5.5 0 0 1-.708-.708L13.293 8.5H1.5A.5.5 0 0 1 1 8"},child:[]}]})(t)}function Ur(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"},child:[]},{tag:"path",attr:{d:"m10.97 4.97-.02.022-3.473 4.425-2.093-2.094a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-1.071-1.05"},child:[]}]})(t)}function kC(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"},child:[]}]})(t)}function SC(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M5 4a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm-.5 2.5A.5.5 0 0 1 5 6h6a.5.5 0 0 1 0 1H5a.5.5 0 0 1-.5-.5M5 8a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h3a.5.5 0 0 0 0-1z"},child:[]},{tag:"path",attr:{d:"M2 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2zm10-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1"},child:[]}]})(t)}function TC(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M0 0h1v15h15v1H0zm14.817 3.113a.5.5 0 0 1 .07.704l-4.5 5.5a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61 4.15-5.073a.5.5 0 0 1 .704-.07"},child:[]}]})(t)}function CC(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M5 3a3 3 0 0 1 6 0v5a3 3 0 0 1-6 0z"},child:[]},{tag:"path",attr:{d:"M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5"},child:[]}]})(t)}function rg(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M3.5 6.5A.5.5 0 0 1 4 7v1a4 4 0 0 0 8 0V7a.5.5 0 0 1 1 0v1a5 5 0 0 1-4.5 4.975V15h3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1h3v-2.025A5 5 0 0 1 3 8V7a.5.5 0 0 1 .5-.5"},child:[]},{tag:"path",attr:{d:"M10 8a2 2 0 1 1-4 0V3a2 2 0 1 1 4 0zM8 0a3 3 0 0 0-3 3v5a3 3 0 0 0 6 0V3a3 3 0 0 0-3-3"},child:[]}]})(t)}function wC(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"},child:[]}]})(t)}function sg(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"},child:[]}]})(t)}function La(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M6 12.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5M3 8.062C3 6.76 4.235 5.765 5.53 5.886a26.6 26.6 0 0 0 4.94 0C11.765 5.765 13 6.76 13 8.062v1.157a.93.93 0 0 1-.765.935c-.845.147-2.34.346-4.235.346s-3.39-.2-4.235-.346A.93.93 0 0 1 3 9.219zm4.542-.827a.25.25 0 0 0-.217.068l-.92.9a25 25 0 0 1-1.871-.183.25.25 0 0 0-.068.495c.55.076 1.232.149 2.02.193a.25.25 0 0 0 .189-.071l.754-.736.847 1.71a.25.25 0 0 0 .404.062l.932-.97a25 25 0 0 0 1.922-.188.25.25 0 0 0-.068-.495c-.538.074-1.207.145-1.98.189a.25.25 0 0 0-.166.076l-.754.785-.842-1.7a.25.25 0 0 0-.182-.135"},child:[]},{tag:"path",attr:{d:"M8.5 1.866a1 1 0 1 0-1 0V3h-2A4.5 4.5 0 0 0 1 7.5V8a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1v1a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-1a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1v-.5A4.5 4.5 0 0 0 10.5 3h-2zM14 7.5V13a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V7.5A3.5 3.5 0 0 1 5.5 4h5A3.5 3.5 0 0 1 14 7.5"},child:[]}]})(t)}function mv(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"},child:[]}]})(t)}function EC(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M1.885.511a1.745 1.745 0 0 1 2.61.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.68.68 0 0 0 .178.643l2.457 2.457a.68.68 0 0 0 .644.178l2.189-.547a1.75 1.75 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.6 18.6 0 0 1-7.01-4.42 18.6 18.6 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877z"},child:[]}]})(t)}function og(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M3.654 1.328a.678.678 0 0 0-1.015-.063L1.605 2.3c-.483.484-.661 1.169-.45 1.77a17.6 17.6 0 0 0 4.168 6.608 17.6 17.6 0 0 0 6.608 4.168c.601.211 1.286.033 1.77-.45l1.034-1.034a.678.678 0 0 0-.063-1.015l-2.307-1.794a.68.68 0 0 0-.58-.122l-2.19.547a1.75 1.75 0 0 1-1.657-.459L5.482 8.062a1.75 1.75 0 0 1-.46-1.657l.548-2.19a.68.68 0 0 0-.122-.58zM1.884.511a1.745 1.745 0 0 1 2.612.163L6.29 2.98c.329.423.445.974.315 1.494l-.547 2.19a.68.68 0 0 0 .178.643l2.457 2.457a.68.68 0 0 0 .644.178l2.189-.547a1.75 1.75 0 0 1 1.494.315l2.306 1.794c.829.645.905 1.87.163 2.611l-1.034 1.034c-.74.74-1.846 1.065-2.877.702a18.6 18.6 0 0 1-7.01-4.42 18.6 18.6 0 0 1-4.42-7.009c-.362-1.03-.037-2.137.703-2.877z"},child:[]}]})(t)}function gv(t){return Le({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"},child:[]},{tag:"path",attr:{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"},child:[]}]})(t)}let _C={data:""},RC=t=>typeof window=="object"?((t?t.querySelector("#_goober"):window._goober)||Object.assign((t||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:t||_C,PC=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,NC=/\/\*[^]*?\*\/|  +/g,ag=/\n+/g,Ci=(t,e)=>{let n="",r="",o="";for(let a in t){let l=t[a];a[0]=="@"?a[1]=="i"?n=a+" "+l+";":r+=a[1]=="f"?Ci(l,a):a+"{"+Ci(l,a[1]=="k"?"":e)+"}":typeof l=="object"?r+=Ci(l,e?e.replace(/([^,])+/g,u=>a.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,d=>/&/.test(d)?d.replace(/&/g,u):u?u+" "+d:d)):a):l!=null&&(a=/^--/.test(a)?a:a.replace(/[A-Z]/g,"-$&").toLowerCase(),o+=Ci.p?Ci.p(a,l):a+":"+l+";")}return n+(e&&o?e+"{"+o+"}":o)+r},Vn={},vv=t=>{if(typeof t=="object"){let e="";for(let n in t)e+=n+vv(t[n]);return e}return t},IC=(t,e,n,r,o)=>{let a=vv(t),l=Vn[a]||(Vn[a]=(d=>{let f=0,m=11;for(;f<d.length;)m=101*m+d.charCodeAt(f++)>>>0;return"go"+m})(a));if(!Vn[l]){let d=a!==t?t:(f=>{let m,y,b=[{}];for(;m=PC.exec(f.replace(NC,""));)m[4]?b.shift():m[3]?(y=m[3].replace(ag," ").trim(),b.unshift(b[0][y]=b[0][y]||{})):b[0][m[1]]=m[2].replace(ag," ").trim();return b[0]})(t);Vn[l]=Ci(o?{["@keyframes "+l]:d}:d,n?"":"."+l)}let u=n&&Vn.g?Vn.g:null;return n&&(Vn.g=Vn[l]),((d,f,m,y)=>{y?f.data=f.data.replace(y,d):f.data.indexOf(d)===-1&&(f.data=m?d+f.data:f.data+d)})(Vn[l],e,r,u),l},jC=(t,e,n)=>t.reduce((r,o,a)=>{let l=e[a];if(l&&l.call){let u=l(n),d=u&&u.props&&u.props.className||/^go/.test(u)&&u;l=d?"."+d:u&&typeof u=="object"?u.props?"":Ci(u,""):u===!1?"":u}return r+o+(l??"")},"");function El(t){let e=this||{},n=t.call?t(e.p):t;return IC(n.unshift?n.raw?jC(n,[].slice.call(arguments,1),e.p):n.reduce((r,o)=>Object.assign(r,o&&o.call?o(e.p):o),{}):n,RC(e.target),e.g,e.o,e.k)}let yv,vd,yd;El.bind({g:1});let Zn=El.bind({k:1});function OC(t,e,n,r){Ci.p=e,yv=t,vd=n,yd=r}function Ni(t,e){let n=this||{};return function(){let r=arguments;function o(a,l){let u=Object.assign({},a),d=u.className||o.className;n.p=Object.assign({theme:vd&&vd()},u),n.o=/ *go\d+/.test(d),u.className=El.apply(n,r)+(d?" "+d:"");let f=t;return t[0]&&(f=u.as||t,delete u.as),yd&&f[0]&&yd(u),yv(f,u)}return o}}var AC=t=>typeof t=="function",rl=(t,e)=>AC(t)?t(e):t,DC=(()=>{let t=0;return()=>(++t).toString()})(),bv=(()=>{let t;return()=>{if(t===void 0&&typeof window<"u"){let e=matchMedia("(prefers-reduced-motion: reduce)");t=!e||e.matches}return t}})(),LC=20,xv=(t,e)=>{switch(e.type){case 0:return{...t,toasts:[e.toast,...t.toasts].slice(0,LC)};case 1:return{...t,toasts:t.toasts.map(a=>a.id===e.toast.id?{...a,...e.toast}:a)};case 2:let{toast:n}=e;return xv(t,{type:t.toasts.find(a=>a.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=e;return{...t,toasts:t.toasts.map(a=>a.id===r||r===void 0?{...a,dismissed:!0,visible:!1}:a)};case 4:return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(a=>a.id!==e.toastId)};case 5:return{...t,pausedAt:e.time};case 6:let o=e.time-(t.pausedAt||0);return{...t,pausedAt:void 0,toasts:t.toasts.map(a=>({...a,pauseDuration:a.pauseDuration+o}))}}},Ma=[],Ki={toasts:[],pausedAt:void 0},rr=t=>{Ki=xv(Ki,t),Ma.forEach(e=>{e(Ki)})},MC={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},UC=(t={})=>{let[e,n]=N.useState(Ki),r=N.useRef(Ki);N.useEffect(()=>(r.current!==Ki&&n(Ki),Ma.push(n),()=>{let a=Ma.indexOf(n);a>-1&&Ma.splice(a,1)}),[]);let o=e.toasts.map(a=>{var l,u,d;return{...t,...t[a.type],...a,removeDelay:a.removeDelay||((l=t[a.type])==null?void 0:l.removeDelay)||t?.removeDelay,duration:a.duration||((u=t[a.type])==null?void 0:u.duration)||t?.duration||MC[a.type],style:{...t.style,...(d=t[a.type])==null?void 0:d.style,...a.style}}});return{...e,toasts:o}},FC=(t,e="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:e,ariaProps:{role:"status","aria-live":"polite"},message:t,pauseDuration:0,...n,id:n?.id||DC()}),mo=t=>(e,n)=>{let r=FC(e,t,n);return rr({type:2,toast:r}),r.id},me=(t,e)=>mo("blank")(t,e);me.error=mo("error");me.success=mo("success");me.loading=mo("loading");me.custom=mo("custom");me.dismiss=t=>{rr({type:3,toastId:t})};me.remove=t=>rr({type:4,toastId:t});me.promise=(t,e,n)=>{let r=me.loading(e.loading,{...n,...n?.loading});return typeof t=="function"&&(t=t()),t.then(o=>{let a=e.success?rl(e.success,o):void 0;return a?me.success(a,{id:r,...n,...n?.success}):me.dismiss(r),o}).catch(o=>{let a=e.error?rl(e.error,o):void 0;a?me.error(a,{id:r,...n,...n?.error}):me.dismiss(r)}),t};var BC=(t,e)=>{rr({type:1,toast:{id:t,height:e}})},zC=()=>{rr({type:5,time:Date.now()})},Ys=new Map,VC=1e3,qC=(t,e=VC)=>{if(Ys.has(t))return;let n=setTimeout(()=>{Ys.delete(t),rr({type:4,toastId:t})},e);Ys.set(t,n)},HC=t=>{let{toasts:e,pausedAt:n}=UC(t);N.useEffect(()=>{if(n)return;let a=Date.now(),l=e.map(u=>{if(u.duration===1/0)return;let d=(u.duration||0)+u.pauseDuration-(a-u.createdAt);if(d<0){u.visible&&me.dismiss(u.id);return}return setTimeout(()=>me.dismiss(u.id),d)});return()=>{l.forEach(u=>u&&clearTimeout(u))}},[e,n]);let r=N.useCallback(()=>{n&&rr({type:6,time:Date.now()})},[n]),o=N.useCallback((a,l)=>{let{reverseOrder:u=!1,gutter:d=8,defaultPosition:f}=l||{},m=e.filter(S=>(S.position||f)===(a.position||f)&&S.height),y=m.findIndex(S=>S.id===a.id),b=m.filter((S,k)=>k<y&&S.visible).length;return m.filter(S=>S.visible).slice(...u?[b+1]:[0,b]).reduce((S,k)=>S+(k.height||0)+d,0)},[e]);return N.useEffect(()=>{e.forEach(a=>{if(a.dismissed)qC(a.id,a.removeDelay);else{let l=Ys.get(a.id);l&&(clearTimeout(l),Ys.delete(a.id))}})},[e]),{toasts:e,handlers:{updateHeight:BC,startPause:zC,endPause:r,calculateOffset:o}}},$C=Zn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,WC=Zn`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,GC=Zn`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,KC=Ni("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${$C} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${WC} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${t=>t.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${GC} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,JC=Zn`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,QC=Ni("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${t=>t.secondary||"#e0e0e0"};
  border-right-color: ${t=>t.primary||"#616161"};
  animation: ${JC} 1s linear infinite;
`,YC=Zn`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,XC=Zn`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,ZC=Ni("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${t=>t.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${YC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${XC} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${t=>t.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,ew=Ni("div")`
  position: absolute;
`,tw=Ni("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,nw=Zn`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,iw=Ni("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${nw} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,rw=({toast:t})=>{let{icon:e,type:n,iconTheme:r}=t;return e!==void 0?typeof e=="string"?N.createElement(iw,null,e):e:n==="blank"?null:N.createElement(tw,null,N.createElement(QC,{...r}),n!=="loading"&&N.createElement(ew,null,n==="error"?N.createElement(KC,{...r}):N.createElement(ZC,{...r})))},sw=t=>`
0% {transform: translate3d(0,${t*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,ow=t=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${t*-150}%,-1px) scale(.6); opacity:0;}
`,aw="0%{opacity:0;} 100%{opacity:1;}",lw="0%{opacity:1;} 100%{opacity:0;}",cw=Ni("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,uw=Ni("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,dw=(t,e)=>{let n=t.includes("top")?1:-1,[r,o]=bv()?[aw,lw]:[sw(n),ow(n)];return{animation:e?`${Zn(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Zn(o)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},hw=N.memo(({toast:t,position:e,style:n,children:r})=>{let o=t.height?dw(t.position||e||"top-center",t.visible):{opacity:0},a=N.createElement(rw,{toast:t}),l=N.createElement(uw,{...t.ariaProps},rl(t.message,t));return N.createElement(cw,{className:t.className,style:{...o,...n,...t.style}},typeof r=="function"?r({icon:a,message:l}):N.createElement(N.Fragment,null,a,l))});OC(N.createElement);var fw=({id:t,className:e,style:n,onHeightUpdate:r,children:o})=>{let a=N.useCallback(l=>{if(l){let u=()=>{let d=l.getBoundingClientRect().height;r(t,d)};u(),new MutationObserver(u).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[t,r]);return N.createElement("div",{ref:a,className:e,style:n},o)},pw=(t,e)=>{let n=t.includes("top"),r=n?{top:0}:{bottom:0},o=t.includes("center")?{justifyContent:"center"}:t.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:bv()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${e*(n?1:-1)}px)`,...r,...o}},mw=El`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ra=16,gw=({reverseOrder:t,position:e="top-center",toastOptions:n,gutter:r,children:o,containerStyle:a,containerClassName:l})=>{let{toasts:u,handlers:d}=HC(n);return N.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Ra,left:Ra,right:Ra,bottom:Ra,pointerEvents:"none",...a},className:l,onMouseEnter:d.startPause,onMouseLeave:d.endPause},u.map(f=>{let m=f.position||e,y=d.calculateOffset(f,{reverseOrder:t,gutter:r,defaultPosition:e}),b=pw(m,y);return N.createElement(fw,{id:f.id,key:f.id,onHeightUpdate:d.updateHeight,className:f.visible?mw:"",style:b},f.type==="custom"?rl(f.message,f):o?o(f):N.createElement(hw,{toast:f,position:m}))}))};const vw=({isOpen:t,onClose:e,onSelectSession:n,onNewChat:r})=>{const[o,a]=N.useState([]),[l,u]=N.useState(!0),[d,f]=N.useState(null),[m,y]=N.useState("");N.useEffect(()=>{t&&b()},[t]);const b=async()=>{try{u(!0);const P=localStorage.getItem("token"),E=await we.get("http://localhost:8080/api/chat-history/sessions",{headers:{Authorization:`Bearer ${P}`}});a(E.data.sessions)}catch(P){console.error("Error fetching chat sessions:",P),me.error("Failed to load chat history")}finally{u(!1)}},S=async(P,E)=>{if(E.stopPropagation(),!!confirm("Are you sure you want to delete this chat session?"))try{const R=localStorage.getItem("token");await we.delete(`http://localhost:8080/api/chat-history/sessions/${P}`,{headers:{Authorization:`Bearer ${R}`}}),me.success("Chat session deleted"),b()}catch(R){console.error("Error deleting session:",R),me.error("Failed to delete chat session")}},k=async(P,E)=>{if(E.stopPropagation(),!m.trim()){me.error("Title cannot be empty");return}try{const R=localStorage.getItem("token");await we.patch(`http://localhost:8080/api/chat-history/sessions/${P}/title`,{title:m.trim()},{headers:{Authorization:`Bearer ${R}`}}),me.success("Title updated"),f(null),y(""),b()}catch(R){console.error("Error updating title:",R),me.error("Failed to update title")}},T=(P,E)=>{E.stopPropagation(),f(P.sessionId),y(P.title)},C=P=>{const E=new Date(P),B=(new Date-E)/(1e3*60*60);return B<24?E.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):B<168?E.toLocaleDateString([],{weekday:"short"}):E.toLocaleDateString([],{month:"short",day:"numeric"})},w=P=>{n(P.sessionId),e()},A=()=>{r(),e()};return t?p.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:p.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4 max-h-[80vh] flex flex-col",children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Chat History"}),p.jsx("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",children:p.jsx(D0,{className:"text-xl"})})]}),p.jsx("div",{className:"p-4 border-b border-gray-200",children:p.jsxs("button",{onClick:A,className:"w-full bg-purple-600 text-white py-2 px-4 rounded-lg hover:bg-purple-700 transition-colors flex items-center justify-center gap-2",children:[p.jsx(Y1,{className:"text-lg"}),"New Chat"]})}),p.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:l?p.jsx("div",{className:"flex items-center justify-center py-8",children:p.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"})}):o.length===0?p.jsxs("div",{className:"text-center py-8 text-gray-500",children:[p.jsx(La,{className:"text-4xl mx-auto mb-4 text-gray-300"}),p.jsx("p",{children:"No chat history yet"}),p.jsx("p",{className:"text-sm",children:"Start a new conversation to see it here"})]}):p.jsx("div",{className:"space-y-2",children:o.map(P=>p.jsx("div",{onClick:()=>w(P),className:"group relative p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer transition-colors",children:p.jsxs("div",{className:"flex items-start justify-between",children:[p.jsxs("div",{className:"flex-1 min-w-0",children:[d===P.sessionId?p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("input",{type:"text",value:m,onChange:E=>y(E.target.value),onKeyPress:E=>{E.key==="Enter"&&k(P.sessionId,E)},className:"flex-1 px-2 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-purple-500",autoFocus:!0}),p.jsx("button",{onClick:E=>k(P.sessionId,E),className:"text-green-600 hover:text-green-700",children:""}),p.jsx("button",{onClick:E=>{E.stopPropagation(),f(null),y("")},className:"text-red-600 hover:text-red-700",children:""})]}):p.jsx("h3",{className:"font-medium text-gray-900 truncate",children:P.title}),p.jsx("p",{className:"text-sm text-gray-500 truncate mt-1",children:P.preview}),p.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-400",children:[p.jsx("span",{children:C(P.lastActivity)}),p.jsxs("span",{children:[P.messageCount," messages"]})]})]}),p.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[p.jsx("button",{onClick:E=>T(P,E),className:"p-1 text-gray-400 hover:text-gray-600 transition-colors",title:"Edit title",children:p.jsx(X1,{className:"text-sm"})}),p.jsx("button",{onClick:E=>S(P.sessionId,E),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Delete session",children:p.jsx(tS,{className:"text-sm"})})]})]})},P.sessionId))})})]})}):null};function yw(){const[t,e]=N.useState([{id:Date.now(),content:"Hello! I'm CareerBot, your AI career counselor. I'm here to help you with resume advice, interview tips, career path exploration, and more. How can I assist you today?",role:"assistant",timestamp:new Date().toISOString()}]),[n,r]=N.useState(""),[o,a]=N.useState(!1),[l,u]=N.useState(null),[d,f]=N.useState(!1),[m,y]=N.useState("New Chat"),[b,S]=N.useState(null),[k,T]=N.useState(!1),C=N.useRef(null),w=N.useRef(null),A=()=>{C.current?.scrollIntoView({behavior:"smooth"})};N.useEffect(()=>{A()},[t]);const P=async ie=>{try{a(!0);const ce=localStorage.getItem("token"),Ae=(await we.get(`http://localhost:8080/api/chat-history/sessions/${ie}`,{headers:{Authorization:`Bearer ${ce}`}})).data.session;u(ie),y(Ae.title);const Se=Ae.messages.map((be,X)=>({id:Date.now()+X,content:be.content,role:be.role,timestamp:be.timestamp}));e(Se)}catch(ce){console.error("Error loading chat session:",ce),me.error("Failed to load chat session")}finally{a(!1)}},E=()=>{e([{id:Date.now(),content:"Hello! I'm CareerBot, your AI career counselor. I'm here to help you with resume advice, interview tips, career path exploration, and more. How can I assist you today?",role:"assistant",timestamp:new Date().toISOString()}]),u(null),y("New Chat"),S(null)},R=async ie=>{const ce=ie.target.files[0];if(!ce)return;if(ce.size>10*1024*1024){me.error("File size must be less than 10MB");return}if(!["application/pdf","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/msword","text/plain","text/csv"].includes(ce.type)){me.error("Only PDF, DOC, DOCX, TXT, and CSV files are allowed");return}try{T(!0);const Ae=localStorage.getItem("token"),Se=new FormData;Se.append("file",ce);const X=(await we.post("http://localhost:8080/api/files/upload",Se,{headers:{Authorization:`Bearer ${Ae}`,"Content-Type":"multipart/form-data"}})).data;S({...X.file,extractedText:X.extractedText,textLength:X.textLength}),me.success(`File "${ce.name}" uploaded successfully!`);const pe={id:Date.now(),content:` File uploaded: ${ce.name}${X.extractedText?` (${X.textLength} characters extracted)`:""}`,role:"system",timestamp:new Date().toISOString(),isFileUpload:!0};e(oe=>[...oe,pe])}catch(Ae){console.error("File upload error:",Ae),me.error("Failed to upload file. Please try again.")}finally{T(!1),w.current&&(w.current.value="")}},B=()=>{S(null)},I=async()=>{if(!n.trim())return;const ie={id:Date.now(),content:n,role:"user",timestamp:new Date().toISOString()};e(Te=>[...Te,ie]);const ce=n;r(""),a(!0);try{const Te=localStorage.getItem("token"),Ae={message:ce,sessionId:l,context:{history:t.slice(-10).map(X=>({role:X.role,content:X.content}))}};b&&b.extractedText&&(Ae.fileData={originalName:b.originalName,extractedText:b.extractedText,textLength:b.textLength});const Se=await we.post("http://localhost:8080/api/ai/chat",Ae,{headers:{Authorization:`Bearer ${Te}`,"Content-Type":"application/json"}}),be={id:Date.now()+1,content:Se.data.response,role:"assistant",timestamp:new Date().toISOString()};if(e(X=>[...X,be]),Se.data.sessionId&&!l){u(Se.data.sessionId);const X=ce.length>30?ce.substring(0,30)+"...":ce;y(X)}S(null)}catch(Te){console.error("Chat error:",Te),me.error("Failed to send message. Please try again.");const Ae={id:Date.now()+1,content:"I apologize, but I'm having trouble processing your request right now. Please try again in a moment.",role:"assistant",timestamp:new Date().toISOString(),isError:!0};e(Se=>[...Se,Ae])}finally{a(!1)}},M=ie=>{ie.key==="Enter"&&!ie.shiftKey&&(ie.preventDefault(),I())},z=ie=>new Date(ie).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),K=ie=>{const ce=ie.role==="user";return ie.role==="system"?p.jsx("div",{className:"flex justify-center mb-4",children:p.jsx("div",{className:"bg-blue-50 text-blue-700 px-4 py-2 rounded-lg text-sm",children:ie.content})},ie.id):p.jsx("div",{className:`flex ${ce?"justify-end":"justify-start"} mb-4`,children:p.jsxs("div",{className:`flex ${ce?"flex-row-reverse":"flex-row"} items-start gap-3 max-w-[80%]`,children:[p.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${ce?"bg-purple-500":"bg-gray-500"}`,children:ce?p.jsx(wC,{className:"text-white text-sm"}):p.jsx(La,{className:"text-white text-sm"})}),p.jsxs("div",{className:`flex flex-col ${ce?"items-end":"items-start"}`,children:[p.jsx("div",{className:`px-4 py-3 rounded-lg ${ce?"bg-purple-500 text-white":ie.isError?"bg-red-100 text-red-800 border border-red-200":"bg-gray-100 text-gray-800"}`,children:p.jsx("div",{className:"whitespace-pre-wrap",children:ie.content})}),p.jsx("span",{className:"text-xs text-gray-500 mt-1",children:z(ie.timestamp)})]})]})},ie.id)},Q=p.jsxs("div",{className:"flex-1 flex flex-col h-full",children:[p.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:m}),l&&p.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[t.length-1," messages"]})]}),p.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",children:[p.jsx(eS,{className:"text-lg"}),p.jsx("span",{className:"text-sm",children:"History"})]})]}),p.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[t.length===0?p.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-gray-500",children:[p.jsx(La,{className:"text-6xl mb-4 text-purple-500"}),p.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Career Counselor AI"}),p.jsx("p",{className:"text-center max-w-md",children:"Ask me anything about career planning, job search, skill development, or professional growth. I'm here to help guide your career journey!"}),p.jsxs("div",{className:"mt-6 space-y-2",children:[p.jsx("p",{className:"text-sm font-medium",children:"Try asking:"}),p.jsxs("div",{className:"space-y-1 text-sm",children:[p.jsx("p",{children:' "What skills should I develop for a software engineering career?"'}),p.jsx("p",{children:' "How can I transition from marketing to data science?"'}),p.jsx("p",{children:' "What are the best practices for resume writing?"'}),p.jsx("p",{children:' "How should I prepare for a technical interview?"'})]})]})]}):t.map(K),o&&p.jsx("div",{className:"flex justify-start mb-4",children:p.jsxs("div",{className:"flex items-start gap-3 max-w-[80%]",children:[p.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-gray-500 flex items-center justify-center",children:p.jsx(La,{className:"text-white text-sm"})}),p.jsx("div",{className:"px-4 py-3 rounded-lg bg-gray-100",children:p.jsxs("div",{className:"flex space-x-1",children:[p.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),p.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),p.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})}),p.jsx("div",{ref:C})]}),b&&p.jsx("div",{className:"px-4 py-3 bg-blue-50 border-t border-blue-200",children:p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(Mm,{className:"text-blue-600 text-xl"}),p.jsxs("div",{children:[p.jsx("p",{className:"text-sm font-medium text-blue-900",children:b.originalName}),p.jsxs("p",{className:"text-xs text-blue-600",children:[b.textLength," characters extracted"]})]})]}),p.jsx("button",{onClick:B,className:"text-blue-600 hover:text-blue-800 transition-colors",children:p.jsx(D0,{className:"text-lg"})})]})}),p.jsxs("div",{className:"p-4 border-t border-gray-200",children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx("button",{onClick:()=>w.current?.click(),disabled:k,className:"p-2 text-gray-500 hover:text-purple-500 transition-colors disabled:opacity-50",title:"Attach file",children:k?p.jsx("div",{className:"w-5 h-5 border-2 border-purple-500 border-t-transparent rounded-full animate-spin"}):p.jsx(Mm,{className:"text-xl"})}),p.jsx("div",{className:"flex-1 relative",children:p.jsx("textarea",{value:n,onChange:ie=>r(ie.target.value),onKeyPress:M,placeholder:b?"Ask about the uploaded file...":"Type your career question...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",rows:"1",style:{minHeight:"48px",maxHeight:"120px"}})}),p.jsx("button",{onClick:I,disabled:!n.trim()||o||k,className:"p-3 bg-purple-500 text-white rounded-lg hover:bg-purple-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Send message",children:p.jsx(Z1,{className:"text-lg"})})]}),p.jsx("input",{ref:w,type:"file",onChange:R,className:"hidden",accept:".pdf,.doc,.docx,.txt,.csv"})]})]});return p.jsxs(Gt,{children:[Q,p.jsx(vw,{isOpen:d,onClose:()=>f(!1),onSelectSession:P,onNewChat:E})]})}function bw(){const[t,e]=N.useState([]),[n,r]=N.useState(!0),o=async()=>{try{const a=await we.get("http://localhost:8080/api/career/developer-jobs");Array.isArray(a.data.data)?e(a.data.data):Array.isArray(a.data)?e(a.data):e([])}catch(a){console.error("Error fetching career info:",a),e([])}finally{r(!1)}};return N.useEffect(()=>{o()},[]),n?p.jsx(Gt,{children:p.jsx("div",{className:"flex items-center justify-center h-full",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto"}),p.jsx("p",{className:"mt-4 text-gray-600",children:"Loading latest jobs..."})]})})}):p.jsx(Gt,{children:p.jsxs("div",{className:"max-w-6xl mx-auto",children:[p.jsxs("div",{className:"mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Latest Jobs"}),p.jsx("p",{className:"text-gray-600",children:"Discover the latest job opportunities in your field"})]}),p.jsx("div",{className:"space-y-6",children:t&&t.length>0?t.map(a=>p.jsxs("div",{className:"flex flex-col md:flex-row bg-white shadow-lg rounded-lg p-5 mb-4",children:[a.employer_logo&&p.jsx("div",{className:"flex-shrink-0 flex items-center justify-center w-full md:w-48 h-32 bg-purple-500 rounded-lg mb-4 md:mb-0 md:mr-6",children:p.jsx("img",{src:a.employer_logo,alt:a.employer_name,className:"object-contain h-24"})}),p.jsxs("div",{className:"flex flex-col flex-1",children:[p.jsxs("div",{className:"flex items-center justify-between",children:[p.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:a.job_title}),p.jsx("span",{className:"text-gray-500 text-sm",children:a.job_employment_type})]}),p.jsxs("span",{className:"text-md text-gray-600 mt-1",children:[a.employer_name,a.job_city&&` | ${a.job_city}`,a.job_state&&`, ${a.job_state}`,a.job_country&&`, ${a.job_country}`]}),p.jsx("p",{className:"line-clamp-5 text-gray-700 my-3",children:a.job_description}),p.jsxs("div",{className:"flex flex-wrap items-center gap-4 mt-2",children:[p.jsx("a",{href:a.job_apply_link,target:"_blank",rel:"noopener noreferrer",className:"bg-purple-500 text-white px-4 py-2 rounded shadow hover:bg-purple-600 transition",children:"Apply Now"}),p.jsxs("span",{className:"text-sm text-gray-500",children:["Posted ",a.job_posted_at]}),a.job_is_remote&&p.jsx("span",{className:"bg-purple-100 text-purple-700 px-2 py-1 rounded text-xs",children:"Remote"})]})]})]},a.job_id)):p.jsx("div",{className:"text-gray-500",children:"No data available"})})]})})}function xw(){const[t,e]=N.useState([]),[n,r]=N.useState(!0),[o,a]=N.useState(null);return N.useEffect(()=>{async function l(){r(!0),a(null);try{const u=await fetch("http://localhost:8080/api/career/skills");if(!u.ok)throw new Error("Failed to fetch skills");const d=await u.json();e(d.data||[])}catch(u){a(u.message)}finally{r(!1)}}l()},[]),n?p.jsx(Gt,{children:p.jsx("div",{className:"flex items-center justify-center h-full",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto"}),p.jsx("p",{className:"mt-4 text-gray-600",children:"Loading skills information..."})]})})}):p.jsx(Gt,{children:p.jsxs("div",{className:"max-w-6xl mx-auto",children:[p.jsxs("div",{className:"mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Skills Information"}),p.jsx("p",{className:"text-gray-600",children:"Explore various skills and their requirements in the job market"})]}),o&&p.jsx("div",{className:"text-red-500",children:o}),!n&&!o&&t.length===0&&p.jsx("div",{children:"No skills found."}),p.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:t.map(l=>p.jsxs("div",{className:"bg-white shadow-md rounded-md p-4 flex flex-col justify-between",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:l.name}),p.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Type: ",p.jsx("span",{className:"font-medium",children:l.type?.name})]}),l.infoUrl&&p.jsx("a",{href:l.infoUrl,target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:underline text-sm mt-auto",children:"More info"})]},l.id||l.uuid))})]})})}function kw(){const[t,e]=N.useState(null),[n,r]=N.useState(!0),[o,a]=N.useState(!1),[l,u]=N.useState({currentEducation:"",currentSkills:"",interests:"",targetRole:"",experienceLevel:"entry",resumeContent:"",preferredIndustry:"",salaryExpectations:"",workStyle:"flexible",locationPreferences:"",timeline:""}),[d,f]=N.useState(null),[m,y]=N.useState(!1),[b,S]=N.useState(new Set);N.useEffect(()=>{k()},[]);const k=async()=>{try{const I=localStorage.getItem("token"),z=(await we.get("http://localhost:8080/api/roadmap",{headers:{Authorization:`Bearer ${I}`}})).data.roadmap,K=z.roadmap||z;console.log("Fetch roadmap data:",K),e(K),u({currentEducation:z.currentEducation||"",currentSkills:Array.isArray(z.currentSkills)?z.currentSkills.join(", "):z.currentSkills||"",interests:Array.isArray(z.interests)?z.interests.join(", "):z.interests||"",targetRole:z.targetRole||"",experienceLevel:z.experienceLevel||"entry",resumeContent:z.resumeContent||"",preferredIndustry:z.preferredIndustry||"",salaryExpectations:z.salaryExpectations||"",workStyle:z.workStyle||"flexible",locationPreferences:z.locationPreferences||"",timeline:z.timeline||""}),a(!1)}catch(I){I.response?.status===404?a(!0):me.error("Failed to load career roadmap")}finally{r(!1)}},T=async I=>{y(!0);try{const M=new FormData;M.append("file",I);const z=localStorage.getItem("token"),K=await we.post("http://localhost:8080/api/files/upload",M,{headers:{Authorization:`Bearer ${z}`,"Content-Type":"multipart/form-data"}});if(K.data.extractedText){const Q=K.data.extractedText,ie=await C(Q),ce=new Set;Object.keys(ie).forEach(Te=>{ie[Te]&&ce.add(Te)}),S(ce),u(Te=>({...Te,resumeContent:Q,...ie})),me.success("Resume uploaded and analyzed successfully! Fields have been auto-filled.")}else me.warning("Resume uploaded but text extraction failed. You can still proceed.")}catch(M){me.error("Failed to upload resume"),console.error("Resume upload error:",M)}finally{y(!1)}},C=async I=>{try{const M=localStorage.getItem("token");return(await we.post("http://localhost:8080/api/ai/analyze-resume-autofill",{resumeText:I},{headers:{Authorization:`Bearer ${M}`}})).data.autoFilledData||{}}catch(M){return console.error("Failed to analyze resume for auto-fill:",M),w(I)}},w=I=>{const M={},z=[/(?:Bachelor|Master|PhD|B\.?S\.?|M\.?S\.?|B\.?A\.?|M\.?A\.?)[\s\w]*?(?:in|of|,)\s*([\w\s]+)/gi,/(?:University|College|Institute)[\s\w]*?(?:of|at|,)\s*([\w\s]+)/gi];for(const Se of z){const be=I.match(Se);if(be){M.currentEducation=be[0].trim();break}}const K=[/(?:Skills|Technologies|Programming Languages|Tools):\s*([^.\n]+)/gi,/(?:JavaScript|Python|Java|React|Node\.js|SQL|AWS|Docker|Git|HTML|CSS|TypeScript|Angular|Vue|MongoDB|PostgreSQL|MySQL|Redis|Kubernetes|Docker|Jenkins|Jira|Agile|Scrum)/gi],Q=[];for(const Se of K){const be=I.match(Se);be&&Q.push(...be.map(X=>X.replace(/[:\s]+$/,"")))}Q.length>0&&(M.currentSkills=[...new Set(Q)].join(", "));const ie=[/(?:Software Engineer|Developer|Programmer|Data Scientist|Product Manager|Designer|Analyst|Architect|Lead|Senior|Junior|Full Stack|Frontend|Backend|DevOps|QA|Test)/gi],ce=[];for(const Se of ie){const be=I.match(Se);be&&ce.push(...be)}ce.length>0&&(M.targetRole=ce[0]);const Te=/(\d+)\s*(?:years?|yrs?)\s*(?:of\s*)?experience/gi,Ae=I.match(Te);if(Ae){const Se=parseInt(Ae[0].match(/\d+/)[0]);Se<2?M.experienceLevel="entry":Se<5?M.experienceLevel="mid":Se<10?M.experienceLevel="senior":M.experienceLevel="expert"}return M},A=async I=>{I.preventDefault(),r(!0);try{const M=localStorage.getItem("token"),K=(await we.post("http://localhost:8080/api/roadmap",l,{headers:{Authorization:`Bearer ${M}`}})).data.roadmap,Q=K.roadmap||K;console.log("Create roadmap data:",Q),e(Q),a(!1),me.success("Career roadmap created successfully!")}catch{me.error("Failed to create career roadmap")}finally{r(!1)}},P=async(I,M,z)=>{try{const K=localStorage.getItem("token");await we.patch("http://localhost:8080/api/roadmap/goal",{goalType:I,goalIndex:M,completed:z},{headers:{Authorization:`Bearer ${K}`}}),k(),me.success(`Goal ${z?"marked as complete":"marked as incomplete"}`)}catch{me.error("Failed to update goal status")}},E=async()=>{if(confirm("This will regenerate your entire roadmap. Are you sure?")){r(!0);try{const I=localStorage.getItem("token"),M={currentEducation:l.currentEducation,currentSkills:l.currentSkills,interests:l.interests,targetRole:l.targetRole,experienceLevel:l.experienceLevel,resumeContent:l.resumeContent,preferredIndustry:l.preferredIndustry,salaryExpectations:l.salaryExpectations,workStyle:l.workStyle,locationPreferences:l.locationPreferences,timeline:l.timeline},K=(await we.post("http://localhost:8080/api/roadmap/regenerate",M,{headers:{Authorization:`Bearer ${I}`}})).data.roadmap,Q=K.roadmap||K;console.log("Regenerate roadmap data:",Q),e(Q),me.success("Career roadmap regenerated successfully!")}catch(I){console.error("Regenerate error:",I),me.error("Failed to regenerate career roadmap")}finally{r(!1)}}},R=(I,M,z,K)=>p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[p.jsxs("div",{className:"flex items-center mb-4",children:[p.jsx("div",{className:"text-2xl text-purple-500 mr-3",children:K}),p.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:I})]}),p.jsx("div",{className:"space-y-3",children:M.map((Q,ie)=>p.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsxs("div",{className:"flex items-center",children:[p.jsx("button",{onClick:()=>P(z,ie,!Q.completed),className:"mr-3 text-xl",children:Q.completed?p.jsx(Ur,{className:"text-green-500"}):p.jsx(kC,{className:"text-gray-400"})}),p.jsx("span",{className:`${Q.completed?"line-through text-gray-500":"text-gray-700"} font-medium`,children:Q.goal})]}),Q.priority&&p.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${Q.priority==="high"?"bg-red-100 text-red-800":Q.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:Q.priority})]}),p.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[p.jsx("span",{children:Q.timeline}),Q.estimatedEffort&&p.jsxs("span",{children:["Effort: ",Q.estimatedEffort]})]})]},ie))})]}),B=(I,M,z)=>p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:I}),p.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:p.jsx("div",{className:`h-2 rounded-full ${z}`,style:{width:`${M}%`}})})]});return n?p.jsx(Gt,{children:p.jsx("div",{className:"flex items-center justify-center h-full",children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500 mx-auto"}),p.jsx("p",{className:"mt-4 text-gray-600",children:"Loading your career roadmap..."})]})})}):o?p.jsx(Gt,{children:p.jsxs("div",{className:"max-w-2xl mx-auto",children:[p.jsxs("div",{className:"text-center mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Create Your Career Roadmap"}),p.jsx("p",{className:"text-gray-600",children:"Let's build a personalized plan for your career development"})]}),p.jsxs("form",{onSubmit:A,className:"space-y-6",children:[p.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Resume Upload (Optional) - Auto-fill Available"}),p.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Upload your resume to automatically fill in education, skills, experience level, and target role fields."}),p.jsx("div",{className:"space-y-4",children:p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Your Resume"}),p.jsx("input",{type:"file",accept:".pdf,.doc,.docx",onChange:I=>{const M=I.target.files[0];M&&(f(M),T(M))},className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),m&&p.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Uploading and analyzing resume..."}),l.resumeContent&&p.jsx("p",{className:"text-sm text-green-600 mt-2",children:" Resume analyzed successfully"})]})})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Education Level"}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"text",value:l.currentEducation,onChange:I=>{u({...l,currentEducation:I.target.value}),b.has("currentEducation")&&S(M=>{const z=new Set(M);return z.delete("currentEducation"),z})},placeholder:"e.g., Bachelor's in Computer Science",className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${b.has("currentEducation")?"border-green-300 bg-green-50":"border-gray-300"}`,required:!0}),b.has("currentEducation")&&p.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:p.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Auto-filled"})})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Role"}),p.jsxs("div",{className:"relative",children:[p.jsx("input",{type:"text",value:l.targetRole,onChange:I=>{u({...l,targetRole:I.target.value}),b.has("targetRole")&&S(M=>{const z=new Set(M);return z.delete("targetRole"),z})},placeholder:"e.g., Software Engineer, Data Scientist",className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${b.has("targetRole")?"border-green-300 bg-green-50":"border-gray-300"}`}),b.has("targetRole")&&p.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:p.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Auto-filled"})})]})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Skills"}),p.jsxs("div",{className:"relative",children:[p.jsx("textarea",{value:l.currentSkills,onChange:I=>{u({...l,currentSkills:I.target.value}),b.has("currentSkills")&&S(M=>{const z=new Set(M);return z.delete("currentSkills"),z})},placeholder:"List your current skills separated by commas (e.g., JavaScript, Project Management, Communication)",className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${b.has("currentSkills")?"border-green-300 bg-green-50":"border-gray-300"}`,rows:"3",required:!0}),b.has("currentSkills")&&p.jsx("div",{className:"absolute right-3 top-3",children:p.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Auto-filled"})})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Career Interests & Goals"}),p.jsx("textarea",{value:l.interests,onChange:I=>u({...l,interests:I.target.value}),placeholder:"Describe your career interests, passions, and long-term goals separated by commas",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",rows:"3",required:!0})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Industry"}),p.jsx("input",{type:"text",value:l.preferredIndustry,onChange:I=>u({...l,preferredIndustry:I.target.value}),placeholder:"e.g., Technology, Healthcare, Finance",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Experience Level"}),p.jsxs("div",{className:"relative",children:[p.jsxs("select",{value:l.experienceLevel,onChange:I=>{u({...l,experienceLevel:I.target.value}),b.has("experienceLevel")&&S(M=>{const z=new Set(M);return z.delete("experienceLevel"),z})},className:`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 ${b.has("experienceLevel")?"border-green-300 bg-green-50":"border-gray-300"}`,children:[p.jsx("option",{value:"entry",children:"Entry Level"}),p.jsx("option",{value:"mid",children:"Mid Level"}),p.jsx("option",{value:"senior",children:"Senior Level"}),p.jsx("option",{value:"expert",children:"Expert Level"})]}),b.has("experienceLevel")&&p.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:p.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Auto-filled"})})]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Work Style Preference"}),p.jsxs("select",{value:l.workStyle,onChange:I=>u({...l,workStyle:I.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[p.jsx("option",{value:"flexible",children:"Flexible"}),p.jsx("option",{value:"remote",children:"Remote"}),p.jsx("option",{value:"hybrid",children:"Hybrid"}),p.jsx("option",{value:"onsite",children:"On-site"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salary Expectations"}),p.jsx("input",{type:"text",value:l.salaryExpectations,onChange:I=>u({...l,salaryExpectations:I.target.value}),placeholder:"e.g., $60,000 - $80,000, Competitive",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location Preferences"}),p.jsx("input",{type:"text",value:l.locationPreferences,onChange:I=>u({...l,locationPreferences:I.target.value}),placeholder:"e.g., New York, Remote, West Coast",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Timeline"}),p.jsx("input",{type:"text",value:l.timeline,onChange:I=>u({...l,timeline:I.target.value}),placeholder:"e.g., 6 months, 1 year, Flexible",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),p.jsx("button",{type:"submit",className:"w-full bg-purple-600 text-white py-3 px-6 rounded-lg hover:bg-purple-700 transition-colors",children:"Generate AI-Powered Career Roadmap"})]})]})}):t?p.jsx(Gt,{children:p.jsxs("div",{className:"max-w-6xl mx-auto",children:[p.jsxs("div",{className:"flex justify-between items-center mb-8",children:[p.jsxs("div",{children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Your Career Roadmap"}),p.jsx("p",{className:"text-gray-600",children:"Track your progress and achieve your career goals"})]}),p.jsxs("div",{className:"flex space-x-3",children:[p.jsxs("button",{onClick:()=>a(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center",children:[p.jsx(sg,{className:"mr-2"}),"Edit"]}),p.jsxs("button",{onClick:E,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center",children:[p.jsx(xC,{className:"mr-2"}),"Regenerate"]})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[B("Short-term Goals",t.shortTermGoals&&t.shortTermGoals.length>0?t.shortTermGoals.filter(I=>I.completed).length/t.shortTermGoals.length*100:0,"bg-green-500"),B("Medium-term Goals",t.mediumTermGoals&&t.mediumTermGoals.length>0?t.mediumTermGoals.filter(I=>I.completed).length/t.mediumTermGoals.length*100:0,"bg-blue-500"),B("Long-term Goals",t.longTermGoals&&t.longTermGoals.length>0?t.longTermGoals.filter(I=>I.completed).length/t.longTermGoals.length*100:0,"bg-purple-500")]}),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.shortTermGoals&&t.shortTermGoals.length>0&&R("Short-term Goals (3-6 months)",t.shortTermGoals,"shortTermGoals",p.jsx(id,{})),t.mediumTermGoals&&t.mediumTermGoals.length>0&&R("Medium-term Goals (6-12 months)",t.mediumTermGoals,"mediumTermGoals",p.jsx(rd,{})),t.longTermGoals&&t.longTermGoals.length>0&&R("Long-term Goals (1-3 years)",t.longTermGoals,"longTermGoals",p.jsx(Qs,{}))]}),(!t.shortTermGoals||t.shortTermGoals.length===0)&&(!t.mediumTermGoals||t.mediumTermGoals.length===0)&&(!t.longTermGoals||t.longTermGoals.length===0)&&p.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mt-6",children:p.jsxs("div",{className:"flex items-center",children:[p.jsx(id,{className:"text-2xl text-yellow-500 mr-3"}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-semibold text-yellow-800",children:"No Goals Generated Yet"}),p.jsx("p",{className:"text-yellow-700 mt-1",children:"Your AI-powered career roadmap is being generated. Please wait a moment or try regenerating the roadmap."})]})]})}),t.skillsToDevelop&&t.skillsToDevelop.length>0&&p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[p.jsxs("div",{className:"flex items-center mb-4",children:[p.jsx(Js,{className:"text-2xl text-purple-500 mr-3"}),p.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Skills to Develop"})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.skillsToDevelop.map((I,M)=>p.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("h4",{className:"font-semibold text-gray-800",children:I.skill}),p.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${I.priority==="high"?"bg-red-100 text-red-800":I.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:I.priority})]}),p.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:[I.currentLevel,"  ",I.targetLevel]}),I.resources&&I.resources.length>0&&p.jsxs("div",{className:"text-sm text-gray-500",children:[p.jsx("strong",{children:"Resources:"})," ",I.resources.join(", ")]})]},M))})]}),t.courses&&t.courses.length>0&&p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[p.jsxs("div",{className:"flex items-center mb-4",children:[p.jsx(rd,{className:"text-2xl text-purple-500 mr-3"}),p.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Recommended Courses"})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.courses.map((I,M)=>p.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[p.jsx("h4",{className:"font-semibold text-gray-800 mb-1",children:I.name}),p.jsx("p",{className:"text-sm text-gray-600 mb-2",children:I.provider}),I.duration&&p.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:["Duration: ",I.duration]}),I.cost&&p.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["Cost: ",I.cost]}),I.skillsCovered&&I.skillsCovered.length>0&&p.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["Skills: ",I.skillsCovered.join(", ")]}),I.url&&p.jsxs("a",{href:I.url,target:"_blank",rel:"noopener noreferrer",className:"text-purple-600 hover:text-purple-700 text-sm flex items-center",children:["View Course",p.jsx($n,{className:"ml-1"})]})]},M))})]}),t.networkingOpportunities&&t.networkingOpportunities.length>0&&p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[p.jsxs("div",{className:"flex items-center mb-4",children:[p.jsx(Qs,{className:"text-2xl text-purple-500 mr-3"}),p.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Networking Opportunities"})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.networkingOpportunities.map((I,M)=>p.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[p.jsx("h4",{className:"font-semibold text-gray-800 mb-1",children:I.opportunity}),p.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Type: ",I.type]}),I.frequency&&p.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:["Frequency: ",I.frequency]}),I.estimatedCost&&p.jsxs("p",{className:"text-sm text-gray-500",children:["Cost: ",I.estimatedCost]})]},M))})]}),t.industryInsights&&p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[p.jsxs("div",{className:"flex items-center mb-4",children:[p.jsx(Js,{className:"text-2xl text-purple-500 mr-3"}),p.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Industry Insights"})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[t.industryInsights.trends&&t.industryInsights.trends.length>0&&p.jsxs("div",{children:[p.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Trends"}),p.jsx("ul",{className:"space-y-1",children:t.industryInsights.trends.map((I,M)=>p.jsxs("li",{className:"text-sm text-gray-600",children:[" ",I]},M))})]}),t.industryInsights.growthAreas&&t.industryInsights.growthAreas.length>0&&p.jsxs("div",{children:[p.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Growth Areas"}),p.jsx("ul",{className:"space-y-1",children:t.industryInsights.growthAreas.map((I,M)=>p.jsxs("li",{className:"text-sm text-gray-600",children:[" ",I]},M))})]}),t.industryInsights.challenges&&t.industryInsights.challenges.length>0&&p.jsxs("div",{children:[p.jsx("h4",{className:"font-semibold text-gray-800 mb-2",children:"Challenges"}),p.jsx("ul",{className:"space-y-1",children:t.industryInsights.challenges.map((I,M)=>p.jsxs("li",{className:"text-sm text-gray-600",children:[" ",I]},M))})]})]})]}),t.targetJobTitles&&t.targetJobTitles.length>0&&p.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[p.jsxs("div",{className:"flex items-center mb-4",children:[p.jsx(Qs,{className:"text-2xl text-purple-500 mr-3"}),p.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Target Job Titles"})]}),p.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.targetJobTitles.map((I,M)=>p.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[p.jsxs("div",{className:"flex items-center justify-between mb-2",children:[p.jsx("h4",{className:"font-semibold text-gray-800",children:I.title}),p.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${I.priority==="high"?"bg-red-100 text-red-800":I.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:I.priority})]}),I.salaryRange&&p.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:["Salary: ",I.salaryRange]}),I.requiredSkills&&I.requiredSkills.length>0&&p.jsxs("p",{className:"text-sm text-gray-500 mb-1",children:["Skills: ",I.requiredSkills.join(", ")]}),I.companies&&I.companies.length>0&&p.jsxs("p",{className:"text-sm text-gray-500",children:["Companies: ",I.companies.join(", ")]})]},M))})]}),t.personalizedAdvice&&p.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 rounded-lg shadow-md p-6 mt-6",children:[p.jsxs("div",{className:"flex items-center mb-4",children:[p.jsx(Js,{className:"text-2xl text-purple-500 mr-3"}),p.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Personalized Advice"})]}),p.jsx("p",{className:"text-gray-700 leading-relaxed",children:t.personalizedAdvice})]})]})}):p.jsx(Gt,{children:p.jsxs("div",{className:"text-center",children:[p.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No Career Roadmap Found"}),p.jsx("p",{className:"text-gray-600 mb-6",children:"Create your first career roadmap to get started on your professional journey."}),p.jsxs("button",{onClick:()=>a(!0),className:"bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors",children:[p.jsx(sg,{className:"inline mr-2"}),"Create Roadmap"]})]})})}function Sw(){const[t,e]=N.useState(""),[n,r]=N.useState(""),[o,a]=N.useState(!1),[l,u]=N.useState(null),[d,f]=N.useState(!1),[m,y]=N.useState(null),[b,S]=N.useState(!1),k=async()=>{if(!t.trim()){me.error("Please enter your resume text");return}a(!0);try{const E=localStorage.getItem("token"),R=await we.post("http://localhost:8080/api/ai/analyze-resume",{resumeText:t.trim(),jobDescription:n.trim()||null},{headers:{Authorization:`Bearer ${E}`}});u(R.data),f(!0),me.success("Resume analysis completed!")}catch(E){console.error("Analysis error:",E),me.error("Failed to analyze resume")}finally{a(!1)}},T=async E=>{S(!0);try{const R=new FormData;R.append("file",E);const B=localStorage.getItem("token"),I=await we.post("http://localhost:8080/api/files/upload",R,{headers:{Authorization:`Bearer ${B}`,"Content-Type":"multipart/form-data"}});if(I.data.extractedText){const M=I.data.extractedText;e(M),me.success("Resume uploaded and text extracted successfully!")}else me.warning("Resume uploaded but text extraction failed. You can still paste the text manually.")}catch(R){me.error("Failed to upload resume"),console.error("Resume upload error:",R)}finally{S(!1)}},C=()=>{e(""),r(""),u(null),f(!1),y(null)},w=()=>p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[p.jsx(nd,{className:"text-purple-500"}),"Resume Analysis"]}),p.jsx("p",{className:"text-gray-600 mb-6",children:"Get AI-powered feedback on your resume to improve your chances of landing your dream job. Upload your resume file or paste the text directly."}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Upload Resume (Optional)"}),p.jsx("input",{type:"file",accept:".pdf,.doc,.docx,.txt",onChange:E=>{const R=E.target.files[0];R&&(y(R),T(R))},className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),b&&p.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Uploading and extracting text from resume..."}),m&&!b&&p.jsx("div",{className:"mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(SC,{className:"text-green-600"}),p.jsx("span",{className:"text-sm font-medium text-green-800",children:m.name}),p.jsx("span",{className:"text-xs text-green-600",children:" Uploaded successfully"})]})}),p.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Supported formats: PDF, DOC, DOCX, TXT"})]}),p.jsxs("div",{className:"relative",children:[p.jsx("div",{className:"absolute inset-0 flex items-center",children:p.jsx("div",{className:"w-full border-t border-gray-300"})}),p.jsx("div",{className:"relative flex justify-center text-sm",children:p.jsx("span",{className:"px-2 bg-white text-gray-500",children:"OR"})})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Resume Text *"}),p.jsx("textarea",{value:t,onChange:E=>e(E.target.value),placeholder:"Paste your resume text here... (You can copy from Word, PDF, or any text format)",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",rows:"12",required:!0}),p.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Include your experience, education, skills, and achievements"})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Job Description (Optional)"}),p.jsx("textarea",{value:n,onChange:E=>r(E.target.value),placeholder:"Paste the job description you're applying for to get targeted feedback...",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",rows:"6"}),p.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"This helps provide more targeted recommendations"})]}),p.jsx("button",{onClick:k,disabled:o||!t.trim(),className:"w-full bg-purple-500 text-white py-3 px-6 rounded-lg hover:bg-purple-600 disabled:opacity-50 transition-colors flex items-center justify-center gap-2",children:o?p.jsxs(p.Fragment,{children:[p.jsx(v0,{className:"animate-spin"}),"Analyzing Resume..."]}):p.jsxs(p.Fragment,{children:[p.jsx(nd,{}),m?"Analyze Uploaded Resume":"Analyze Resume"]})})]})]}),A=()=>p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[p.jsx(m0,{className:"text-purple-500"}),"Analysis Results"]}),p.jsxs("div",{className:"space-y-6",children:[p.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 p-6 rounded-lg",children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Overall Assessment"}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("div",{className:"text-3xl font-bold text-purple-600",children:[l.resumeScore||"85","%"]}),p.jsx("div",{className:"flex gap-1",children:[...Array(5)].map((E,R)=>p.jsx(mv,{className:`text-xl ${R<Math.floor((l.resumeScore||85)/20)?"text-yellow-400":"text-gray-300"}`},R))})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[p.jsx(Ur,{className:"text-green-500"}),"Strengths"]}),p.jsx("div",{className:"bg-green-50 p-4 rounded-lg",children:p.jsx("ul",{className:"space-y-2",children:l.strengths?.map((E,R)=>p.jsxs("li",{className:"flex items-start gap-2 text-sm text-green-700",children:[p.jsx(Ur,{className:"text-green-500 mt-0.5 flex-shrink-0"}),E]},R))||["Clear structure and formatting","Relevant experience highlighted","Good use of action verbs"].map((E,R)=>p.jsxs("li",{className:"flex items-start gap-2 text-sm text-green-700",children:[p.jsx(Ur,{className:"text-green-500 mt-0.5 flex-shrink-0"}),E]},R))})})]}),p.jsxs("div",{children:[p.jsxs("h3",{className:"font-semibold text-gray-800 mb-3 flex items-center gap-2",children:[p.jsx($n,{className:"text-orange-500"}),"Areas for Improvement"]}),p.jsx("div",{className:"bg-orange-50 p-4 rounded-lg",children:p.jsx("ul",{className:"space-y-2",children:l.areasForImprovement?.map((E,R)=>p.jsxs("li",{className:"flex items-start gap-2 text-sm text-orange-700",children:[p.jsx($n,{className:"text-orange-500 mt-0.5 flex-shrink-0"}),E]},R))||["Add more quantifiable achievements","Include relevant keywords from job descriptions","Enhance the professional summary"].map((E,R)=>p.jsxs("li",{className:"flex items-start gap-2 text-sm text-orange-700",children:[p.jsx($n,{className:"text-orange-500 mt-0.5 flex-shrink-0"}),E]},R))})})]})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Specific Suggestions"}),p.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:p.jsx("ul",{className:"space-y-2",children:l.suggestions?.map((E,R)=>p.jsxs("li",{className:"flex items-start gap-2 text-sm text-blue-700",children:[p.jsx($n,{className:"text-blue-500 mt-0.5 flex-shrink-0"}),E]},R))||["Use numbers to quantify your achievements (e.g., 'Increased sales by 25%')","Include industry-specific keywords naturally in your content","Make your summary more compelling and specific to your target role","Add relevant certifications and training programs"].map((E,R)=>p.jsxs("li",{className:"flex items-start gap-2 text-sm text-blue-700",children:[p.jsx($n,{className:"text-blue-500 mt-0.5 flex-shrink-0"}),E]},R))})})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"ATS Optimization Tips"}),p.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:p.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[p.jsx("li",{children:" Use standard section headings (Experience, Education, Skills)"}),p.jsx("li",{children:" Avoid graphics, tables, and complex formatting"}),p.jsx("li",{children:" Use simple, readable fonts (Arial, Calibri, Times New Roman)"}),p.jsx("li",{children:" Include relevant keywords naturally throughout your resume"}),p.jsx("li",{children:" Keep your resume to 1-2 pages maximum"}),p.jsx("li",{children:" Use bullet points for achievements and responsibilities"})]})})]}),l.keywords&&p.jsxs("div",{children:[p.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Keywords to Consider Adding"}),p.jsx("div",{className:"bg-purple-50 p-4 rounded-lg",children:p.jsx("div",{className:"flex flex-wrap gap-2",children:l.keywords.map((E,R)=>p.jsx("span",{className:"px-3 py-1 bg-purple-100 text-purple-800 text-sm rounded-full",children:E},R))})})]}),p.jsx("div",{className:"flex gap-4",children:p.jsx("button",{onClick:C,className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Analyze Another Resume"})})]})]}),P=p.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:p.jsxs("div",{className:"max-w-6xl mx-auto",children:[p.jsxs("div",{className:"mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Resume Analyzer"}),p.jsx("p",{className:"text-gray-600",children:"Get AI-powered feedback on your resume to improve your chances of landing interviews"})]}),!d&&w(),d&&A()]})});return p.jsx(Gt,{children:P})}function Tw(){const[t,e]=N.useState({currentSkills:"",targetRole:""}),[n,r]=N.useState(null),[o,a]=N.useState(!1),l=async b=>{if(b.preventDefault(),!t.currentSkills||!t.targetRole){me.error("Please fill in all fields");return}a(!0);try{const S=localStorage.getItem("token"),k=await we.post("http://localhost:8080/api/ai/skill-gap-analysis",t,{headers:{Authorization:`Bearer ${S}`}});r(k.data),me.success("Skill gap analysis completed!")}catch(S){console.error("Analysis error:",S),me.error("Failed to analyze skills")}finally{a(!1)}},u=(b,S,k,T)=>p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[k,p.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:b})]}),S&&S.length>0?p.jsx("div",{className:"space-y-2",children:S.map((C,w)=>p.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gray-50 rounded-lg",children:[p.jsx(gv,{className:"text-red-500"}),p.jsx("span",{className:"text-gray-700",children:C})]},w))}):p.jsxs("div",{className:"flex items-center gap-2 p-2 bg-green-50 rounded-lg",children:[p.jsx(Ur,{className:"text-green-500"}),p.jsx("span",{className:"text-green-700",children:"All required skills covered!"})]})]}),d=()=>p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Recommended Actions"}),n.recommendations.courses.length>0&&p.jsxs("div",{className:"mb-6",children:[p.jsxs("h4",{className:"font-medium text-gray-700 mb-3 flex items-center gap-2",children:[p.jsx(rd,{className:"text-blue-500"}),"Recommended Courses"]}),p.jsx("div",{className:"space-y-3",children:n.recommendations.courses.map((b,S)=>p.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[p.jsx("h5",{className:"font-medium text-gray-800",children:b.course}),p.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Provider: ",b.provider]}),p.jsxs("p",{className:"text-sm text-gray-600",children:["Duration: ",b.estimatedDuration]}),b.cost&&p.jsxs("p",{className:"text-sm text-gray-600",children:["Cost: ",b.cost]})]},S))})]}),n.recommendations.projects.length>0&&p.jsxs("div",{className:"mb-6",children:[p.jsxs("h4",{className:"font-medium text-gray-700 mb-3 flex items-center gap-2",children:[p.jsx(Qs,{className:"text-green-500"}),"Project Ideas"]}),p.jsx("div",{className:"space-y-3",children:n.recommendations.projects.map((b,S)=>p.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[p.jsx("h5",{className:"font-medium text-gray-800",children:b.project}),p.jsx("p",{className:"text-sm text-gray-600 mt-1",children:b.description}),b.difficulty&&p.jsxs("p",{className:"text-sm text-gray-600",children:["Difficulty: ",b.difficulty]})]},S))})]}),n.recommendations.certifications.length>0&&p.jsxs("div",{className:"mb-6",children:[p.jsxs("h4",{className:"font-medium text-gray-700 mb-3 flex items-center gap-2",children:[p.jsx(Js,{className:"text-purple-500"}),"Certifications"]}),p.jsx("div",{className:"space-y-3",children:n.recommendations.certifications.map((b,S)=>p.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[p.jsx("h5",{className:"font-medium text-gray-800",children:b.certification}),p.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Provider: ",b.provider]}),b.validity&&p.jsxs("p",{className:"text-sm text-gray-600",children:["Validity: ",b.validity]})]},S))})]})]}),f=()=>p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Analysis Insights"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[p.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[p.jsx("div",{className:"text-lg font-semibold text-blue-600 capitalize",children:n.analysis?.overallGap||"Medium"}),p.jsx("div",{className:"text-sm text-blue-700",children:"Overall Gap Level"})]}),p.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[p.jsx("div",{className:"text-lg font-semibold text-green-600 capitalize",children:n.analysis?.marketDemand||"High"}),p.jsx("div",{className:"text-sm text-green-700",children:"Market Demand"})]}),p.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[p.jsx("div",{className:"text-lg font-semibold text-purple-600",children:n.analysis?.timeline||"6-12 months"}),p.jsx("div",{className:"text-sm text-purple-700",children:"Timeline to Acquire"})]}),p.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[p.jsx("div",{className:"text-lg font-semibold text-orange-600",children:n.analysis?.prioritySkills?.length||0}),p.jsx("div",{className:"text-sm text-orange-700",children:"Priority Skills"})]})]}),n.analysis?.prioritySkills&&n.analysis.prioritySkills.length>0&&p.jsxs("div",{className:"mt-6",children:[p.jsx("h4",{className:"font-medium text-gray-700 mb-3",children:"Priority Skills to Focus On:"}),p.jsx("div",{className:"flex flex-wrap gap-2",children:n.analysis.prioritySkills.map((b,S)=>p.jsx("span",{className:"px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm font-medium",children:b},S))})]})]}),m=()=>{const b=n.skillGap.technical.length+n.skillGap.soft.length+n.skillGap.tools.length,S=n.currentSkills.length,k=b>0?S/(S+b)*100:100;return p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Skill Progress Overview"}),p.jsxs("div",{className:"mb-4",children:[p.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[p.jsxs("span",{children:["Current Skills: ",S]}),p.jsxs("span",{children:["Missing Skills: ",b]})]}),p.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3",children:p.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 h-3 rounded-full transition-all duration-500",style:{width:`${k}%`}})}),p.jsxs("div",{className:"text-center mt-2",children:[p.jsxs("span",{className:"text-lg font-semibold text-gray-800",children:[Math.round(k),"%"]}),p.jsx("span",{className:"text-sm text-gray-600 ml-1",children:"Complete"})]})]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[p.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.skillGap.technical.length}),p.jsx("div",{className:"text-sm text-blue-700",children:"Technical Skills Needed"})]}),p.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[p.jsx("div",{className:"text-2xl font-bold text-green-600",children:n.skillGap.soft.length}),p.jsx("div",{className:"text-sm text-green-700",children:"Soft Skills Needed"})]}),p.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[p.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.skillGap.tools.length}),p.jsx("div",{className:"text-sm text-purple-700",children:"Tools Needed"})]})]})]})},y=p.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:p.jsxs("div",{className:"max-w-6xl mx-auto",children:[p.jsxs("div",{className:"mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Skill Gap Analyzer"}),p.jsx("p",{className:"text-gray-600",children:"Compare your current skills with job requirements and get personalized recommendations"})]}),!n&&p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-8",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Analyze Your Skills"}),p.jsxs("form",{onSubmit:l,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Role"}),p.jsxs("select",{value:t.targetRole,onChange:b=>e({...t,targetRole:b.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",required:!0,children:[p.jsx("option",{value:"",children:"Select a role"}),p.jsx("option",{value:"software engineer",children:"Software Engineer"}),p.jsx("option",{value:"data scientist",children:"Data Scientist"}),p.jsx("option",{value:"product manager",children:"Product Manager"}),p.jsx("option",{value:"ui/ux designer",children:"UI/UX Designer"}),p.jsx("option",{value:"devops engineer",children:"DevOps Engineer"}),p.jsx("option",{value:"frontend developer",children:"Frontend Developer"}),p.jsx("option",{value:"backend developer",children:"Backend Developer"}),p.jsx("option",{value:"full stack developer",children:"Full Stack Developer"}),p.jsx("option",{value:"machine learning engineer",children:"Machine Learning Engineer"}),p.jsx("option",{value:"business analyst",children:"Business Analyst"}),p.jsx("option",{value:"project manager",children:"Project Manager"}),p.jsx("option",{value:"sales representative",children:"Sales Representative"}),p.jsx("option",{value:"customer success manager",children:"Customer Success Manager"}),p.jsx("option",{value:"human resources specialist",children:"Human Resources Specialist"}),p.jsx("option",{value:"financial analyst",children:"Financial Analyst"}),p.jsx("option",{value:"content writer",children:"Content Writer"}),p.jsx("option",{value:"digital marketing specialist",children:"Digital Marketing Specialist"}),p.jsx("option",{value:"marketing specialist",children:"Marketing Specialist"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Current Skills (comma-separated)"}),p.jsx("textarea",{value:t.currentSkills,onChange:b=>e({...t,currentSkills:b.target.value}),placeholder:"e.g., JavaScript, Python, Communication, Project Management",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",rows:"4",required:!0})]}),p.jsx("button",{type:"submit",disabled:o,className:"w-full bg-purple-500 text-white py-3 px-6 rounded-lg hover:bg-purple-600 disabled:opacity-50 transition-colors",children:o?"Analyzing...":"Analyze Skills"})]})]}),n&&p.jsxs("div",{className:"space-y-6",children:[m(),f(),p.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u("Technical Skills Needed",n.skillGap.technical,p.jsx(TC,{className:"text-blue-500 text-xl"})),u("Soft Skills Needed",n.skillGap.soft,p.jsx(Qs,{className:"text-green-500 text-xl"})),u("Tools & Technologies Needed",n.skillGap.tools,p.jsx(Js,{className:"text-purple-500 text-xl"}))]}),d(),p.jsx("div",{className:"text-center",children:p.jsx("button",{onClick:()=>r(null),className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Analyze Different Role"})})]})]})});return p.jsx(Gt,{children:y})}var Mu={exports:{}},lg;function Cw(){return lg||(lg=1,function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function o(d,f,m){this.fn=d,this.context=f,this.once=m||!1}function a(d,f,m,y,b){if(typeof m!="function")throw new TypeError("The listener must be a function");var S=new o(m,y||d,b),k=n?n+f:f;return d._events[k]?d._events[k].fn?d._events[k]=[d._events[k],S]:d._events[k].push(S):(d._events[k]=S,d._eventsCount++),d}function l(d,f){--d._eventsCount===0?d._events=new r:delete d._events[f]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],m,y;if(this._eventsCount===0)return f;for(y in m=this._events)e.call(m,y)&&f.push(n?y.slice(1):y);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(m)):f},u.prototype.listeners=function(f){var m=n?n+f:f,y=this._events[m];if(!y)return[];if(y.fn)return[y.fn];for(var b=0,S=y.length,k=new Array(S);b<S;b++)k[b]=y[b].fn;return k},u.prototype.listenerCount=function(f){var m=n?n+f:f,y=this._events[m];return y?y.fn?1:y.length:0},u.prototype.emit=function(f,m,y,b,S,k){var T=n?n+f:f;if(!this._events[T])return!1;var C=this._events[T],w=arguments.length,A,P;if(C.fn){switch(C.once&&this.removeListener(f,C.fn,void 0,!0),w){case 1:return C.fn.call(C.context),!0;case 2:return C.fn.call(C.context,m),!0;case 3:return C.fn.call(C.context,m,y),!0;case 4:return C.fn.call(C.context,m,y,b),!0;case 5:return C.fn.call(C.context,m,y,b,S),!0;case 6:return C.fn.call(C.context,m,y,b,S,k),!0}for(P=1,A=new Array(w-1);P<w;P++)A[P-1]=arguments[P];C.fn.apply(C.context,A)}else{var E=C.length,R;for(P=0;P<E;P++)switch(C[P].once&&this.removeListener(f,C[P].fn,void 0,!0),w){case 1:C[P].fn.call(C[P].context);break;case 2:C[P].fn.call(C[P].context,m);break;case 3:C[P].fn.call(C[P].context,m,y);break;case 4:C[P].fn.call(C[P].context,m,y,b);break;default:if(!A)for(R=1,A=new Array(w-1);R<w;R++)A[R-1]=arguments[R];C[P].fn.apply(C[P].context,A)}}return!0},u.prototype.on=function(f,m,y){return a(this,f,m,y,!1)},u.prototype.once=function(f,m,y){return a(this,f,m,y,!0)},u.prototype.removeListener=function(f,m,y,b){var S=n?n+f:f;if(!this._events[S])return this;if(!m)return l(this,S),this;var k=this._events[S];if(k.fn)k.fn===m&&(!b||k.once)&&(!y||k.context===y)&&l(this,S);else{for(var T=0,C=[],w=k.length;T<w;T++)(k[T].fn!==m||b&&!k[T].once||y&&k[T].context!==y)&&C.push(k[T]);C.length?this._events[S]=C.length===1?C[0]:C:l(this,S)}return this},u.prototype.removeAllListeners=function(f){var m;return f?(m=n?n+f:f,this._events[m]&&l(this,m)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=n,u.EventEmitter=u,t.exports=u}(Mu)),Mu.exports}var ww=Cw();const Ew=h0(ww);var cg={};function _w(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(r){if(r!=="default"&&!(r in t)){var o=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return n[r]}})}})}),Object.freeze(t)}var Rw=Object.defineProperty,Pw=(t,e,n)=>e in t?Rw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ug=(t,e,n)=>Pw(t,typeof e!="symbol"?e+"":e,n);class Rt{constructor(){ug(this,"_locking"),ug(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(o=>e=()=>{this._locks-=1,o()}),r=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),r}}function nt(t,e){if(!t)throw new Error(e)}const Nw=34028234663852886e22,Iw=-34028234663852886e22,jw=4294967295,Ow=2147483647,Aw=-2147483648;function Ua(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>Ow||t<Aw)throw new Error("invalid int 32: "+t)}function bd(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>jw||t<0)throw new Error("invalid uint 32: "+t)}function kv(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>Nw||t<Iw))throw new Error("invalid float 32: "+t)}const Sv=Symbol("@bufbuild/protobuf/enum-type");function Dw(t){const e=t[Sv];return nt(e,"missing enum type on enum object"),e}function Tv(t,e,n,r){t[Sv]=Cv(e,n.map(o=>({no:o.no,name:o.name,localName:t[o.no]})))}function Cv(t,e,n){const r=Object.create(null),o=Object.create(null),a=[];for(const l of e){const u=wv(l);a.push(u),r[l.name]=u,o[l.no]=u}return{typeName:t,values:a,findName(l){return r[l]},findNumber(l){return o[l]}}}function Lw(t,e,n){const r={};for(const o of e){const a=wv(o);r[a.localName]=a.no,r[a.no]=a.localName}return Tv(r,t,e),r}function wv(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class uh{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const r=this.getType(),o=r.runtime.bin,a=o.makeReadOptions(n);return o.readMessage(this,a.readerFactory(e),e.byteLength,a),this}fromJson(e,n){const r=this.getType(),o=r.runtime.json,a=o.makeReadOptions(n);return o.readMessage(r,e,a,this),this}fromJsonString(e,n){let r;try{r=JSON.parse(e)}catch(o){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(o instanceof Error?o.message:String(o)))}return this.fromJson(r,n)}toBinary(e){const n=this.getType(),r=n.runtime.bin,o=r.makeWriteOptions(e),a=o.writerFactory();return r.writeMessage(this,a,o),a.finish()}toJson(e){const n=this.getType(),r=n.runtime.json,o=r.makeWriteOptions(e);return r.writeMessage(this,o)}toJsonString(e){var n;const r=this.toJson(e);return JSON.stringify(r,null,(n=e?.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Mw(t,e,n,r){var o;const a=(o=r?.localName)!==null&&o!==void 0?o:e.substring(e.lastIndexOf(".")+1),l={[a]:function(u){t.util.initFields(this),t.util.initPartial(u,this)}}[a];return Object.setPrototypeOf(l.prototype,new uh),Object.assign(l,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(u,d){return new l().fromBinary(u,d)},fromJson(u,d){return new l().fromJson(u,d)},fromJsonString(u,d){return new l().fromJsonString(u,d)},equals(u,d){return t.util.equals(l,u,d)}}),l}function Uw(){let t=0,e=0;for(let r=0;r<28;r+=7){let o=this.buf[this.pos++];if(t|=(o&127)<<r,(o&128)==0)return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,(n&128)==0)return this.assertBounds(),[t,e];for(let r=3;r<=31;r+=7){let o=this.buf[this.pos++];if(e|=(o&127)<<r,(o&128)==0)return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function Uu(t,e,n){for(let a=0;a<28;a=a+7){const l=t>>>a,u=!(!(l>>>7)&&e==0),d=(u?l|128:l)&255;if(n.push(d),!u)return}const r=t>>>28&15|(e&7)<<4,o=e>>3!=0;if(n.push((o?r|128:r)&255),!!o){for(let a=3;a<31;a=a+7){const l=e>>>a,u=!!(l>>>7),d=(u?l|128:l)&255;if(n.push(d),!u)return}n.push(e>>>31&1)}}const Fa=4294967296;function dg(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let r=0,o=0;function a(l,u){const d=Number(t.slice(l,u));o*=n,r=r*n+d,r>=Fa&&(o=o+(r/Fa|0),r=r%Fa)}return a(-24,-18),a(-18,-12),a(-12,-6),a(-6),e?_v(r,o):dh(r,o)}function Fw(t,e){let n=dh(t,e);const r=n.hi&2147483648;r&&(n=_v(n.lo,n.hi));const o=Ev(n.lo,n.hi);return r?"-"+o:o}function Ev(t,e){if({lo:t,hi:e}=Bw(t,e),e<=2097151)return String(Fa*e+t);const n=t&16777215,r=(t>>>24|e<<8)&16777215,o=e>>16&65535;let a=n+r*6777216+o*6710656,l=r+o*8147497,u=o*2;const d=1e7;return a>=d&&(l+=Math.floor(a/d),a%=d),l>=d&&(u+=Math.floor(l/d),l%=d),u.toString()+hg(l)+hg(a)}function Bw(t,e){return{lo:t>>>0,hi:e>>>0}}function dh(t,e){return{lo:t|0,hi:e|0}}function _v(t,e){return e=~e,t?t=~t+1:e+=1,dh(t,e)}const hg=t=>{const e=String(t);return"0000000".slice(e.length)+e};function fg(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function zw(){let t=this.buf[this.pos++],e=t&127;if((t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,(t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,(t&128)==0)return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,(t&128)==0)return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;(t&128)!==0&&n<10;n++)t=this.buf[this.pos++];if((t&128)!=0)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function Vw(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof cg!="object"||cg.BUF_BIGINT_DISABLE!=="1")){const o=BigInt("-9223372036854775808"),a=BigInt("9223372036854775807"),l=BigInt("0"),u=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(d){const f=typeof d=="bigint"?d:BigInt(d);if(f>a||f<o)throw new Error("int64 invalid: ".concat(d));return f},uParse(d){const f=typeof d=="bigint"?d:BigInt(d);if(f>u||f<l)throw new Error("uint64 invalid: ".concat(d));return f},enc(d){return t.setBigInt64(0,this.parse(d),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(d){return t.setBigInt64(0,this.uParse(d),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(d,f){return t.setInt32(0,d,!0),t.setInt32(4,f,!0),t.getBigInt64(0,!0)},uDec(d,f){return t.setInt32(0,d,!0),t.setInt32(4,f,!0),t.getBigUint64(0,!0)}}}const n=o=>nt(/^-?[0-9]+$/.test(o),"int64 invalid: ".concat(o)),r=o=>nt(/^[0-9]+$/.test(o),"uint64 invalid: ".concat(o));return{zero:"0",supported:!1,parse(o){return typeof o!="string"&&(o=o.toString()),n(o),o},uParse(o){return typeof o!="string"&&(o=o.toString()),r(o),o},enc(o){return typeof o!="string"&&(o=o.toString()),n(o),dg(o)},uEnc(o){return typeof o!="string"&&(o=o.toString()),r(o),dg(o)},dec(o,a){return Fw(o,a)},uDec(o,a){return Ev(o,a)}}}const Qe=Vw();var $;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})($||($={}));var Pi;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(Pi||(Pi={}));function ki(t,e,n){if(e===n)return!0;if(t==$.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==n[r])return!1;return!0}switch(t){case $.UINT64:case $.FIXED64:case $.INT64:case $.SFIXED64:case $.SINT64:return e==n}return!1}function $r(t,e){switch(t){case $.BOOL:return!1;case $.UINT64:case $.FIXED64:case $.INT64:case $.SFIXED64:case $.SINT64:return e==0?Qe.zero:"0";case $.DOUBLE:case $.FLOAT:return 0;case $.BYTES:return new Uint8Array(0);case $.STRING:return"";default:return 0}}function Rv(t,e){switch(t){case $.BOOL:return e===!1;case $.STRING:return e==="";case $.BYTES:return e instanceof Uint8Array&&!e.byteLength;default:return e==0}}var ot;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})(ot||(ot={}));class qw{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let o=0;o<this.chunks.length;o++)e+=this.chunks[o].length;let n=new Uint8Array(e),r=0;for(let o=0;o<this.chunks.length;o++)n.set(this.chunks[o],r),r+=this.chunks[o].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(bd(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Ua(e),fg(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){kv(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){bd(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Ua(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Ua(e),e=(e<<1^e>>31)>>>0,fg(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),o=Qe.enc(e);return r.setInt32(0,o.lo,!0),r.setInt32(4,o.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),r=new DataView(n.buffer),o=Qe.uEnc(e);return r.setInt32(0,o.lo,!0),r.setInt32(4,o.hi,!0),this.raw(n)}int64(e){let n=Qe.enc(e);return Uu(n.lo,n.hi,this.buf),this}sint64(e){let n=Qe.enc(e),r=n.hi>>31,o=n.lo<<1^r,a=(n.hi<<1|n.lo>>>31)^r;return Uu(o,a,this.buf),this}uint64(e){let n=Qe.uEnc(e);return Uu(n.lo,n.hi,this.buf),this}}class Hw{constructor(e,n){this.varint64=Uw,this.uint32=zw,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,r=e&7;if(n<=0||r<0||r>5)throw new Error("illegal tag: field no "+n+" wire type "+r);return[n,r]}skip(e,n){let r=this.pos;switch(e){case ot.Varint:for(;this.buf[this.pos++]&128;);break;case ot.Bit64:this.pos+=4;case ot.Bit32:this.pos+=4;break;case ot.LengthDelimited:let o=this.uint32();this.pos+=o;break;case ot.StartGroup:for(;;){const[a,l]=this.tag();if(l===ot.EndGroup){if(n!==void 0&&a!==n)throw new Error("invalid end group tag");break}this.skip(l,a)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(r,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return Qe.dec(...this.varint64())}uint64(){return Qe.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),r=-(e&1);return e=(e>>>1|(n&1)<<31)^r,n=n>>>1^r,Qe.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Qe.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Qe.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function $w(t,e,n,r){let o;return{typeName:e,extendee:n,get field(){if(!o){const a=typeof r=="function"?r():r;a.name=e.split(".").pop(),a.jsonName="[".concat(e,"]"),o=t.util.newFieldList([a]).list()[0]}return o},runtime:t}}function Pv(t){const e=t.field.localName,n=Object.create(null);return n[e]=Ww(t),[n,()=>n[e]]}function Ww(t){const e=t.field;if(e.repeated)return[];if(e.default!==void 0)return e.default;switch(e.kind){case"enum":return e.T.values[0].no;case"scalar":return $r(e.T,e.L);case"message":const n=e.T,r=new n;return n.fieldWrapper?n.fieldWrapper.unwrapField(r):r;case"map":throw"map fields are not allowed to be extensions"}}function Gw(t,e){if(!e.repeated&&(e.kind=="enum"||e.kind=="scalar")){for(let n=t.length-1;n>=0;--n)if(t[n].no==e.no)return[t[n]];return[]}return t.filter(n=>n.no===e.no)}let Wn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),_l=[];for(let t=0;t<Wn.length;t++)_l[Wn[t].charCodeAt(0)]=t;_l[45]=Wn.indexOf("+");_l[95]=Wn.indexOf("/");const Nv={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),r=0,o=0,a,l=0;for(let u=0;u<t.length;u++){if(a=_l[t.charCodeAt(u)],a===void 0)switch(t[u]){case"=":o=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:l=a,o=1;break;case 1:n[r++]=l<<2|(a&48)>>4,l=a,o=2;break;case 2:n[r++]=(l&15)<<4|(a&60)>>2,l=a,o=3;break;case 3:n[r++]=(l&3)<<6|a,o=0;break}}if(o==1)throw Error("invalid base64 string.");return n.subarray(0,r)},enc(t){let e="",n=0,r,o=0;for(let a=0;a<t.length;a++)switch(r=t[a],n){case 0:e+=Wn[r>>2],o=(r&3)<<4,n=1;break;case 1:e+=Wn[o|r>>4],o=(r&15)<<2,n=2;break;case 2:e+=Wn[o|r>>6],e+=Wn[r&63],n=0;break}return n&&(e+=Wn[o],e+="=",n==1&&(e+="=")),e}};function Kw(t,e,n){jv(e,t);const r=e.runtime.bin.makeReadOptions(n),o=Gw(t.getType().runtime.bin.listUnknownFields(t),e.field),[a,l]=Pv(e);for(const u of o)e.runtime.bin.readField(a,r.readerFactory(u.data),e.field,u.wireType,r);return l()}function Jw(t,e,n,r){jv(e,t);const o=e.runtime.bin.makeReadOptions(r),a=e.runtime.bin.makeWriteOptions(r);if(Iv(t,e)){const f=t.getType().runtime.bin.listUnknownFields(t).filter(m=>m.no!=e.field.no);t.getType().runtime.bin.discardUnknownFields(t);for(const m of f)t.getType().runtime.bin.onUnknownField(t,m.no,m.wireType,m.data)}const l=a.writerFactory();let u=e.field;!u.opt&&!u.repeated&&(u.kind=="enum"||u.kind=="scalar")&&(u=Object.assign(Object.assign({},e.field),{opt:!0})),e.runtime.bin.writeField(u,n,l,a);const d=o.readerFactory(l.finish());for(;d.pos<d.len;){const[f,m]=d.tag(),y=d.skip(m,f);t.getType().runtime.bin.onUnknownField(t,f,m,y)}}function Iv(t,e){const n=t.getType();return e.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(t).find(r=>r.no==e.field.no)}function jv(t,e){nt(t.extendee.typeName==e.getType().typeName,"extension ".concat(t.typeName," can only be applied to message ").concat(t.extendee.typeName))}function Ov(t,e){const n=t.localName;if(t.repeated)return e[n].length>0;if(t.oneof)return e[t.oneof.localName].case===n;switch(t.kind){case"enum":case"scalar":return t.opt||t.req?e[n]!==void 0:t.kind=="enum"?e[n]!==t.T.values[0].no:!Rv(t.T,e[n]);case"message":return e[n]!==void 0;case"map":return Object.keys(e[n]).length>0}}function pg(t,e){const n=t.localName,r=!t.opt&&!t.req;if(t.repeated)e[n]=[];else if(t.oneof)e[t.oneof.localName]={case:void 0};else switch(t.kind){case"map":e[n]={};break;case"enum":e[n]=r?t.T.values[0].no:void 0;break;case"scalar":e[n]=r?$r(t.T,t.L):void 0;break;case"message":e[n]=void 0;break}}function Gn(t,e){if(t===null||typeof t!="object"||!Object.getOwnPropertyNames(uh.prototype).every(r=>r in t&&typeof t[r]=="function"))return!1;const n=t.getType();return n===null||typeof n!="function"||!("typeName"in n)||typeof n.typeName!="string"?!1:e===void 0?!0:n.typeName==e.typeName}function Av(t,e){return Gn(e)||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}$.DOUBLE,$.FLOAT,$.INT64,$.UINT64,$.INT32,$.UINT32,$.BOOL,$.STRING,$.BYTES;const mg={ignoreUnknownFields:!1},gg={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function Qw(t){return t?Object.assign(Object.assign({},mg),t):mg}function Yw(t){return t?Object.assign(Object.assign({},gg),t):gg}const sl=Symbol(),Ba=Symbol();function Xw(){return{makeReadOptions:Qw,makeWriteOptions:Yw,readMessage(t,e,n,r){if(e==null||Array.isArray(e)||typeof e!="object")throw new Error("cannot decode message ".concat(t.typeName," from JSON: ").concat(En(e)));r=r??new t;const o=new Map,a=n.typeRegistry;for(const[l,u]of Object.entries(e)){const d=t.fields.findJsonName(l);if(d){if(d.oneof){if(u===null&&d.kind=="scalar")continue;const f=o.get(d.oneof);if(f!==void 0)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: multiple keys for oneof "').concat(d.oneof.name,'" present: "').concat(f,'", "').concat(l,'"'));o.set(d.oneof,l)}vg(r,u,d,n,t)}else{let f=!1;if(a?.findExtension&&l.startsWith("[")&&l.endsWith("]")){const m=a.findExtension(l.substring(1,l.length-1));if(m&&m.extendee.typeName==t.typeName){f=!0;const[y,b]=Pv(m);vg(y,u,m.field,n,m),Jw(r,m,b(),n)}}if(!f&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(t.typeName,' from JSON: key "').concat(l,'" is unknown'))}}return r},writeMessage(t,e){const n=t.getType(),r={};let o;try{for(o of n.fields.byNumber()){if(!Ov(o,t)){if(o.req)throw"required field not set";if(!e.emitDefaultValues||!eE(o))continue}const l=o.oneof?t[o.oneof.localName].value:t[o.localName],u=yg(o,l,e);u!==void 0&&(r[e.useProtoFieldName?o.name:o.jsonName]=u)}const a=e.typeRegistry;if(a?.findExtensionFor)for(const l of n.runtime.bin.listUnknownFields(t)){const u=a.findExtensionFor(n.typeName,l.no);if(u&&Iv(t,u)){const d=Kw(t,u,e),f=yg(u.field,d,e);f!==void 0&&(r[u.field.jsonName]=f)}}}catch(a){const l=o?"cannot encode field ".concat(n.typeName,".").concat(o.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),u=a instanceof Error?a.message:String(a);throw new Error(l+(u.length>0?": ".concat(u):""))}return r},readScalar(t,e,n){return Xs(t,e,n??Pi.BIGINT,!0)},writeScalar(t,e,n){if(e!==void 0&&(n||Rv(t,e)))return za(t,e)},debug:En}}function En(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function vg(t,e,n,r,o){let a=n.localName;if(n.repeated){if(nt(n.kind!="map"),e===null)return;if(!Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(En(e)));const l=t[a];for(const u of e){if(u===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(En(u)));switch(n.kind){case"message":l.push(n.T.fromJson(u,r));break;case"enum":const d=Fu(n.T,u,r.ignoreUnknownFields,!0);d!==Ba&&l.push(d);break;case"scalar":try{l.push(Xs(n.T,u,n.L,!0))}catch(f){let m="cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(En(u));throw f instanceof Error&&f.message.length>0&&(m+=": ".concat(f.message)),new Error(m)}break}}}else if(n.kind=="map"){if(e===null)return;if(typeof e!="object"||Array.isArray(e))throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(En(e)));const l=t[a];for(const[u,d]of Object.entries(e)){if(d===null)throw new Error("cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: map value null"));let f;try{f=Zw(n.K,u)}catch(m){let y="cannot decode map key for field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(En(e));throw m instanceof Error&&m.message.length>0&&(y+=": ".concat(m.message)),new Error(y)}switch(n.V.kind){case"message":l[f]=n.V.T.fromJson(d,r);break;case"enum":const m=Fu(n.V.T,d,r.ignoreUnknownFields,!0);m!==Ba&&(l[f]=m);break;case"scalar":try{l[f]=Xs(n.V.T,d,Pi.BIGINT,!0)}catch(y){let b="cannot decode map value for field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(En(e));throw y instanceof Error&&y.message.length>0&&(b+=": ".concat(y.message)),new Error(b)}break}}}else switch(n.oneof&&(t=t[n.oneof.localName]={case:a},a="value"),n.kind){case"message":const l=n.T;if(e===null&&l.typeName!="google.protobuf.Value")return;let u=t[a];Gn(u)?u.fromJson(e,r):(t[a]=u=l.fromJson(e,r),l.fieldWrapper&&!n.oneof&&(t[a]=l.fieldWrapper.unwrapField(u)));break;case"enum":const d=Fu(n.T,e,r.ignoreUnknownFields,!1);switch(d){case sl:pg(n,t);break;case Ba:break;default:t[a]=d;break}break;case"scalar":try{const f=Xs(n.T,e,n.L,!1);switch(f){case sl:pg(n,t);break;default:t[a]=f;break}}catch(f){let m="cannot decode field ".concat(o.typeName,".").concat(n.name," from JSON: ").concat(En(e));throw f instanceof Error&&f.message.length>0&&(m+=": ".concat(f.message)),new Error(m)}break}}function Zw(t,e){if(t===$.BOOL)switch(e){case"true":e=!0;break;case"false":e=!1;break}return Xs(t,e,Pi.BIGINT,!0).toString()}function Xs(t,e,n,r){if(e===null)return r?$r(t,n):sl;switch(t){case $.DOUBLE:case $.FLOAT:if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const o=Number(e);if(Number.isNaN(o)||!Number.isFinite(o))break;return t==$.FLOAT&&kv(o),o;case $.INT32:case $.FIXED32:case $.SFIXED32:case $.SINT32:case $.UINT32:let a;if(typeof e=="number"?a=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(a=Number(e)),a===void 0)break;return t==$.UINT32||t==$.FIXED32?bd(a):Ua(a),a;case $.INT64:case $.SFIXED64:case $.SINT64:if(typeof e!="number"&&typeof e!="string")break;const l=Qe.parse(e);return n?l.toString():l;case $.FIXED64:case $.UINT64:if(typeof e!="number"&&typeof e!="string")break;const u=Qe.uParse(e);return n?u.toString():u;case $.BOOL:if(typeof e!="boolean")break;return e;case $.STRING:if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case $.BYTES:if(e==="")return new Uint8Array(0);if(typeof e!="string")break;return Nv.dec(e)}throw new Error}function Fu(t,e,n,r){if(e===null)return t.typeName=="google.protobuf.NullValue"?0:r?t.values[0].no:sl;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const o=t.findName(e);if(o!==void 0)return o.no;if(n)return Ba;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(En(e)))}function eE(t){return t.repeated||t.kind=="map"?!0:!(t.oneof||t.kind=="message"||t.opt||t.req)}function yg(t,e,n){if(t.kind=="map"){nt(typeof e=="object"&&e!=null);const r={},o=Object.entries(e);switch(t.V.kind){case"scalar":for(const[l,u]of o)r[l.toString()]=za(t.V.T,u);break;case"message":for(const[l,u]of o)r[l.toString()]=u.toJson(n);break;case"enum":const a=t.V.T;for(const[l,u]of o)r[l.toString()]=Bu(a,u,n.enumAsInteger);break}return n.emitDefaultValues||o.length>0?r:void 0}if(t.repeated){nt(Array.isArray(e));const r=[];switch(t.kind){case"scalar":for(let o=0;o<e.length;o++)r.push(za(t.T,e[o]));break;case"enum":for(let o=0;o<e.length;o++)r.push(Bu(t.T,e[o],n.enumAsInteger));break;case"message":for(let o=0;o<e.length;o++)r.push(e[o].toJson(n));break}return n.emitDefaultValues||r.length>0?r:void 0}switch(t.kind){case"scalar":return za(t.T,e);case"enum":return Bu(t.T,e,n.enumAsInteger);case"message":return Av(t.T,e).toJson(n)}}function Bu(t,e,n){var r;if(nt(typeof e=="number"),t.typeName=="google.protobuf.NullValue")return null;if(n)return e;const o=t.findNumber(e);return(r=o?.name)!==null&&r!==void 0?r:e}function za(t,e){switch(t){case $.INT32:case $.SFIXED32:case $.SINT32:case $.FIXED32:case $.UINT32:return nt(typeof e=="number"),e;case $.FLOAT:case $.DOUBLE:return nt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e;case $.STRING:return nt(typeof e=="string"),e;case $.BOOL:return nt(typeof e=="boolean"),e;case $.UINT64:case $.FIXED64:case $.INT64:case $.SFIXED64:case $.SINT64:return nt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),e.toString();case $.BYTES:return nt(e instanceof Uint8Array),Nv.enc(e)}}const jr=Symbol("@bufbuild/protobuf/unknown-fields"),bg={readUnknownFields:!0,readerFactory:t=>new Hw(t)},xg={writeUnknownFields:!0,writerFactory:()=>new qw};function tE(t){return t?Object.assign(Object.assign({},bg),t):bg}function nE(t){return t?Object.assign(Object.assign({},xg),t):xg}function iE(){return{makeReadOptions:tE,makeWriteOptions:nE,listUnknownFields(t){var e;return(e=t[jr])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[jr]},writeUnknownFields(t,e){const r=t[jr];if(r)for(const o of r)e.tag(o.no,o.wireType).raw(o.data)},onUnknownField(t,e,n,r){const o=t;Array.isArray(o[jr])||(o[jr]=[]),o[jr].push({no:e,wireType:n,data:r})},readMessage(t,e,n,r,o){const a=t.getType(),l=o?e.len:e.pos+n;let u,d;for(;e.pos<l&&([u,d]=e.tag(),!(o===!0&&d==ot.EndGroup));){const f=a.fields.find(u);if(!f){const m=e.skip(d,u);r.readUnknownFields&&this.onUnknownField(t,u,d,m);continue}kg(t,e,f,d,r)}if(o&&(d!=ot.EndGroup||u!==n))throw new Error("invalid end group tag")},readField:kg,writeMessage(t,e,n){const r=t.getType();for(const o of r.fields.byNumber()){if(!Ov(o,t)){if(o.req)throw new Error("cannot encode field ".concat(r.typeName,".").concat(o.name," to binary: required field not set"));continue}const a=o.oneof?t[o.oneof.localName].value:t[o.localName];Sg(o,a,e,n)}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e},writeField(t,e,n,r){e!==void 0&&Sg(t,e,n,r)}}}function kg(t,e,n,r,o){let{repeated:a,localName:l}=n;switch(n.oneof&&(t=t[n.oneof.localName],t.case!=l&&delete t.value,t.case=l,l="value"),n.kind){case"scalar":case"enum":const u=n.kind=="enum"?$.INT32:n.T;let d=ol;if(n.kind=="scalar"&&n.L>0&&(d=sE),a){let b=t[l];if(r==ot.LengthDelimited&&u!=$.STRING&&u!=$.BYTES){let k=e.uint32()+e.pos;for(;e.pos<k;)b.push(d(e,u))}else b.push(d(e,u))}else t[l]=d(e,u);break;case"message":const f=n.T;a?t[l].push(Va(e,new f,o,n)):Gn(t[l])?Va(e,t[l],o,n):(t[l]=Va(e,new f,o,n),f.fieldWrapper&&!n.oneof&&!n.repeated&&(t[l]=f.fieldWrapper.unwrapField(t[l])));break;case"map":let[m,y]=rE(n,e,o);t[l][m]=y;break}}function Va(t,e,n,r){const o=e.getType().runtime.bin,a=r?.delimited;return o.readMessage(e,t,a?r.no:t.uint32(),n,a),e}function rE(t,e,n){const r=e.uint32(),o=e.pos+r;let a,l;for(;e.pos<o;){const[u]=e.tag();switch(u){case 1:a=ol(e,t.K);break;case 2:switch(t.V.kind){case"scalar":l=ol(e,t.V.T);break;case"enum":l=e.int32();break;case"message":l=Va(e,new t.V.T,n,void 0);break}break}}if(a===void 0&&(a=$r(t.K,Pi.BIGINT)),typeof a!="string"&&typeof a!="number"&&(a=a.toString()),l===void 0)switch(t.V.kind){case"scalar":l=$r(t.V.T,Pi.BIGINT);break;case"enum":l=t.V.T.values[0].no;break;case"message":l=new t.V.T;break}return[a,l]}function sE(t,e){const n=ol(t,e);return typeof n=="bigint"?n.toString():n}function ol(t,e){switch(e){case $.STRING:return t.string();case $.BOOL:return t.bool();case $.DOUBLE:return t.double();case $.FLOAT:return t.float();case $.INT32:return t.int32();case $.INT64:return t.int64();case $.UINT64:return t.uint64();case $.FIXED64:return t.fixed64();case $.BYTES:return t.bytes();case $.FIXED32:return t.fixed32();case $.SFIXED32:return t.sfixed32();case $.SFIXED64:return t.sfixed64();case $.SINT64:return t.sint64();case $.UINT32:return t.uint32();case $.SINT32:return t.sint32()}}function Sg(t,e,n,r){nt(e!==void 0);const o=t.repeated;switch(t.kind){case"scalar":case"enum":let a=t.kind=="enum"?$.INT32:t.T;if(o)if(nt(Array.isArray(e)),t.packed)aE(n,a,t.no,e);else for(const l of e)Zs(n,a,t.no,l);else Zs(n,a,t.no,e);break;case"message":if(o){nt(Array.isArray(e));for(const l of e)Tg(n,r,t,l)}else Tg(n,r,t,e);break;case"map":nt(typeof e=="object"&&e!=null);for(const[l,u]of Object.entries(e))oE(n,r,t,l,u);break}}function oE(t,e,n,r,o){t.tag(n.no,ot.LengthDelimited),t.fork();let a=r;switch(n.K){case $.INT32:case $.FIXED32:case $.UINT32:case $.SFIXED32:case $.SINT32:a=Number.parseInt(r);break;case $.BOOL:nt(r=="true"||r=="false"),a=r=="true";break}switch(Zs(t,n.K,1,a),n.V.kind){case"scalar":Zs(t,n.V.T,2,o);break;case"enum":Zs(t,$.INT32,2,o);break;case"message":nt(o!==void 0),t.tag(2,ot.LengthDelimited).bytes(o.toBinary(e));break}t.join()}function Tg(t,e,n,r){const o=Av(n.T,r);n.delimited?t.tag(n.no,ot.StartGroup).raw(o.toBinary(e)).tag(n.no,ot.EndGroup):t.tag(n.no,ot.LengthDelimited).bytes(o.toBinary(e))}function Zs(t,e,n,r){nt(r!==void 0);let[o,a]=Dv(e);t.tag(n,o)[a](r)}function aE(t,e,n,r){if(!r.length)return;t.tag(n,ot.LengthDelimited).fork();let[,o]=Dv(e);for(let a=0;a<r.length;a++)t[o](r[a]);t.join()}function Dv(t){let e=ot.Varint;switch(t){case $.BYTES:case $.STRING:e=ot.LengthDelimited;break;case $.DOUBLE:case $.FIXED64:case $.SFIXED64:e=ot.Bit64;break;case $.FIXED32:case $.SFIXED32:case $.FLOAT:e=ot.Bit32;break}const n=$[t].toLowerCase();return[e,n]}function lE(){return{setEnumType:Tv,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const r of n.fields.byMember()){const o=r.localName,a=e,l=t;if(l[o]!=null)switch(r.kind){case"oneof":const u=l[o].case;if(u===void 0)continue;const d=r.findField(u);let f=l[o].value;d&&d.kind=="message"&&!Gn(f,d.T)?f=new d.T(f):d&&d.kind==="scalar"&&d.T===$.BYTES&&(f=zs(f)),a[o]={case:u,value:f};break;case"scalar":case"enum":let m=l[o];r.T===$.BYTES&&(m=r.repeated?m.map(zs):zs(m)),a[o]=m;break;case"map":switch(r.V.kind){case"scalar":case"enum":if(r.V.T===$.BYTES)for(const[S,k]of Object.entries(l[o]))a[o][S]=zs(k);else Object.assign(a[o],l[o]);break;case"message":const b=r.V.T;for(const S of Object.keys(l[o])){let k=l[o][S];b.fieldWrapper||(k=new b(k)),a[o][S]=k}break}break;case"message":const y=r.T;if(r.repeated)a[o]=l[o].map(b=>Gn(b,y)?b:new y(b));else{const b=l[o];y.fieldWrapper?y.typeName==="google.protobuf.BytesValue"?a[o]=zs(b):a[o]=b:a[o]=Gn(b,y)?b:new y(b)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(r=>{const o=e[r.localName],a=n[r.localName];if(r.repeated){if(o.length!==a.length)return!1;switch(r.kind){case"message":return o.every((l,u)=>r.T.equals(l,a[u]));case"scalar":return o.every((l,u)=>ki(r.T,l,a[u]));case"enum":return o.every((l,u)=>ki($.INT32,l,a[u]))}throw new Error("repeated cannot contain ".concat(r.kind))}switch(r.kind){case"message":let l=o,u=a;return r.T.fieldWrapper&&(l!==void 0&&!Gn(l)&&(l=r.T.fieldWrapper.wrapField(l)),u!==void 0&&!Gn(u)&&(u=r.T.fieldWrapper.wrapField(u))),r.T.equals(l,u);case"enum":return ki($.INT32,o,a);case"scalar":return ki(r.T,o,a);case"oneof":if(o.case!==a.case)return!1;const d=r.findField(o.case);if(d===void 0)return!0;switch(d.kind){case"message":return d.T.equals(o.value,a.value);case"enum":return ki($.INT32,o.value,a.value);case"scalar":return ki(d.T,o.value,a.value)}throw new Error("oneof cannot contain ".concat(d.kind));case"map":const f=Object.keys(o).concat(Object.keys(a));switch(r.V.kind){case"message":const m=r.V.T;return f.every(b=>m.equals(o[b],a[b]));case"enum":return f.every(b=>ki($.INT32,o[b],a[b]));case"scalar":const y=r.V.T;return f.every(b=>ki(y,o[b],a[b]))}break}})},clone(t){const e=t.getType(),n=new e,r=n;for(const o of e.fields.byMember()){const a=t[o.localName];let l;if(o.repeated)l=a.map(Pa);else if(o.kind=="map"){l=r[o.localName];for(const[u,d]of Object.entries(a))l[u]=Pa(d)}else o.kind=="oneof"?l=o.findField(a.case)?{case:a.case,value:Pa(a.value)}:{case:void 0}:l=Pa(a);r[o.localName]=l}for(const o of e.runtime.bin.listUnknownFields(t))e.runtime.bin.onUnknownField(r,o.no,o.wireType,o.data);return n}}}function Pa(t){if(t===void 0)return t;if(Gn(t))return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function zs(t){return t instanceof Uint8Array?t:new Uint8Array(t)}function cE(t,e,n){return{syntax:t,json:Xw(),bin:iE(),util:Object.assign(Object.assign({},lE()),{newFieldList:e,initFields:n}),makeMessageType(r,o,a){return Mw(this,r,o,a)},makeEnum:Lw,makeEnumType:Cv,getEnumType:Dw,makeExtension(r,o,a){return $w(this,r,o,a)}}}class uE{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const r of this.list())n[r.jsonName]=n[r.name]=r;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const r of this.list())n[r.no]=r;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const r of this.list())r.oneof?r.oneof!==n&&(n=r.oneof,e.push(n)):e.push(r)}return this.members}}function Lv(t,e){const n=Mv(t);return e?n:gE(mE(n))}function dE(t){return Lv(t,!1)}const hE=Mv;function Mv(t){let e=!1;const n=[];for(let r=0;r<t.length;r++){let o=t.charAt(r);switch(o){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(o),e=!1;break;default:e&&(e=!1,o=o.toUpperCase()),n.push(o);break}}return n.join("")}const fE=new Set(["constructor","toString","toJSON","valueOf"]),pE=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Uv=t=>"".concat(t,"$"),mE=t=>pE.has(t)?Uv(t):t,gE=t=>fE.has(t)?Uv(t):t;class vE{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=dE(e)}addField(e){nt(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}function yE(t,e){var n,r,o,a,l,u;const d=[];let f;for(const m of typeof t=="function"?t():t){const y=m;if(y.localName=Lv(m.name,m.oneof!==void 0),y.jsonName=(n=m.jsonName)!==null&&n!==void 0?n:hE(m.name),y.repeated=(r=m.repeated)!==null&&r!==void 0?r:!1,m.kind=="scalar"&&(y.L=(o=m.L)!==null&&o!==void 0?o:Pi.BIGINT),y.delimited=(a=m.delimited)!==null&&a!==void 0?a:!1,y.req=(l=m.req)!==null&&l!==void 0?l:!1,y.opt=(u=m.opt)!==null&&u!==void 0?u:!1,m.packed===void 0&&(y.packed=m.kind=="enum"||m.kind=="scalar"&&m.T!=$.BYTES&&m.T!=$.STRING),m.oneof!==void 0){const b=typeof m.oneof=="string"?m.oneof:m.oneof.name;(!f||f.name!=b)&&(f=new vE(b)),y.oneof=f,f.addField(y)}d.push(y)}return d}const q=cE("proto3",t=>new uE(t,e=>yE(e)),t=>{for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,r=t;if(e.repeated){r[n]=[];continue}switch(e.kind){case"oneof":r[n]={case:void 0};break;case"enum":r[n]=0;break;case"map":r[n]={};break;case"scalar":r[n]=$r(e.T,e.L);break}}});class Lt extends uh{constructor(e){super(),this.seconds=Qe.zero,this.nanos=0,q.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(q.json.debug(e)));const r=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!r)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const o=Date.parse(r[1]+"-"+r[2]+"-"+r[3]+"T"+r[4]+":"+r[5]+":"+r[6]+(r[8]?r[8]:"Z"));if(Number.isNaN(o))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(o<Date.parse("0001-01-01T00:00:00Z")||o>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Qe.parse(o/1e3),this.nanos=0,r[7]&&(this.nanos=parseInt("1"+r[7]+"0".repeat(9-r[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let r="Z";if(this.nanos>0){const o=(this.nanos+1e9).toString().substring(1);o.substring(3)==="000000"?r="."+o.substring(0,3)+"Z":o.substring(6)==="000"?r="."+o.substring(0,6)+"Z":r="."+o+"Z"}return new Date(n).toISOString().replace(".000Z",r)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return Lt.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new Lt({seconds:Qe.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new Lt().fromBinary(e,n)}static fromJson(e,n){return new Lt().fromJson(e,n)}static fromJsonString(e,n){return new Lt().fromJsonString(e,n)}static equals(e,n){return q.util.equals(Lt,e,n)}}Lt.runtime=q;Lt.typeName="google.protobuf.Timestamp";Lt.fields=q.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const bE=q.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Lt},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:xE,repeated:!0},{no:5,name:"events",kind:"message",T:SE,repeated:!0}]),xE=q.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:kE,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),kE=q.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:Lt},{no:3,name:"value",kind:"scalar",T:2}]),SE=q.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:Lt},{no:7,name:"normalized_end_timestamp",kind:"message",T:Lt,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),Fv=q.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),fn=q.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),lt=q.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),hh=q.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),Gs=q.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),ro=q.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),mn=q.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),Or=q.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),TE=q.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),mt=q.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),Rl=q.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:al,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:Xv}]),al=q.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),CE=q.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:q.getEnumType(lt),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),er=q.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:q.getEnumType(Fr)},{no:4,name:"tracks",kind:"message",T:Dr,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:CE},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:q.getEnumType(so)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:q.getEnumType(mn)},{no:18,name:"kind_details",kind:"enum",T:q.getEnumType(wE),repeated:!0}]),Fr=q.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),so=q.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"}]),wE=q.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),Wt=q.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),EE=q.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Yi,repeated:!0}]),Dr=q.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:q.getEnumType(fn)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:q.getEnumType(lt)},{no:10,name:"layers",kind:"message",T:Yi,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:EE,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:q.getEnumType(Wt)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:Xv},{no:19,name:"audio_features",kind:"enum",T:q.getEnumType(mt),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:q.getEnumType(Fv)}]),Yi=q.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:q.getEnumType(hh)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),Dt=q.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:q.getEnumType(Re)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:zv,oneof:"value"},{no:3,name:"speaker",kind:"message",T:_E,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:Vv,oneof:"value"},{no:7,name:"transcription",kind:"message",T:RE,oneof:"value"},{no:8,name:"metrics",kind:"message",T:bE,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:xd,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:qv,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:Hv,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:$v,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:Sd,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:Td,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:Cd,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),Re=q.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),_E=q.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:Bv,repeated:!0}]),Bv=q.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),zv=q.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),Vv=q.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),RE=q.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:PE,repeated:!0}]),PE=q.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),xd=q.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),qv=q.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),Hv=q.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),$v=q.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Wv,oneof:"value"}]),Wv=q.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),Gv=q.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),Kv=q.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:q.getEnumType(Jv)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),Jv=q.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),NE=q.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:q.getEnumType(Qv)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),Qv=q.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),Yv=q.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:Cg},{no:2,name:"screen",kind:"message",T:Cg},{no:3,name:"resume_connection",kind:"enum",T:q.getEnumType(ro)},{no:4,name:"disabled_codecs",kind:"message",T:IE},{no:5,name:"force_relay",kind:"enum",T:q.getEnumType(ro)}]),Cg=q.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:q.getEnumType(ro)}]),IE=q.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:al,repeated:!0},{no:2,name:"publish",kind:"message",T:al,repeated:!0}]),Xv=q.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),kd=q.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),Zv=q.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:q.getEnumType(kd)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),ey=q.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),Sd=q.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:q.getEnumType(Wt)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:Zv,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:ey,oneof:"content_header"}],{localName:"DataStream_Header"}),Td=q.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),Cd=q.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),pn=q.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),wd=q.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),jE=q.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),OE=q.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:tr,oneof:"message"},{no:2,name:"answer",kind:"message",T:tr,oneof:"message"},{no:3,name:"trickle",kind:"message",T:fh,oneof:"message"},{no:4,name:"add_track",kind:"message",T:_d,oneof:"message"},{no:5,name:"mute",kind:"message",T:ph,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Pl,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:ty,oneof:"message"},{no:8,name:"leave",kind:"message",T:Nl,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:iy,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:ay,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:ly,oneof:"message"},{no:13,name:"simulate",kind:"message",T:wn,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:ry,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:dy,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:ny,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:UE,oneof:"message"}]),wg=q.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:AE,oneof:"message"},{no:2,name:"answer",kind:"message",T:tr,oneof:"message"},{no:3,name:"offer",kind:"message",T:tr,oneof:"message"},{no:4,name:"trickle",kind:"message",T:fh,oneof:"message"},{no:5,name:"update",kind:"message",T:ME,oneof:"message"},{no:6,name:"track_published",kind:"message",T:mh,oneof:"message"},{no:8,name:"leave",kind:"message",T:Nl,oneof:"message"},{no:9,name:"mute",kind:"message",T:ph,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:FE,oneof:"message"},{no:11,name:"room_update",kind:"message",T:BE,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:VE,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:HE,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:WE,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:GE,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:LE,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:DE,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:JE,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:XE,oneof:"message"},{no:22,name:"request_response",kind:"message",T:ZE,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:e_,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:KE,oneof:"message"}]),Ed=q.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]),_d=q.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:q.getEnumType(fn)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:q.getEnumType(lt)},{no:9,name:"layers",kind:"message",T:Yi,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Ed,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:q.getEnumType(Wt)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:q.getEnumType(Fv)},{no:17,name:"audio_features",kind:"enum",T:q.getEnumType(mt),repeated:!0}]),fh=q.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:q.getEnumType(pn)},{no:3,name:"final",kind:"scalar",T:8}]),ph=q.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),AE=q.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:Rl},{no:2,name:"participant",kind:"message",T:er},{no:3,name:"other_participants",kind:"message",T:er,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:sy,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Yv},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Kv},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:al,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),DE=q.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:sy,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Yv},{no:3,name:"server_info",kind:"message",T:Kv},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),mh=q.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Dr}]),LE=q.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),tr=q.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13}]),ME=q.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:er,repeated:!0}]),Pl=q.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Gv,repeated:!0}]),ty=q.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:q.getEnumType(hh)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),ny=q.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:q.getEnumType(mt),repeated:!0}]),UE=q.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Nl=q.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:q.getEnumType(mn)},{no:3,name:"action",kind:"enum",T:q.getEnumType(Br)},{no:4,name:"regions",kind:"message",T:QE}]),Br=q.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),iy=q.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Yi,repeated:!0}]),ry=q.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),sy=q.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),FE=q.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:Bv,repeated:!0}]),BE=q.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:Rl}]),zE=q.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:q.getEnumType(Gs)},{no:3,name:"score",kind:"scalar",T:2}]),VE=q.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:zE,repeated:!0}]),qE=q.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:q.getEnumType(wd)}]),HE=q.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:qE,repeated:!0}]),gh=q.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:q.getEnumType(hh)},{no:2,name:"enabled",kind:"scalar",T:8}]),$E=q.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:gh,repeated:!0}]),WE=q.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:gh,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:$E,repeated:!0}]),oy=q.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),ay=q.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:oy,repeated:!0}]),GE=q.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),KE=q.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:Rl},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:er},{no:4,name:"other_participants",kind:"message",T:er,repeated:!0}]),ly=q.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:tr},{no:2,name:"subscription",kind:"message",T:Pl},{no:3,name:"publish_tracks",kind:"message",T:mh,repeated:!0},{no:4,name:"data_channels",kind:"message",T:uy,repeated:!0},{no:5,name:"offer",kind:"message",T:tr},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:cy,repeated:!0}]),cy=q.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),uy=q.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:q.getEnumType(pn)}]),wn=q.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:q.getEnumType(jE),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),dy=q.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),JE=q.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),QE=q.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:YE,repeated:!0}]),YE=q.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),XE=q.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:q.getEnumType(TE)}]),ZE=q.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:q.getEnumType(vh)},{no:3,name:"message",kind:"scalar",T:9}]),vh=q.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"}]),e_=q.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);function t_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qa={exports:{}},n_=qa.exports,Eg;function i_(){return Eg||(Eg=1,function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(n_,function(){var e=function(){},n="undefined",r=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),o=["trace","debug","info","warn","error"],a={},l=null;function u(T,C){var w=T[C];if(typeof w.bind=="function")return w.bind(T);try{return Function.prototype.bind.call(w,T)}catch{return function(){return Function.prototype.apply.apply(w,[T,arguments])}}}function d(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function f(T){return T==="debug"&&(T="log"),typeof console===n?!1:T==="trace"&&r?d:console[T]!==void 0?u(console,T):console.log!==void 0?u(console,"log"):e}function m(){for(var T=this.getLevel(),C=0;C<o.length;C++){var w=o[C];this[w]=C<T?e:this.methodFactory(w,T,this.name)}if(this.log=this.debug,typeof console===n&&T<this.levels.SILENT)return"No console available for logging"}function y(T){return function(){typeof console!==n&&(m.call(this),this[T].apply(this,arguments))}}function b(T,C,w){return f(T)||y.apply(this,arguments)}function S(T,C){var w=this,A,P,E,R="loglevel";typeof T=="string"?R+=":"+T:typeof T=="symbol"&&(R=void 0);function B(Q){var ie=(o[Q]||"silent").toUpperCase();if(!(typeof window===n||!R)){try{window.localStorage[R]=ie;return}catch{}try{window.document.cookie=encodeURIComponent(R)+"="+ie+";"}catch{}}}function I(){var Q;if(!(typeof window===n||!R)){try{Q=window.localStorage[R]}catch{}if(typeof Q===n)try{var ie=window.document.cookie,ce=encodeURIComponent(R),Te=ie.indexOf(ce+"=");Te!==-1&&(Q=/^([^;]+)/.exec(ie.slice(Te+ce.length+1))[1])}catch{}return w.levels[Q]===void 0&&(Q=void 0),Q}}function M(){if(!(typeof window===n||!R)){try{window.localStorage.removeItem(R)}catch{}try{window.document.cookie=encodeURIComponent(R)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}function z(Q){var ie=Q;if(typeof ie=="string"&&w.levels[ie.toUpperCase()]!==void 0&&(ie=w.levels[ie.toUpperCase()]),typeof ie=="number"&&ie>=0&&ie<=w.levels.SILENT)return ie;throw new TypeError("log.setLevel() called with invalid level: "+Q)}w.name=T,w.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},w.methodFactory=C||b,w.getLevel=function(){return E??P??A},w.setLevel=function(Q,ie){return E=z(Q),ie!==!1&&B(E),m.call(w)},w.setDefaultLevel=function(Q){P=z(Q),I()||w.setLevel(Q,!1)},w.resetLevel=function(){E=null,M(),m.call(w)},w.enableAll=function(Q){w.setLevel(w.levels.TRACE,Q)},w.disableAll=function(Q){w.setLevel(w.levels.SILENT,Q)},w.rebuild=function(){if(l!==w&&(A=z(l.getLevel())),m.call(w),l===w)for(var Q in a)a[Q].rebuild()},A=z(l?l.getLevel():"WARN");var K=I();K!=null&&(E=z(K)),m.call(w)}l=new S,l.getLogger=function(C){if(typeof C!="symbol"&&typeof C!="string"||C==="")throw new TypeError("You must supply a name when creating a logger.");var w=a[C];return w||(w=a[C]=new S(C,l.methodFactory)),w};var k=typeof window!==n?window.log:void 0;return l.noConflict=function(){return typeof window!==n&&window.log===l&&(window.log=k),l},l.getLoggers=function(){return a},l.default=l,l})}(qa)),qa.exports}var Il=i_(),Rd;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(Rd||(Rd={}));var gn;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(gn||(gn={}));let De=Il.getLogger("livekit");Object.values(gn).map(t=>Il.getLogger(t));De.setDefaultLevel(Rd.info);function ei(t){const e=Il.getLogger(t);return e.setDefaultLevel(De.getLevel()),e}const r_=Il.getLogger("lk-e2ee"),Vs=7e3,s_=[0,300,2*2*300,3*3*300,4*4*300,Vs,Vs,Vs,Vs,Vs];class o_{constructor(e){this._retryDelays=e!==void 0?[...e]:s_}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function a_(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n}function j(t,e,n,r){function o(a){return a instanceof n?a:new n(function(l){l(a)})}return new(n||(n=Promise))(function(a,l){function u(m){try{f(r.next(m))}catch(y){l(y)}}function d(m){try{f(r.throw(m))}catch(y){l(y)}}function f(m){m.done?a(m.value):o(m.value).then(u,d)}f((r=r.apply(t,e||[])).next())})}function _g(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Kn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof _g=="function"?_g(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(a){n[a]=t[a]&&function(l){return new Promise(function(u,d){l=t[a](l),o(u,d,l.done,l.value)})}}function o(a,l,u,d){Promise.resolve(d).then(function(f){a({value:f,done:u})},l)}}var Na={exports:{}},Rg;function l_(){if(Rg)return Na.exports;Rg=1;var t=typeof Reflect=="object"?Reflect:null,e=t&&typeof t.apply=="function"?t.apply:function(R,B,I){return Function.prototype.apply.call(R,B,I)},n;t&&typeof t.ownKeys=="function"?n=t.ownKeys:Object.getOwnPropertySymbols?n=function(R){return Object.getOwnPropertyNames(R).concat(Object.getOwnPropertySymbols(R))}:n=function(R){return Object.getOwnPropertyNames(R)};function r(E){console&&console.warn&&console.warn(E)}var o=Number.isNaN||function(R){return R!==R};function a(){a.init.call(this)}Na.exports=a,Na.exports.once=w,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var l=10;function u(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(E){if(typeof E!="number"||E<0||o(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");l=E}}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(R){if(typeof R!="number"||R<0||o(R))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+R+".");return this._maxListeners=R,this};function d(E){return E._maxListeners===void 0?a.defaultMaxListeners:E._maxListeners}a.prototype.getMaxListeners=function(){return d(this)},a.prototype.emit=function(R){for(var B=[],I=1;I<arguments.length;I++)B.push(arguments[I]);var M=R==="error",z=this._events;if(z!==void 0)M=M&&z.error===void 0;else if(!M)return!1;if(M){var K;if(B.length>0&&(K=B[0]),K instanceof Error)throw K;var Q=new Error("Unhandled error."+(K?" ("+K.message+")":""));throw Q.context=K,Q}var ie=z[R];if(ie===void 0)return!1;if(typeof ie=="function")e(ie,this,B);else for(var ce=ie.length,Te=k(ie,ce),I=0;I<ce;++I)e(Te[I],this,B);return!0};function f(E,R,B,I){var M,z,K;if(u(B),z=E._events,z===void 0?(z=E._events=Object.create(null),E._eventsCount=0):(z.newListener!==void 0&&(E.emit("newListener",R,B.listener?B.listener:B),z=E._events),K=z[R]),K===void 0)K=z[R]=B,++E._eventsCount;else if(typeof K=="function"?K=z[R]=I?[B,K]:[K,B]:I?K.unshift(B):K.push(B),M=d(E),M>0&&K.length>M&&!K.warned){K.warned=!0;var Q=new Error("Possible EventEmitter memory leak detected. "+K.length+" "+String(R)+" listeners added. Use emitter.setMaxListeners() to increase limit");Q.name="MaxListenersExceededWarning",Q.emitter=E,Q.type=R,Q.count=K.length,r(Q)}return E}a.prototype.addListener=function(R,B){return f(this,R,B,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(R,B){return f(this,R,B,!0)};function m(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(E,R,B){var I={fired:!1,wrapFn:void 0,target:E,type:R,listener:B},M=m.bind(I);return M.listener=B,I.wrapFn=M,M}a.prototype.once=function(R,B){return u(B),this.on(R,y(this,R,B)),this},a.prototype.prependOnceListener=function(R,B){return u(B),this.prependListener(R,y(this,R,B)),this},a.prototype.removeListener=function(R,B){var I,M,z,K,Q;if(u(B),M=this._events,M===void 0)return this;if(I=M[R],I===void 0)return this;if(I===B||I.listener===B)--this._eventsCount===0?this._events=Object.create(null):(delete M[R],M.removeListener&&this.emit("removeListener",R,I.listener||B));else if(typeof I!="function"){for(z=-1,K=I.length-1;K>=0;K--)if(I[K]===B||I[K].listener===B){Q=I[K].listener,z=K;break}if(z<0)return this;z===0?I.shift():T(I,z),I.length===1&&(M[R]=I[0]),M.removeListener!==void 0&&this.emit("removeListener",R,Q||B)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(R){var B,I,M;if(I=this._events,I===void 0)return this;if(I.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):I[R]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete I[R]),this;if(arguments.length===0){var z=Object.keys(I),K;for(M=0;M<z.length;++M)K=z[M],K!=="removeListener"&&this.removeAllListeners(K);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(B=I[R],typeof B=="function")this.removeListener(R,B);else if(B!==void 0)for(M=B.length-1;M>=0;M--)this.removeListener(R,B[M]);return this};function b(E,R,B){var I=E._events;if(I===void 0)return[];var M=I[R];return M===void 0?[]:typeof M=="function"?B?[M.listener||M]:[M]:B?C(M):k(M,M.length)}a.prototype.listeners=function(R){return b(this,R,!0)},a.prototype.rawListeners=function(R){return b(this,R,!1)},a.listenerCount=function(E,R){return typeof E.listenerCount=="function"?E.listenerCount(R):S.call(E,R)},a.prototype.listenerCount=S;function S(E){var R=this._events;if(R!==void 0){var B=R[E];if(typeof B=="function")return 1;if(B!==void 0)return B.length}return 0}a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function k(E,R){for(var B=new Array(R),I=0;I<R;++I)B[I]=E[I];return B}function T(E,R){for(;R+1<E.length;R++)E[R]=E[R+1];E.pop()}function C(E){for(var R=new Array(E.length),B=0;B<R.length;++B)R[B]=E[B].listener||E[B];return R}function w(E,R){return new Promise(function(B,I){function M(K){E.removeListener(R,z),I(K)}function z(){typeof E.removeListener=="function"&&E.removeListener("error",M),B([].slice.call(arguments))}P(E,R,z,{once:!0}),R!=="error"&&A(E,M,{once:!0})})}function A(E,R,B){typeof E.on=="function"&&P(E,"error",R,B)}function P(E,R,B,I){if(typeof E.on=="function")I.once?E.once(R,B):E.on(R,B);else if(typeof E.addEventListener=="function")E.addEventListener(R,function M(z){I.once&&E.removeEventListener(R,M),B(z)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return Na.exports}var On=l_();let hy=!0,fy=!0;function Ks(t,e,n){const r=t.match(e);return r&&r.length>=n&&parseFloat(r[n],10)}function sr(t,e,n){if(!t.RTCPeerConnection)return;const r=t.RTCPeerConnection.prototype,o=r.addEventListener;r.addEventListener=function(l,u){if(l!==e)return o.apply(this,arguments);const d=f=>{const m=n(f);m&&(u.handleEvent?u.handleEvent(m):u(m))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(u,d),o.apply(this,[l,d])};const a=r.removeEventListener;r.removeEventListener=function(l,u){if(l!==e||!this._eventMap||!this._eventMap[e])return a.apply(this,arguments);if(!this._eventMap[e].has(u))return a.apply(this,arguments);const d=this._eventMap[e].get(u);return this._eventMap[e].delete(u),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,a.apply(this,[l,d])},Object.defineProperty(r,"on"+e,{get(){return this["_on"+e]},set(l){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),l&&this.addEventListener(e,this["_on"+e]=l)},enumerable:!0,configurable:!0})}function c_(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(hy=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function u_(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(fy=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function py(){if(typeof window=="object"){if(hy)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function yh(t,e){fy&&console.warn(t+" is deprecated, please use "+e+" instead.")}function d_(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.userAgentData&&n.userAgentData.brands){const r=n.userAgentData.brands.find(o=>o.brand==="Chromium");if(r)return{browser:"chrome",version:parseInt(r.version,10)}}if(n.mozGetUserMedia)e.browser="firefox",e.version=parseInt(Ks(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=parseInt(Ks(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=parseInt(Ks(n.userAgent,/AppleWebKit\/(\d+)\./,1)),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype,e._safariVersion=Ks(n.userAgent,/Version\/(\d+(\.?\d+))/,1);else return e.browser="Not a supported browser.",e;return e}function Pg(t){return Object.prototype.toString.call(t)==="[object Object]"}function my(t){return Pg(t)?Object.keys(t).reduce(function(e,n){const r=Pg(t[n]),o=r?my(t[n]):t[n],a=r&&!Object.keys(o).length;return o===void 0||a?e:Object.assign(e,{[n]:o})},{}):t}function Pd(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(r=>{r.endsWith("Id")?Pd(t,t.get(e[r]),n):r.endsWith("Ids")&&e[r].forEach(o=>{Pd(t,t.get(o),n)})}))}function Ng(t,e,n){const r=n?"outbound-rtp":"inbound-rtp",o=new Map;if(e===null)return o;const a=[];return t.forEach(l=>{l.type==="track"&&l.trackIdentifier===e.id&&a.push(l)}),a.forEach(l=>{t.forEach(u=>{u.type===r&&u.trackId===l.id&&Pd(t,u,o)})}),o}const Ig=py;function gy(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const r=function(u){if(typeof u!="object"||u.mandatory||u.optional)return u;const d={};return Object.keys(u).forEach(f=>{if(f==="require"||f==="advanced"||f==="mediaSource")return;const m=typeof u[f]=="object"?u[f]:{ideal:u[f]};m.exact!==void 0&&typeof m.exact=="number"&&(m.min=m.max=m.exact);const y=function(b,S){return b?b+S.charAt(0).toUpperCase()+S.slice(1):S==="deviceId"?"sourceId":S};if(m.ideal!==void 0){d.optional=d.optional||[];let b={};typeof m.ideal=="number"?(b[y("min",f)]=m.ideal,d.optional.push(b),b={},b[y("max",f)]=m.ideal,d.optional.push(b)):(b[y("",f)]=m.ideal,d.optional.push(b))}m.exact!==void 0&&typeof m.exact!="number"?(d.mandatory=d.mandatory||{},d.mandatory[y("",f)]=m.exact):["min","max"].forEach(b=>{m[b]!==void 0&&(d.mandatory=d.mandatory||{},d.mandatory[y(b,f)]=m[b])})}),u.advanced&&(d.optional=(d.optional||[]).concat(u.advanced)),d},o=function(u,d){if(e.version>=61)return d(u);if(u=JSON.parse(JSON.stringify(u)),u&&typeof u.audio=="object"){const f=function(m,y,b){y in m&&!(b in m)&&(m[b]=m[y],delete m[y])};u=JSON.parse(JSON.stringify(u)),f(u.audio,"autoGainControl","googAutoGainControl"),f(u.audio,"noiseSuppression","googNoiseSuppression"),u.audio=r(u.audio)}if(u&&typeof u.video=="object"){let f=u.video.facingMode;f=f&&(typeof f=="object"?f:{ideal:f});const m=e.version<66;if(f&&(f.exact==="user"||f.exact==="environment"||f.ideal==="user"||f.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!m)){delete u.video.facingMode;let y;if(f.exact==="environment"||f.ideal==="environment"?y=["back","rear"]:(f.exact==="user"||f.ideal==="user")&&(y=["front"]),y)return n.mediaDevices.enumerateDevices().then(b=>{b=b.filter(k=>k.kind==="videoinput");let S=b.find(k=>y.some(T=>k.label.toLowerCase().includes(T)));return!S&&b.length&&y.includes("back")&&(S=b[b.length-1]),S&&(u.video.deviceId=f.exact?{exact:S.deviceId}:{ideal:S.deviceId}),u.video=r(u.video),Ig("chrome: "+JSON.stringify(u)),d(u)})}u.video=r(u.video)}return Ig("chrome: "+JSON.stringify(u)),d(u)},a=function(u){return e.version>=64?u:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[u.name]||u.name,message:u.message,constraint:u.constraint||u.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},l=function(u,d,f){o(u,m=>{n.webkitGetUserMedia(m,d,y=>{f&&f(a(y))})})};if(n.getUserMedia=l.bind(n),n.mediaDevices.getUserMedia){const u=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(d){return o(d,f=>u(f).then(m=>{if(f.audio&&!m.getAudioTracks().length||f.video&&!m.getVideoTracks().length)throw m.getTracks().forEach(y=>{y.stop()}),new DOMException("","NotFoundError");return m},m=>Promise.reject(a(m))))}}}function vy(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function yy(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=r=>{r.stream.addEventListener("addtrack",o=>{let a;t.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(u=>u.track&&u.track.id===o.track.id):a={track:o.track};const l=new Event("track");l.track=o.track,l.receiver=a,l.transceiver={receiver:a},l.streams=[r.stream],this.dispatchEvent(l)}),r.stream.getTracks().forEach(o=>{let a;t.RTCPeerConnection.prototype.getReceivers?a=this.getReceivers().find(u=>u.track&&u.track.id===o.id):a={track:o};const l=new Event("track");l.track=o,l.receiver=a,l.transceiver={receiver:a},l.streams=[r.stream],this.dispatchEvent(l)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else sr(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function by(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(o,a){return{track:a,get dtmf(){return this._dtmf===void 0&&(a.kind==="audio"?this._dtmf=o.createDTMFSender(a):this._dtmf=null),this._dtmf},_pc:o}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const o=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(u,d){let f=o.apply(this,arguments);return f||(f=e(this,u),this._senders.push(f)),f};const a=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(u){a.apply(this,arguments);const d=this._senders.indexOf(u);d!==-1&&this._senders.splice(d,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._senders=this._senders||[],n.apply(this,[a]),a.getTracks().forEach(l=>{this._senders.push(e(this,l))})};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){this._senders=this._senders||[],r.apply(this,[a]),a.getTracks().forEach(l=>{const u=this._senders.find(d=>d.track===l);u&&this._senders.splice(this._senders.indexOf(u),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(o=>o._pc=this),r},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function xy(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const a=n.apply(this,[]);return a.forEach(l=>l._pc=this),a});const r=t.RTCPeerConnection.prototype.addTrack;r&&(t.RTCPeerConnection.prototype.addTrack=function(){const a=r.apply(this,arguments);return a._pc=this,a}),t.RTCRtpSender.prototype.getStats=function(){const a=this;return this._pc.getStats().then(l=>Ng(l,a.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const o=n.apply(this,[]);return o.forEach(a=>a._pc=this),o}),sr(t,"track",r=>(r.receiver._pc=r.srcElement,r)),t.RTCRtpReceiver.prototype.getStats=function(){const o=this;return this._pc.getStats().then(a=>Ng(a,o.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const r=arguments[0];let o,a,l;return this.getSenders().forEach(u=>{u.track===r&&(o?l=!0:o=u)}),this.getReceivers().forEach(u=>(u.track===r&&(a?l=!0:a=u),u.track===r)),l||o&&a?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):o?o.getStats():a?a.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function ky(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(l=>this._shimmedLocalStreams[l][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(l,u){if(!u)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const d=e.apply(this,arguments);return this._shimmedLocalStreams[u.id]?this._shimmedLocalStreams[u.id].indexOf(d)===-1&&this._shimmedLocalStreams[u.id].push(d):this._shimmedLocalStreams[u.id]=[u,d],d};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(l){this._shimmedLocalStreams=this._shimmedLocalStreams||{},l.getTracks().forEach(f=>{if(this.getSenders().find(y=>y.track===f))throw new DOMException("Track already exists.","InvalidAccessError")});const u=this.getSenders();n.apply(this,arguments);const d=this.getSenders().filter(f=>u.indexOf(f)===-1);this._shimmedLocalStreams[l.id]=[l].concat(d)};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[l.id],r.apply(this,arguments)};const o=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(l){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},l&&Object.keys(this._shimmedLocalStreams).forEach(u=>{const d=this._shimmedLocalStreams[u].indexOf(l);d!==-1&&this._shimmedLocalStreams[u].splice(d,1),this._shimmedLocalStreams[u].length===1&&delete this._shimmedLocalStreams[u]}),o.apply(this,arguments)}}function Sy(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return ky(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const m=n.apply(this);return this._reverseStreams=this._reverseStreams||{},m.map(y=>this._reverseStreams[y.id])};const r=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(m){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},m.getTracks().forEach(y=>{if(this.getSenders().find(S=>S.track===y))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[m.id]){const y=new t.MediaStream(m.getTracks());this._streams[m.id]=y,this._reverseStreams[y.id]=m,m=y}r.apply(this,[m])};const o=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(m){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},o.apply(this,[this._streams[m.id]||m]),delete this._reverseStreams[this._streams[m.id]?this._streams[m.id].id:m.id],delete this._streams[m.id]},t.RTCPeerConnection.prototype.addTrack=function(m,y){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const b=[].slice.call(arguments,1);if(b.length!==1||!b[0].getTracks().find(T=>T===m))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(T=>T.track===m))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const k=this._streams[y.id];if(k)k.addTrack(m),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const T=new t.MediaStream([m]);this._streams[y.id]=T,this._reverseStreams[T.id]=y,this.addStream(T)}return this.getSenders().find(T=>T.track===m)};function a(f,m){let y=m.sdp;return Object.keys(f._reverseStreams||[]).forEach(b=>{const S=f._reverseStreams[b],k=f._streams[S.id];y=y.replace(new RegExp(k.id,"g"),S.id)}),new RTCSessionDescription({type:m.type,sdp:y})}function l(f,m){let y=m.sdp;return Object.keys(f._reverseStreams||[]).forEach(b=>{const S=f._reverseStreams[b],k=f._streams[S.id];y=y.replace(new RegExp(S.id,"g"),k.id)}),new RTCSessionDescription({type:m.type,sdp:y})}["createOffer","createAnswer"].forEach(function(f){const m=t.RTCPeerConnection.prototype[f],y={[f](){const b=arguments;return arguments.length&&typeof arguments[0]=="function"?m.apply(this,[k=>{const T=a(this,k);b[0].apply(null,[T])},k=>{b[1]&&b[1].apply(null,k)},arguments[2]]):m.apply(this,arguments).then(k=>a(this,k))}};t.RTCPeerConnection.prototype[f]=y[f]});const u=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?u.apply(this,arguments):(arguments[0]=l(this,arguments[0]),u.apply(this,arguments))};const d=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const f=d.get.apply(this);return f.type===""?f:a(this,f)}}),t.RTCPeerConnection.prototype.removeTrack=function(m){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!m._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(m._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let b;Object.keys(this._streams).forEach(S=>{this._streams[S].getTracks().find(T=>m.track===T)&&(b=this._streams[S])}),b&&(b.getTracks().length===1?this.removeStream(this._reverseStreams[b.id]):b.removeTrack(m.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Nd(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const r=t.RTCPeerConnection.prototype[n],o={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),r.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=o[n]})}function Ty(t,e){sr(t,"negotiationneeded",n=>{const r=n.target;if(!((e.version<72||r.getConfiguration&&r.getConfiguration().sdpSemantics==="plan-b")&&r.signalingState!=="stable"))return n})}var jg=Object.freeze({__proto__:null,fixNegotiationNeeded:Ty,shimAddTrackRemoveTrack:Sy,shimAddTrackRemoveTrackWithNative:ky,shimGetSendersWithDtmf:by,shimGetUserMedia:gy,shimMediaStream:vy,shimOnTrack:yy,shimPeerConnection:Nd,shimSenderReceiverGetStats:xy});function Cy(t,e){const n=t&&t.navigator,r=t&&t.MediaStreamTrack;if(n.getUserMedia=function(o,a,l){yh("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(o).then(a,l)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const o=function(l,u,d){u in l&&!(d in l)&&(l[d]=l[u],delete l[u])},a=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(l){return typeof l=="object"&&typeof l.audio=="object"&&(l=JSON.parse(JSON.stringify(l)),o(l.audio,"autoGainControl","mozAutoGainControl"),o(l.audio,"noiseSuppression","mozNoiseSuppression")),a(l)},r&&r.prototype.getSettings){const l=r.prototype.getSettings;r.prototype.getSettings=function(){const u=l.apply(this,arguments);return o(u,"mozAutoGainControl","autoGainControl"),o(u,"mozNoiseSuppression","noiseSuppression"),u}}if(r&&r.prototype.applyConstraints){const l=r.prototype.applyConstraints;r.prototype.applyConstraints=function(u){return this.kind==="audio"&&typeof u=="object"&&(u=JSON.parse(JSON.stringify(u)),o(u,"autoGainControl","mozAutoGainControl"),o(u,"noiseSuppression","mozNoiseSuppression")),l.apply(this,[u])}}}}function h_(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(r){if(!(r&&r.video)){const o=new DOMException("getDisplayMedia without video constraints is undefined");return o.name="NotFoundError",o.code=8,Promise.reject(o)}return r.video===!0?r.video={mediaSource:e}:r.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(r)})}function wy(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Id(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(o){const a=t.RTCPeerConnection.prototype[o],l={[o](){return arguments[0]=new(o==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),a.apply(this,arguments)}};t.RTCPeerConnection.prototype[o]=l[o]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},r=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[a,l,u]=arguments;return r.apply(this,[a||null]).then(d=>{if(e.version<53&&!l)try{d.forEach(f=>{f.type=n[f.type]||f.type})}catch(f){if(f.name!=="TypeError")throw f;d.forEach((m,y)=>{d.set(y,Object.assign({},m,{type:n[m.type]||m.type}))})}return d}).then(l,u)}}function Ey(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const o=e.apply(this,[]);return o.forEach(a=>a._pc=this),o});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const o=n.apply(this,arguments);return o._pc=this,o}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function _y(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=e.apply(this,[]);return r.forEach(o=>o._pc=this),r}),sr(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function Ry(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){yh("removeStream","removeTrack"),this.getSenders().forEach(r=>{r.track&&n.getTracks().includes(r.track)&&this.removeTrack(r)})})}function Py(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function Ny(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let r=arguments[1]&&arguments[1].sendEncodings;r===void 0&&(r=[]),r=[...r];const o=r.length>0;o&&r.forEach(l=>{if("rid"in l&&!/^[a-z0-9]{0,16}$/i.test(l.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in l&&!(parseFloat(l.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in l&&!(parseFloat(l.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const a=e.apply(this,arguments);if(o){const{sender:l}=a,u=l.getParameters();(!("encodings"in u)||u.encodings.length===1&&Object.keys(u.encodings[0]).length===0)&&(u.encodings=r,l.sendEncodings=r,this.setParametersPromises.push(l.setParameters(u).then(()=>{delete l.sendEncodings}).catch(()=>{delete l.sendEncodings})))}return a})}function Iy(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const r=e.apply(this,arguments);return"encodings"in r||(r.encodings=[].concat(this.sendEncodings||[{}])),r})}function jy(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function Oy(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Og=Object.freeze({__proto__:null,shimAddTransceiver:Ny,shimCreateAnswer:Oy,shimCreateOffer:jy,shimGetDisplayMedia:h_,shimGetParameters:Iy,shimGetUserMedia:Cy,shimOnTrack:wy,shimPeerConnection:Id,shimRTCDataChannel:Py,shimReceiverGetStats:_y,shimRemoveStream:Ry,shimSenderGetStats:Ey});function Ay(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(r){this._localStreams||(this._localStreams=[]),this._localStreams.includes(r)||this._localStreams.push(r),r.getAudioTracks().forEach(o=>e.call(this,o,r)),r.getVideoTracks().forEach(o=>e.call(this,o,r))},t.RTCPeerConnection.prototype.addTrack=function(r){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return a&&a.forEach(u=>{this._localStreams?this._localStreams.includes(u)||this._localStreams.push(u):this._localStreams=[u]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const r=this._localStreams.indexOf(n);if(r===-1)return;this._localStreams.splice(r,1);const o=n.getTracks();this.getSenders().forEach(a=>{o.includes(a.track)&&this.removeTrack(a)})})}}function Dy(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=r=>{r.streams.forEach(o=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(o))return;this._remoteStreams.push(o);const a=new Event("addstream");a.stream=o,this.dispatchEvent(a)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const r=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(o){o.streams.forEach(a=>{if(r._remoteStreams||(r._remoteStreams=[]),r._remoteStreams.indexOf(a)>=0)return;r._remoteStreams.push(a);const l=new Event("addstream");l.stream=a,r.dispatchEvent(l)})}),e.apply(r,arguments)}}}function Ly(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,r=e.createAnswer,o=e.setLocalDescription,a=e.setRemoteDescription,l=e.addIceCandidate;e.createOffer=function(f,m){const y=arguments.length>=2?arguments[2]:arguments[0],b=n.apply(this,[y]);return m?(b.then(f,m),Promise.resolve()):b},e.createAnswer=function(f,m){const y=arguments.length>=2?arguments[2]:arguments[0],b=r.apply(this,[y]);return m?(b.then(f,m),Promise.resolve()):b};let u=function(d,f,m){const y=o.apply(this,[d]);return m?(y.then(f,m),Promise.resolve()):y};e.setLocalDescription=u,u=function(d,f,m){const y=a.apply(this,[d]);return m?(y.then(f,m),Promise.resolve()):y},e.setRemoteDescription=u,u=function(d,f,m){const y=l.apply(this,[d]);return m?(y.then(f,m),Promise.resolve()):y},e.addIceCandidate=u}function My(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,r=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=o=>r(Uy(o))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(r,o,a){e.mediaDevices.getUserMedia(r).then(o,a)}).bind(e))}function Uy(t){return t&&t.video!==void 0?Object.assign({},t,{video:my(t.video)}):t}function Fy(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(r,o){if(r&&r.iceServers){const a=[];for(let l=0;l<r.iceServers.length;l++){let u=r.iceServers[l];u.urls===void 0&&u.url?(yh("RTCIceServer.url","RTCIceServer.urls"),u=JSON.parse(JSON.stringify(u)),u.urls=u.url,delete u.url,a.push(u)):a.push(r.iceServers[l])}r.iceServers=a}return new e(r,o)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function By(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function zy(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(r){if(r){typeof r.offerToReceiveAudio<"u"&&(r.offerToReceiveAudio=!!r.offerToReceiveAudio);const o=this.getTransceivers().find(l=>l.receiver.track.kind==="audio");r.offerToReceiveAudio===!1&&o?o.direction==="sendrecv"?o.setDirection?o.setDirection("sendonly"):o.direction="sendonly":o.direction==="recvonly"&&(o.setDirection?o.setDirection("inactive"):o.direction="inactive"):r.offerToReceiveAudio===!0&&!o&&this.addTransceiver("audio",{direction:"recvonly"}),typeof r.offerToReceiveVideo<"u"&&(r.offerToReceiveVideo=!!r.offerToReceiveVideo);const a=this.getTransceivers().find(l=>l.receiver.track.kind==="video");r.offerToReceiveVideo===!1&&a?a.direction==="sendrecv"?a.setDirection?a.setDirection("sendonly"):a.direction="sendonly":a.direction==="recvonly"&&(a.setDirection?a.setDirection("inactive"):a.direction="inactive"):r.offerToReceiveVideo===!0&&!a&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function Vy(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var Ag=Object.freeze({__proto__:null,shimAudioContext:Vy,shimCallbacksAPI:Ly,shimConstraints:Uy,shimCreateOfferLegacy:zy,shimGetUserMedia:My,shimLocalStreamsAPI:Ay,shimRTCIceServerUrls:Fy,shimRemoteStreamsAPI:Dy,shimTrackEventTransceiver:By}),zu={exports:{}},Dg;function f_(){return Dg||(Dg=1,function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(r=>r.trim())},e.splitSections=function(n){return n.split(`
m=`).map((o,a)=>(a>0?"m="+o:o).trim()+`\r
`)},e.getDescription=function(n){const r=e.splitSections(n);return r&&r[0]},e.getMediaSections=function(n){const r=e.splitSections(n);return r.shift(),r},e.matchPrefix=function(n,r){return e.splitLines(n).filter(o=>o.indexOf(r)===0)},e.parseCandidate=function(n){let r;n.indexOf("a=candidate:")===0?r=n.substring(12).split(" "):r=n.substring(10).split(" ");const o={foundation:r[0],component:{1:"rtp",2:"rtcp"}[r[1]]||r[1],protocol:r[2].toLowerCase(),priority:parseInt(r[3],10),ip:r[4],address:r[4],port:parseInt(r[5],10),type:r[7]};for(let a=8;a<r.length;a+=2)switch(r[a]){case"raddr":o.relatedAddress=r[a+1];break;case"rport":o.relatedPort=parseInt(r[a+1],10);break;case"tcptype":o.tcpType=r[a+1];break;case"ufrag":o.ufrag=r[a+1],o.usernameFragment=r[a+1];break;default:o[r[a]]===void 0&&(o[r[a]]=r[a+1]);break}return o},e.writeCandidate=function(n){const r=[];r.push(n.foundation);const o=n.component;o==="rtp"?r.push(1):o==="rtcp"?r.push(2):r.push(o),r.push(n.protocol.toUpperCase()),r.push(n.priority),r.push(n.address||n.ip),r.push(n.port);const a=n.type;return r.push("typ"),r.push(a),a!=="host"&&n.relatedAddress&&n.relatedPort&&(r.push("raddr"),r.push(n.relatedAddress),r.push("rport"),r.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(r.push("tcptype"),r.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(r.push("ufrag"),r.push(n.usernameFragment||n.ufrag)),"candidate:"+r.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let r=n.substring(9).split(" ");const o={payloadType:parseInt(r.shift(),10)};return r=r[0].split("/"),o.name=r[0],o.clockRate=parseInt(r[1],10),o.channels=r.length===3?parseInt(r[2],10):1,o.numChannels=o.channels,o},e.writeRtpMap=function(n){let r=n.payloadType;n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType);const o=n.channels||n.numChannels||1;return"a=rtpmap:"+r+" "+n.name+"/"+n.clockRate+(o!==1?"/"+o:"")+`\r
`},e.parseExtmap=function(n){const r=n.substring(9).split(" ");return{id:parseInt(r[0],10),direction:r[0].indexOf("/")>0?r[0].split("/")[1]:"sendrecv",uri:r[1],attributes:r.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const r={};let o;const a=n.substring(n.indexOf(" ")+1).split(";");for(let l=0;l<a.length;l++)o=a[l].trim().split("="),r[o[0].trim()]=o[1];return r},e.writeFmtp=function(n){let r="",o=n.payloadType;if(n.preferredPayloadType!==void 0&&(o=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const a=[];Object.keys(n.parameters).forEach(l=>{n.parameters[l]!==void 0?a.push(l+"="+n.parameters[l]):a.push(l)}),r+="a=fmtp:"+o+" "+a.join(";")+`\r
`}return r},e.parseRtcpFb=function(n){const r=n.substring(n.indexOf(" ")+1).split(" ");return{type:r.shift(),parameter:r.join(" ")}},e.writeRtcpFb=function(n){let r="",o=n.payloadType;return n.preferredPayloadType!==void 0&&(o=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(a=>{r+="a=rtcp-fb:"+o+" "+a.type+(a.parameter&&a.parameter.length?" "+a.parameter:"")+`\r
`}),r},e.parseSsrcMedia=function(n){const r=n.indexOf(" "),o={ssrc:parseInt(n.substring(7,r),10)},a=n.indexOf(":",r);return a>-1?(o.attribute=n.substring(r+1,a),o.value=n.substring(a+1)):o.attribute=n.substring(r+1),o},e.parseSsrcGroup=function(n){const r=n.substring(13).split(" ");return{semantics:r.shift(),ssrcs:r.map(o=>parseInt(o,10))}},e.getMid=function(n){const r=e.matchPrefix(n,"a=mid:")[0];if(r)return r.substring(6)},e.parseFingerprint=function(n){const r=n.substring(14).split(" ");return{algorithm:r[0].toLowerCase(),value:r[1].toUpperCase()}},e.getDtlsParameters=function(n,r){return{role:"auto",fingerprints:e.matchPrefix(n+r,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,r){let o="a=setup:"+r+`\r
`;return n.fingerprints.forEach(a=>{o+="a=fingerprint:"+a.algorithm+" "+a.value+`\r
`}),o},e.parseCryptoLine=function(n){const r=n.substring(9).split(" ");return{tag:parseInt(r[0],10),cryptoSuite:r[1],keyParams:r[2],sessionParams:r.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const r=n.substring(7).split("|");return{keyMethod:"inline",keySalt:r[0],lifeTime:r[1],mkiValue:r[2]?r[2].split(":")[0]:void 0,mkiLength:r[2]?r[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,r){return e.matchPrefix(n+r,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,r){const o=e.matchPrefix(n+r,"a=ice-ufrag:")[0],a=e.matchPrefix(n+r,"a=ice-pwd:")[0];return o&&a?{usernameFragment:o.substring(12),password:a.substring(10)}:null},e.writeIceParameters=function(n){let r="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(r+=`a=ice-lite\r
`),r},e.parseRtpParameters=function(n){const r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},a=e.splitLines(n)[0].split(" ");r.profile=a[2];for(let u=3;u<a.length;u++){const d=a[u],f=e.matchPrefix(n,"a=rtpmap:"+d+" ")[0];if(f){const m=e.parseRtpMap(f),y=e.matchPrefix(n,"a=fmtp:"+d+" ");switch(m.parameters=y.length?e.parseFmtp(y[0]):{},m.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+d+" ").map(e.parseRtcpFb),r.codecs.push(m),m.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(m.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(u=>{r.headerExtensions.push(e.parseExtmap(u))});const l=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return r.codecs.forEach(u=>{l.forEach(d=>{u.rtcpFeedback.find(m=>m.type===d.type&&m.parameter===d.parameter)||u.rtcpFeedback.push(d)})}),r},e.writeRtpDescription=function(n,r){let o="";o+="m="+n+" ",o+=r.codecs.length>0?"9":"0",o+=" "+(r.profile||"UDP/TLS/RTP/SAVPF")+" ",o+=r.codecs.map(l=>l.preferredPayloadType!==void 0?l.preferredPayloadType:l.payloadType).join(" ")+`\r
`,o+=`c=IN IP4 0.0.0.0\r
`,o+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,r.codecs.forEach(l=>{o+=e.writeRtpMap(l),o+=e.writeFmtp(l),o+=e.writeRtcpFb(l)});let a=0;return r.codecs.forEach(l=>{l.maxptime>a&&(a=l.maxptime)}),a>0&&(o+="a=maxptime:"+a+`\r
`),r.headerExtensions&&r.headerExtensions.forEach(l=>{o+=e.writeExtmap(l)}),o},e.parseRtpEncodingParameters=function(n){const r=[],o=e.parseRtpParameters(n),a=o.fecMechanisms.indexOf("RED")!==-1,l=o.fecMechanisms.indexOf("ULPFEC")!==-1,u=e.matchPrefix(n,"a=ssrc:").map(b=>e.parseSsrcMedia(b)).filter(b=>b.attribute==="cname"),d=u.length>0&&u[0].ssrc;let f;const m=e.matchPrefix(n,"a=ssrc-group:FID").map(b=>b.substring(17).split(" ").map(k=>parseInt(k,10)));m.length>0&&m[0].length>1&&m[0][0]===d&&(f=m[0][1]),o.codecs.forEach(b=>{if(b.name.toUpperCase()==="RTX"&&b.parameters.apt){let S={ssrc:d,codecPayloadType:parseInt(b.parameters.apt,10)};d&&f&&(S.rtx={ssrc:f}),r.push(S),a&&(S=JSON.parse(JSON.stringify(S)),S.fec={ssrc:d,mechanism:l?"red+ulpfec":"red"},r.push(S))}}),r.length===0&&d&&r.push({ssrc:d});let y=e.matchPrefix(n,"b=");return y.length&&(y[0].indexOf("b=TIAS:")===0?y=parseInt(y[0].substring(7),10):y[0].indexOf("b=AS:")===0?y=parseInt(y[0].substring(5),10)*1e3*.95-50*40*8:y=void 0,r.forEach(b=>{b.maxBitrate=y})),r},e.parseRtcpParameters=function(n){const r={},o=e.matchPrefix(n,"a=ssrc:").map(u=>e.parseSsrcMedia(u)).filter(u=>u.attribute==="cname")[0];o&&(r.cname=o.value,r.ssrc=o.ssrc);const a=e.matchPrefix(n,"a=rtcp-rsize");r.reducedSize=a.length>0,r.compound=a.length===0;const l=e.matchPrefix(n,"a=rtcp-mux");return r.mux=l.length>0,r},e.writeRtcpParameters=function(n){let r="";return n.reducedSize&&(r+=`a=rtcp-rsize\r
`),n.mux&&(r+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(r+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),r},e.parseMsid=function(n){let r;const o=e.matchPrefix(n,"a=msid:");if(o.length===1)return r=o[0].substring(7).split(" "),{stream:r[0],track:r[1]};const a=e.matchPrefix(n,"a=ssrc:").map(l=>e.parseSsrcMedia(l)).filter(l=>l.attribute==="msid");if(a.length>0)return r=a[0].value.split(" "),{stream:r[0],track:r[1]}},e.parseSctpDescription=function(n){const r=e.parseMLine(n),o=e.matchPrefix(n,"a=max-message-size:");let a;o.length>0&&(a=parseInt(o[0].substring(19),10)),isNaN(a)&&(a=65536);const l=e.matchPrefix(n,"a=sctp-port:");if(l.length>0)return{port:parseInt(l[0].substring(12),10),protocol:r.fmt,maxMessageSize:a};const u=e.matchPrefix(n,"a=sctpmap:");if(u.length>0){const d=u[0].substring(10).split(" ");return{port:parseInt(d[0],10),protocol:d[1],maxMessageSize:a}}},e.writeSctpDescription=function(n,r){let o=[];return n.protocol!=="DTLS/SCTP"?o=["m="+n.kind+" 9 "+n.protocol+" "+r.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+r.port+`\r
`]:o=["m="+n.kind+" 9 "+n.protocol+" "+r.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+r.port+" "+r.protocol+` 65535\r
`],r.maxMessageSize!==void 0&&o.push("a=max-message-size:"+r.maxMessageSize+`\r
`),o.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,r,o){let a;const l=r!==void 0?r:2;return n?a=n:a=e.generateSessionId(),`v=0\r
o=`+(o||"thisisadapterortc")+" "+a+" "+l+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,r){const o=e.splitLines(n);for(let a=0;a<o.length;a++)switch(o[a]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return o[a].substring(2)}return r?e.getDirection(r):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const o=e.splitLines(n)[0].substring(2).split(" ");return{kind:o[0],port:parseInt(o[1],10),protocol:o[2],fmt:o.slice(3).join(" ")}},e.parseOLine=function(n){const o=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:o[0],sessionId:o[1],sessionVersion:parseInt(o[2],10),netType:o[3],addressType:o[4],address:o[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const r=e.splitLines(n);for(let o=0;o<r.length;o++)if(r[o].length<2||r[o].charAt(1)!=="=")return!1;return!0},t.exports=e}(zu)),zu.exports}var qy=f_(),zr=t_(qy),p_=_w({__proto__:null,default:zr},[qy]);function Ha(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(r){if(typeof r=="object"&&r.candidate&&r.candidate.indexOf("a=")===0&&(r=JSON.parse(JSON.stringify(r)),r.candidate=r.candidate.substring(2)),r.candidate&&r.candidate.length){const o=new e(r),a=zr.parseCandidate(r.candidate);for(const l in a)l in o||Object.defineProperty(o,l,{value:a[l]});return o.toJSON=function(){return{candidate:o.candidate,sdpMid:o.sdpMid,sdpMLineIndex:o.sdpMLineIndex,usernameFragment:o.usernameFragment}},o}return new e(r)},t.RTCIceCandidate.prototype=e.prototype,sr(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function jd(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||sr(t,"icecandidate",e=>{if(e.candidate){const n=zr.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function $a(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(u){if(!u||!u.sdp)return!1;const d=zr.splitSections(u.sdp);return d.shift(),d.some(f=>{const m=zr.parseMLine(f);return m&&m.kind==="application"&&m.protocol.indexOf("SCTP")!==-1})},r=function(u){const d=u.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(d===null||d.length<2)return-1;const f=parseInt(d[1],10);return f!==f?-1:f},o=function(u){let d=65536;return e.browser==="firefox"&&(e.version<57?u===-1?d=16384:d=2147483637:e.version<60?d=e.version===57?65535:65536:d=2147483637),d},a=function(u,d){let f=65536;e.browser==="firefox"&&e.version===57&&(f=65535);const m=zr.matchPrefix(u.sdp,"a=max-message-size:");return m.length>0?f=parseInt(m[0].substring(19),10):e.browser==="firefox"&&d!==-1&&(f=2147483637),f},l=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:d}=this.getConfiguration();d==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const d=r(arguments[0]),f=o(d),m=a(arguments[0],d);let y;f===0&&m===0?y=Number.POSITIVE_INFINITY:f===0||m===0?y=Math.max(f,m):y=Math.min(f,m);const b={};Object.defineProperty(b,"maxMessageSize",{get(){return y}}),this._sctp=b}return l.apply(this,arguments)}}function Wa(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(r,o){const a=r.send;r.send=function(){const u=arguments[0],d=u.length||u.size||u.byteLength;if(r.readyState==="open"&&o.sctp&&d>o.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+o.sctp.maxMessageSize+" bytes)");return a.apply(r,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const o=n.apply(this,arguments);return e(o,this),o},sr(t,"datachannel",r=>(e(r.channel,r.target),r))}function Od(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const r=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=o=>{const a=o.target;if(a._lastConnectionState!==a.connectionState){a._lastConnectionState=a.connectionState;const l=new Event("connectionstatechange",o);a.dispatchEvent(l)}return o},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),r.apply(this,arguments)}})}function Ad(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e._safariVersion>=13.1)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(o){if(o&&o.sdp&&o.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const a=o.sdp.split(`
`).filter(l=>l.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&o instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:o.type,sdp:a}):o.sdp=a}return n.apply(this,arguments)}}function Ga(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Ka(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let o=arguments[0]||{};if(typeof o!="object"||o.type&&o.sdp)return n.apply(this,arguments);if(o={type:o.type,sdp:o.sdp},!o.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":o.type="offer";break;default:o.type="answer";break}return o.sdp||o.type!=="offer"&&o.type!=="answer"?n.apply(this,[o]):(o.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(l=>n.apply(this,[l]))})}var m_=Object.freeze({__proto__:null,removeExtmapAllowMixed:Ad,shimAddIceCandidateNullOrEmpty:Ga,shimConnectionState:Od,shimMaxMessageSize:$a,shimParameterlessSetLocalDescription:Ka,shimRTCIceCandidate:Ha,shimRTCIceCandidateRelayProtocol:jd,shimSendThrowTypeError:Wa});function g_(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=py,r=d_(t),o={browserDetails:r,commonShim:m_,extractVersion:Ks,disableLog:c_,disableWarnings:u_,sdp:p_};switch(r.browser){case"chrome":if(!jg||!Nd||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),o;if(r.version===null)return n("Chrome shim can not determine version, not shimming."),o;n("adapter.js shimming chrome."),o.browserShim=jg,Ga(t,r),Ka(t),gy(t,r),vy(t),Nd(t,r),yy(t),Sy(t,r),by(t),xy(t),Ty(t,r),Ha(t),jd(t),Od(t),$a(t,r),Wa(t),Ad(t,r);break;case"firefox":if(!Og||!Id||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),o;n("adapter.js shimming firefox."),o.browserShim=Og,Ga(t,r),Ka(t),Cy(t,r),Id(t,r),wy(t),Ry(t),Ey(t),_y(t),Py(t),Ny(t),Iy(t),jy(t),Oy(t),Ha(t),Od(t),$a(t,r),Wa(t);break;case"safari":if(!Ag||!e.shimSafari)return n("Safari shim is not included in this adapter release."),o;n("adapter.js shimming safari."),o.browserShim=Ag,Ga(t,r),Ka(t),Fy(t),zy(t),Ly(t),Ay(t),Dy(t),By(t),My(t),Vy(t),Ha(t),jd(t),$a(t,r),Wa(t),Ad(t,r);break;default:n("Unsupported browser!");break}return o}g_({window:typeof window>"u"?void 0:window});const v_=10,qs="lk_e2ee",y_="LKFrameEncryptionKey",b_={sharedKey:!1,ratchetSalt:y_,ratchetWindowSize:8,failureTolerance:v_,keyringSize:16};var _i;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(_i||(_i={}));var Lg;(function(t){t.KeyRatcheted="keyRatcheted"})(Lg||(Lg={}));var Ei;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Ei||(Ei={}));var Mg;(function(t){t.Error="cryptorError"})(Mg||(Mg={}));function x_(){return k_()||Dd()}function Dd(){return typeof window.RTCRtpScriptTransform<"u"}function k_(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class UP extends On.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,r,o)=>{De.debug("key ratcheted event received",{ratchetResult:n,participantId:r,keyIndex:o})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},b_),e),this.on(_i.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,r){const o={key:e,participantIdentity:n,keyIndex:r};if(!this.options.sharedKey&&!n)throw new Error("participant identity needs to be passed for encryption key if sharedKey option is false");this.keyInfoMap.set("".concat(n??"shared","-").concat(r??0),o),this.emit(_i.SetKey,o)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(_i.RatchetRequest,e,n)}}class Ii extends Error{constructor(e,n){super(n||"an error has occured"),this.name="LiveKitError",this.code=e}}var Me;(function(t){t[t.NotAllowed=0]="NotAllowed",t[t.ServerUnreachable=1]="ServerUnreachable",t[t.InternalError=2]="InternalError",t[t.Cancelled=3]="Cancelled",t[t.LeaveRequest=4]="LeaveRequest",t[t.Timeout=5]="Timeout"})(Me||(Me={}));class He extends Ii{constructor(e,n,r,o){super(1,e),this.name="ConnectionError",this.status=r,this.reason=n,this.context=o,this.reasonName=Me[n]}}class bh extends Ii{constructor(e){super(21,e??"device is unsupported"),this.name="DeviceUnsupportedError"}}class Jn extends Ii{constructor(e){super(20,e??"track is invalid"),this.name="TrackInvalidError"}}class S_ extends Ii{constructor(e){super(10,e??"unsupported server"),this.name="UnsupportedServer"}}class dt extends Ii{constructor(e){super(12,e??"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Ld extends Ii{constructor(e){super(13,e??"unable to negotiate"),this.name="NegotiationError"}}class Ug extends Ii{constructor(e,n){super(15,e),this.name="PublishTrackError",this.status=n}}class Fg extends Ii{constructor(e,n){super(15,e),this.reason=n,this.reasonName=typeof n=="string"?n:vh[n]}}var ll;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(ll||(ll={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(ll||(ll={}));var Bg;(function(t){t[t.InvalidKey=0]="InvalidKey",t[t.MissingKey=1]="MissingKey",t[t.InternalError=2]="InternalError"})(Bg||(Bg={}));var ee;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.Moved="moved",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.ParticipantAttributesChanged="participantAttributesChanged",t.ParticipantActive="participantActive",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged",t.ChatMessage="chatMessage",t.LocalTrackSubscribed="localTrackSubscribed",t.MetricsReceived="metricsReceived"})(ee||(ee={}));var se;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackCpuConstrained="localTrackCpuConstrained",t.LocalSenderCreated="localSenderCreated",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.SipDTMFReceived="sipDTMFReceived",t.TranscriptionReceived="transcriptionReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.TrackCpuConstrained="trackCpuConstrained",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded",t.AttributesChanged="attributesChanged",t.LocalTrackSubscribed="localTrackSubscribed",t.ChatMessage="chatMessage",t.Active="active"})(se||(se={}));var re;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalTrackSubscribed="localTrackSubscribed",t.Offline="offline",t.SignalRequestResponse="signalRequestResponse",t.SignalConnected="signalConnected",t.RoomMoved="roomMoved"})(re||(re={}));var ne;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.CpuConstrained="cpuConstrained",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed",t.TrackProcessorUpdate="trackProcessorUpdate",t.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",t.TranscriptionReceived="transcriptionReceived",t.TimeSyncUpdate="timeSyncUpdate",t.PreConnectBufferFlushed="preConnectBufferFlushed"})(ne||(ne={}));function T_(t){return typeof t>"u"?t:typeof structuredClone=="function"?typeof t=="object"&&t!==null?structuredClone(Object.assign({},t)):structuredClone(t):JSON.parse(JSON.stringify(t))}const C_=/version\/(\d+(\.?_?\d+)+)/i;let Vu;function Jt(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof navigator>"u")return;const n=navigator.userAgent.toLowerCase();if(Vu===void 0||e){const r=w_.find(o=>{let{test:a}=o;return a.test(n)});Vu=r?.describe(n)}return Vu}const w_=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:Ja(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:qu(t)}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:Ja(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0,osVersion:qu(t)}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:Ja(C_,t),os:t.includes("mobile/")?"iOS":"macOS",osVersion:qu(t)}}}];function Ja(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=e.match(t);return r&&r.length>=n&&r[n]||""}function qu(t){return t.includes("mac os")?Ja(/\(.+?(\d+_\d+(:?_\d+)?)/,t,1).replace(/_/g,"."):void 0}var E_="2.15.4";const __=E_,R_=16;class bt{}bt.setTimeout=function(){return setTimeout(...arguments)};bt.setInterval=function(){return setInterval(...arguments)};bt.clearTimeout=function(){return clearTimeout(...arguments)};bt.clearInterval=function(){return clearInterval(...arguments)};const P_=5e3,Hs=[];var Kt;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH"})(Kt||(Kt={}));class G extends On.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var o;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=G.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=De,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),P_):this.handleAppVisibilityChanged()},this.log=ei((o=r.loggerName)!==null&&o!==void 0?o:gn.Track),this.loggerContextCb=r.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=G.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Oe(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===G.Kind.Video&&(n="video"),this.attachedElements.length===0&&this.kind===G.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(Hs.forEach(a=>{a.parentElement===null&&!e&&(e=a)}),e&&Hs.splice(Hs.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),Lr(this.mediaStreamTrack,e);const r=e.srcObject.getTracks(),o=r.some(a=>a.kind==="audio");return e.play().then(()=>{this.emit(o?ne.AudioPlaybackStarted:ne.VideoPlaybackStarted)}).catch(a=>{a.name==="NotAllowedError"?this.emit(o?ne.AudioPlaybackFailed:ne.VideoPlaybackFailed,a):a.name==="AbortError"?De.debug("".concat(o?"audio":"video"," playback aborted, likely due to new play request")):De.warn("could not playback ".concat(o?"audio":"video"),a),o&&e&&r.some(l=>l.kind==="video")&&a.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(ne.ElementAttached,e),e}detach(e){try{if(e){Vr(this.mediaStreamTrack,e);const r=this.attachedElements.indexOf(e);return r>=0&&(this.attachedElements.splice(r,1),this.recycleElement(e),this.emit(ne.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(r=>{Vr(this.mediaStreamTrack,r),n.push(r),this.recycleElement(r),this.emit(ne.ElementDetached,r)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=ei(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),Hs.forEach(r=>{r.parentElement||(n=!1)}),n&&Hs.push(e)}}handleAppVisibilityChanged(){return j(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden",!this.isInBackground&&this.kind===G.Kind.Video&&setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Mt()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Mt()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function Lr(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let r;t.kind==="audio"?r=n.getAudioTracks():r=n.getVideoTracks(),r.includes(t)||(r.forEach(o=>{n.removeTrack(o)}),n.addTrack(t)),(!nr()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(nr()||Wr())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function Vr(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(f){f.Audio="audio",f.Video="video",f.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(f){f.Camera="camera",f.Microphone="microphone",f.ScreenShare="screen_share",f.ScreenShareAudio="screen_share_audio",f.Unknown="unknown"})(n=t.Source||(t.Source={}));let r;(function(f){f.Active="active",f.Paused="paused",f.Unknown="unknown"})(r=t.StreamState||(t.StreamState={}));function o(f){switch(f){case e.Audio:return fn.AUDIO;case e.Video:return fn.VIDEO;default:return fn.DATA}}t.kindToProto=o;function a(f){switch(f){case fn.AUDIO:return e.Audio;case fn.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=a;function l(f){switch(f){case n.Camera:return lt.CAMERA;case n.Microphone:return lt.MICROPHONE;case n.ScreenShare:return lt.SCREEN_SHARE;case n.ScreenShareAudio:return lt.SCREEN_SHARE_AUDIO;default:return lt.UNKNOWN}}t.sourceToProto=l;function u(f){switch(f){case lt.CAMERA:return n.Camera;case lt.MICROPHONE:return n.Microphone;case lt.SCREEN_SHARE:return n.ScreenShare;case lt.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=u;function d(f){switch(f){case wd.ACTIVE:return r.Active;case wd.PAUSED:return r.Paused;default:return r.Unknown}}t.streamStateFromProto=d})(G||(G={}));class qe{constructor(e,n,r,o,a){if(typeof e=="object")this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else if(n!==void 0&&r!==void 0)this.width=e,this.height=n,this.aspectRatio=e/n,this.encoding={maxBitrate:r,maxFramerate:o,priority:a};else throw new TypeError("Unsupported options: provide at least width, height and maxBitrate")}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const N_=["vp8","h264"],I_=["vp8","h264","vp9","av1","h265"];function j_(t){return!!N_.find(e=>e===t)}var zg;(function(t){t[t.PREFER_REGRESSION=0]="PREFER_REGRESSION",t[t.SIMULCAST=1]="SIMULCAST",t[t.REGRESSION=2]="REGRESSION"})(zg||(zg={}));var Md;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:24e3},t.music={maxBitrate:48e3},t.musicStereo={maxBitrate:64e3},t.musicHighQuality={maxBitrate:96e3},t.musicHighQualityStereo={maxBitrate:128e3}})(Md||(Md={}));const oo={h90:new qe(160,90,9e4,20),h180:new qe(320,180,16e4,20),h216:new qe(384,216,18e4,20),h360:new qe(640,360,45e4,20),h540:new qe(960,540,8e5,25),h720:new qe(1280,720,17e5,30),h1080:new qe(1920,1080,3e6,30),h1440:new qe(2560,1440,5e6,30),h2160:new qe(3840,2160,8e6,30)},Ud={h120:new qe(160,120,7e4,20),h180:new qe(240,180,125e3,20),h240:new qe(320,240,14e4,20),h360:new qe(480,360,33e4,20),h480:new qe(640,480,5e5,20),h540:new qe(720,540,6e5,25),h720:new qe(960,720,13e5,30),h1080:new qe(1440,1080,23e5,30),h1440:new qe(1920,1440,38e5,30)},xh={h360fps3:new qe(640,360,2e5,3,"medium"),h360fps15:new qe(640,360,4e5,15,"medium"),h720fps5:new qe(1280,720,8e5,5,"medium"),h720fps15:new qe(1280,720,15e5,15,"medium"),h720fps30:new qe(1280,720,2e6,30,"medium"),h1080fps15:new qe(1920,1080,25e5,15,"medium"),h1080fps30:new qe(1920,1080,5e6,30,"medium"),original:new qe(0,0,7e6,30,"medium")},O_="|",Vg="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function A_(t){const e=t.split(O_);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function Bt(t){return j(this,void 0,void 0,function*(){return new Promise(e=>bt.setTimeout(e,t))})}function Fd(){return"addTransceiver"in RTCPeerConnection.prototype}function Bd(){return"addTrack"in RTCPeerConnection.prototype}function D_(){if(!("getCapabilities"in RTCRtpSender)||nr())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function L_(){if(!("getCapabilities"in RTCRtpSender)||Wr())return!1;if(nr()){const n=Jt();if(n?.version&&In(n.version,"16")<0||n?.os==="iOS"&&n?.osVersion&&In(n.osVersion,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function _n(t){return t==="av1"||t==="vp9"}function zd(t){return!document||cl()?!1:(t||(t=document.createElement("audio")),"setSinkId"in t)}function M_(){return typeof RTCPeerConnection>"u"?!1:Fd()||Bd()}function Wr(){var t;return((t=Jt())===null||t===void 0?void 0:t.name)==="Firefox"}function nr(){var t;return((t=Jt())===null||t===void 0?void 0:t.name)==="Safari"}function cl(){const t=Jt();return t?.name==="Safari"||t?.os==="iOS"}function U_(){const t=Jt();return t?.name==="Safari"&&t.version.startsWith("17.")||t?.os==="iOS"&&!!t?.osVersion&&In(t.osVersion,"17")>=0}function F_(t){return t||(t=Jt()),t?.name==="Safari"&&In(t.version,"18.3")>0||t?.os==="iOS"&&!!t?.osVersion&&In(t.osVersion,"18.3")>0}function Hy(){var t,e;return Mt()?(e=(t=navigator.userAgentData)===null||t===void 0?void 0:t.mobile)!==null&&e!==void 0?e:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function B_(){const t=Jt(),e="17.2";if(t)return t.name!=="Safari"&&t.os!=="iOS"||t.os==="iOS"&&t.osVersion&&In(e,t.osVersion)>=0?!0:t.name==="Safari"&&In(e,t.version)>=0}function Mt(){return typeof document<"u"}function Nn(){return navigator.product=="ReactNative"}function Vd(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function $y(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Wy(){if(!Nn())return;let t=$y();if(t)return t.platform}function qg(){if(Mt())return window.devicePixelRatio;if(Nn()){let t=$y();if(t)return t.devicePixelRatio}return 1}function In(t,e){const n=t.split("."),r=e.split("."),o=Math.min(n.length,r.length);for(let a=0;a<o;++a){const l=parseInt(n[a],10),u=parseInt(r[a],10);if(l>u)return 1;if(l<u)return-1;if(a===o-1&&l===u)return 0}return t===""&&e!==""?-1:e===""?1:n.length==r.length?0:n.length<r.length?-1:1}function z_(t){for(const e of t)e.target.handleResize(e)}function V_(t){for(const e of t)e.target.handleVisibilityChanged(e)}let Hu=null;const Hg=()=>(Hu||(Hu=new ResizeObserver(z_)),Hu);let $u=null;const $g=()=>($u||($u=new IntersectionObserver(V_,{root:null,rootMargin:"0px"})),$u);function q_(){var t;const e=new NE({sdk:Qv.JS,protocol:R_,version:__});return Nn()&&(e.os=(t=Wy())!==null&&t!==void 0?t:""),e}function Wg(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=document.createElement("canvas");o.width=t,o.height=e;const a=o.getContext("2d");a?.fillRect(0,0,o.width,o.height),r&&a&&(a.beginPath(),a.arc(t/2,e/2,50,0,Math.PI*2,!0),a.closePath(),a.fillStyle="grey",a.fill());const l=o.captureStream(),[u]=l.getTracks();if(!u)throw Error("Could not get empty media stream video track");return u.enabled=n,u}let $s;function Wu(){if(!$s){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const r=t.createMediaStreamDestination();if(e.connect(n),n.connect(r),e.start(),[$s]=r.stream.getAudioTracks(),!$s)throw Error("Could not get empty media stream audio track");$s.enabled=!1}return $s.clone()}class Mr{get isResolved(){return this._isResolved}constructor(e,n){this._isResolved=!1,this.onFinally=n,this.promise=new Promise((r,o)=>j(this,void 0,void 0,function*(){this.resolve=r,this.reject=o,e&&(yield e(r,o))})).finally(()=>{var r;this._isResolved=!0,(r=this.onFinally)===null||r===void 0||r.call(this)})}}function H_(t,e){const n=Object.assign({cloneTrack:!1,fftSize:2048,smoothingTimeConstant:.8,minDecibels:-100,maxDecibels:-80},e),r=Sh();if(!r)throw new Error("Audio Context not supported on this browser");const o=n.cloneTrack?t.mediaStreamTrack.clone():t.mediaStreamTrack,a=r.createMediaStreamSource(new MediaStream([o])),l=r.createAnalyser();l.minDecibels=n.minDecibels,l.maxDecibels=n.maxDecibels,l.fftSize=n.fftSize,l.smoothingTimeConstant=n.smoothingTimeConstant,a.connect(l);const u=new Uint8Array(l.frequencyBinCount);return{calculateVolume:()=>{l.getByteFrequencyData(u);let m=0;for(const b of u)m+=Math.pow(b/255,2);return Math.sqrt(m/u.length)},analyser:l,cleanup:()=>j(this,void 0,void 0,function*(){yield r.close(),n.cloneTrack&&o.stop()})}}function $_(t){return I_.includes(t)}function Ri(t){if(typeof t=="string"||typeof t=="number")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function W_(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function qd(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}function G_(t,e){return t.segments.map(n=>{let{id:r,text:o,language:a,startTime:l,endTime:u,final:d}=n;var f;const m=(f=e.get(r))!==null&&f!==void 0?f:Date.now(),y=Date.now();return d?e.delete(r):e.set(r,m),{id:r,text:o,startTime:Number.parseInt(l.toString()),endTime:Number.parseInt(u.toString()),final:d,language:a,firstReceivedTime:m,lastReceivedTime:y}})}function K_(t){const{id:e,timestamp:n,message:r,editTimestamp:o}=t;return{id:e,timestamp:Number.parseInt(n.toString()),editTimestamp:o?Number.parseInt(o.toString()):void 0,message:r}}function Gg(t){switch(t.reason){case Me.LeaveRequest:return t.context;case Me.Cancelled:return mn.CLIENT_INITIATED;case Me.NotAllowed:return mn.USER_REJECTED;case Me.ServerUnreachable:return mn.JOIN_FAILURE;default:return mn.UNKNOWN_REASON}}function Qa(t){return t!==void 0?Number(t):void 0}function Wi(t){return t!==void 0?BigInt(t):void 0}function qr(t){return!!t&&!(t instanceof MediaStreamTrack)&&t.isLocal}function Rn(t){return!!t&&t.kind==G.Kind.Audio}function or(t){return!!t&&t.kind==G.Kind.Video}function Si(t){return qr(t)&&or(t)}function qn(t){return qr(t)&&Rn(t)}function Hd(t){return!!t&&!t.isLocal}function J_(t){return!!t&&!t.isLocal}function Gu(t){return Hd(t)&&or(t)}function Q_(t){return t.isLocal}function Y_(t,e){const n=[];let r=new TextEncoder().encode(t);for(;r.length>e;){let o=e;for(;o>0;){const a=r[o];if(a!==void 0&&(a&192)!==128)break;o--}n.push(r.slice(0,o)),r=r.slice(o)}return r.length>0&&n.push(r),n}function Gy(t,e,n){var r,o,a,l;const{optionsWithoutProcessor:u,audioProcessor:d,videoProcessor:f}=Jy(t??{}),m=e?.processor,y=n?.processor,b=u??{};return b.audio===!0&&(b.audio={}),b.video===!0&&(b.video={}),b.audio&&($d(b.audio,e),(r=(a=b.audio).deviceId)!==null&&r!==void 0||(a.deviceId={ideal:"default"}),(d||m)&&(b.audio.processor=d??m)),b.video&&($d(b.video,n),(o=(l=b.video).deviceId)!==null&&o!==void 0||(l.deviceId={ideal:"default"}),(f||y)&&(b.video.processor=f??y)),b}function $d(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function kh(t){var e,n,r,o;const a={};if(t.video)if(typeof t.video=="object"){const l={},u=l,d=t.video;Object.keys(d).forEach(f=>{switch(f){case"resolution":$d(u,d.resolution);break;default:u[f]=d[f]}}),a.video=l,(e=(r=a.video).deviceId)!==null&&e!==void 0||(r.deviceId={ideal:"default"})}else a.video=t.video?{deviceId:{ideal:"default"}}:!1;else a.video=!1;return t.audio?typeof t.audio=="object"?(a.audio=t.audio,(n=(o=a.audio).deviceId)!==null&&n!==void 0||(o.deviceId={ideal:"default"})):a.audio={deviceId:{ideal:"default"}}:a.audio=!1,a}function Ky(t){return j(this,arguments,void 0,function(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return function*(){const r=Sh();if(r){const o=r.createAnalyser();o.fftSize=2048;const a=o.frequencyBinCount,l=new Uint8Array(a);r.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(o),yield Bt(n),o.getByteTimeDomainData(l);const d=l.some(f=>f!==128&&f!==0);return r.close(),!d}return!1}()})}function Sh(){var t;const e=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(e){const n=new e({latencyHint:"interactive"});if(n.state==="suspended"&&typeof window<"u"&&(!((t=window.document)===null||t===void 0)&&t.body)){const r=()=>j(this,void 0,void 0,function*(){var o;try{n.state==="suspended"&&(yield n.resume())}catch(a){console.warn("Error trying to auto-resume audio context",a)}(o=window.document.body)===null||o===void 0||o.removeEventListener("click",r)});window.document.body.addEventListener("click",r)}return n}}function X_(t){return t==="audioinput"?G.Source.Microphone:t==="videoinput"?G.Source.Camera:G.Source.Unknown}function Wd(t){return t===G.Source.Microphone?"audioinput":t===G.Source.Camera?"videoinput":void 0}function Z_(t){var e,n;let r=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(r=typeof r=="boolean"?{}:r,nr()?r=Object.assign(Object.assign({},r),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):r=Object.assign(Object.assign({},r),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:r,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio,preferCurrentTab:t.preferCurrentTab}}function Ya(t){return t.split("/")[1].toLowerCase()}function eR(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new mh({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function Oe(t){return"mediaStreamTrack"in t?{trackID:t.sid,source:t.source,muted:t.isMuted,enabled:t.mediaStreamTrack.enabled,kind:t.kind,streamID:t.mediaStreamID,streamTrackID:t.mediaStreamTrack.id}:{trackID:t.trackSid,enabled:t.isEnabled,muted:t.isMuted,trackInfo:Object.assign({mimeType:t.mimeType,name:t.trackName,encrypted:t.isEncrypted,kind:t.kind,source:t.source},t.track?Oe(t.track):{})}}function tR(){return typeof RTCRtpReceiver<"u"&&"getSynchronizationSources"in RTCRtpReceiver}function nR(t,e){var n;t===void 0&&(t={}),e===void 0&&(e={});const r=[...Object.keys(e),...Object.keys(t)],o={};for(const a of r)t[a]!==e[a]&&(o[a]=(n=e[a])!==null&&n!==void 0?n:"");return o}function Jy(t){const e=Object.assign({},t);let n,r;return typeof e.audio=="object"&&e.audio.processor&&(n=e.audio.processor,e.audio=Object.assign(Object.assign({},e.audio),{processor:void 0})),typeof e.video=="object"&&e.video.processor&&(r=e.video.processor,e.video=Object.assign(Object.assign({},e.video),{processor:void 0})),{audioProcessor:n,videoProcessor:r,optionsWithoutProcessor:T_(e)}}function iR(t){switch(t){case lt.CAMERA:return G.Source.Camera;case lt.MICROPHONE:return G.Source.Microphone;case lt.SCREEN_SHARE:return G.Source.ScreenShare;case lt.SCREEN_SHARE_AUDIO:return G.Source.ScreenShareAudio;default:return G.Source.Unknown}}function Kg(t,e){return t.width*t.height<e.width*e.height}function rR(t,e){var n;return(n=t.layers)===null||n===void 0?void 0:n.find(r=>r.quality===e)}class sR extends On.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var r,o;const{kind:a,data:l}=n.data;switch(a){case"error":De.error(l.error.message),this.emit(Ei.EncryptionError,l.error);break;case"initAck":l.enabled&&this.keyProvider.getKeys().forEach(u=>{this.postKey(u)});break;case"enable":if(l.enabled&&this.keyProvider.getKeys().forEach(u=>{this.postKey(u)}),this.encryptionEnabled!==l.enabled&&l.participantIdentity===((r=this.room)===null||r===void 0?void 0:r.localParticipant.identity))this.emit(Ei.ParticipantEncryptionStatusChanged,l.enabled,this.room.localParticipant),this.encryptionEnabled=l.enabled;else if(l.participantIdentity){const u=(o=this.room)===null||o===void 0?void 0:o.getParticipantByIdentity(l.participantIdentity);if(!u)throw TypeError("couldn't set encryption status, participant not found".concat(l.participantIdentity));this.emit(Ei.ParticipantEncryptionStatusChanged,l.enabled,u)}break;case"ratchetKey":this.keyProvider.emit(_i.KeyRatcheted,l.ratchetResult,l.participantIdentity,l.keyIndex);break}},this.onWorkerError=n=>{De.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Ei.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!x_())throw new bh("tried to setup end-to-end encryption on an unsupported browser");if(De.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:r_.getLevel()}};this.worker&&(De.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){De.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?De.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(re.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(ee.TrackPublished,(r,o)=>this.setParticipantCryptorEnabled(r.trackInfo.encryption!==Wt.NONE,o.identity)),e.on(ee.ConnectionStateChanged,r=>{r===ze.Connected&&e.remoteParticipants.forEach(o=>{o.trackPublications.forEach(a=>{this.setParticipantCryptorEnabled(a.trackInfo.encryption!==Wt.NONE,o.identity)})})}).on(ee.TrackUnsubscribed,(r,o,a)=>{var l;const u={kind:"removeTransform",data:{participantIdentity:a.identity,trackId:r.mediaStreamID}};(l=this.worker)===null||l===void 0||l.postMessage(u)}).on(ee.TrackSubscribed,(r,o,a)=>{this.setupE2EEReceiver(r,a.identity,o.trackInfo)}).on(ee.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");n.getKeys().forEach(r=>{this.postKey(r)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(se.LocalSenderCreated,(r,o)=>j(this,void 0,void 0,function*(){this.setupE2EESender(o,r)})),n.on(_i.SetKey,r=>this.postKey(r)).on(_i.RatchetRequest,(r,o)=>this.postRatchetRequest(r,o))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const r={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(r)}postKey(e){let{key:n,participantIdentity:r,keyIndex:o}=e;var a;if(!this.worker)throw Error("could not set key, worker is missing");const l={kind:"setKey",data:{participantIdentity:r,isPublisher:r===((a=this.room)===null||a===void 0?void 0:a.localParticipant.identity),key:n,keyIndex:o}};this.worker.postMessage(l)}postEnable(e,n){if(this.worker){const r={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(r)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const r={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(r)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,r){if(e.receiver){if(!r?.mimeType||r.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?Ya(r.mimeType):void 0)}}setupE2EESender(e,n){if(!qr(e)||!n){n||De.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,r,o){return j(this,void 0,void 0,function*(){if(this.worker){if(Dd()){const a={kind:"decode",participantIdentity:r,trackId:n,codec:o};e.transform=new RTCRtpScriptTransform(this.worker,a)}else{if(qs in e&&o){const d={kind:"updateCodec",data:{trackId:n,codec:o,participantIdentity:r}};this.worker.postMessage(d);return}let a=e.writableStream,l=e.readableStream;if(!a||!l){const d=e.createEncodedStreams();e.writableStream=d.writable,a=d.writable,e.readableStream=d.readable,l=d.readable}const u={kind:"decode",data:{readableStream:l,writableStream:a,trackId:n,codec:o,participantIdentity:r,isReuse:qs in e}};this.worker.postMessage(u,[l,a])}e[qs]=!0}})}handleSender(e,n,r){var o;if(!(qs in e||!this.worker)){if(!(!((o=this.room)===null||o===void 0)&&o.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Dd()){De.info("initialize script transform");const a={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,a)}else{De.info("initialize encoded streams");const a=e.createEncodedStreams(),l={kind:"encode",data:{readableStream:a.readable,writableStream:a.writable,codec:r,trackId:n,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(l,[a.readable,a.writable])}e[qs]=!0}}}const Ku="default";class gt{constructor(){this._previousDevices=[]}static getInstance(){return this.instance===void 0&&(this.instance=new gt),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return j(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var a;if(((a=gt.userMediaPromiseMap)===null||a===void 0?void 0:a.size)>0){De.debug("awaiting getUserMedia promise");try{n?yield gt.userMediaPromiseMap.get(n):yield Promise.all(gt.userMediaPromiseMap.values())}catch{De.warn("error waiting for media permissons")}}let l=yield navigator.mediaDevices.enumerateDevices();if(o&&!(nr()&&r.hasDeviceInUse(n))&&(l.filter(d=>d.kind===n).length===0||l.some(d=>{const f=d.label==="",m=n?d.kind===n:!0;return f&&m}))){const d={video:n!=="audioinput"&&n!=="audiooutput",audio:n!=="videoinput"&&{deviceId:{ideal:"default"}}},f=yield navigator.mediaDevices.getUserMedia(d);l=yield navigator.mediaDevices.enumerateDevices(),f.getTracks().forEach(m=>{m.stop()})}return r._previousDevices=l,n&&(l=l.filter(u=>u.kind===n)),l}()})}normalizeDeviceId(e,n,r){return j(this,void 0,void 0,function*(){if(n!==Ku)return n;const o=yield this.getDevices(e),a=o.find(u=>u.deviceId===Ku);if(!a){De.warn("could not reliably determine default device");return}const l=o.find(u=>u.deviceId!==Ku&&u.groupId===(r??a.groupId));if(!l){De.warn("could not reliably determine default device");return}return l?.deviceId})}hasDeviceInUse(e){return e?gt.userMediaPromiseMap.has(e):gt.userMediaPromiseMap.size>0}}gt.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];gt.userMediaPromiseMap=new Map;var eo;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(eo||(eo={}));class oR{constructor(){this.pendingTasks=new Map,this.taskMutex=new Rt,this.nextTaskIndex=0}run(e){return j(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:eo.WAITING};this.pendingTasks.set(n.id,n);const r=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=eo.RUNNING,yield e()}finally{n.status=eo.COMPLETED,this.pendingTasks.delete(n.id),r()}})}flush(){return j(this,void 0,void 0,function*(){return this.run(()=>j(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}function aR(t,e){const n=new URL(W_(t));return e.forEach((r,o)=>{n.searchParams.set(o,r)}),Qy(n,"rtc")}function lR(t){const e=new URL(qd(t));return Qy(e,"validate")}function cR(t){return t.endsWith("/")?t:"".concat(t,"/")}function Qy(t,e){return t.pathname="".concat(cR(t.pathname)).concat(e),t.toString()}const uR=["syncState","trickle","offer","answer","simulate","leave"];function dR(t){const e=uR.indexOf(t.case)>=0;return De.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var Ke;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(Ke||(Ke={}));class Th{get currentState(){return this.state}get isDisconnected(){return this.state===Ke.DISCONNECTING||this.state===Ke.DISCONNECTED}get isEstablishingConnection(){return this.state===Ke.CONNECTING||this.state===Ke.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;this.rtt=0,this.state=Ke.DISCONNECTED,this.log=De,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=ei((r=n.loggerName)!==null&&r!==void 0?r:gn.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new oR,this.queuedRequests=[],this.closingLock=new Rt,this.connectionLock=new Rt,this.state=Ke.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,r,o){return j(this,void 0,void 0,function*(){return this.state=Ke.CONNECTING,this.options=r,yield this.connect(e,n,r,o)})}reconnect(e,n,r,o){return j(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=Ke.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:r,reconnectReason:o}))})}connect(e,n,r,o){this.connectOptions=r;const a=q_(),l=hR(n,a,r),u=aR(e,l),d=lR(u);return new Promise((f,m)=>j(this,void 0,void 0,function*(){const y=yield this.connectionLock.lock();try{const b=()=>j(this,void 0,void 0,function*(){this.close(),clearTimeout(S),m(new He("room connection has been cancelled (signal)",Me.Cancelled))}),S=setTimeout(()=>{this.close(),m(new He("room connection has timed out (signal)",Me.ServerUnreachable))},r.websocketTimeout);o?.aborted&&b(),o?.addEventListener("abort",b);const k=new URL(u);k.searchParams.has("access_token")&&k.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(k),Object.assign({reconnect:r.reconnect,reconnectReason:r.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(u),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(S)},this.ws.onerror=T=>j(this,void 0,void 0,function*(){if(this.state!==Ke.CONNECTED){this.state=Ke.DISCONNECTED,clearTimeout(S);try{const C=yield fetch(d);if(C.status.toFixed(0).startsWith("4")){const w=yield C.text();m(new He(w,Me.NotAllowed,C.status))}else m(new He("Encountered unknown websocket error during connection: ".concat(T.toString()),Me.InternalError,C.status))}catch(C){m(new He(C instanceof Error?C.message:"server was not reachable",Me.ServerUnreachable))}return}this.handleWSError(T)}),this.ws.onmessage=T=>j(this,void 0,void 0,function*(){var C,w,A;let P;if(typeof T.data=="string"){const E=JSON.parse(T.data);P=wg.fromJson(E,{ignoreUnknownFields:!0})}else if(T.data instanceof ArrayBuffer)P=wg.fromBinary(new Uint8Array(T.data));else{this.log.error("could not decode websocket message: ".concat(typeof T.data),this.logContext);return}if(this.state!==Ke.CONNECTED){let E=!1;if(((C=P.message)===null||C===void 0?void 0:C.case)==="join"?(this.state=Ke.CONNECTED,o?.removeEventListener("abort",b),this.pingTimeoutDuration=P.message.value.pingTimeout,this.pingIntervalDuration=P.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),f(P.message.value)):this.state===Ke.RECONNECTING&&P.message.case!=="leave"?(this.state=Ke.CONNECTED,o?.removeEventListener("abort",b),this.startPingInterval(),((w=P.message)===null||w===void 0?void 0:w.case)==="reconnect"?f(P.message.value):(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),f(void 0),E=!0)):this.isEstablishingConnection&&P.message.case==="leave"?m(new He("Received leave request while trying to (re)connect",Me.LeaveRequest,void 0,P.message.value.reason)):r.reconnect||m(new He("did not receive join response, got ".concat((A=P.message)===null||A===void 0?void 0:A.case," instead"),Me.InternalError)),!E)return}this.signalLatency&&(yield Bt(this.signalLatency)),this.handleSignalResponse(P)}),this.ws.onclose=T=>{this.isEstablishingConnection&&m(new He("Websocket got closed during a (re)connection attempt",Me.InternalError)),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:T.reason,code:T.code,wasClean:T.wasClean,state:this.state})),this.handleOnClose(T.reason)}}finally{y()}}))}close(){return j(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){const r=yield e.closingLock.lock();try{if(e.clearPingInterval(),n&&(e.state=Ke.DISCONNECTING),e.ws){e.ws.onmessage=null,e.ws.onopen=null,e.ws.onclose=null;const o=new Promise(a=>{e.ws?e.ws.onclose=()=>{a()}:a()});e.ws.readyState<e.ws.CLOSING&&(e.ws.close(),yield Promise.race([o,Bt(250)])),e.ws=void 0}}finally{n&&(e.state=Ke.DISCONNECTED),r()}}()})}sendOffer(e,n){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:ul(e,n)})}sendAnswer(e,n){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:ul(e,n)})}sendIceCandidate(e,n){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new fh({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new ph({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return j(this,arguments,void 0,function(r,o){var a=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return function*(){const u=a.getNextRequestId();return yield a.sendRequest({case:"updateMetadata",value:new ry({requestId:u,metadata:r,name:o,attributes:l})}),u}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new iy({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new ay({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Qe.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new dy({timestamp:Qe.parse(Date.now()),rtt:Qe.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,n){return this.sendRequest({case:"updateAudioTrack",value:new ny({trackSid:e,features:n})})}sendLeave(){return this.sendRequest({case:"leave",value:new Nl({reason:mn.CLIENT_INITIATED,action:Br.DISCONNECT})})}sendRequest(e){return j(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return function*(){if(!o&&!dR(n)&&r.state===Ke.RECONNECTING){r.queuedRequests.push(()=>j(r,void 0,void 0,function*(){yield this.sendRequest(n,!0)}));return}if(o||(yield r.requestQueue.flush()),r.signalLatency&&(yield Bt(r.signalLatency)),r.isDisconnected){r.log.debug("skipping signal request (type: ".concat(n.case,") - SignalClient disconnected"));return}if(!r.ws||r.ws.readyState!==r.ws.OPEN){r.log.error("cannot send signal request before connected, type: ".concat(n?.case),r.logContext);return}const l=new OE({message:n});try{r.useJSON?r.ws.send(l.toJsonString()):r.ws.send(l.toBinary())}catch(u){r.log.error("error sending signal message",Object.assign(Object.assign({},r.logContext),{error:u}))}}()})}handleSignalResponse(e){var n,r;const o=e.message;if(o==null){this.log.debug("received unsupported message",this.logContext);return}let a=!1;if(o.case==="answer"){const l=Jg(o.value);this.onAnswer&&this.onAnswer(l,o.value.id)}else if(o.case==="offer"){const l=Jg(o.value);this.onOffer&&this.onOffer(l,o.value.id)}else if(o.case==="trickle"){const l=JSON.parse(o.value.candidateInit);this.onTrickle&&this.onTrickle(l,o.value.target)}else o.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=o.value.participants)!==null&&n!==void 0?n:[]):o.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(o.value):o.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((r=o.value.speakers)!==null&&r!==void 0?r:[]):o.case==="leave"?this.onLeave&&this.onLeave(o.value):o.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(o.value.sid,o.value.muted):o.case==="roomUpdate"?this.onRoomUpdate&&o.value.room&&this.onRoomUpdate(o.value.room):o.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(o.value):o.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(o.value):o.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(o.value):o.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(o.value):o.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(o.value):o.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(o.value):o.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(o.value):o.case==="pong"||(o.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(o.value.lastPingTimestamp.toString()),this.resetPingTimeout(),a=!0):o.case==="requestResponse"?this.onRequestResponse&&this.onRequestResponse(o.value):o.case==="trackSubscribed"?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(o.value.trackSid):o.case==="roomMoved"?(this.onTokenRefresh&&this.onTokenRefresh(o.value.token),this.onRoomMoved&&this.onRoomMoved(o.value)):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:o.case})));a||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return j(this,void 0,void 0,function*(){if(this.state===Ke.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=bt.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&bt.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=bt.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&bt.clearInterval(this.pingInterval)}}function Jg(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function ul(t,e){return new tr({sdp:t.sdp,type:t.type,id:e})}function hR(t,e,n){var r;const o=new URLSearchParams;return o.set("access_token",t),n.reconnect&&(o.set("reconnect","1"),n.sid&&o.set("sid",n.sid)),o.set("auto_subscribe",n.autoSubscribe?"1":"0"),o.set("sdk",Nn()?"reactnative":"js"),o.set("version",e.version),o.set("protocol",e.protocol.toString()),e.deviceModel&&o.set("device_model",e.deviceModel),e.os&&o.set("os",e.os),e.osVersion&&o.set("os_version",e.osVersion),e.browser&&o.set("browser",e.browser),e.browserVersion&&o.set("browser_version",e.browserVersion),n.adaptiveStream&&o.set("adaptive_stream","1"),n.reconnectReason&&o.set("reconnect_reason",n.reconnectReason.toString()),!((r=navigator.connection)===null||r===void 0)&&r.type&&o.set("network",navigator.connection.type),o}class Qg{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0&&this.buffer[0].sequence<=e;)this.pop()}alignBufferedAmount(e){for(;this.buffer.length>0;){const n=this.buffer[0];if(this._totalSize-n.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class fR{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,n){const r=Date.now();r-this._lastCleanup>this.ttl/2&&this.cleanup();const o=r+this.ttl;return this._map.set(e,{value:n,expiresAt:o}),this}get(e){const n=this._map.get(e);if(n){if(n.expiresAt<Date.now()){this._map.delete(e);return}return n.value}}has(e){const n=this._map.get(e);return n?n.expiresAt<Date.now()?(this._map.delete(e),!1):!0:!1}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[n,r]of this._map.entries())r.expiresAt<e&&this._map.delete(n);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[n,r]of this._map.entries())r.expiresAt>=Date.now()&&e(r.value,n,this.asValueMap())}map(e){this.cleanup();const n=[],r=this.asValueMap();for(const[o,a]of r.entries())n.push(e(a,o,r));return n}asValueMap(){const e=new Map;for(const[n,r]of this._map.entries())r.expiresAt>=Date.now()&&e.set(n,r.value);return e}}var un={},Ju={},Qu={exports:{}},Yg;function Ch(){if(Yg)return Qu.exports;Yg=1;var t=Qu.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return e.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return e.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return e.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var n="candidate:%s %d %s %d %s %d typ %s";return n+=e.raddr!=null?" raddr %s rport %d":"%v%v",n+=e.tcptype!=null?" tcptype %s":"%v",e.generation!=null&&(n+=" generation %d"),n+=e["network-id"]!=null?" network-id %d":"%v",n+=e["network-cost"]!=null?" network-cost %d":"%v",n}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var n="ssrc:%d";return e.attribute!=null&&(n+=" %s",e.value!=null&&(n+=":%s")),n}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return e.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(e.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var n="mediaclk:";return n+=e.id!=null?"id=%s %s":"%v%s",n+=e.mediaClockValue!=null?"=%s":"",n+=e.rateNumerator!=null?" rate=%s":"",n+=e.rateDenominator!=null?"/%s":"",n}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(t).forEach(function(e){var n=t[e];n.forEach(function(r){r.reg||(r.reg=/(.*)/),r.format||(r.format="%s")})}),Qu.exports}var Xg;function pR(){return Xg||(Xg=1,function(t){var e=function(u){return String(Number(u))===u?Number(u):u},n=function(u,d,f,m){if(m&&!f)d[m]=e(u[1]);else for(var y=0;y<f.length;y+=1)u[y+1]!=null&&(d[f[y]]=e(u[y+1]))},r=function(u,d,f){var m=u.name&&u.names;u.push&&!d[u.push]?d[u.push]=[]:m&&!d[u.name]&&(d[u.name]={});var y=u.push?{}:m?d[u.name]:d;n(f.match(u.reg),y,u.names,u.name),u.push&&d[u.push].push(y)},o=Ch(),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(u){var d={},f=[],m=d;return u.split(/(\r\n|\r|\n)/).filter(a).forEach(function(y){var b=y[0],S=y.slice(2);b==="m"&&(f.push({rtp:[],fmtp:[]}),m=f[f.length-1]);for(var k=0;k<(o[b]||[]).length;k+=1){var T=o[b][k];if(T.reg.test(S))return r(T,m,S)}}),d.media=f,d};var l=function(u,d){var f=d.split(/=(.+)/,2);return f.length===2?u[f[0]]=e(f[1]):f.length===1&&d.length>1&&(u[f[0]]=void 0),u};t.parseParams=function(u){return u.split(/;\s?/).reduce(l,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(u){return u.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(u){for(var d=[],f=u.split(" ").map(e),m=0;m<f.length;m+=3)d.push({component:f[m],ip:f[m+1],port:f[m+2]});return d},t.parseImageAttributes=function(u){return u.split(" ").map(function(d){return d.substring(1,d.length-1).split(",").reduce(l,{})})},t.parseSimulcastStreamList=function(u){return u.split(";").map(function(d){return d.split(",").map(function(f){var m,y=!1;return f[0]!=="~"?m=e(f):(m=e(f.substring(1,f.length)),y=!0),{scid:m,paused:y}})})}}(Ju)),Ju}var Yu,Zg;function mR(){if(Zg)return Yu;Zg=1;var t=Ch(),e=/%[sdv%]/g,n=function(l){var u=1,d=arguments,f=d.length;return l.replace(e,function(m){if(u>=f)return m;var y=d[u];switch(u+=1,m){case"%%":return"%";case"%s":return String(y);case"%d":return Number(y);case"%v":return""}})},r=function(l,u,d){var f=u.format instanceof Function?u.format(u.push?d:d[u.name]):u.format,m=[l+"="+f];if(u.names)for(var y=0;y<u.names.length;y+=1){var b=u.names[y];u.name?m.push(d[u.name][b]):m.push(d[u.names[y]])}else m.push(d[u.name]);return n.apply(null,m)},o=["v","o","s","i","u","e","p","c","b","t","r","z","a"],a=["i","c","b","a"];return Yu=function(l,u){u=u||{},l.version==null&&(l.version=0),l.name==null&&(l.name=" "),l.media.forEach(function(y){y.payloads==null&&(y.payloads="")});var d=u.outerOrder||o,f=u.innerOrder||a,m=[];return d.forEach(function(y){t[y].forEach(function(b){b.name in l&&l[b.name]!=null?m.push(r(y,b,l)):b.push in l&&l[b.push]!=null&&l[b.push].forEach(function(S){m.push(r(y,b,S))})})}),l.media.forEach(function(y){m.push(r("m",t.m[0],y)),f.forEach(function(b){t[b].forEach(function(S){S.name in y&&y[S.name]!=null?m.push(r(b,S,y)):S.push in y&&y[S.push]!=null&&y[S.push].forEach(function(k){m.push(r(b,S,k))})})})}),m.join(`\r
`)+`\r
`},Yu}var e0;function gR(){if(e0)return un;e0=1;var t=pR(),e=mR(),n=Ch();return un.grammar=n,un.write=e,un.parse=t.parse,un.parseParams=t.parseParams,un.parseFmtpConfig=t.parseFmtpConfig,un.parsePayloads=t.parsePayloads,un.parseRemoteCandidates=t.parseRemoteCandidates,un.parseImageAttributes=t.parseImageAttributes,un.parseSimulcastStreamList=t.parseSimulcastStreamList,un}var Ti=gR();function wh(t,e,n){var r,o,a;e===void 0&&(e=50),n===void 0&&(n={});var l=(r=n.isImmediate)!=null&&r,u=(o=n.callback)!=null&&o,d=n.maxWait,f=Date.now(),m=[];function y(){if(d!==void 0){var S=Date.now()-f;if(S+e>=d)return d-S}return e}var b=function(){var S=[].slice.call(arguments),k=this;return new Promise(function(T,C){var w=l&&a===void 0;if(a!==void 0&&clearTimeout(a),a=setTimeout(function(){if(a=void 0,f=Date.now(),!l){var P=t.apply(k,S);u&&u(P),m.forEach(function(E){return(0,E.resolve)(P)}),m=[]}},y()),w){var A=t.apply(k,S);return u&&u(A),T(A)}m.push({resolve:T,reject:C})})};return b.cancel=function(S){a!==void 0&&clearTimeout(a),m.forEach(function(k){return(0,k.reject)(S)}),m=[]},b}const vR=.7,yR=20,Hr={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class t0 extends On.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var r;super(),this.log=De,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=wh(o=>j(this,void 0,void 0,function*(){this.emit(Hr.NegotiationStarted);try{yield this.createAndSendOffer()}catch(a){if(o)o(a);else throw a}}),yR),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=ei((r=n.loggerName)!==null&&r!==void 0?r:gn.PCTransport),this.loggerOptions=n,this.config=e,this._pc=this.createPC(),this.offerLock=new Rt}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var r;n.candidate&&((r=this.onIceCandidate)===null||r===void 0||r.call(this,n.candidate))},e.onicecandidateerror=n=>{var r;(r=this.onIceCandidateError)===null||r===void 0||r.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var r;(r=this.onDataChannel)===null||r===void 0||r.call(this,n)},e.ontrack=n=>{var r;(r=this.onTrack)===null||r===void 0||r.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return j(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,n){return j(this,void 0,void 0,function*(){var r;if(e.type==="answer"&&this.latestOfferId>0&&n>0&&n!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:n,latestOfferId:this.latestOfferId})),!1;let o;if(e.type==="offer"){let{stereoMids:a,nackMids:l}=bR(e);this.remoteStereoMids=a,this.remoteNackMids=l}else if(e.type==="answer"){const a=Ti.parse((r=e.sdp)!==null&&r!==void 0?r:"");a.media.forEach(l=>{l.type==="audio"&&this.trackBitrates.some(u=>{if(!u.transceiver||l.mid!=u.transceiver.mid)return!1;let d=0;if(l.rtp.some(m=>m.codec.toUpperCase()===u.codec.toUpperCase()?(d=m.payload,!0):!1),d===0)return!0;let f=!1;for(const m of l.fmtp)if(m.payload===d){m.config=m.config.split(";").filter(y=>!y.includes("maxaveragebitrate")).join(";"),u.maxbr>0&&(m.config+=";maxaveragebitrate=".concat(u.maxbr*1e3)),f=!0;break}return f||u.maxbr>0&&l.fmtp.push({payload:d,config:"maxaveragebitrate=".concat(u.maxbr*1e3)}),!0})}),o=Ti.write(a)}return yield this.setMungedSDP(e,o,!0),this.pendingCandidates.forEach(a=>{this.pc.addIceCandidate(a)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(Hr.NegotiationComplete),e.sdp&&Ti.parse(e.sdp).media.forEach(l=>{l.type==="video"&&this.emit(Hr.RTPVideoPayloadTypes,l.rtp)})),!0})}createAndSendOffer(e){return j(this,void 0,void 0,function*(){var n;const r=yield this.offerLock.lock();try{if(this.onOffer===void 0)return;if(e?.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const u=this._pc.remoteDescription;if(e?.iceRestart&&u)yield this._pc.setRemoteDescription(u);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const o=this.latestOfferId+1;this.latestOfferId=o;const a=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:a.sdp},this.logContext));const l=Ti.parse((n=a.sdp)!==null&&n!==void 0?n:"");if(l.media.forEach(u=>{i0(u),u.type==="audio"?n0(u,[],[]):u.type==="video"&&this.trackBitrates.some(d=>{if(!u.msid||!d.cid||!u.msid.includes(d.cid))return!1;let f=0;if(u.rtp.some(y=>y.codec.toUpperCase()===d.codec.toUpperCase()?(f=y.payload,!0):!1),f===0||(_n(d.codec)&&!nr()&&this.ensureVideoDDExtensionForSVC(u,l),d.codec!=="av1"))return!0;const m=Math.round(d.maxbr*vR);for(const y of u.fmtp)if(y.payload===f){y.config.includes("x-google-start-bitrate")||(y.config+=";x-google-start-bitrate=".concat(m));break}return!0})}),this.latestOfferId>o){this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:o}));return}yield this.setMungedSDP(a,Ti.write(l)),this.onOffer(a,this.latestOfferId)}finally{r()}})}createAndSetAnswer(){return j(this,void 0,void 0,function*(){var e;const n=yield this.pc.createAnswer(),r=Ti.parse((e=n.sdp)!==null&&e!==void 0?e:"");return r.media.forEach(o=>{i0(o),o.type==="audio"&&n0(o,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,Ti.write(r)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new dt("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new dt("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return j(this,void 0,void 0,function*(){var e;if(!this._pc)return;let n="";const r=new Map,o=new Map;if((yield this._pc.getStats()).forEach(u=>{switch(u.type){case"transport":n=u.selectedCandidatePairId;break;case"candidate-pair":n===""&&u.selected&&(n=u.id),r.set(u.id,u);break;case"remote-candidate":o.set(u.id,"".concat(u.address,":").concat(u.port));break}}),n==="")return;const l=(e=r.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(l!==void 0)return o.get(l)})}setMungedSDP(e,n,r){return j(this,void 0,void 0,function*(){if(n){const o=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(r?"remote":"local"," description"),this.logContext),r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(a){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:a,sdp:n})),e.sdp=o}}try{r?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(o){let a="unknown error";o instanceof Error?a=o.message:typeof o=="string"&&(a=o);const l={error:a,sdp:e.sdp};throw!r&&this.pc.remoteDescription&&(l.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:l})),new Ld(a)}})}ensureVideoDDExtensionForSVC(e,n){var r,o;if(!((r=e.ext)===null||r===void 0?void 0:r.some(l=>l.uri===Vg))){if(this.ddExtID===0){let l=0;n.media.forEach(u=>{var d;u.type==="video"&&((d=u.ext)===null||d===void 0||d.forEach(f=>{f.value>l&&(l=f.value)}))}),this.ddExtID=l+1}(o=e.ext)===null||o===void 0||o.push({value:this.ddExtID,uri:Vg})}}}function n0(t,e,n){let r=0;t.rtp.some(o=>o.codec==="opus"?(r=o.payload,!0):!1),r>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(o=>o.payload===r&&o.type==="nack")&&t.rtcpFb.push({payload:r,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(o=>o.payload===r?(o.config.includes("stereo=1")||(o.config+=";stereo=1"),!0):!1))}function bR(t){var e;const n=[],r=[],o=Ti.parse((e=t.sdp)!==null&&e!==void 0?e:"");let a=0;return o.media.forEach(l=>{var u;l.type==="audio"&&(l.rtp.some(d=>d.codec==="opus"?(a=d.payload,!0):!1),!((u=l.rtcpFb)===null||u===void 0)&&u.some(d=>d.payload===a&&d.type==="nack")&&r.push(l.mid),l.fmtp.some(d=>d.payload===a?(d.config.includes("sprop-stereo=1")&&n.push(l.mid),!0):!1))}),{stereoMids:n,nackMids:r}}function i0(t){if(t.connection){const e=t.connection.ip.indexOf(":")>=0;(t.connection.version===4&&e||t.connection.version===6&&!e)&&(t.connection.ip="0.0.0.0",t.connection.version=4)}}const Gd="vp8",xR={audioPreset:Md.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:xh.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Gd,backupCodec:!0,preConnectBuffer:!1},Yy={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},Xy={deviceId:{ideal:"default"},resolution:oo.h720.resolution},kR={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new o_,disconnectOnPageLeave:!0,webAudioMix:!1},Eh={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var tt;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(tt||(tt={}));class SR{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,r){var o;this.peerConnectionTimeout=Eh.peerConnectionTimeout,this.log=De,this.updateState=()=>{var a;const l=this.state,u=this.requiredTransports.map(d=>d.getConnectionState());u.every(d=>d==="connected")?this.state=tt.CONNECTED:u.some(d=>d==="failed")?this.state=tt.FAILED:u.some(d=>d==="connecting")?this.state=tt.CONNECTING:u.every(d=>d==="closed")?this.state=tt.CLOSED:u.some(d=>d==="closed")?this.state=tt.CLOSING:u.every(d=>d==="new")&&(this.state=tt.NEW),l!==this.state&&(this.log.debug("pc state change: from ".concat(tt[l]," to ").concat(tt[this.state]),this.logContext),(a=this.onStateChange)===null||a===void 0||a.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=ei((o=r.loggerName)!==null&&o!==void 0?o:gn.PCManager),this.loggerOptions=r,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n,this.publisher=new t0(e,r),this.subscriber=new t0(e,r),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=a=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,a,pn.PUBLISHER)},this.subscriber.onIceCandidate=a=>{var l;(l=this.onIceCandidate)===null||l===void 0||l.call(this,a,pn.SUBSCRIBER)},this.subscriber.onDataChannel=a=>{var l;(l=this.onDataChannel)===null||l===void 0||l.call(this,a)},this.subscriber.onTrack=a=>{var l;(l=this.onTrack)===null||l===void 0||l.call(this,a)},this.publisher.onOffer=(a,l)=>{var u;(u=this.onPublisherOffer)===null||u===void 0||u.call(this,a,l)},this.state=tt.NEW,this.connectionLock=new Rt,this.remoteOfferLock=new Rt}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,n){return this.publisher.setRemoteDescription(e,n)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return j(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(r){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:r}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return j(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return j(this,void 0,void 0,function*(){n===pn.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,n){return j(this,void 0,void 0,function*(){this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()}));const r=yield this.remoteOfferLock.lock();try{return(yield this.subscriber.setRemoteDescription(e,n))?yield this.subscriber.createAndSetAnswer():void 0}finally{r()}})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){return j(this,void 0,void 0,function*(){var r;const o=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((r=this.requiredTransports)===null||r===void 0?void 0:r.map(a=>this.ensureTransportConnected(a,e,n)))}finally{o()}})}negotiate(e){return j(this,void 0,void 0,function*(){return new Promise((n,r)=>j(this,void 0,void 0,function*(){const o=setTimeout(()=>{r("negotiation timed out")},this.peerConnectionTimeout),a=()=>{clearTimeout(o),r("negotiation aborted")};e.signal.addEventListener("abort",a),this.publisher.once(Hr.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(Hr.NegotiationComplete,()=>{clearTimeout(o),n()})}),yield this.publisher.negotiate(l=>{clearTimeout(o),r(l)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===pn.PUBLISHER?this.publisher.getConnectedAddress():e===pn.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){return j(this,arguments,void 0,function(r,o){var a=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return function*(){if(r.getConnectionState()!=="connected")return new Promise((d,f)=>j(a,void 0,void 0,function*(){const m=()=>{this.log.warn("abort transport connection",this.logContext),bt.clearTimeout(y),f(new He("room connection has been cancelled",Me.Cancelled))};o?.signal.aborted&&m(),o?.signal.addEventListener("abort",m);const y=bt.setTimeout(()=>{o?.signal.removeEventListener("abort",m),f(new He("could not establish pc connection",Me.InternalError))},l);for(;this.state!==tt.CONNECTED;)if(yield Bt(50),o?.signal.aborted){f(new He("room connection has been cancelled",Me.Cancelled));return}bt.clearTimeout(y),o?.signal.removeEventListener("abort",m),d()}))}()})}}class it extends Error{constructor(e,n,r){super(n),this.code=e,this.message=r0(n,it.MAX_MESSAGE_BYTES),this.data=r?r0(r,it.MAX_DATA_BYTES):void 0}static fromProto(e){return new it(e.code,e.message,e.data)}toProto(){return new Wv({code:this.code,message:this.message,data:this.data})}static builtIn(e,n){return new it(it.ErrorCode[e],it.ErrorMessage[e],n)}}it.MAX_MESSAGE_BYTES=256;it.MAX_DATA_BYTES=15360;it.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404};it.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};const Zy=15360;function _h(t){return new TextEncoder().encode(t).length}function r0(t,e){if(_h(t)<=e)return t;let n=0,r=t.length;const o=new TextEncoder;for(;n<r;){const a=Math.floor((n+r+1)/2);o.encode(t.slice(0,a)).length<=e?n=a:r=a-1}return t.slice(0,n)}const Rh=2e3;function jl(t,e){if(!e)return 0;let n,r;return"bytesReceived"in t?(n=t.bytesReceived,r=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,r=e.bytesSent),n===void 0||r===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-r)*8*1e3/(t.timestamp-e.timestamp)}const Ph=typeof MediaRecorder<"u";class TR{constructor(){throw new Error("MediaRecorder is not available in this environment")}}const CR=Ph?MediaRecorder:TR;class wR extends CR{constructor(e,n){if(!Ph)throw new Error("MediaRecorder is not available in this environment");super(new MediaStream([e.mediaStreamTrack]),n);let r,o;const a=()=>o===void 0,l=()=>{this.removeEventListener("dataavailable",r),this.removeEventListener("stop",l),this.removeEventListener("error",u),o?.close(),o=void 0},u=d=>{o?.error(d),this.removeEventListener("dataavailable",r),this.removeEventListener("stop",l),this.removeEventListener("error",u),o=void 0};this.byteStream=new ReadableStream({start:d=>{o=d,r=f=>j(this,void 0,void 0,function*(){let m;if(f.data.arrayBuffer){const y=yield f.data.arrayBuffer();m=new Uint8Array(y)}else if(f.data.byteArray)m=f.data.byteArray;else throw new Error("no data available!");a()||d.enqueue(m)}),this.addEventListener("dataavailable",r)},cancel:()=>{l()}}),this.addEventListener("stop",l),this.addEventListener("error",u)}}function ER(){return Ph}const _R=1e3,RR=1e4;class eb extends G{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,n,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=arguments.length>4?arguments[4]:void 0;super(e,n,a),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=wh(()=>j(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>j(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(ne.Ended,this)},this.reacquireTrack=!1,this.providedByUser=o,this.muteLock=new Rt,this.pauseUpstreamLock=new Rt,this.processorLock=new Rt,this.restartLock=new Rt,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),r&&(this._constraints=r)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==G.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,n){return j(this,void 0,void 0,function*(){var r;if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(a=>{Vr(this._mediaStreamTrack,a)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let o;if(this.processor&&e){const a=yield this.processorLock.lock();try{if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(Lr(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),o=this.processor.processedTrack}finally{a()}}this.sender&&((r=this.sender.transport)===null||r===void 0?void 0:r.state)!=="closed"&&(yield this.sender.replaceTrack(o??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(a=>{Lr(o??e,a)}))})}waitForDimensions(){return j(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_R;return function*(){var r;if(e.kind===G.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((r=Jt())===null||r===void 0?void 0:r.os)==="iOS"&&(yield Bt(10));const o=Date.now();for(;Date.now()-o<n;){const a=e.dimensions;if(a)return a;yield Bt(50)}throw new Jn("unable to get track dimensions after timeout")}()})}setDeviceId(e){return j(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Ri(e)||(this._constraints.deviceId=e,this.isMuted)?!0:(yield this.restartTrack(),Ri(e)===this._mediaStreamTrack.getSettings().deviceId)})}getDeviceId(){return j(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){if(e.source===G.Source.ScreenShare)return;const{deviceId:r,groupId:o}=e._mediaStreamTrack.getSettings(),a=e.kind===G.Kind.Audio?"audioinput":"videoinput";return n?gt.getInstance().normalizeDeviceId(a,r,o):r}()})}mute(){return j(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return j(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,n){return j(this,void 0,void 0,function*(){if(!this.sender)throw new Jn("unable to replace an unpublished track");let r,o;return typeof n=="boolean"?r=n:n!==void 0&&(r=n.userProvidedTrack,o=n.stopProcessor),this.providedByUser=r??!0,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),o&&this.processor&&(yield this.stopProcessor()),this})}restart(e){return j(this,void 0,void 0,function*(){this.manuallyStopped=!1;const n=yield this.restartLock.lock();try{e||(e=this._constraints);const{deviceId:r,facingMode:o}=e,a=a_(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const l={audio:!1,video:!1};this.kind===G.Kind.Video?l.video=r||o?{deviceId:r,facingMode:o}:!0:l.audio=r?{deviceId:r}:!0,this.attachedElements.forEach(f=>{Vr(this.mediaStreamTrack,f)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const d=(yield navigator.mediaDevices.getUserMedia(l)).getTracks()[0];return yield d.applyConstraints(a),d.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(d),this._constraints=e,this.emit(ne.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{n()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ne.Muted:ne.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return j(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Hy()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return j(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(ne.UpstreamPaused,this);const r=Jt();if(r?.name==="Safari"&&In(r.version,"12.0")<0)throw new bh("pauseUpstream is not supported on Safari < 12.");((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(null))}finally{n()}})}resumeUpstream(){return j(this,void 0,void 0,function*(){var e;const n=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(ne.UpstreamResumed,this),((e=this.sender.transport)===null||e===void 0?void 0:e.state)!=="closed"&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{n()}})}getRTCStatsReport(){return j(this,void 0,void 0,function*(){var e;return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){return j(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var a;const l=yield r.processorLock.lock();try{r.log.debug("setting up processor",r.logContext);const u=document.createElement(r.kind),d={kind:r.kind,track:r._mediaStreamTrack,element:u,audioContext:r.audioContext};if(yield n.init(d),r.log.debug("processor initialized",r.logContext),r.processor&&(yield r.stopProcessor()),r.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");if(Lr(r._mediaStreamTrack,u),u.muted=!0,u.play().catch(f=>{f instanceof DOMException&&f.name==="AbortError"?(r.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},r.logContext),{error:f})),setTimeout(()=>{u.play().catch(m=>{r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{err:m}))})},100)):r.log.error("failed to play processor element",Object.assign(Object.assign({},r.logContext),{error:f}))}),r.processor=n,r.processorElement=u,r.processor.processedTrack){for(const f of r.attachedElements)f!==r.processorElement&&o&&(Vr(r._mediaStreamTrack,f),Lr(r.processor.processedTrack,f));yield(a=r.sender)===null||a===void 0?void 0:a.replaceTrack(r.processor.processedTrack)}r.emit(ne.TrackProcessorUpdate,r.processor)}finally{l()}}()})}getProcessor(){return this.processor}stopProcessor(){return j(this,arguments,void 0,function(){var e=this;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var r,o;e.processor&&(e.log.debug("stopping processor",e.logContext),(r=e.processor.processedTrack)===null||r===void 0||r.stop(),yield e.processor.destroy(),e.processor=void 0,n||((o=e.processorElement)===null||o===void 0||o.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(ne.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100;if(!ER()){this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext);return}if(this.localTrackRecorder){this.log.warn("preconnect buffer already started");return}else{let n="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(n)||(n="video/mp4"),this.localTrackRecorder=new wR(this,{mimeType:n})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},RR)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return(e=this.localTrackRecorder)===null||e===void 0?void 0:e.mimeType}}class dl extends eb{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;super(e,G.Kind.Audio,n,r,a),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>j(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let l;try{l=yield this.getSenderStats()}catch(u){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:u}));return}l&&this.prevStats&&(this._currentBitrate=jl(l,this.prevStats)),this.prevStats=l}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(ne.AudioTrackFeatureUpdate,this,mt.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(ne.AudioTrackFeatureUpdate,this,mt.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=o,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return j(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===G.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return j(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const r=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Ri(this._constraints.deviceId);return this.source===G.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||r)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return j(this,void 0,void 0,function*(){let n;if(e){const r=kh({audio:e});typeof r.audio!="boolean"&&(n=r.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return j(this,void 0,void 0,function*(){const r=yield n.restart.call(this,e);return this.checkForSilence(),r})}startMonitor(){Mt()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Rh)))}setProcessor(e){return j(this,void 0,void 0,function*(){var n;const r=yield this.processorLock.lock();try{if(!Nn()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.stopProcessor());const o={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(o),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(ne.TrackProcessorUpdate,this.processor)}finally{r()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return j(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let r;return n.forEach(o=>{o.type==="outbound-rtp"&&(r={type:"audio",streamId:o.id,packetsSent:o.packetsSent,packetsLost:o.packetsLost,bytesSent:o.bytesSent,timestamp:o.timestamp,roundTripTime:o.roundTripTime,jitter:o.jitter})}),r})}checkForSilence(){return j(this,void 0,void 0,function*(){const e=yield Ky(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(ne.AudioSilenceDetected)),e})}}function PR(t,e,n){switch(t.kind){case"audio":return new dl(t,e,!1,void 0,n);case"video":return new hl(t,e,!1,n);default:throw new Jn("unsupported track type: ".concat(t.kind))}}const NR=Object.values(oo),IR=Object.values(Ud),jR=Object.values(xh),OR=[oo.h180,oo.h360],AR=[Ud.h180,Ud.h360],DR=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var r,o;return new qe(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((r=t.encoding.maxFramerate)!==null&&r!==void 0?r:30)/((o=n.fps)!==null&&o!==void 0?o:30))))),n.fps,t.encoding.priority)}),Kd=["q","h","f"];function Jd(t,e,n,r){var o,a;let l=r?.videoEncoding;t&&(l=r?.screenShareEncoding);const u=r?.simulcast,d=r?.scalabilityMode,f=r?.videoCodec;if(!l&&!u&&!d||!e||!n)return[{}];l||(l=MR(t,e,n,f),De.debug("using video encoding",l));const m=l.maxFramerate,y=new qe(e,n,l.maxBitrate,l.maxFramerate,l.priority);if(d&&_n(f)){const k=new tb(d),T=[];if(k.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(d));const C=Jt();if(cl()||Nn()||C?.name==="Chrome"&&In(C?.version,"113")<0){const w=k.suffix=="h"?2:3,A=F_(C);for(let P=0;P<k.spatial;P+=1)T.push({rid:Kd[2-P],maxBitrate:l.maxBitrate/Math.pow(w,P),maxFramerate:y.encoding.maxFramerate,scaleResolutionDownBy:A?Math.pow(2,P):void 0});T[0].scalabilityMode=d}else T.push({maxBitrate:l.maxBitrate,maxFramerate:y.encoding.maxFramerate,scalabilityMode:d});return y.encoding.priority&&(T[0].priority=y.encoding.priority,T[0].networkPriority=y.encoding.priority),De.debug("using svc encoding",{encodings:T}),T}if(!u)return[l];let b=[];t?b=(o=o0(r?.screenShareSimulcastLayers))!==null&&o!==void 0?o:s0(t,y):b=(a=o0(r?.videoSimulcastLayers))!==null&&a!==void 0?a:s0(t,y);let S;if(b.length>0){const k=b[0];b.length>1&&([,S]=b);const T=Math.max(e,n);if(T>=960&&S)return Xu(e,n,[k,S,y],m);if(T>=480)return Xu(e,n,[k,y],m)}return Xu(e,n,[y])}function LR(t,e,n){var r,o,a,l;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&De.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const u=t.mediaStreamTrack.getSettings(),d=(r=u.width)!==null&&r!==void 0?r:(o=t.dimensions)===null||o===void 0?void 0:o.width,f=(a=u.height)!==null&&a!==void 0?a:(l=t.dimensions)===null||l===void 0?void 0:l.height;return t.source===G.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),Jd(t.source===G.Source.ScreenShare,d,f,n)}function MR(t,e,n,r){const o=UR(t,e,n);let{encoding:a}=o[0];const l=Math.max(e,n);for(let u=0;u<o.length;u+=1){const d=o[u];if(a=d.encoding,d.width>=l)break}if(r)switch(r){case"av1":case"h265":a=Object.assign({},a),a.maxBitrate=a.maxBitrate*.7;break;case"vp9":a=Object.assign({},a),a.maxBitrate=a.maxBitrate*.85;break}return a}function UR(t,e,n){if(t)return jR;const r=e>n?e/n:n/e;return Math.abs(r-16/9)<Math.abs(r-4/3)?NR:IR}function s0(t,e){if(t)return DR(e);const{width:n,height:r}=e,o=n>r?n/r:r/n;return Math.abs(o-16/9)<Math.abs(o-4/3)?OR:AR}function Xu(t,e,n,r){const o=[];if(n.forEach((a,l)=>{if(l>=Kd.length)return;const u=Math.min(t,e),f={rid:Kd[l],scaleResolutionDownBy:Math.max(1,u/Math.min(a.width,a.height)),maxBitrate:a.encoding.maxBitrate},m=r&&a.encoding.maxFramerate?Math.min(r,a.encoding.maxFramerate):a.encoding.maxFramerate;m&&(f.maxFramerate=m);const y=Wr()||l===0;a.encoding.priority&&y&&(f.priority=a.encoding.priority,f.networkPriority=a.encoding.priority),o.push(f)}),Nn()&&Wy()==="ios"){let a;o.forEach(u=>{a?u.maxFramerate&&u.maxFramerate>a&&(a=u.maxFramerate):a=u.maxFramerate});let l=!0;o.forEach(u=>{var d;u.maxFramerate!=a&&(l&&(l=!1,De.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),De.info('Setting framerate of encoding "'.concat((d=u.rid)!==null&&d!==void 0?d:"",'" to ').concat(a)),u.maxFramerate=a)})}return o}function o0(t){if(t)return t.sort((e,n)=>{const{encoding:r}=e,{encoding:o}=n;return r.maxBitrate>o.maxBitrate?1:r.maxBitrate<o.maxBitrate?-1:r.maxBitrate===o.maxBitrate&&r.maxFramerate&&o.maxFramerate?r.maxFramerate>o.maxFramerate?1:-1:0})}class tb{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}function FR(t){return t.source===G.Source.ScreenShare||t.constraints.height&&Ri(t.constraints.height)>=1080?"maintain-resolution":"balanced"}const BR=5e3;class hl extends eb{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3?arguments[3]:void 0;super(e,G.Kind.Video,n,r,o),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>j(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let a;try{a=yield this.getSenderStats()}catch(d){this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:d}));return}const l=new Map(a.map(d=>[d.rid,d])),u=a.some(d=>d.qualityLimitationReason==="cpu");if(u!==this.isCpuConstrained&&(this.isCpuConstrained=u,this.isCpuConstrained&&this.emit(ne.CpuConstrained)),this.prevStats){let d=0;l.forEach((f,m)=>{var y;const b=(y=this.prevStats)===null||y===void 0?void 0:y.get(m);d+=jl(f,b)}),this._currentBitrate=d}this.prevStats=l}),this.senderLock=new Rt}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!Mt())return;const r=(n=this.sender)===null||n===void 0?void 0:n.getParameters();r&&(this.encodings=r.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Rh))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return j(this,void 0,void 0,function*(){var n,r,o,a,l;yield e.pauseUpstream.call(this);try{for(var u=!0,d=Kn(this.simulcastCodecs.values()),f;f=yield d.next(),n=f.done,!n;u=!0)a=f.value,u=!1,yield(l=a.sender)===null||l===void 0?void 0:l.replaceTrack(null)}catch(m){r={error:m}}finally{try{!u&&!n&&(o=d.return)&&(yield o.call(d))}finally{if(r)throw r.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return j(this,void 0,void 0,function*(){var n,r,o,a,l;yield e.resumeUpstream.call(this);try{for(var u=!0,d=Kn(this.simulcastCodecs.values()),f;f=yield d.next(),n=f.done,!n;u=!0){a=f.value,u=!1;const m=a;yield(l=m.sender)===null||l===void 0?void 0:l.replaceTrack(m.mediaStreamTrack)}}catch(m){r={error:m}}finally{try{!u&&!n&&(o=d.return)&&(yield o.call(d))}finally{if(r)throw r.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return j(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===G.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return j(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.isMuted?(this.source===G.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){return j(this,void 0,void 0,function*(){var e;if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],r=yield this.sender.getStats();return r.forEach(o=>{var a;if(o.type==="outbound-rtp"){const l={type:"video",streamId:o.id,frameHeight:o.frameHeight,frameWidth:o.frameWidth,framesPerSecond:o.framesPerSecond,framesSent:o.framesSent,firCount:o.firCount,pliCount:o.pliCount,nackCount:o.nackCount,packetsSent:o.packetsSent,bytesSent:o.bytesSent,qualityLimitationReason:o.qualityLimitationReason,qualityLimitationDurations:o.qualityLimitationDurations,qualityLimitationResolutionChanges:o.qualityLimitationResolutionChanges,rid:(a=o.rid)!==null&&a!==void 0?a:o.id,retransmittedPacketsSent:o.retransmittedPacketsSent,targetBitrate:o.targetBitrate,timestamp:o.timestamp},u=r.get(o.remoteId);u&&(l.jitter=u.jitter,l.packetsLost=u.packetsLost,l.roundTripTime=u.roundTripTime),n.push(l)}}),n.sort((o,a)=>{var l,u;return((l=a.frameWidth)!==null&&l!==void 0?l:0)-((u=o.frameWidth)!==null&&u!==void 0?u:0)}),n})}setPublishingQuality(e){const n=[];for(let r=Kt.LOW;r<=Kt.HIGH;r+=1)n.push(new gh({quality:r,enabled:r<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(_n(this.codec),n)}restartTrack(e){return j(this,void 0,void 0,function*(){var n,r,o,a,l;let u;if(e){const y=kh({video:e});typeof y.video!="boolean"&&(u=y.video)}yield this.restart(u),this.isCpuConstrained=!1;try{for(var d=!0,f=Kn(this.simulcastCodecs.values()),m;m=yield f.next(),n=m.done,!n;d=!0){a=m.value,d=!1;const y=a;y.sender&&((l=y.sender.transport)===null||l===void 0?void 0:l.state)!=="closed"&&(y.mediaStreamTrack=this.mediaStreamTrack.clone(),yield y.sender.replaceTrack(y.mediaStreamTrack))}}catch(y){r={error:y}}finally{try{!d&&!n&&(o=f.return)&&(yield o.call(f))}finally{if(r)throw r.error}}})}setProcessor(e){const n=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return j(this,arguments,void 0,function(r){var o=this;let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){var l,u,d,f,m,y;if(yield n.setProcessor.call(o,r,a),!((m=o.processor)===null||m===void 0)&&m.processedTrack)try{for(var b=!0,S=Kn(o.simulcastCodecs.values()),k;k=yield S.next(),l=k.done,!l;b=!0)f=k.value,b=!1,yield(y=f.sender)===null||y===void 0?void 0:y.replaceTrack(o.processor.processedTrack)}catch(T){u={error:T}}finally{try{!b&&!l&&(d=S.return)&&(yield d.call(S))}finally{if(u)throw u.error}}}()})}setDegradationPreference(e){return j(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const n=this.sender.getParameters();n.degradationPreference=e,this.sender.setParameters(n)}catch(n){this.log.warn("failed to set degradationPreference",Object.assign({error:n},this.logContext))}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e)){this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);return}const r={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,r),r}setSimulcastTrackSender(e,n){const r=this.simulcastCodecs.get(e);r&&(r.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},BR))}setPublishingCodecs(e){return j(this,void 0,void 0,function*(){var n,r,o,a,l,u,d;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(_n(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const f=[];try{for(n=!0,r=Kn(e);o=yield r.next(),a=o.done,!a;n=!0){d=o.value,n=!1;const m=d;if(!this.codec||this.codec===m.codec)yield this.setPublishingLayers(_n(m.codec),m.qualities);else{const y=this.simulcastCodecs.get(m.codec);if(this.log.debug("try setPublishingCodec for ".concat(m.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:y})),!y||!y.sender){for(const b of m.qualities)if(b.enabled){f.push(m.codec);break}}else y.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(m.codec),this.logContext),yield a0(y.sender,y.encodings,m.qualities,this.senderLock,_n(m.codec),this.log,this.logContext))}}}catch(m){l={error:m}}finally{try{!n&&!a&&(u=r.return)&&(yield u.call(r))}finally{if(l)throw l.error}}return f})}setPublishingLayers(e,n){return j(this,void 0,void 0,function*(){if(this.optimizeForPerformance){this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:n}));return}this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:n})),!(!this.sender||!this.encodings)&&(yield a0(this.sender,this.encodings,n,this.senderLock,e,this.log,this.logContext))})}prioritizePerformance(){return j(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const n=this.sender.getParameters();n.encodings=n.encodings.map((r,o)=>{var a;return Object.assign(Object.assign({},r),{active:o===0,scaleResolutionDownBy:Math.max(1,Math.ceil(((a=this.mediaStreamTrack.getSettings().height)!==null&&a!==void 0?a:360)/360)),scalabilityMode:o===0&&_n(this.codec)?"L1T3":void 0,maxFramerate:o===0?15:0,maxBitrate:o===0?r.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:n.encodings})),this.encodings=n.encodings,yield this.sender.setParameters(n)}catch(n){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:n})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return j(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Hy()&&this.isInBackground&&this.source===G.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function a0(t,e,n,r,o,a,l){return j(this,void 0,void 0,function*(){const u=yield r.lock();a.debug("setPublishingLayersForSender",Object.assign(Object.assign({},l),{sender:t,qualities:n,senderEncodings:e}));try{const d=t.getParameters(),{encodings:f}=d;if(!f)return;if(f.length!==e.length){a.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},l),{encodings:f,senderEncodings:e}));return}let m=!1;!1&&f[0].scalabilityMode||(o&&n.some(S=>S.enabled)&&n.forEach(S=>S.enabled=!0),f.forEach((b,S)=>{var k;let T=(k=b.rid)!==null&&k!==void 0?k:"";T===""&&(T="q");const C=nb(T),w=n.find(A=>A.quality===C);w&&b.active!==w.enabled&&(m=!0,b.active=w.enabled,a.debug("setting layer ".concat(w.quality," to ").concat(b.active?"enabled":"disabled"),l),Wr()&&(w.enabled?(b.scaleResolutionDownBy=e[S].scaleResolutionDownBy,b.maxBitrate=e[S].maxBitrate,b.maxFrameRate=e[S].maxFrameRate):(b.scaleResolutionDownBy=4,b.maxBitrate=10,b.maxFrameRate=2)))})),m&&(d.encodings=f,a.debug("setting encodings",Object.assign(Object.assign({},l),{encodings:d.encodings})),yield t.setParameters(d))}finally{u()}})}function nb(t){switch(t){case"f":return Kt.HIGH;case"h":return Kt.MEDIUM;case"q":return Kt.LOW;default:return Kt.HIGH}}function l0(t,e,n,r){if(!n)return[new Yi({quality:Kt.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(r){const o=n[0].scalabilityMode,a=new tb(o),l=[],u=a.suffix=="h"?1.5:2,d=a.suffix=="h"?2:3;for(let f=0;f<a.spatial;f+=1)l.push(new Yi({quality:Math.min(Kt.HIGH,a.spatial-1)-f,width:Math.ceil(t/Math.pow(u,f)),height:Math.ceil(e/Math.pow(u,f)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(d,f)):0,ssrc:0}));return l}return n.map(o=>{var a,l,u;const d=(a=o.scaleResolutionDownBy)!==null&&a!==void 0?a:1;let f=nb((l=o.rid)!==null&&l!==void 0?l:"");return new Yi({quality:f,width:Math.ceil(t/d),height:Math.ceil(e/d),bitrate:(u=o.maxBitrate)!==null&&u!==void 0?u:0,ssrc:0})})}const c0="_lossy",u0="_reliable",zR=2*1e3,Zu="leave-reconnect",VR=3e4;var dn;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(dn||(dn={}));class qR extends On.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Eh.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=dn.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=De,this.reliableDataSequence=1,this.reliableMessageBuffer=new Qg,this.reliableReceivedState=new fR(VR),this.handleDataChannel=r=>j(this,[r],void 0,function(o){var a=this;let{channel:l}=o;return function*(){if(l){if(l.label===u0)a.reliableDCSub=l;else if(l.label===c0)a.lossyDCSub=l;else return;a.log.debug("on data channel ".concat(l.id,", ").concat(l.label),a.logContext),l.onmessage=a.handleDataMessage}}()}),this.handleDataMessage=r=>j(this,void 0,void 0,function*(){var o,a;const l=yield this.dataProcessLock.lock();try{let u;if(r.data instanceof ArrayBuffer)u=r.data;else if(r.data instanceof Blob)u=yield r.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:r.data}));return}const d=Dt.fromBinary(new Uint8Array(u));if(d.sequence>0&&d.participantSid!==""){const f=this.reliableReceivedState.get(d.participantSid);if(f&&d.sequence<=f)return;this.reliableReceivedState.set(d.participantSid,d.sequence)}((o=d.value)===null||o===void 0?void 0:o.case)==="speaker"?this.emit(re.ActiveSpeakersUpdate,d.value.value.speakers):(((a=d.value)===null||a===void 0?void 0:a.case)==="user"&&$R(d,d.value.value),this.emit(re.DataPacketReceived,d))}finally{l()}}),this.handleDataError=r=>{const a=r.currentTarget.maxRetransmits===0?"lossy":"reliable";if(r instanceof ErrorEvent&&r.error){const{error:l}=r.error;this.log.error("DataChannel error on ".concat(a,": ").concat(r.message),Object.assign(Object.assign({},this.logContext),{error:l}))}else this.log.error("Unknown DataChannel error on ".concat(a),Object.assign(Object.assign({},this.logContext),{event:r}))},this.handleBufferedAmountLow=r=>{const a=r.currentTarget.maxRetransmits===0?Re.LOSSY:Re.RELIABLE;this.updateAndEmitDCBufferStatus(a)},this.handleDisconnect=(r,o)=>{if(this._isClosed)return;this.log.warn("".concat(r," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const a=d=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(d,"ms. giving up"),this.logContext),this.emit(re.Disconnected),this.close()},l=Date.now()-this.reconnectStart;let u=this.getNextRetryDelay({elapsedMs:l,retryCount:this.reconnectAttempts});if(u===null){a(l);return}r===Zu&&(u=0),this.log.debug("reconnecting in ".concat(u,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=bt.setTimeout(()=>this.attemptReconnect(o).finally(()=>this.reconnectTimeout=void 0),u)},this.waitForRestarted=()=>new Promise((r,o)=>{this.pcState===dn.Connected&&r();const a=()=>{this.off(re.Disconnected,l),r()},l=()=>{this.off(re.Restarted,a),o()};this.once(re.Restarted,a),this.once(re.Disconnected,l)}),this.updateAndEmitDCBufferStatus=r=>{const o=this.isBufferStatusLow(r);typeof o<"u"&&o!==this.dcBufferStatus.get(r)&&(this.dcBufferStatus.set(r,o),this.emit(re.DCBufferStatusChanged,o,r))},this.isBufferStatusLow=r=>{const o=this.dataChannelForKind(r);if(o)return r===Re.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(o.bufferedAmount),o.bufferedAmount<=o.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Ke.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Or.RR_SIGNAL_DISCONNECTED))},this.log=ei((n=e.loggerName)!==null&&n!==void 0?n:gn.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Th(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new Rt,this.dataProcessLock=new Rt,this.dcBufferStatus=new Map([[Re.LOSSY,!0],[Re.RELIABLE,!0]]),this.client.onParticipantUpdate=r=>this.emit(re.ParticipantUpdate,r),this.client.onConnectionQuality=r=>this.emit(re.ConnectionQualityUpdate,r),this.client.onRoomUpdate=r=>this.emit(re.RoomUpdate,r),this.client.onSubscriptionError=r=>this.emit(re.SubscriptionError,r),this.client.onSubscriptionPermissionUpdate=r=>this.emit(re.SubscriptionPermissionUpdate,r),this.client.onSpeakersChanged=r=>this.emit(re.SpeakersChanged,r),this.client.onStreamStateUpdate=r=>this.emit(re.StreamStateChanged,r),this.client.onRequestResponse=r=>this.emit(re.SignalRequestResponse,r)}get logContext(){var e,n,r,o,a,l;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomID:(o=(r=this.latestJoinResponse)===null||r===void 0?void 0:r.room)===null||o===void 0?void 0:o.sid,participant:(l=(a=this.latestJoinResponse)===null||a===void 0?void 0:a.participant)===null||l===void 0?void 0:l.identity,pID:this.participantSid}}join(e,n,r,o){return j(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=r,this.maxJoinAttempts=r.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const a=yield this.client.join(e,n,r,o);return this._isClosed=!1,this.latestJoinResponse=a,this.subscriberPrimary=a.subscriberPrimary,this.pcManager||(yield this.configure(a)),(!this.subscriberPrimary||a.fastPublish)&&this.negotiate(),this.clientConfiguration=a.clientConfiguration,this.emit(re.SignalConnected,a),a}catch(a){if(a instanceof He&&a.reason===Me.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,r,o);throw a}})}close(){return j(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.joinAttempts=0,this.emit(re.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return j(this,void 0,void 0,function*(){var e;yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=r=>{r&&(r.close(),r.onbufferedamountlow=null,r.onclose=null,r.onclosing=null,r.onerror=null,r.onmessage=null,r.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new Qg,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return j(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Jn("a track with the same ID has already been published");return new Promise((n,r)=>{const o=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],r(new He("publication of local track timed out, no response from server",Me.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:a=>{clearTimeout(o),n(a)},reject:()=>{clearTimeout(o),r(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){return j(this,void 0,void 0,function*(){var e;return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return j(this,void 0,void 0,function*(){var n,r;if(this.pcManager&&this.pcManager.currentState!==tt.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const o=this.makeRTCConfiguration(e);this.pcManager=new SR(o,e.subscriberPrimary,this.loggerOptions),this.emit(re.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(a,l)=>{this.client.sendIceCandidate(a,l)},this.pcManager.onPublisherOffer=(a,l)=>{this.client.sendOffer(a,l)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(a,l,u)=>j(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(a),this.logContext),["closed","disconnected","failed"].includes(l)&&(this.publisherConnectionPromise=void 0),a===tt.CONNECTED){const m=this.pcState===dn.New;this.pcState=dn.Connected,m&&this.emit(re.Connected,e)}else a===tt.FAILED&&this.pcState===dn.Connected&&(this.pcState=dn.Disconnected,this.handleDisconnect("peerconnection failed",u==="failed"?Or.RR_SUBSCRIBER_FAILED:Or.RR_PUBLISHER_FAILED));const d=this.client.isDisconnected||this.client.currentState===Ke.RECONNECTING,f=[tt.FAILED,tt.CLOSING,tt.CLOSED].includes(a);d&&f&&!this._isClosed&&this.emit(re.Offline)}),this.pcManager.onTrack=a=>{this.emit(re.MediaTrackAdded,a.track,a.streams[0],a.receiver)},HR((r=e.serverInfo)===null||r===void 0?void 0:r.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,n)=>j(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e,n))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=(e,n)=>j(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=n,!this.pcManager)return;const r=yield this.pcManager.createSubscriberAnswerFromOffer(e,n);r&&this.client.sendAnswer(r,n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:r}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],r(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(re.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(re.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(re.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(re.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var n;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(re.RoomMoved,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Or.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e?.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case Br.DISCONNECT:this.emit(re.Disconnected,e?.reason),this.close();break;case Br.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(Zu);break;case Br.RESUME:this.handleDisconnect(Zu)}}}makeRTCConfiguration(e){var n;const r=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),r.encodedInsertableStreams=!0),e.iceServers&&!r.iceServers){const o=[];e.iceServers.forEach(a=>{const l={urls:a.urls};a.username&&(l.username=a.username),a.credential&&(l.credential=a.credential),o.push(l)}),r.iceServers=o}return e.clientConfiguration&&e.clientConfiguration.forceRelay===ro.ENABLED&&(r.iceTransportPolicy="relay"),r.sdpSemantics="unified-plan",r.continualGatheringPolicy="gather_continually",r}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(c0,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(u0,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,n,r){return j(this,void 0,void 0,function*(){if(Fd())return yield this.createTransceiverRTCRtpSender(e,n,r);if(Bd())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new dt("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,r,o){return j(this,void 0,void 0,function*(){if(Fd())return this.createSimulcastTransceiverSender(e,n,r,o);if(Bd())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new dt("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,r){return j(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("publisher is closed");const o=[];e.mediaStream&&o.push(e.mediaStream),or(e)&&(e.codec=n.videoCodec);const a={direction:"sendonly",streams:o};return r&&(a.sendEncodings=r),(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,a)).sender})}createSimulcastTransceiverSender(e,n,r,o){return j(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("publisher is closed");const a={direction:"sendonly"};o&&(a.sendEncodings=o);const l=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,a);if(r.videoCodec)return e.setSimulcastTrackSender(r.videoCodec,l.sender),l.sender})}createRTCRtpSender(e){return j(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return j(this,void 0,void 0,function*(){var n,r,o;if(!this._isClosed){if(this.attemptingReconnect){De.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===ro.DISABLED||((o=(r=this.pcManager)===null||r===void 0?void 0:r.currentState)!==null&&o!==void 0?o:tt.NEW)===tt.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(a){this.reconnectAttempts+=1;let l=!0;a instanceof dt?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:a})),l=!1):a instanceof Ar||(this.fullReconnectOnNext=!0),l?this.handleDisconnect("reconnect",Or.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(re.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){return j(this,void 0,void 0,function*(){var n,r,o;try{if(!this.url||!this.token)throw new dt("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(re.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let a;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Ar;a=yield this.join(e??this.url,this.token,this.signalOpts)}catch(l){throw l instanceof He&&l.reason===Me.NotAllowed?new dt("could not reconnect, token might be expired"):new Ar}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(re.SignalRestarted,a),yield this.waitForPCReconnected(),this.client.currentState!==Ke.CONNECTED)throw new Ar("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(re.Restarted)}catch(a){const l=yield(r=this.regionUrlProvider)===null||r===void 0?void 0:r.getNextBestRegionUrl();if(l){yield this.restartConnection(l);return}else throw(o=this.regionUrlProvider)===null||o===void 0||o.resetAttempts(),a}})}resumeConnection(e){return j(this,void 0,void 0,function*(){var n;if(!this.url||!this.token)throw new dt("could not reconnect, url or token not saved");if(!this.pcManager)throw new dt("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(re.Resuming);let r;try{this.setupSignalClientCallbacks(),r=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(o){let a="";throw o instanceof Error&&(a=o.message,this.log.error(o.message,Object.assign(Object.assign({},this.logContext),{error:o}))),o instanceof He&&o.reason===Me.NotAllowed?new dt("could not reconnect, token might be expired"):o instanceof He&&o.reason===Me.LeaveRequest?o:new Ar(a)}if(this.emit(re.SignalResumed),r){const o=this.makeRTCConfiguration(r);this.pcManager.updateConfiguration(o),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=r.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Ke.CONNECTED)throw new Ar("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),r?.lastMessageSeq&&this.resendReliableMessagesForResume(r.lastMessageSeq),this.emit(re.Resumed)})}waitForPCInitialConnection(e,n){return j(this,void 0,void 0,function*(){if(!this.pcManager)throw new dt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return j(this,void 0,void 0,function*(){this.pcState=dn.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Bt(zR),!this.pcManager)throw new dt("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=dn.Connected}catch(e){throw this.pcState=dn.Disconnected,new He("could not establish PC connection, ".concat(e.message),Me.InternalError)}})}publishRpcResponse(e,n,r,o){return j(this,void 0,void 0,function*(){const a=new Dt({destinationIdentities:[e],kind:Re.RELIABLE,value:{case:"rpcResponse",value:new $v({requestId:n,value:o?{case:"error",value:o.toProto()}:{case:"payload",value:r??""}})}});yield this.sendDataPacket(a,Re.RELIABLE)})}publishRpcAck(e,n){return j(this,void 0,void 0,function*(){const r=new Dt({destinationIdentities:[e],kind:Re.RELIABLE,value:{case:"rpcAck",value:new Hv({requestId:n})}});yield this.sendDataPacket(r,Re.RELIABLE)})}sendDataPacket(e,n){return j(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(n),n===Re.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const r=e.toBinary(),o=this.dataChannelForKind(n);if(o){if(n===Re.RELIABLE&&this.reliableMessageBuffer.push({data:r,sequence:e.sequence}),this.attemptingReconnect)return;o.send(r)}this.updateAndEmitDCBufferStatus(n)})}resendReliableMessagesForResume(e){return j(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(Re.RELIABLE);const n=this.dataChannelForKind(Re.RELIABLE);n&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(r=>{n.send(r.data)})),this.updateAndEmitDCBufferStatus(Re.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((n,r)=>j(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))n();else{const o=()=>r("Engine closed");for(this.once(re.Closing,o);!this.dcBufferStatus.get(e);)yield Bt(10);this.off(re.Closing,o),n()}}))}ensureDataTransportConnected(e){return j(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;return function*(){var a;if(!r.pcManager)throw new dt("PC manager is closed");const l=o?r.pcManager.subscriber:r.pcManager.publisher,u=o?"Subscriber":"Publisher";if(!l)throw new He("".concat(u," connection not set"),Me.InternalError);let d=!1;!o&&!r.dataChannelForKind(n,o)&&(r.createDataChannels(),d=!0),!d&&!o&&!r.pcManager.publisher.isICEConnected&&r.pcManager.publisher.getICEConnectionState()!=="checking"&&(d=!0),d&&r.negotiate();const f=r.dataChannelForKind(n,o);if(f?.readyState==="open")return;const m=new Date().getTime()+r.peerConnectionTimeout;for(;new Date().getTime()<m;){if(l.isICEConnected&&((a=r.dataChannelForKind(n,o))===null||a===void 0?void 0:a.readyState)==="open")return;yield Bt(50)}throw new He("could not establish ".concat(u," connection, state: ").concat(l.getICEConnectionState()),Me.InternalError)}()})}ensurePublisherConnected(e){return j(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==tt.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return j(this,void 0,void 0,function*(){return new Promise((e,n)=>j(this,void 0,void 0,function*(){if(!this.pcManager){n(new Ld("PC manager is closed"));return}this.pcManager.requirePublisher(),this.pcManager.publisher.getTransceivers().length==0&&!this.lossyDC&&!this.reliableDC&&this.createDataChannels();const r=new AbortController,o=()=>{r.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(re.Closing,o),this.pcManager.publisher.once(Hr.RTPVideoPayloadTypes,a=>{const l=new Map;a.forEach(u=>{const d=u.codec.toLowerCase();$_(d)&&l.set(u.payload,d)}),this.emit(re.RTPVideoMapUpdate,l)});try{yield this.pcManager.negotiate(r),e()}catch(a){a instanceof Ld&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Or.RR_UNKNOWN),n(a)}finally{this.off(re.Closing,o)}}))})}dataChannelForKind(e,n){if(n){if(e===Re.LOSSY)return this.lossyDCSub;if(e===Re.RELIABLE)return this.reliableDCSub}else{if(e===Re.LOSSY)return this.lossyDC;if(e===Re.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var r,o;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const a=this.pcManager.subscriber.getLocalDescription(),l=this.pcManager.subscriber.getRemoteDescription(),u=(o=(r=this.signalOpts)===null||r===void 0?void 0:r.autoSubscribe)!==null&&o!==void 0?o:!0,d=new Array,f=new Array;e.forEach(m=>{m.isDesired!==u&&d.push(m.trackSid),m.isEnabled||f.push(m.trackSid)}),this.client.sendSyncState(new ly({answer:a?ul({sdp:a.sdp,type:a.type}):void 0,offer:l?ul({sdp:l.sdp,type:l.type}):void 0,subscription:new Pl({trackSids:d,subscribe:!u,participantTracks:[]}),publishTracks:eR(n),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:f,datachannelReceiveStates:this.reliableReceivedState.map((m,y)=>new cy({publisherSid:y,lastSeq:m}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(r,o)=>{r?.id!==void 0&&r.id!==null&&e.push(new uy({label:r.label,id:r.id,target:o}))};return n(this.dataChannelForKind(Re.LOSSY),pn.PUBLISHER),n(this.dataChannelForKind(Re.RELIABLE),pn.PUBLISHER),n(this.dataChannelForKind(Re.LOSSY,!0),pn.SUBSCRIBER),n(this.dataChannelForKind(Re.RELIABLE,!0),pn.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&bt.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Mt()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Mt()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class Ar extends Error{}function HR(t){return t!==void 0&&t>13}function $R(t,e){const n=t.participantIdentity?t.participantIdentity:e.participantIdentity;t.participantIdentity=n,e.participantIdentity=n;const r=t.destinationIdentities.length!==0?t.destinationIdentities:e.destinationIdentities;t.destinationIdentities=r,e.destinationIdentities=r}class Qd{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return Vd(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return j(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(r=>!this.attemptedRegions.find(o=>o.url===r.url));if(n.length>0){const r=n[0];return this.attemptedRegions.push(r),De.debug("next region: ".concat(r.region)),r.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return j(this,void 0,void 0,function*(){const n=yield fetch("".concat(WR(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const r=yield n.json();return this.lastUpdateAt=Date.now(),r}else throw new He("Could not fetch region settings: ".concat(n.statusText),n.status===401?Me.NotAllowed:Me.InternalError,n.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}function WR(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}class ib{get info(){return this._info}constructor(e,n,r){this.reader=n,this.totalByteSize=r,this._info=e,this.bytesReceived=0}}class GR extends ib{handleChunkReceived(e){var n;this.bytesReceived+=e.content.byteLength;const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader();return{next:()=>j(this,void 0,void 0,function*(){try{const{done:n,value:r}=yield e.read();return n?{done:!0,value:void 0}:(this.handleChunkReceived(r),{done:!1,value:r.content})}catch{return{done:!0,value:void 0}}}),return(){return j(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return j(this,void 0,void 0,function*(){var e,n,r,o;let a=new Set;try{for(var l=!0,u=Kn(this),d;d=yield u.next(),e=d.done,!e;l=!0){o=d.value,l=!1;const f=o;a.add(f)}}catch(f){n={error:f}}finally{try{!l&&!e&&(r=u.return)&&(yield r.call(u))}finally{if(n)throw n.error}}return Array.from(a)})}}class KR extends ib{constructor(e,n,r){super(e,n,r),this.receivedChunks=new Map}handleChunkReceived(e){var n;const r=Qa(e.chunkIndex),o=this.receivedChunks.get(r);if(o&&o.version>e.version)return;this.receivedChunks.set(r,e),this.bytesReceived+=e.content.byteLength;const a=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;(n=this.onProgress)===null||n===void 0||n.call(this,a)}[Symbol.asyncIterator](){const e=this.reader.getReader(),n=new TextDecoder;return{next:()=>j(this,void 0,void 0,function*(){try{const{done:r,value:o}=yield e.read();return r?{done:!0,value:void 0}:(this.handleChunkReceived(o),{done:!1,value:n.decode(o.content)})}catch{return{done:!0,value:void 0}}}),return(){return j(this,void 0,void 0,function*(){return e.releaseLock(),{done:!0,value:void 0}})}}}readAll(){return j(this,void 0,void 0,function*(){var e,n,r,o;let a="";try{for(var l=!0,u=Kn(this),d;d=yield u.next(),e=d.done,!e;l=!0)o=d.value,l=!1,a+=o}catch(f){n={error:f}}finally{try{!l&&!e&&(r=u.return)&&(yield r.call(u))}finally{if(n)throw n.error}}return a})}}class rb{constructor(e,n,r){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=r,this.info=n}write(e){return this.defaultWriter.write(e)}close(){return j(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),(e=this.onClose)===null||e===void 0||e.call(this)})}}class JR extends rb{}class QR extends rb{}class sb extends G{constructor(e,n,r,o,a){super(e,r,a),this.sid=n,this.receiver=o}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?ne.Muted:ne.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=r=>{r.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(ne.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return j(this,void 0,void 0,function*(){var e;return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Rh)),tR()&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var n;this.timeSyncHandle=requestAnimationFrame(()=>e());const r=(n=this.receiver)===null||n===void 0?void 0:n.getSynchronizationSources()[0];if(r){const{timestamp:o,rtpTimestamp:a}=r;a&&this.rtpTimestamp!==a&&(this.emit(ne.TimeSyncUpdate,{timestamp:o,rtpTimestamp:a}),this.rtpTimestamp=a)}};e()}}class ob extends sb{constructor(e,n,r,o,a,l){super(e,n,G.Kind.Audio,r,l),this.monitorReceiver=()=>j(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const u=yield this.getReceiverStats();u&&this.prevStats&&this.receiver&&(this._currentBitrate=jl(u,this.prevStats)),this.prevStats=u}),this.audioContext=o,this.webAudioPluginNodes=[],a&&(this.sinkId=a.deviceId)}setVolume(e){var n;for(const r of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):r.volume=e;Nn()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(Nn())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return j(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(zd(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&zd(e)&&e.setSinkId(this.sinkId).catch(r=>{this.log.error("Failed to set sink id on remote audio track",r,this.logContext)}),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let r=this.sourceNode;this.webAudioPluginNodes.forEach(o=>{r.connect(o),r=o}),this.gainNode=e.createGain(),r.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(ne.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(o=>{this.emit(ne.AudioPlaybackFailed,o)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return j(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(r=>{r.type==="inbound-rtp"&&(n={type:"audio",streamId:r.id,timestamp:r.timestamp,jitter:r.jitter,bytesReceived:r.bytesReceived,concealedSamples:r.concealedSamples,concealmentEvents:r.concealmentEvents,silentConcealedSamples:r.silentConcealedSamples,silentConcealmentEvents:r.silentConcealmentEvents,totalAudioEnergy:r.totalAudioEnergy,totalSamplesDuration:r.totalSamplesDuration})}),n})}}const ed=100;class YR extends sb{constructor(e,n,r,o,a){super(e,n,G.Kind.Video,r,a),this.elementInfos=[],this.monitorReceiver=()=>j(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const l=yield this.getReceiverStats();l&&this.prevStats&&this.receiver&&(this._currentBitrate=jl(l,this.prevStats)),this.prevStats=l}),this.debouncedHandleResize=wh(()=>{this.updateDimensions()},ed),this.adaptiveStreamSettings=o}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?Vr(this._mediaStreamTrack,n):Lr(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new XR(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(r=>r===e);for(const r of n)r.stopObserving();this.elementInfos=this.elementInfos.filter(r=>r!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const r of n)this.stopObservingElement(r);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return j(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,r="",o=new Map;return e.forEach(a=>{a.type==="inbound-rtp"?(r=a.codecId,n={type:"video",streamId:a.id,framesDecoded:a.framesDecoded,framesDropped:a.framesDropped,framesReceived:a.framesReceived,packetsReceived:a.packetsReceived,packetsLost:a.packetsLost,frameWidth:a.frameWidth,frameHeight:a.frameHeight,pliCount:a.pliCount,firCount:a.firCount,nackCount:a.nackCount,jitter:a.jitter,timestamp:a.timestamp,bytesReceived:a.bytesReceived,decoderImplementation:a.decoderImplementation}):a.type==="codec"&&o.set(a.id,a)}),n&&r!==""&&o.get(r)&&(n.mimeType=o.get(r).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(r=>r.element===e);for(const r of n)this.stopObservingElementInfo(r)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return j(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const r=this.elementInfos.reduce((u,d)=>Math.max(u,d.visibilityChangedAt||0),0),o=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,a=this.elementInfos.some(u=>u.pictureInPicture),l=this.elementInfos.some(u=>u.visible)&&!o||a;if(this.lastVisible!==l){if(!l&&Date.now()-r<ed){bt.setTimeout(()=>{this.updateVisibility()},ed);return}this.lastVisible=l,this.emit(ne.VisibilityChanged,l,this)}}updateDimensions(){var e,n;let r=0,o=0;const a=this.getPixelDensity();for(const l of this.elementInfos){const u=l.width()*a,d=l.height()*a;u+d>r+o&&(r=u,o=d)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===r&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===o||(this.lastDimensions={width:r,height:o},this.emit(ne.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?qg():n||(qg()>2?2:1)}}class XR{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=r=>{var o;const{target:a,isIntersecting:l}=r;a===this.element&&(this.isIntersecting=l,this.isPiP=Ws(this.element),this.visibilityChangedAt=Date.now(),(o=this.handleVisibilityChanged)===null||o===void 0||o.call(this))},this.onEnterPiP=()=>{var r,o,a;(o=(r=window.documentPictureInPicture)===null||r===void 0?void 0:r.window)===null||o===void 0||o.addEventListener("pagehide",this.onLeavePiP),this.isPiP=Ws(this.element),(a=this.handleVisibilityChanged)===null||a===void 0||a.call(this)},this.onLeavePiP=()=>{var r;this.isPiP=Ws(this.element),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this)},this.element=e,this.isIntersecting=n??Yd(e),this.isPiP=Mt()&&Ws(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,n,r;this.isIntersecting=Yd(this.element),this.isPiP=Ws(this.element),this.element.handleResize=()=>{var o;(o=this.handleResize)===null||o===void 0||o.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,$g().observe(this.element),Hg().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),(e=window.documentPictureInPicture)===null||e===void 0||e.addEventListener("enter",this.onEnterPiP),(r=(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window)===null||r===void 0||r.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,n,r,o,a;(e=$g())===null||e===void 0||e.unobserve(this.element),(n=Hg())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),(r=window.documentPictureInPicture)===null||r===void 0||r.removeEventListener("enter",this.onEnterPiP),(a=(o=window.documentPictureInPicture)===null||o===void 0?void 0:o.window)===null||a===void 0||a.removeEventListener("pagehide",this.onLeavePiP)}}function Ws(t){var e,n;return document.pictureInPictureElement===t?!0:!((e=window.documentPictureInPicture)===null||e===void 0)&&e.window?Yd(t,(n=window.documentPictureInPicture)===null||n===void 0?void 0:n.window):!1}function Yd(t,e){const n=e||window;let r=t.offsetTop,o=t.offsetLeft;const a=t.offsetWidth,l=t.offsetHeight,{hidden:u}=t,{display:d}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,r+=t.offsetTop,o+=t.offsetLeft;return r<n.pageYOffset+n.innerHeight&&o<n.pageXOffset+n.innerWidth&&r+l>n.pageYOffset&&o+a>n.pageXOffset&&!u&&d!=="none"}class Hn extends On.EventEmitter{constructor(e,n,r,o){var a;super(),this.metadataMuted=!1,this.encryption=Wt.NONE,this.log=De,this.handleMuted=()=>{this.emit(ne.Muted)},this.handleUnmuted=()=>{this.emit(ne.Unmuted)},this.log=ei((a=o?.loggerName)!==null&&a!==void 0?a:gn.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=r,this.source=G.Source.Unknown}setTrack(e){this.track&&(this.track.off(ne.Muted,this.handleMuted),this.track.off(ne.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(ne.Muted,this.handleMuted),e.on(ne.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Oe(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==Wt.NONE}get audioTrack(){if(Rn(this.track))return this.track}get videoTrack(){if(or(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=G.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===G.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(Hn||(Hn={}));class Xd extends Hn{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,r,o){super(e,n.sid,n.name,o),this.track=void 0,this.handleTrackEnded=()=>{this.emit(ne.Ended)},this.handleCpuConstrained=()=>{this.track&&or(this.track)&&this.emit(ne.CpuConstrained,this.track)},this.updateInfo(n),this.setTrack(r)}setTrack(e){this.track&&(this.track.off(ne.Ended,this.handleTrackEnded),this.track.off(ne.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(ne.Ended,this.handleTrackEnded),e.on(ne.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return j(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){return j(this,void 0,void 0,function*(){var e;return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){return j(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){return j(this,void 0,void 0,function*(){var e;yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(Rn(this.track)){const n=this.track.getSourceTrackSettings(),r=new Set;return n.autoGainControl&&r.add(mt.TF_AUTO_GAIN_CONTROL),n.echoCancellation&&r.add(mt.TF_ECHO_CANCELLATION),n.noiseSuppression&&r.add(mt.TF_NOISE_SUPPRESSION),n.channelCount&&n.channelCount>1&&r.add(mt.TF_STEREO),!((e=this.options)===null||e===void 0)&&e.dtx||r.add(mt.TF_NO_DTX),this.track.enhancedNoiseCancellation&&r.add(mt.TF_ENHANCED_NOISE_CANCELLATION),Array.from(r.values())}else return[]}}function Ol(t,e){return j(this,void 0,void 0,function*(){t??(t={});let n=!1;const{audioProcessor:r,videoProcessor:o,optionsWithoutProcessor:a}=Jy(t);let l=a.audio,u=a.video;if(r&&typeof a.audio=="object"&&(a.audio.processor=r),o&&typeof a.video=="object"&&(a.video.processor=o),t.audio&&typeof a.audio=="object"&&typeof a.audio.deviceId=="string"){const y=a.audio.deviceId;a.audio.deviceId={exact:y},n=!0,l=Object.assign(Object.assign({},a.audio),{deviceId:{ideal:y}})}if(a.video&&typeof a.video=="object"&&typeof a.video.deviceId=="string"){const y=a.video.deviceId;a.video.deviceId={exact:y},n=!0,u=Object.assign(Object.assign({},a.video),{deviceId:{ideal:y}})}(a.audio===!0||typeof a.audio=="object"&&!a.audio.deviceId)&&(a.audio={deviceId:"default"}),a.video===!0?a.video={deviceId:"default"}:typeof a.video=="object"&&!a.video.deviceId&&(a.video.deviceId="default");const d=Gy(a,Yy,Xy),f=kh(d),m=navigator.mediaDevices.getUserMedia(f);a.audio&&(gt.userMediaPromiseMap.set("audioinput",m),m.catch(()=>gt.userMediaPromiseMap.delete("audioinput"))),a.video&&(gt.userMediaPromiseMap.set("videoinput",m),m.catch(()=>gt.userMediaPromiseMap.delete("videoinput")));try{const y=yield m;return yield Promise.all(y.getTracks().map(b=>j(this,void 0,void 0,function*(){const S=b.kind==="audio";let k=S?d.audio:d.video;(typeof k=="boolean"||!k)&&(k={});let T;const C=S?f.audio:f.video;typeof C!="boolean"&&(T=C);const w=b.getSettings().deviceId;T?.deviceId&&Ri(T.deviceId)!==w?T.deviceId=w:T||(T={deviceId:w});const A=PR(b,T,e);return A.kind===G.Kind.Video?A.source=G.Source.Camera:A.kind===G.Kind.Audio&&(A.source=G.Source.Microphone),A.mediaStream=y,Rn(A)&&r?yield A.setProcessor(r):or(A)&&o&&(yield A.setProcessor(o)),A})))}catch(y){if(!n)throw y;return Ol(Object.assign(Object.assign({},t),{audio:l,video:u}),e)}})}function ZR(t){return j(this,void 0,void 0,function*(){return(yield Ol({audio:!1,video:!0}))[0]})}function eP(t){return j(this,void 0,void 0,function*(){return(yield Ol({audio:!0,video:!1}))[0]})}var wi;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(wi||(wi={}));function tP(t){switch(t){case Gs.EXCELLENT:return wi.Excellent;case Gs.GOOD:return wi.Good;case Gs.POOR:return wi.Poor;case Gs.LOST:return wi.Lost;default:return wi.Unknown}}class ab extends On.EventEmitter{get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return((e=this.permissions)===null||e===void 0?void 0:e.agent)||this.kind===so.AGENT}get isActive(){var e;return((e=this.participantInfo)===null||e===void 0?void 0:e.state)===Fr.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,n,r,o,a,l){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:so.STANDARD;var d;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=wi.Unknown,this.log=De,this.log=ei((d=l?.loggerName)!==null&&d!==void 0?d:gn.Participant),this.loggerOptions=l,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=r,this.metadata=o,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=u,this._attributes=a??{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,n]of this.trackPublications)if(n.source===e)return n}getTrackPublicationByName(e){for(const[,n]of this.trackPublications)if(n.trackName===e)return n}waitUntilActive(){return this.isActive?Promise.resolve():this.activeFuture?this.activeFuture.promise:(this.activeFuture=new Mr,this.once(se.Active,()=>{var e,n;(n=(e=this.activeFuture)===null||e===void 0?void 0:e.resolve)===null||n===void 0||n.call(e),this.activeFuture=void 0}),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrackPublication(G.Source.Camera);return!(!((e=n?.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrackPublication(G.Source.Microphone);return!(!((e=n?.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(G.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){var n;return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===Fr.ACTIVE&&((n=this.participantInfo)===null||n===void 0?void 0:n.state)!==Fr.ACTIVE&&this.emit(se.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const n=this.metadata!==e,r=this.metadata;this.metadata=e,n&&this.emit(se.ParticipantMetadataChanged,r)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(se.ParticipantNameChanged,e)}_setAttributes(e){const n=nR(this.attributes,e);this._attributes=e,Object.keys(n).length>0&&this.emit(se.AttributesChanged,n)}setPermissions(e){var n,r,o,a,l,u;const d=this.permissions,f=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((r=this.permissions)===null||r===void 0?void 0:r.canSubscribe)||e.canPublishData!==((o=this.permissions)===null||o===void 0?void 0:o.canPublishData)||e.hidden!==((a=this.permissions)===null||a===void 0?void 0:a.hidden)||e.recorder!==((l=this.permissions)===null||l===void 0?void 0:l.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((m,y)=>{var b;return m!==((b=this.permissions)===null||b===void 0?void 0:b.canPublishSources[y])})||e.canSubscribeMetrics!==((u=this.permissions)===null||u===void 0?void 0:u.canSubscribeMetrics);return this.permissions=e,f&&this.emit(se.ParticipantPermissionsChanged,d),f}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(se.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=tP(e),n!==this._connectionQuality&&this.emit(se.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,n;this.activeFuture&&((n=(e=this.activeFuture).reject)===null||n===void 0||n.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(n=>Rn(n.track)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(ne.Muted,()=>{this.emit(se.TrackMuted,e)}),e.on(ne.Unmuted,()=>{this.emit(se.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case G.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case G.Kind.Video:this.videoTrackPublications.set(e.trackSid,e);break}}}function nP(t){var e,n,r;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new oy({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(r=t.allowAll)!==null&&r!==void 0?r:!1,trackSids:t.allowedTrackSids||[]})}const d0=15e3;class iP extends ab{constructor(e,n,r,o,a){super(e,n,void 0,void 0,void 0,{loggerName:o.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Wt.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Mr)},this.handleReconnected=()=>{var l,u;(u=(l=this.reconnectFuture)===null||l===void 0?void 0:l.resolve)===null||u===void 0||u.call(l),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var l,u,d,f,m,y;this.reconnectFuture&&(this.reconnectFuture.promise.catch(b=>this.log.warn(b.message,this.logContext)),(u=(l=this.reconnectFuture)===null||l===void 0?void 0:l.reject)===null||u===void 0||u.call(l,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&((f=(d=this.signalConnectedFuture).reject)===null||f===void 0||f.call(d,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),(y=(m=this.activeAgentFuture)===null||m===void 0?void 0:m.reject)===null||y===void 0||y.call(m,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=l=>{var u,d;l.participant&&this.updateInfo(l.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Mr),(d=(u=this.signalConnectedFuture).resolve)===null||d===void 0||d.call(u)},this.handleSignalRequestResponse=l=>{const{requestId:u,reason:d,message:f}=l,m=this.pendingSignalRequests.get(u);m&&(d!==vh.OK&&m.reject(new Fg(f,d)),this.pendingSignalRequests.delete(u))},this.handleDataPacket=l=>{switch(l.value.case){case"rpcResponse":let u=l.value.value,d=null,f=null;u.value.case==="payload"?d=u.value.value:u.value.case==="error"&&(f=it.fromProto(u.value.value)),this.handleIncomingRpcResponse(u.requestId,d,f);break;case"rpcAck":let m=l.value.value;this.handleIncomingRpcAck(m.requestId);break}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(l=>nP(l)))},this.onTrackUnmuted=l=>{this.onTrackMuted(l,l.isUpstreamPaused)},this.onTrackMuted=(l,u)=>{if(u===void 0&&(u=!0),!l.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Oe(l)));return}this.engine.updateMuteStatus(l.sid,u)},this.onTrackUpstreamPaused=l=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Oe(l))),this.onTrackMuted(l,!0)},this.onTrackUpstreamResumed=l=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Oe(l))),this.onTrackMuted(l,l.isMuted)},this.onTrackFeatureUpdate=l=>{const u=this.audioTrackPublications.get(l.sid);if(!u){this.log.warn("Could not update local audio track settings, missing publication for track ".concat(l.sid),this.logContext);return}this.engine.client.sendUpdateLocalAudioTrack(u.trackSid,u.getTrackFeatures())},this.onTrackCpuConstrained=(l,u)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),Oe(u))),this.emit(se.LocalTrackCpuConstrained,l,u)},this.handleSubscribedQualityUpdate=l=>j(this,void 0,void 0,function*(){var u,d,f,m,y;if(!(!((y=this.roomOptions)===null||y===void 0)&&y.dynacast))return;const b=this.videoTrackPublications.get(l.trackSid);if(!b){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:l.trackSid}));return}if(!b.videoTrack)return;const S=yield b.videoTrack.setPublishingCodecs(l.subscribedCodecs);try{for(var k=!0,T=Kn(S),C;C=yield T.next(),u=C.done,!u;k=!0){m=C.value,k=!1;const w=m;j_(w)&&(this.log.debug("publish ".concat(w," for ").concat(b.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Oe(b))),yield this.publishAdditionalCodecForTrack(b.videoTrack,w,b.options))}}catch(w){d={error:w}}finally{try{!k&&!u&&(f=T.return)&&(yield f.call(T))}finally{if(d)throw d.error}}}),this.handleLocalTrackUnpublished=l=>{const u=this.trackPublications.get(l.trackSid);if(!u){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:l.trackSid}));return}this.unpublishTrack(u.track)},this.handleTrackEnded=l=>j(this,void 0,void 0,function*(){if(l.source===G.Source.ScreenShare||l.source===G.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Oe(l))),this.unpublishTrack(l);else if(l.isUserProvided)yield l.mute();else if(qn(l)||Si(l))try{if(Mt())try{const u=yield navigator?.permissions.query({name:l.source===G.Source.Camera?"camera":"microphone"});if(u&&u.state==="denied")throw this.log.warn("user has revoked access to ".concat(l.source),Object.assign(Object.assign({},this.logContext),Oe(l))),u.onchange=()=>{u.state!=="denied"&&(l.isMuted||l.restartTrack(),u.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}l.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Oe(l))),qn(l)?yield l.restartTrack({deviceId:"default"}):yield l.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Oe(l))),yield l.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=r,this.roomOptions=o,this.setupEngine(r),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=a}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Wt.NONE}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setupEngine(e){var n;this.engine=e,this.engine.on(re.RemoteMute,(r,o)=>{const a=this.trackPublications.get(r);!a||!a.track||(o?a.mute():a.unmute())}),!((n=this.signalConnectedFuture)===null||n===void 0)&&n.isResolved&&(this.signalConnectedFuture=void 0),this.engine.on(re.Connected,this.handleReconnected).on(re.SignalConnected,this.handleSignalConnected).on(re.SignalRestarted,this.handleReconnected).on(re.SignalResumed,this.handleReconnected).on(re.Restarting,this.handleReconnecting).on(re.Resuming,this.handleReconnecting).on(re.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(re.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(re.Closing,this.handleClosing).on(re.SignalRequestResponse,this.handleSignalRequestResponse).on(re.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return j(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return j(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return j(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return j(this,arguments,void 0,function(n){var r=this;let{metadata:o,name:a,attributes:l}=n;return function*(){return new Promise((u,d)=>j(r,void 0,void 0,function*(){var f,m;try{let y=!1;const b=yield this.engine.client.sendUpdateLocalMetadata((f=o??this.metadata)!==null&&f!==void 0?f:"",(m=a??this.name)!==null&&m!==void 0?m:"",l),S=performance.now();for(this.pendingSignalRequests.set(b,{resolve:u,reject:k=>{d(k),y=!0},values:{name:a,metadata:o,attributes:l}});performance.now()-S<5e3&&!y;){if((!a||this.name===a)&&(!o||this.metadata===o)&&(!l||Object.entries(l).every(k=>{let[T,C]=k;return this.attributes[T]===C||C===""&&!this.attributes[T]}))){this.pendingSignalRequests.delete(b),u();return}yield Bt(50)}d(new Fg("Request to update local metadata timed out","TimeoutError"))}catch(y){y instanceof Error&&d(y)}}))}()})}setCameraEnabled(e,n,r){return this.setTrackEnabled(G.Source.Camera,e,n,r)}setMicrophoneEnabled(e,n,r){return this.setTrackEnabled(G.Source.Microphone,e,n,r)}setScreenShareEnabled(e,n,r){return this.setTrackEnabled(G.Source.ScreenShare,e,n,r)}setPermissions(e){const n=this.permissions,r=super.setPermissions(e);return r&&n&&this.emit(se.ParticipantPermissionsChanged,n),r}setE2EEEnabled(e){return j(this,void 0,void 0,function*(){this.encryptionType=e?Wt.GCM:Wt.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,r,o){return j(this,void 0,void 0,function*(){var a,l;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n})),this.republishPromise&&(yield this.republishPromise);let u=this.getTrackPublication(e);if(n)if(u)yield u.unmute();else{let d;if(this.pendingPublishing.has(e)){const f=yield this.waitForPendingPublicationOfSource(e);return f||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield f?.unmute(),f}this.pendingPublishing.add(e);try{switch(e){case G.Source.Camera:d=yield this.createTracks({video:(a=r)!==null&&a!==void 0?a:!0});break;case G.Source.Microphone:d=yield this.createTracks({audio:(l=r)!==null&&l!==void 0?l:!0});break;case G.Source.ScreenShare:d=yield this.createScreenTracks(Object.assign({},r));break;default:throw new Jn(e)}}catch(f){throw d?.forEach(m=>{m.stop()}),f instanceof Error&&this.emit(se.MediaDevicesError,f,Wd(e)),this.pendingPublishing.delete(e),f}for(const f of d){const m=Object.assign(Object.assign({},this.roomOptions.publishDefaults),r);e===G.Source.Microphone&&Rn(f)&&m.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),f.startPreConnectBuffer())}try{const f=[];for(const y of d)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Oe(y))),f.push(this.publishTrack(y,o));[u]=yield Promise.all(f)}catch(f){throw d?.forEach(m=>{m.stop()}),f}finally{this.pendingPublishing.delete(e)}}else if(!u?.track&&this.pendingPublishing.has(e)&&(u=yield this.waitForPendingPublicationOfSource(e),u||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),u&&u.track)if(e===G.Source.ScreenShare){u=yield this.unpublishTrack(u.track);const d=this.getTrackPublication(G.Source.ScreenShareAudio);d&&d.track&&this.unpublishTrack(d.track)}else yield u.mute();return u})}enableCameraAndMicrophone(){return j(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has(G.Source.Camera)||this.pendingPublishing.has(G.Source.Microphone))){this.pendingPublishing.add(G.Source.Camera),this.pendingPublishing.add(G.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete(G.Source.Camera),this.pendingPublishing.delete(G.Source.Microphone)}}})}createTracks(e){return j(this,void 0,void 0,function*(){var n,r;e??(e={});const o=Gy(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(r=this.roomOptions)===null||r===void 0?void 0:r.videoCaptureDefaults);try{return(yield Ol(o,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext})).map(u=>(Rn(u)&&(this.microphoneError=void 0,u.setAudioContext(this.audioContext),u.source=G.Source.Microphone,this.emit(se.AudioStreamAcquired)),or(u)&&(this.cameraError=void 0,u.source=G.Source.Camera),u))}catch(a){throw a instanceof Error&&(e.audio&&(this.microphoneError=a),e.video&&(this.cameraError=a)),a}})}createScreenTracks(e){return j(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new bh("getDisplayMedia not supported");e.resolution===void 0&&!U_()&&(e.resolution=xh.h1080fps30.resolution);const n=Z_(e),r=yield navigator.mediaDevices.getDisplayMedia(n),o=r.getVideoTracks();if(o.length===0)throw new Jn("no video track found");const a=new hl(o[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});a.source=G.Source.ScreenShare,e.contentHint&&(a.mediaStreamTrack.contentHint=e.contentHint);const l=[a];if(r.getAudioTracks().length>0){this.emit(se.AudioStreamAcquired);const u=new dl(r.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});u.source=G.Source.ScreenShareAudio,l.push(u)}return l})}publishTrack(e,n){return j(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,n)})}publishOrRepublishTrack(e,n){return j(this,arguments,void 0,function(r,o){var a=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return function*(){var u,d,f,m;qn(r)&&r.setAudioContext(a.audioContext),yield(u=a.reconnectFuture)===null||u===void 0?void 0:u.promise,a.republishPromise&&!l&&(yield a.republishPromise),qr(r)&&a.pendingPublishPromises.has(r)&&(yield a.pendingPublishPromises.get(r));let y;if(r instanceof MediaStreamTrack)y=r.getConstraints();else{y=r.constraints;let w;switch(r.source){case G.Source.Microphone:w="audioinput";break;case G.Source.Camera:w="videoinput"}w&&a.activeDeviceMap.has(w)&&(y=Object.assign(Object.assign({},y),{deviceId:a.activeDeviceMap.get(w)}))}if(r instanceof MediaStreamTrack)switch(r.kind){case"audio":r=new dl(r,y,!0,a.audioContext,{loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});break;case"video":r=new hl(r,y,!0,{loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});break;default:throw new Jn("unsupported MediaStreamTrack kind ".concat(r.kind))}else r.updateLoggerOptions({loggerName:a.roomOptions.loggerName,loggerContextCb:()=>a.logContext});let b;if(a.trackPublications.forEach(w=>{w.track&&w.track===r&&(b=w)}),b)return a.log.warn("track has already been published, skipping",Object.assign(Object.assign({},a.logContext),Oe(b))),b;const S="channelCount"in r.mediaStreamTrack.getSettings()&&r.mediaStreamTrack.getSettings().channelCount===2||r.mediaStreamTrack.getConstraints().channelCount===2,k=(d=o?.forceStereo)!==null&&d!==void 0?d:S;k&&(o||(o={}),o.dtx===void 0&&a.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},a.logContext),Oe(r))),o.red===void 0&&a.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(f=o.dtx)!==null&&f!==void 0||(o.dtx=!1),(m=o.red)!==null&&m!==void 0||(o.red=!1));const T=Object.assign(Object.assign({},a.roomOptions.publishDefaults),o);!B_()&&a.roomOptions.e2ee&&(a.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},a.logContext)),T.simulcast=!1),T.source&&(r.source=T.source);const C=new Promise((w,A)=>j(a,void 0,void 0,function*(){try{if(this.engine.client.currentState!==Ke.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:Oe(r)}));const P=setTimeout(()=>{A(new Ug("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(P);const E=yield this.publish(r,T,k);w(E)}else try{const P=yield this.publish(r,T,k);w(P)}catch(P){A(P)}}catch(P){A(P)}}));a.pendingPublishPromises.set(r,C);try{return yield C}catch(w){throw w}finally{a.pendingPublishPromises.delete(r)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Mr),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),Oe(e))),!1;const{canPublish:n,canPublishSources:r}=this.permissions;return n&&(r.length===0||r.map(o=>iR(o)).includes(e.source))?!0:(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),Oe(e))),!1)}publish(e,n,r){return j(this,void 0,void 0,function*(){var o,a,l,u,d,f,m,y,b,S;if(!this.hasPermissionsToPublish(e))throw new Ug("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(z=>qr(e)&&z.source===e.source)&&e.source!==G.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Oe(e))),n.stopMicTrackOnMute&&Rn(e)&&(e.stopOnMute=!0),e.source===G.Source.ScreenShare&&Wr()&&(n.simulcast=!1),n.videoCodec==="av1"&&!D_()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!L_()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Gd),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(z=>n.videoCodec===Ya(z.mime))||(n.videoCodec=Ya(this.enabledPublishVideoCodecs[0].mime)));const T=n.videoCodec;e.on(ne.Muted,this.onTrackMuted),e.on(ne.Unmuted,this.onTrackUnmuted),e.on(ne.Ended,this.handleTrackEnded),e.on(ne.UpstreamPaused,this.onTrackUpstreamPaused),e.on(ne.UpstreamResumed,this.onTrackUpstreamResumed),e.on(ne.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const C=[],w=!(!((o=n.dtx)!==null&&o!==void 0)||o),A=e.getSourceTrackSettings();A.autoGainControl&&C.push(mt.TF_AUTO_GAIN_CONTROL),A.echoCancellation&&C.push(mt.TF_ECHO_CANCELLATION),A.noiseSuppression&&C.push(mt.TF_NOISE_SUPPRESSION),A.channelCount&&A.channelCount>1&&C.push(mt.TF_STEREO),w&&C.push(mt.TF_NO_DTX),qn(e)&&e.hasPreConnectBuffer&&C.push(mt.TF_PRECONNECT_BUFFER);const P=new _d({cid:e.mediaStreamTrack.id,name:n.name,type:G.kindToProto(e.kind),muted:e.isMuted,source:G.sourceToProto(e.source),disableDtx:w,encryption:this.encryptionType,stereo:r,disableRed:this.isE2EEEnabled||!(!((a=n.red)!==null&&a!==void 0)||a),stream:n?.stream,backupCodecPolicy:n?.backupCodecPolicy,audioFeatures:C});let E;if(e.kind===G.Kind.Video){let z={width:0,height:0};try{z=yield e.waitForDimensions()}catch{const Q=(u=(l=this.roomOptions.videoCaptureDefaults)===null||l===void 0?void 0:l.resolution)!==null&&u!==void 0?u:oo.h720.resolution;z={width:Q.width,height:Q.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Oe(e)),{dims:z}))}P.width=z.width,P.height=z.height,Si(e)&&(_n(T)&&(e.source===G.Source.ScreenShare&&(n.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),Oe(e))))),n.scalabilityMode=(d=n.scalabilityMode)!==null&&d!==void 0?d:"L3T3_KEY"),P.simulcastCodecs=[new Ed({codec:T,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Gd}),n.backupCodec&&T!==n.backupCodec.codec&&P.encryption===Wt.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),P.simulcastCodecs.push(new Ed({codec:n.backupCodec.codec,cid:""})))),E=Jd(e.source===G.Source.ScreenShare,P.width,P.height,n),P.layers=l0(P.width,P.height,E,_n(n.videoCodec))}else e.kind===G.Kind.Audio&&(E=[{maxBitrate:(f=n.audioPreset)===null||f===void 0?void 0:f.maxBitrate,priority:(y=(m=n.audioPreset)===null||m===void 0?void 0:m.priority)!==null&&y!==void 0?y:"high",networkPriority:(S=(b=n.audioPreset)===null||b===void 0?void 0:b.priority)!==null&&S!==void 0?S:"high"}]);if(!this.engine||this.engine.isClosed)throw new dt("cannot publish track when not connected");const R=()=>j(this,void 0,void 0,function*(){var z,K,Q;if(!this.engine.pcManager)throw new dt("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,n,E),this.emit(se.LocalSenderCreated,e.sender,e),Si(e)&&((z=n.degradationPreference)!==null&&z!==void 0||(n.degradationPreference=FR(e)),e.setDegradationPreference(n.degradationPreference)),E)if(Wr()&&e.kind===G.Kind.Audio){let ie;for(const ce of this.engine.pcManager.publisher.getTransceivers())if(ce.sender===e.sender){ie=ce;break}ie&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:ie,codec:"opus",maxbr:!((K=E[0])===null||K===void 0)&&K.maxBitrate?E[0].maxBitrate/1e3:0})}else e.codec&&_n(e.codec)&&(!((Q=E[0])===null||Q===void 0)&&Q.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:P.cid,codec:e.codec,maxbr:E[0].maxBitrate/1e3});yield this.engine.negotiate()});let B;const I=new Promise((z,K)=>j(this,void 0,void 0,function*(){var Q;try{B=yield this.engine.addTrack(P),z(B)}catch(ie){e.sender&&(!((Q=this.engine.pcManager)===null||Q===void 0)&&Q.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(ce=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),Oe(e)),{error:ce}))})),K(ie)}}));if(this.enabledPublishVideoCodecs.length>0)B=(yield Promise.all([I,R()]))[0];else{B=yield I;let z;if(B.codecs.forEach(K=>{z===void 0&&(z=K.mimeType)}),z&&e.kind===G.Kind.Video){const K=Ya(z);K!==T&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Oe(e)),{codec:K})),n.videoCodec=K,E=Jd(e.source===G.Source.ScreenShare,P.width,P.height,n))}yield R()}const M=new Xd(e.kind,B,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(M.on(ne.CpuConstrained,z=>this.onTrackCpuConstrained(z,M)),M.options=n,e.sid=B.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:E,trackInfo:B})),Si(e)?e.startMonitor(this.engine.client):qn(e)&&e.startMonitor(),this.addTrackPublication(M),this.emit(se.LocalTrackPublished,M),qn(e)&&B.audioFeatures.includes(mt.TF_PRECONNECT_BUFFER)){const z=e.getPreConnectBuffer(),K=e.getPreConnectBufferMimeType();this.on(se.LocalTrackSubscribed,Q=>{if(Q.trackSid===B.sid){if(!e.hasPreConnectBuffer){this.log.warn("subscribe event came to late, buffer already closed",this.logContext);return}this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),Oe(e))),e.stopPreConnectBuffer()}}),z&&new Promise((ie,ce)=>j(this,void 0,void 0,function*(){var Te,Ae,Se,be,X,pe;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),Oe(e)));const ke=setTimeout(()=>{ce(new Error("agent not active within 10 seconds"))},1e4),Ee=yield this.waitUntilActiveAgentPresent();clearTimeout(ke),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),Oe(e)));const je=yield this.streamBytes({name:"preconnect-buffer",mimeType:K,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[Ee.identity],attributes:{trackId:M.trackSid,sampleRate:String((X=A.sampleRate)!==null&&X!==void 0?X:"48000"),channels:String((pe=A.channelCount)!==null&&pe!==void 0?pe:"1")}});try{for(var oe=!0,L=Kn(z),W;W=yield L.next(),Te=W.done,!Te;oe=!0){be=W.value,oe=!1;const Pe=be;yield je.write(Pe)}}catch(Pe){Ae={error:Pe}}finally{try{!oe&&!Te&&(Se=L.return)&&(yield Se.call(L))}finally{if(Ae)throw Ae.error}}yield je.close(),ie()}catch(ke){ce(ke)}})).then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),Oe(e)))}).catch(ie=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),Oe(e)),{error:ie}))})}return M})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,r){return j(this,void 0,void 0,function*(){var o;if(this.encryptionType!==Wt.NONE)return;let a;if(this.trackPublications.forEach(S=>{S.track&&S.track===e&&(a=S)}),!a)throw new Jn("track is not published");if(!Si(e))throw new Jn("track is not a video track");const l=Object.assign(Object.assign({},(o=this.roomOptions)===null||o===void 0?void 0:o.publishDefaults),r),u=LR(e,n,l);if(!u){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Oe(e)));return}const d=e.addSimulcastTrack(n,u);if(!d)return;const f=new _d({cid:d.mediaStreamTrack.id,type:G.kindToProto(e.kind),muted:e.isMuted,source:G.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:l.videoCodec,cid:d.mediaStreamTrack.id}]});if(f.layers=l0(f.width,f.height,u),!this.engine||this.engine.isClosed)throw new dt("cannot publish track when not connected");const m=()=>j(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,d,l,u),yield this.engine.negotiate()}),b=(yield Promise.all([this.engine.addTrack(f),m()]))[0];this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:u,trackInfo:b}))})}unpublishTrack(e,n){return j(this,void 0,void 0,function*(){var r,o;if(qr(e)){const f=this.pendingPublishPromises.get(e);f&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),Oe(e))),yield f)}const a=this.getPublicationForTrack(e),l=a?Oe(a):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),l)),!a||!a.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),l));return}e=a.track,e.off(ne.Muted,this.onTrackMuted),e.off(ne.Unmuted,this.onTrackUnmuted),e.off(ne.Ended,this.handleTrackEnded),e.off(ne.UpstreamPaused,this.onTrackUpstreamPaused),e.off(ne.UpstreamResumed,this.onTrackUpstreamResumed),e.off(ne.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),n===void 0&&(n=(o=(r=this.roomOptions)===null||r===void 0?void 0:r.stopLocalTrackOnUnpublish)!==null&&o!==void 0?o:!0),n?e.stop():e.stopMonitor();let u=!1;const d=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<tt.FAILED&&d)try{for(const f of this.engine.pcManager.publisher.getTransceivers())f.sender===d&&(f.direction="inactive",u=!0);if(this.engine.removeTrack(d)&&(u=!0),Si(e)){for(const[,f]of e.simulcastCodecs)f.sender&&(this.engine.removeTrack(f.sender)&&(u=!0),f.sender=void 0);e.simulcastCodecs.clear()}}catch(f){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),l),{error:f}))}switch(this.trackPublications.delete(a.trackSid),a.kind){case G.Kind.Audio:this.audioTrackPublications.delete(a.trackSid);break;case G.Kind.Video:this.videoTrackPublications.delete(a.trackSid);break}return this.emit(se.LocalTrackUnpublished,a),a.setTrack(void 0),u&&(yield this.engine.negotiate()),a})}unpublishTracks(e){return j(this,void 0,void 0,function*(){return(yield Promise.all(e.map(r=>this.unpublishTrack(r)))).filter(r=>!!r)})}republishAllTracks(e){return j(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return function*(){r.republishPromise&&(yield r.republishPromise),r.republishPromise=new Promise((a,l)=>j(r,void 0,void 0,function*(){try{const u=[];this.trackPublications.forEach(d=>{d.track&&(n&&(d.options=Object.assign(Object.assign({},d.options),n)),u.push(d))}),yield Promise.all(u.map(d=>j(this,void 0,void 0,function*(){const f=d.track;yield this.unpublishTrack(f,!1),o&&!f.isMuted&&f.source!==G.Source.ScreenShare&&f.source!==G.Source.ScreenShareAudio&&(qn(f)||Si(f))&&!f.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:d.trackSid})),yield f.restartTrack()),yield this.publishOrRepublishTrack(f,d.options,!0)}))),a()}catch(u){l(u)}finally{this.republishPromise=void 0}})),yield r.republishPromise}()})}publishData(e){return j(this,arguments,void 0,function(n){var r=this;let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const a=o.reliable?Re.RELIABLE:Re.LOSSY,l=o.destinationIdentities,u=o.topic,d=new Dt({kind:a,value:{case:"user",value:new zv({participantIdentity:r.identity,payload:n,destinationIdentities:l,topic:u})}});yield r.engine.sendDataPacket(d,a)}()})}publishDtmf(e,n){return j(this,void 0,void 0,function*(){const r=new Dt({kind:Re.RELIABLE,value:{case:"sipDtmf",value:new Vv({code:e,digit:n})}});yield this.engine.sendDataPacket(r,Re.RELIABLE)})}sendChatMessage(e,n){return j(this,void 0,void 0,function*(){const r={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:n?.attachments},o=new Dt({value:{case:"chatMessage",value:new xd(Object.assign(Object.assign({},r),{timestamp:Qe.parse(r.timestamp)}))}});return yield this.engine.sendDataPacket(o,Re.RELIABLE),this.emit(se.ChatMessage,r),r})}editChatMessage(e,n){return j(this,void 0,void 0,function*(){const r=Object.assign(Object.assign({},n),{message:e,editTimestamp:Date.now()}),o=new Dt({value:{case:"chatMessage",value:new xd(Object.assign(Object.assign({},r),{timestamp:Qe.parse(r.timestamp),editTimestamp:Qe.parse(r.editTimestamp)}))}});return yield this.engine.sendDataPacket(o,Re.RELIABLE),this.emit(se.ChatMessage,r),r})}sendText(e,n){return j(this,void 0,void 0,function*(){var r;const o=crypto.randomUUID(),l=new TextEncoder().encode(e).byteLength,u=(r=n?.attachments)===null||r===void 0?void 0:r.map(()=>crypto.randomUUID()),d=new Array(u?u.length+1:1).fill(0),f=(y,b)=>{var S;d[b]=y;const k=d.reduce((T,C)=>T+C,0);(S=n?.onProgress)===null||S===void 0||S.call(n,k)},m=yield this.streamText({streamId:o,totalSize:l,destinationIdentities:n?.destinationIdentities,topic:n?.topic,attachedStreamIds:u,attributes:n?.attributes});return yield m.write(e),f(1,0),yield m.close(),n?.attachments&&u&&(yield Promise.all(n.attachments.map((y,b)=>j(this,void 0,void 0,function*(){return this._sendFile(u[b],y,{topic:n.topic,mimeType:y.type,onProgress:S=>{f(S,b+1)}})})))),m.info})}streamText(e){return j(this,void 0,void 0,function*(){var n,r;const o=(n=e?.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),a={id:o,mimeType:"text/plain",timestamp:Date.now(),topic:(r=e?.topic)!==null&&r!==void 0?r:"",size:e?.totalSize,attributes:e?.attributes},l=new Sd({streamId:o,mimeType:a.mimeType,topic:a.topic,timestamp:Wi(a.timestamp),totalLength:Wi(e?.totalSize),attributes:a.attributes,contentHeader:{case:"textHeader",value:new Zv({version:e?.version,attachedStreamIds:e?.attachedStreamIds,replyToStreamId:e?.replyToStreamId,operationType:e?.type==="update"?kd.UPDATE:kd.CREATE})}}),u=e?.destinationIdentities,d=new Dt({destinationIdentities:u,value:{case:"streamHeader",value:l}});yield this.engine.sendDataPacket(d,Re.RELIABLE);let f=0;const m=this,y=new WritableStream({write(k){return j(this,void 0,void 0,function*(){for(const T of Y_(k,d0)){yield m.engine.waitForBufferStatusLow(Re.RELIABLE);const C=new Td({content:T,streamId:o,chunkIndex:Wi(f)}),w=new Dt({destinationIdentities:u,value:{case:"streamChunk",value:C}});yield m.engine.sendDataPacket(w,Re.RELIABLE),f+=1}})},close(){return j(this,void 0,void 0,function*(){const k=new Cd({streamId:o}),T=new Dt({destinationIdentities:u,value:{case:"streamTrailer",value:k}});yield m.engine.sendDataPacket(T,Re.RELIABLE)})},abort(k){console.log("Sink error:",k)}});let b=()=>j(this,void 0,void 0,function*(){yield S.close()});m.engine.once(re.Closing,b);const S=new JR(y,a,()=>this.engine.off(re.Closing,b));return S})}sendFile(e,n){return j(this,void 0,void 0,function*(){const r=crypto.randomUUID();return yield this._sendFile(r,e,n),{id:r}})}_sendFile(e,n,r){return j(this,void 0,void 0,function*(){var o;const a=yield this.streamBytes({streamId:e,totalSize:n.size,name:n.name,mimeType:(o=r?.mimeType)!==null&&o!==void 0?o:n.type,topic:r?.topic,destinationIdentities:r?.destinationIdentities}),l=n.stream().getReader();for(;;){const{done:u,value:d}=yield l.read();if(u)break;yield a.write(d)}return yield a.close(),a.info})}streamBytes(e){return j(this,void 0,void 0,function*(){var n,r,o,a,l;const u=(n=e?.streamId)!==null&&n!==void 0?n:crypto.randomUUID(),d=e?.destinationIdentities,f={id:u,mimeType:(r=e?.mimeType)!==null&&r!==void 0?r:"application/octet-stream",topic:(o=e?.topic)!==null&&o!==void 0?o:"",timestamp:Date.now(),attributes:e?.attributes,size:e?.totalSize,name:(a=e?.name)!==null&&a!==void 0?a:"unknown"},m=new Sd({totalLength:Wi((l=f.size)!==null&&l!==void 0?l:0),mimeType:f.mimeType,streamId:u,topic:f.topic,timestamp:Wi(Date.now()),attributes:f.attributes,contentHeader:{case:"byteHeader",value:new ey({name:f.name})}}),y=new Dt({destinationIdentities:d,value:{case:"streamHeader",value:m}});yield this.engine.sendDataPacket(y,Re.RELIABLE);let b=0;const S=new Rt,k=this.engine,T=this.log,C=new WritableStream({write(A){return j(this,void 0,void 0,function*(){const P=yield S.lock();let E=0;try{for(;E<A.byteLength;){const R=A.slice(E,E+d0);yield k.waitForBufferStatusLow(Re.RELIABLE);const B=new Dt({destinationIdentities:d,value:{case:"streamChunk",value:new Td({content:R,streamId:u,chunkIndex:Wi(b)})}});yield k.sendDataPacket(B,Re.RELIABLE),b+=1,E+=R.byteLength}}finally{P()}})},close(){return j(this,void 0,void 0,function*(){const A=new Cd({streamId:u}),P=new Dt({destinationIdentities:d,value:{case:"streamTrailer",value:A}});yield k.sendDataPacket(P,Re.RELIABLE)})},abort(A){T.error("Sink error:",A)}});return new QR(C,f)})}performRpc(e){return j(this,arguments,void 0,function(n){var r=this;let{destinationIdentity:o,method:a,payload:l,responseTimeout:u=1e4}=n;return function*(){return new Promise((f,m)=>j(r,void 0,void 0,function*(){var y,b,S,k;if(_h(l)>Zy){m(it.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));return}if(!((b=(y=this.engine.latestJoinResponse)===null||y===void 0?void 0:y.serverInfo)===null||b===void 0)&&b.version&&In((k=(S=this.engine.latestJoinResponse)===null||S===void 0?void 0:S.serverInfo)===null||k===void 0?void 0:k.version,"1.8.0")<0){m(it.builtIn("UNSUPPORTED_SERVER"));return}const T=crypto.randomUUID();yield this.publishRpcRequest(o,T,a,l,u-2e3);const C=setTimeout(()=>{this.pendingAcks.delete(T),m(it.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(T),clearTimeout(w)},2e3);this.pendingAcks.set(T,{resolve:()=>{clearTimeout(C)},participantIdentity:o});const w=setTimeout(()=>{this.pendingResponses.delete(T),m(it.builtIn("RESPONSE_TIMEOUT"))},u);this.pendingResponses.set(T,{resolve:(A,P)=>{clearTimeout(w),this.pendingAcks.has(T)&&(console.warn("RPC response received before ack",T),this.pendingAcks.delete(T),clearTimeout(C)),P?m(P):f(A??"")},participantIdentity:o})}))}()})}registerRpcMethod(e,n){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const n=this.pendingAcks.get(e);n?(n.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,n,r){const o=this.pendingResponses.get(e);o?(o.resolve(n,r),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,n,r,o,a){return j(this,void 0,void 0,function*(){const l=new Dt({destinationIdentities:[e],kind:Re.RELIABLE,value:{case:"rpcRequest",value:new qv({id:n,method:r,payload:o,responseTimeoutMs:a,version:1})}});yield this.engine.sendDataPacket(l,Re.RELIABLE)})}handleParticipantDisconnected(e){for(const[n,{participantIdentity:r}]of this.pendingAcks)r===e&&this.pendingAcks.delete(n);for(const[n,{participantIdentity:r,resolve:o}]of this.pendingResponses)r===e&&(o(null,it.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(n))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(n=>n.mime.split("/")[0].toLowerCase()==="video")}updateInfo(e){return super.updateInfo(e)?(e.tracks.forEach(n=>{var r,o;const a=this.trackPublications.get(n.sid);if(a){const l=a.isMuted||((o=(r=a.track)===null||r===void 0?void 0:r.isUpstreamPaused)!==null&&o!==void 0?o:!1);l!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Oe(a)),{mutedOnServer:l})),this.engine.client.sendMuteTrack(n.sid,l))}}),!0):!1}setActiveAgent(e){var n,r,o,a;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?(r=(n=this.activeAgentFuture)===null||n===void 0?void 0:n.resolve)===null||r===void 0||r.call(n,e):(a=(o=this.activeAgentFuture)===null||o===void 0?void 0:o.reject)===null||a===void 0||a.call(o,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Mr),this.activeAgentFuture.promise)}getPublicationForTrack(e){let n;return this.trackPublications.forEach(r=>{const o=r.track;o&&(e instanceof MediaStreamTrack?(qn(o)||Si(o))&&o.mediaStreamTrack===e&&(n=r):e===o&&(n=r))}),n}waitForPendingPublicationOfSource(e){return j(this,void 0,void 0,function*(){const r=Date.now();for(;Date.now()<r+1e4;){const o=Array.from(this.pendingPublishPromises.entries()).find(a=>{let[l]=a;return l.source===e});if(o)return o[1];yield Bt(20)}})}}class rP extends Hn{constructor(e,n,r,o){super(e,n.sid,n.name,o),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=a=>{this.setTrack(void 0),this.emit(ne.Ended,a)},this.handleVisibilityChange=a=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(a),this.logContext),this.visible=a,this.emitTrackUpdate()},this.handleVideoDimensionsChange=a=>{this.log.debug("adaptivestream video dimensions ".concat(a.width,"x").concat(a.height),this.logContext),this.videoDimensionsAdaptiveStream=a,this.emitTrackUpdate()},this.subscribed=r,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const o=new Pl({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Gv({participantSid:"",trackSids:[this.trackSid]})]});this.emit(ne.UpdateSubscription,o),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(r)}get subscriptionStatus(){return this.subscribed===!1?Hn.SubscriptionStatus.Unsubscribed:super.isSubscribed?Hn.SubscriptionStatus.Subscribed:Hn.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Hn.PermissionStatus.Allowed:Hn.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return this.requestedDisabled!==void 0?!this.requestedDisabled:this.isAdaptiveStream?this.visible:!0}get isLocal(){return!1}setEnabled(e){!this.isManualOperationAllowed()||this.requestedDisabled===!e||(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.requestedMaxQuality===e||(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,r;this.isManualOperationAllowed()&&(((n=this.requestedVideoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((r=this.requestedVideoDimensions)===null||r===void 0?void 0:r.height)===e.height||(Gu(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&Gu(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return(e=this.requestedMaxQuality)!==null&&e!==void 0?e:Kt.HIGH}setTrack(e){const n=this.subscriptionStatus,r=this.permissionStatus,o=this.track;o!==e&&(o&&(o.off(ne.VideoDimensionsChanged,this.handleVideoDimensionsChange),o.off(ne.VisibilityChanged,this.handleVisibilityChange),o.off(ne.Ended,this.handleEnded),o.detach(),o.stopMonitor(),this.emit(ne.Unsubscribed,o)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(ne.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(ne.VisibilityChanged,this.handleVisibilityChange),e.on(ne.Ended,this.handleEnded),this.emit(ne.Subscribed,e)),this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,r=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(r),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(ne.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?ne.Muted:ne.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(ne.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(ne.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return Gu(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new ty({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===G.Kind.Video){let n=this.requestedVideoDimensions;if(this.videoDimensionsAdaptiveStream!==void 0)if(n)Kg(this.videoDimensionsAdaptiveStream,n)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream);else if(this.requestedMaxQuality!==void 0&&this.trackInfo){const r=rR(this.trackInfo,this.requestedMaxQuality);r&&Kg(this.videoDimensionsAdaptiveStream,r)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),n=this.videoDimensionsAdaptiveStream;n?(e.width=Math.ceil(n.width),e.height=Math.ceil(n.height)):this.requestedMaxQuality!==void 0?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:Kt.HIGH})),e.quality=Kt.HIGH)}this.emit(ne.UpdateSettings,e)}}class fl extends ab{static fromParticipantInfo(e,n,r){return new fl(e,n.sid,n.identity,n.name,n.metadata,n.attributes,r,n.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,n,r,o,a,l,u){let d=arguments.length>7&&arguments[7]!==void 0?arguments[7]:so.STANDARD;super(n,r||"",o,a,l,u,d),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(ne.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),Oe(e)),{settings:n})),this.signalClient.sendUpdateTrackSettings(n)}),e.on(ne.UpdateSubscription,n=>{n.participantTracks.forEach(r=>{r.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(ne.SubscriptionPermissionChanged,n=>{this.emit(se.TrackSubscriptionPermissionChanged,e,n)}),e.on(ne.SubscriptionStatusChanged,n=>{this.emit(se.TrackSubscriptionStatusChanged,e,n)}),e.on(ne.Subscribed,n=>{this.emit(se.TrackSubscribed,n,e)}),e.on(ne.Unsubscribed,n=>{this.emit(se.TrackUnsubscribed,n,e)}),e.on(ne.SubscriptionFailed,n=>{this.emit(se.TrackSubscriptionFailed,e.trackSid,n)})}getTrackPublication(e){const n=super.getTrackPublication(e);if(n)return n}getTrackPublicationByName(e){const n=super.getTrackPublicationByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:G.Source.Microphone;this.volumeMap.set(n,e);const r=this.getTrackPublication(n);r&&r.track&&r.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:G.Source.Microphone;const n=this.getTrackPublication(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,r,o,a,l){let u=this.getTrackPublicationBySid(n);if(u||n.startsWith("TR")||this.trackPublications.forEach(m=>{!u&&e.kind===m.kind.toString()&&(u=m)}),!u){if(l===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(se.TrackSubscriptionFailed,n);return}l===void 0&&(l=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,r,o,a,l-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Oe(u))),this.emit(se.TrackSubscriptionFailed,n);return}const d=e.kind==="video";let f;return d?f=new YR(e,n,o,a):f=new ob(e,n,o,this.audioContext,this.audioOutput),f.source=u.source,f.isMuted=u.isMuted,f.setMediaStream(r),f.start(),u.setTrack(f),this.volumeMap.has(u.source)&&Hd(f)&&Rn(f)&&f.setVolume(this.volumeMap.get(u.source)),u}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,r=new Map;return e.tracks.forEach(o=>{var a,l;let u=this.getTrackPublicationBySid(o.sid);if(u)u.updateInfo(o);else{const d=G.kindFromProto(o.type);if(!d)return;u=new rP(d,o,(a=this.signalClient.connectOptions)===null||a===void 0?void 0:a.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(l=this.loggerOptions)===null||l===void 0?void 0:l.loggerName}),u.updateInfo(o),r.set(o.sid,u);const f=Array.from(this.trackPublications.values()).find(m=>m.source===u?.source);f&&u.source!==G.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(u.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Oe(f),newTrack:Oe(u)})),this.addTrackPublication(u)}n.set(o.sid,u)}),this.trackPublications.forEach(o=>{n.has(o.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Oe(o))),this.unpublishTrack(o.trackSid,!0))}),r.forEach(o=>{this.emit(se.TrackPublished,o)}),!0}unpublishTrack(e,n){const r=this.trackPublications.get(e);if(!r)return;const{track:o}=r;switch(o&&(o.stop(),r.setTrack(void 0)),this.trackPublications.delete(e),r.kind){case G.Kind.Audio:this.audioTrackPublications.delete(e);break;case G.Kind.Video:this.videoTrackPublications.delete(e);break}n&&this.emit(se.TrackUnpublished,r)}setAudioOutput(e){return j(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTrackPublications.forEach(r=>{var o;Rn(r.track)&&Hd(r.track)&&n.push(r.track.setSinkId((o=e.deviceId)!==null&&o!==void 0?o:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:r})),super.emit(e,...r)}}var ze;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting",t.SignalReconnecting="signalReconnecting"})(ze||(ze={}));const sP=4*1e3;class Gr extends On.EventEmitter{constructor(e){var n,r,o,a;if(super(),n=this,this.state=ze.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=De,this.bufferedEvents=[],this.isResuming=!1,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map,this.rpcHandlers=new Map,this.connect=(l,u,d)=>j(this,void 0,void 0,function*(){var f;if(!M_())throw Nn()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const m=yield this.disconnectLock.lock();if(this.state===ze.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),m(),Promise.resolve();if(this.connectFuture)return m(),this.connectFuture.promise;this.setAndEmitConnectionState(ze.Connecting),((f=this.regionUrlProvider)===null||f===void 0?void 0:f.getServerUrl().toString())!==l&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Vd(new URL(l))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Qd(l,u):this.regionUrlProvider.updateToken(u),this.regionUrlProvider.fetchRegionSettings().then(S=>{var k;(k=this.regionUrlProvider)===null||k===void 0||k.setServerReportedRegions(S)}).catch(S=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:S}))}));const y=(S,k,T)=>j(this,void 0,void 0,function*(){var C,w;this.abortController&&this.abortController.abort();const A=new AbortController;this.abortController=A,m?.();try{yield this.attemptConnection(T??l,u,d,A),this.abortController=void 0,S()}catch(P){if(this.regionUrlProvider&&P instanceof He&&P.reason!==Me.Cancelled&&P.reason!==Me.NotAllowed){let E=null;try{E=yield this.regionUrlProvider.getNextBestRegionUrl((C=this.abortController)===null||C===void 0?void 0:C.signal)}catch(R){if(R instanceof He&&(R.status===401||R.reason===Me.Cancelled)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),k(R);return}}E&&!(!((w=this.abortController)===null||w===void 0)&&w.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(P.message,". Retrying with another region: ").concat(E),this.logContext),this.recreateEngine(),yield y(S,k,E)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,Gg(P)),k(P))}else{let E=mn.UNKNOWN_REASON;P instanceof He&&(E=Gg(P)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,E),k(P)}}}),b=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Mr((S,k)=>{y(S,k,b)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(l,u,d,f,m,y)=>j(this,void 0,void 0,function*(){var b,S,k;const T=yield d.join(l,u,{autoSubscribe:f.autoSubscribe,adaptiveStream:typeof m.adaptiveStream=="object"?!0:m.adaptiveStream,maxRetries:f.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:f.websocketTimeout},y.signal);let C=T.serverInfo;if(C||(C={version:T.serverVersion,region:T.serverRegion}),this.serverInfo=C,this.log.debug("connected to Livekit Server ".concat(Object.entries(C).map(w=>{let[A,P]=w;return"".concat(A,": ").concat(P)}).join(", ")),{room:(b=T.room)===null||b===void 0?void 0:b.name,roomSid:(S=T.room)===null||S===void 0?void 0:S.sid,identity:(k=T.participant)===null||k===void 0?void 0:k.identity}),!C.version)throw new S_("unknown server version");return C.version==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),m.dynacast=!1),T}),this.applyJoinResponse=l=>{const u=l.participant;if(this.localParticipant.sid=u.sid,this.localParticipant.identity=u.identity,this.localParticipant.setEnabledPublishCodecs(l.enabledPublishCodecs),this.options.e2ee&&this.e2eeManager)try{this.e2eeManager.setSifTrailer(l.sifTrailer)}catch(d){this.log.error(d instanceof Error?d.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:d}))}this.handleParticipantUpdates([u,...l.otherParticipants]),l.room&&this.handleRoomUpdate(l.room)},this.attemptConnection=(l,u,d,f)=>j(this,void 0,void 0,function*(){var m,y;this.state===ze.Reconnecting||this.isResuming||!((m=this.engine)===null||m===void 0)&&m.pendingReconnect?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((y=this.regionUrlProvider)===null||y===void 0)&&y.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Eh),d),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const b=yield this.connectSignal(l,u,this.engine,this.connOptions,this.options,f);this.applyJoinResponse(b),this.setupLocalParticipantEvents(),this.emit(ee.SignalConnected)}catch(b){yield this.engine.close(),this.recreateEngine();const S=new He("could not establish signal connection",Me.ServerUnreachable);throw b instanceof Error&&(S.message="".concat(S.message,": ").concat(b.message)),b instanceof He&&(S.reason=b.reason,S.status=b.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:b})),S}if(f.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new He("Connection attempt aborted",Me.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,f)}catch(b){throw yield this.engine.close(),this.recreateEngine(),b}Mt()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Mt()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(ze.Connected),this.emit(ee.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var l=arguments.length,u=new Array(l),d=0;d<l;d++)u[d]=arguments[d];return j(n,[...u],void 0,function(){var f=this;let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return function*(){var y,b,S,k;const T=yield f.disconnectLock.lock();try{if(f.state===ze.Disconnected){f.log.debug("already disconnected",f.logContext);return}f.log.info("disconnect from room",Object.assign({},f.logContext)),(f.state===ze.Connecting||f.state===ze.Reconnecting||f.isResuming)&&(f.log.warn("abort connection attempt",f.logContext),(y=f.abortController)===null||y===void 0||y.abort(),(S=(b=f.connectFuture)===null||b===void 0?void 0:b.reject)===null||S===void 0||S.call(b,new He("Client initiated disconnect",Me.Cancelled)),f.connectFuture=void 0),!((k=f.engine)===null||k===void 0)&&k.client.isDisconnected||(yield f.engine.client.sendLeave()),f.engine&&(yield f.engine.close()),f.handleDisconnect(m,mn.CLIENT_INITIATED),f.engine=void 0}finally{T()}}()})},this.onPageLeave=()=>j(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>j(this,void 0,void 0,function*(){const l=[],u=Jt();if(u&&u.os==="iOS"){const d="livekit-dummy-audio-el";let f=document.getElementById(d);if(!f){f=document.createElement("audio"),f.id=d,f.autoplay=!0,f.hidden=!0;const m=Wu();m.enabled=!0;const y=new MediaStream([m]);f.srcObject=y,document.addEventListener("visibilitychange",()=>{f&&(f.srcObject=document.hidden?null:y,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(f),this.once(ee.Disconnected,()=>{f?.remove(),f=null})}l.push(f)}this.remoteParticipants.forEach(d=>{d.audioTrackPublications.forEach(f=>{f.track&&f.track.attachedElements.forEach(m=>{l.push(m)})})});try{yield Promise.all([this.acquireAudioContext(),...l.map(d=>(d.muted=!1,d.play()))]),this.handleAudioPlaybackStarted()}catch(d){throw this.handleAudioPlaybackFailed(d),d}}),this.startVideo=()=>j(this,void 0,void 0,function*(){const l=[];for(const u of this.remoteParticipants.values())u.videoTrackPublications.forEach(d=>{var f;(f=d.track)===null||f===void 0||f.attachedElements.forEach(m=>{l.includes(m)||l.push(m)})});yield Promise.all(l.map(u=>u.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(u=>{u.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const l of this.remoteParticipants.values())this.handleParticipantDisconnected(l.identity,l);this.setAndEmitConnectionState(ze.Reconnecting)&&this.emit(ee.Reconnecting)},this.handleSignalRestarted=l=>j(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(l.serverRegion),Object.assign(Object.assign({},this.logContext),{region:l.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(l);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(u){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:u}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:l.serverRegion}))}catch{return}this.setAndEmitConnectionState(ze.Connected),this.emit(ee.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=l=>{l.forEach(u=>{var d;if(u.identity===this.localParticipant.identity){this.localParticipant.updateInfo(u);return}u.identity===""&&(u.identity=(d=this.sidToIdentity.get(u.sid))!==null&&d!==void 0?d:"");let f=this.remoteParticipants.get(u.identity);u.state===Fr.DISCONNECTED?this.handleParticipantDisconnected(u.identity,f):f=this.getOrCreateParticipant(u.identity,u)})},this.handleActiveSpeakersUpdate=l=>{const u=[],d={};l.forEach(f=>{if(d[f.sid]=!0,f.sid===this.localParticipant.sid)this.localParticipant.audioLevel=f.level,this.localParticipant.setIsSpeaking(!0),u.push(this.localParticipant);else{const m=this.getRemoteParticipantBySid(f.sid);m&&(m.audioLevel=f.level,m.setIsSpeaking(!0),u.push(m))}}),d[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(f=>{d[f.sid]||(f.audioLevel=0,f.setIsSpeaking(!1))}),this.activeSpeakers=u,this.emitWhenConnected(ee.ActiveSpeakersChanged,u)},this.handleSpeakersChanged=l=>{const u=new Map;this.activeSpeakers.forEach(f=>{const m=this.remoteParticipants.get(f.identity);m&&m.sid!==f.sid||u.set(f.sid,f)}),l.forEach(f=>{let m=this.getRemoteParticipantBySid(f.sid);f.sid===this.localParticipant.sid&&(m=this.localParticipant),m&&(m.audioLevel=f.level,m.setIsSpeaking(f.active),f.active?u.set(f.sid,m):u.delete(f.sid))});const d=Array.from(u.values());d.sort((f,m)=>m.audioLevel-f.audioLevel),this.activeSpeakers=d,this.emitWhenConnected(ee.ActiveSpeakersChanged,d)},this.handleStreamStateUpdate=l=>{l.streamStates.forEach(u=>{const d=this.getRemoteParticipantBySid(u.participantSid);if(!d)return;const f=d.getTrackPublicationBySid(u.trackSid);if(!f||!f.track)return;const m=G.streamStateFromProto(u.state);m!==f.track.streamState&&(f.track.streamState=m,d.emit(se.TrackStreamStateChanged,f,f.track.streamState),this.emitWhenConnected(ee.TrackStreamStateChanged,f,f.track.streamState,d))})},this.handleSubscriptionPermissionUpdate=l=>{const u=this.getRemoteParticipantBySid(l.participantSid);if(!u)return;const d=u.getTrackPublicationBySid(l.trackSid);d&&d.setAllowed(l.allowed)},this.handleSubscriptionError=l=>{const u=Array.from(this.remoteParticipants.values()).find(f=>f.trackPublications.has(l.trackSid));if(!u)return;const d=u.getTrackPublicationBySid(l.trackSid);d&&d.setSubscriptionError(l.err)},this.handleDataPacket=l=>{const u=this.remoteParticipants.get(l.participantIdentity);if(l.value.case==="user")this.handleUserPacket(u,l.value.value,l.kind);else if(l.value.case==="transcription")this.handleTranscription(u,l.value.value);else if(l.value.case==="sipDtmf")this.handleSipDtmf(u,l.value.value);else if(l.value.case==="chatMessage")this.handleChatMessage(u,l.value.value);else if(l.value.case==="metrics")this.handleMetrics(l.value.value,u);else if(l.value.case==="streamHeader")this.handleStreamHeader(l.value.value,l.participantIdentity);else if(l.value.case==="streamChunk")this.handleStreamChunk(l.value.value);else if(l.value.case==="streamTrailer")this.handleStreamTrailer(l.value.value);else if(l.value.case==="rpcRequest"){const d=l.value.value;this.handleIncomingRpcRequest(l.participantIdentity,d.id,d.method,d.payload,d.responseTimeoutMs,d.version)}},this.handleUserPacket=(l,u,d)=>{this.emit(ee.DataReceived,u.payload,l,d,u.topic),l?.emit(se.DataReceived,u.payload,d)},this.handleSipDtmf=(l,u)=>{this.emit(ee.SipDTMFReceived,u,l),l?.emit(se.SipDTMFReceived,u)},this.bufferedSegments=new Map,this.handleTranscription=(l,u)=>{const d=u.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(u.transcribedParticipantIdentity),f=d?.trackPublications.get(u.trackId),m=G_(u,this.transcriptionReceivedTimes);f?.emit(ne.TranscriptionReceived,m),d?.emit(se.TranscriptionReceived,m,f),this.emit(ee.TranscriptionReceived,m,d,f)},this.handleChatMessage=(l,u)=>{const d=K_(u);this.emit(ee.ChatMessage,d,l)},this.handleMetrics=(l,u)=>{this.emit(ee.MetricsReceived,l,u)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(ee.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=l=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:l})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(ee.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(ee.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(ee.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>j(this,void 0,void 0,function*(){var l;((l=Jt())===null||l===void 0?void 0:l.os)!=="iOS"&&(yield this.selectDefaultDevices()),this.emit(ee.MediaDevicesChanged)}),this.handleRoomUpdate=l=>{const u=this.roomInfo;this.roomInfo=l,u&&u.metadata!==l.metadata&&this.emitWhenConnected(ee.RoomMetadataChanged,l.metadata),u?.activeRecording!==l.activeRecording&&this.emitWhenConnected(ee.RecordingStatusChanged,l.activeRecording)},this.handleConnectionQualityUpdate=l=>{l.updates.forEach(u=>{if(u.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(u.quality);return}const d=this.getRemoteParticipantBySid(u.participantSid);d&&d.setConnectionQuality(u.quality)})},this.onLocalParticipantMetadataChanged=l=>{this.emit(ee.ParticipantMetadataChanged,l,this.localParticipant)},this.onLocalParticipantNameChanged=l=>{this.emit(ee.ParticipantNameChanged,l,this.localParticipant)},this.onLocalAttributesChanged=l=>{this.emit(ee.ParticipantAttributesChanged,l,this.localParticipant)},this.onLocalTrackMuted=l=>{this.emit(ee.TrackMuted,l,this.localParticipant)},this.onLocalTrackUnmuted=l=>{this.emit(ee.TrackUnmuted,l,this.localParticipant)},this.onTrackProcessorUpdate=l=>{var u;(u=l?.onPublish)===null||u===void 0||u.call(l,this)},this.onLocalTrackPublished=l=>j(this,void 0,void 0,function*(){var u,d,f,m,y,b;(u=l.track)===null||u===void 0||u.on(ne.TrackProcessorUpdate,this.onTrackProcessorUpdate),(d=l.track)===null||d===void 0||d.on(ne.Restarted,this.onLocalTrackRestarted),(y=(m=(f=l.track)===null||f===void 0?void 0:f.getProcessor())===null||m===void 0?void 0:m.onPublish)===null||y===void 0||y.call(m,this),this.emit(ee.LocalTrackPublished,l,this.localParticipant),qn(l.track)&&(yield l.track.checkForSilence())&&this.emit(ee.LocalAudioSilenceDetected,l);const S=yield(b=l.track)===null||b===void 0?void 0:b.getDeviceId(!1),k=Wd(l.source);k&&S&&S!==this.localParticipant.activeDeviceMap.get(k)&&(this.localParticipant.activeDeviceMap.set(k,S),this.emit(ee.ActiveDeviceChanged,k,S))}),this.onLocalTrackUnpublished=l=>{var u,d;(u=l.track)===null||u===void 0||u.off(ne.TrackProcessorUpdate,this.onTrackProcessorUpdate),(d=l.track)===null||d===void 0||d.off(ne.Restarted,this.onLocalTrackRestarted),this.emit(ee.LocalTrackUnpublished,l,this.localParticipant)},this.onLocalTrackRestarted=l=>j(this,void 0,void 0,function*(){const u=yield l.getDeviceId(!1),d=Wd(l.source);d&&u&&u!==this.localParticipant.activeDeviceMap.get(d)&&(this.log.debug("local track restarted, setting ".concat(d," ").concat(u," active"),this.logContext),this.localParticipant.activeDeviceMap.set(d,u),this.emit(ee.ActiveDeviceChanged,d,u))}),this.onLocalConnectionQualityChanged=l=>{this.emit(ee.ConnectionQualityChanged,l,this.localParticipant)},this.onMediaDevicesError=(l,u)=>{this.emit(ee.MediaDevicesError,l,u)},this.onLocalParticipantPermissionsChanged=l=>{this.emit(ee.ParticipantPermissionsChanged,l,this.localParticipant)},this.onLocalChatMessageSent=l=>{this.emit(ee.ChatMessage,l,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},kR),e),this.log=ei((r=this.options.loggerName)!==null&&r!==void 0?r:gn.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},Yy),e?.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},Xy),e?.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},xR),e?.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new Rt,this.localParticipant=new iP("","",this.engine,this.options,this.rpcHandlers),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Ri(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Ri(this.options.audioCaptureDefaults.deviceId)),!((o=this.options.audioOutput)===null||o===void 0)&&o.deviceId&&this.switchActiveDevice("audiooutput",Ri(this.options.audioOutput.deviceId)).catch(l=>this.log.warn("Could not set audio output: ".concat(l.message),this.logContext)),this.options.e2ee&&this.setupE2EE(),Mt()){const l=new AbortController;(a=navigator.mediaDevices)===null||a===void 0||a.addEventListener("devicechange",this.handleDeviceChange,{signal:l.signal}),Gr.cleanupRegistry&&Gr.cleanupRegistry.register(this,()=>{l.abort()})}}registerTextStreamHandler(e,n){if(this.textStreamHandlers.has(e))throw new TypeError('A text stream handler for topic "'.concat(e,'" has already been set.'));this.textStreamHandlers.set(e,n)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,n){if(this.byteStreamHandlers.has(e))throw new TypeError('A byte stream handler for topic "'.concat(e,'" has already been set.'));this.byteStreamHandlers.set(e,n)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}registerRpcMethod(e,n){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,n)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}handleIncomingRpcRequest(e,n,r,o,a,l){return j(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,n),l!==1){yield this.engine.publishRpcResponse(e,n,null,it.builtIn("UNSUPPORTED_VERSION"));return}const u=this.rpcHandlers.get(r);if(!u){yield this.engine.publishRpcResponse(e,n,null,it.builtIn("UNSUPPORTED_METHOD"));return}let d=null,f=null;try{const m=yield u({requestId:n,callerIdentity:e,payload:o,responseTimeout:a});_h(m)>Zy?(d=it.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(r))):f=m}catch(m){m instanceof it?d=m:(console.warn("Uncaught error returned by RPC handler for ".concat(r,". Returning APPLICATION_ERROR instead."),m),d=it.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,n,f,d)})}setE2EEEnabled(e){return j(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&("e2eeManager"in this.options.e2ee?this.e2eeManager=this.options.e2ee.e2eeManager:this.e2eeManager=new sR(this.options.e2ee),this.e2eeManager.on(Ei.ParticipantEncryptionStatusChanged,(n,r)=>{Q_(r)&&(this.isE2EEEnabled=n),this.emit(ee.ParticipantEncryptionStatusChanged,n,r)}),this.e2eeManager.on(Ei.EncryptionError,n=>this.emit(ee.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:(e=this.roomInfo)===null||e===void 0?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}getSid(){return j(this,void 0,void 0,function*(){return this.state===ze.Disconnected?"":this.roomInfo&&this.roomInfo.sid!==""?this.roomInfo.sid:new Promise((e,n)=>{const r=o=>{o.sid!==""&&(this.engine.off(re.RoomUpdate,r),e(o.sid))};this.engine.on(re.RoomUpdate,r),this.once(ee.Disconnected,()=>{this.engine.off(re.RoomUpdate,r),n("Room disconnected before room server id was available")})})})}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new qR(this.options),this.engine.on(re.ParticipantUpdate,this.handleParticipantUpdates).on(re.RoomUpdate,this.handleRoomUpdate).on(re.SpeakersChanged,this.handleSpeakersChanged).on(re.StreamStateChanged,this.handleStreamStateUpdate).on(re.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(re.SubscriptionError,this.handleSubscriptionError).on(re.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(re.MediaTrackAdded,(e,n,r)=>{this.onTrackAdded(e,n,r)}).on(re.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(re.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(re.DataPacketReceived,this.handleDataPacket).on(re.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(ze.SignalReconnecting)&&this.emit(ee.SignalReconnecting)}).on(re.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(ze.Connected)&&this.emit(ee.Reconnected)}).on(re.SignalResumed,()=>{this.bufferedEvents=[],(this.state===ze.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(re.Restarting,this.handleRestarting).on(re.SignalRestarted,this.handleSignalRestarted).on(re.Offline,()=>{this.setAndEmitConnectionState(ze.Reconnecting)&&this.emit(ee.Reconnecting)}).on(re.DCBufferStatusChanged,(e,n)=>{this.emit(ee.DCBufferStatusChanged,e,n)}).on(re.LocalTrackSubscribed,e=>{const n=this.localParticipant.getTrackPublications().find(r=>{let{trackSid:o}=r;return o===e});if(!n){this.log.warn("could not find local track subscription for subscribed event",this.logContext);return}this.localParticipant.emit(se.LocalTrackSubscribed,n),this.emitWhenConnected(ee.LocalTrackSubscribed,n,this.localParticipant)}).on(re.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((n,r)=>{this.handleParticipantDisconnected(r,n)}),this.emit(ee.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return gt.getInstance().getDevices(e,n)}prepareConnection(e,n){return j(this,void 0,void 0,function*(){if(this.state===ze.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Vd(new URL(e))&&n){this.regionUrlProvider=new Qd(e,n);const r=yield this.regionUrlProvider.getNextBestRegionUrl();r&&this.state===ze.Disconnected&&(this.regionUrl=r,yield fetch(qd(r),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(r),this.logContext))}else yield fetch(qd(e),{method:"HEAD"})}catch(r){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:r}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return j(this,void 0,void 0,function*(){let r=()=>{},o;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":o=new wn({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":o=new wn({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":o=new wn({scenario:{case:"serverLeave",value:!0}});break;case"migration":o=new wn({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":r=()=>j(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new wn({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":r=()=>j(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),o=new wn({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":o=new wn({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),r=()=>j(this,void 0,void 0,function*(){const a=this.engine.client.onLeave;a&&a(new Nl({reason:mn.CLIENT_INITIATED,action:Br.RECONNECT}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");o=new wn({scenario:{case:"subscriberBandwidth",value:Wi(n)}});break;case"leave-full-reconnect":o=new wn({scenario:{case:"leaveRequestFullReconnect",value:!0}})}o&&(yield this.engine.client.sendSimulateScenario(o),yield r())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){return j(this,arguments,void 0,function(r,o){var a=this;let l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return function*(){var u,d,f,m,y,b,S;let k=!0,T=!1;const C=l?{exact:o}:o;if(r==="audioinput"){T=a.localParticipant.audioTrackPublications.size===0;const w=(u=a.getActiveDevice(r))!==null&&u!==void 0?u:a.options.audioCaptureDefaults.deviceId;a.options.audioCaptureDefaults.deviceId=C;const A=Array.from(a.localParticipant.audioTrackPublications.values()).filter(E=>E.source===G.Source.Microphone);try{k=(yield Promise.all(A.map(E=>{var R;return(R=E.audioTrack)===null||R===void 0?void 0:R.setDeviceId(C)}))).every(E=>E===!0)}catch(E){throw a.options.audioCaptureDefaults.deviceId=w,E}const P=A.some(E=>{var R,B;return(B=(R=E.track)===null||R===void 0?void 0:R.isMuted)!==null&&B!==void 0?B:!1});k&&P&&(T=!0)}else if(r==="videoinput"){T=a.localParticipant.videoTrackPublications.size===0;const w=(d=a.getActiveDevice(r))!==null&&d!==void 0?d:a.options.videoCaptureDefaults.deviceId;a.options.videoCaptureDefaults.deviceId=C;const A=Array.from(a.localParticipant.videoTrackPublications.values()).filter(E=>E.source===G.Source.Camera);try{k=(yield Promise.all(A.map(E=>{var R;return(R=E.videoTrack)===null||R===void 0?void 0:R.setDeviceId(C)}))).every(E=>E===!0)}catch(E){throw a.options.videoCaptureDefaults.deviceId=w,E}const P=A.some(E=>{var R,B;return(B=(R=E.track)===null||R===void 0?void 0:R.isMuted)!==null&&B!==void 0?B:!1});k&&P&&(T=!0)}else if(r==="audiooutput"){if(T=!0,!zd()&&!a.options.webAudioMix||a.options.webAudioMix&&a.audioContext&&!("setSinkId"in a.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");a.options.webAudioMix&&(o=(f=yield gt.getInstance().normalizeDeviceId("audiooutput",o))!==null&&f!==void 0?f:""),(m=(S=a.options).audioOutput)!==null&&m!==void 0||(S.audioOutput={});const w=(y=a.getActiveDevice(r))!==null&&y!==void 0?y:a.options.audioOutput.deviceId;a.options.audioOutput.deviceId=o;try{a.options.webAudioMix&&((b=a.audioContext)===null||b===void 0||b.setSinkId(o)),yield Promise.all(Array.from(a.remoteParticipants.values()).map(A=>A.setAudioOutput({deviceId:o})))}catch(A){throw a.options.audioOutput.deviceId=w,A}}return T&&(a.localParticipant.activeDeviceMap.set(r,o),a.emit(ee.ActiveDeviceChanged,r,o)),k}()})}setupLocalParticipantEvents(){this.localParticipant.on(se.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(se.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(se.AttributesChanged,this.onLocalAttributesChanged).on(se.TrackMuted,this.onLocalTrackMuted).on(se.TrackUnmuted,this.onLocalTrackUnmuted).on(se.LocalTrackPublished,this.onLocalTrackPublished).on(se.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(se.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(se.MediaDevicesError,this.onMediaDevicesError).on(se.AudioStreamAcquired,this.startAudio).on(se.ChatMessage,this.onLocalChatMessageSent).on(se.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,r){if(this.state===ze.Connecting||this.state===ze.Reconnecting){const m=()=>{this.onTrackAdded(e,n,r),y()},y=()=>{this.off(ee.Reconnected,m),this.off(ee.Connected,m),this.off(ee.Disconnected,y)};this.once(ee.Reconnected,m),this.once(ee.Connected,m),this.once(ee.Disconnected,y);return}if(this.state===ze.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}if(e.readyState==="ended"){this.log.info("skipping incoming track as it already ended",this.logContext);return}const o=A_(n.id),a=o[0];let l=o[1],u=e.id;if(l&&l.startsWith("TR")&&(u=l),a===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const d=Array.from(this.remoteParticipants.values()).find(m=>m.sid===a);if(!d){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(a),this.logContext);return}let f;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?f=this.options.adaptiveStream:f={}),d.addSubscribedMediaTrack(e,u,n,r,f)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var r;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.state!==ze.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(o=>{o.trackPublications.forEach(a=>{o.unpublishTrack(a.trackSid)})}),this.localParticipant.trackPublications.forEach(o=>{var a,l,u;o.track&&this.localParticipant.unpublishTrack(o.track,e),e?((a=o.track)===null||a===void 0||a.detach(),(l=o.track)===null||l===void 0||l.stop()):(u=o.track)===null||u===void 0||u.stopMonitor()}),this.localParticipant.off(se.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(se.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(se.AttributesChanged,this.onLocalAttributesChanged).off(se.TrackMuted,this.onLocalTrackMuted).off(se.TrackUnmuted,this.onLocalTrackUnmuted).off(se.LocalTrackPublished,this.onLocalTrackPublished).off(se.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(se.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(se.MediaDevicesError,this.onMediaDevicesError).off(se.AudioStreamAcquired,this.startAudio).off(se.ChatMessage,this.onLocalChatMessageSent).off(se.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.webAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Mt()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(r=navigator.mediaDevices)===null||r===void 0||r.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(ze.Disconnected),this.emit(ee.Disconnected,n)}}}handleParticipantDisconnected(e,n){var r;this.remoteParticipants.delete(e),n&&(n.trackPublications.forEach(o=>{n.unpublishTrack(o.trackSid,!0)}),this.emit(ee.ParticipantDisconnected,n),n.setDisconnected(),(r=this.localParticipant)===null||r===void 0||r.handleParticipantDisconnected(n.identity))}handleStreamHeader(e,n){return j(this,void 0,void 0,function*(){var r;if(e.contentHeader.case==="byteHeader"){const o=this.byteStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);return}let a;const l={id:e.streamId,name:(r=e.contentHeader.value.name)!==null&&r!==void 0?r:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Qa(e.timestamp),attributes:e.attributes},u=new ReadableStream({start:d=>{a=d,this.byteStreamControllers.set(e.streamId,{info:l,controller:a,startTime:Date.now()})}});o(new GR(l,u,Qa(e.totalLength)),{identity:n})}else if(e.contentHeader.case==="textHeader"){const o=this.textStreamHandlers.get(e.topic);if(!o){this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);return}let a;const l={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes},u=new ReadableStream({start:d=>{a=d,this.textStreamControllers.set(e.streamId,{info:l,controller:a,startTime:Date.now()})}});o(new KR(l,u,Qa(e.totalLength)),{identity:n})}})}handleStreamChunk(e){const n=this.byteStreamControllers.get(e.streamId);n&&e.content.length>0&&n.controller.enqueue(e);const r=this.textStreamControllers.get(e.streamId);r&&e.content.length>0&&r.controller.enqueue(e)}handleStreamTrailer(e){const n=this.textStreamControllers.get(e.streamId);n&&(n.info.attributes=Object.assign(Object.assign({},n.info.attributes),e.attributes),n.controller.close(),this.textStreamControllers.delete(e.streamId));const r=this.byteStreamControllers.get(e.streamId);r&&(r.info.attributes=Object.assign(Object.assign({},r.info.attributes),e.attributes),r.controller.close(),this.byteStreamControllers.delete(e.streamId))}selectDefaultDevices(){return j(this,void 0,void 0,function*(){var e,n,r;const o=gt.getInstance().previousDevices,a=yield gt.getInstance().getDevices(void 0,!1),l=Jt();if(l?.name==="Chrome"&&l.os!=="iOS")for(let d of a){const f=o.find(m=>m.deviceId===d.deviceId);f&&f.label!==""&&f.kind===d.kind&&f.label!==d.label&&this.getActiveDevice(d.kind)==="default"&&this.emit(ee.ActiveDeviceChanged,d.kind,d.deviceId)}const u=["audiooutput","audioinput","videoinput"];for(let d of u){const f=X_(d),m=this.localParticipant.getTrackPublication(f);if(m&&(!((e=m.track)===null||e===void 0)&&e.isUserProvided))continue;const y=a.filter(S=>S.kind===d),b=this.getActiveDevice(d);if(b===((n=o.filter(S=>S.kind===d)[0])===null||n===void 0?void 0:n.deviceId)&&y.length>0&&((r=y[0])===null||r===void 0?void 0:r.deviceId)!==b){yield this.switchActiveDevice(d,y[0].deviceId);continue}d==="audioinput"&&!cl()||d==="videoinput"||y.length>0&&!y.find(S=>S.deviceId===this.getActiveDevice(d))&&(d!=="audiooutput"||!cl())&&(yield this.switchActiveDevice(d,y[0].deviceId))}})}acquireAudioContext(){return j(this,void 0,void 0,function*(){var e,n;if(typeof this.options.webAudioMix!="boolean"&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=Sh())!==null&&e!==void 0?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(o=>o.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&this.audioContext.state==="suspended")try{yield Promise.race([this.audioContext.resume(),Bt(200)])}catch(o){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:o}))}const r=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";r!==this.canPlaybackAudio&&(this.audioEnabled=r,this.emit(ee.AudioPlaybackStatusChanged,r))})}createParticipant(e,n){var r;let o;return n?o=fl.fromParticipantInfo(this.engine.client,n,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):o=new fl(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&o.setAudioContext(this.audioContext),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&o.setAudioOutput(this.options.audioOutput).catch(a=>this.log.warn("Could not set audio output: ".concat(a.message),this.logContext)),o}getOrCreateParticipant(e,n){if(this.remoteParticipants.has(e)){const o=this.remoteParticipants.get(e);return n&&o.updateInfo(n)&&this.sidToIdentity.set(n.sid,n.identity),o}const r=this.createParticipant(e,n);return this.remoteParticipants.set(e,r),this.sidToIdentity.set(n.sid,n.identity),this.emitWhenConnected(ee.ParticipantConnected,r),r.on(se.TrackPublished,o=>{this.emitWhenConnected(ee.TrackPublished,o,r)}).on(se.TrackSubscribed,(o,a)=>{o.kind===G.Kind.Audio?(o.on(ne.AudioPlaybackStarted,this.handleAudioPlaybackStarted),o.on(ne.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):o.kind===G.Kind.Video&&(o.on(ne.VideoPlaybackFailed,this.handleVideoPlaybackFailed),o.on(ne.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(ee.TrackSubscribed,o,a,r)}).on(se.TrackUnpublished,o=>{this.emit(ee.TrackUnpublished,o,r)}).on(se.TrackUnsubscribed,(o,a)=>{this.emit(ee.TrackUnsubscribed,o,a,r)}).on(se.TrackMuted,o=>{this.emitWhenConnected(ee.TrackMuted,o,r)}).on(se.TrackUnmuted,o=>{this.emitWhenConnected(ee.TrackUnmuted,o,r)}).on(se.ParticipantMetadataChanged,o=>{this.emitWhenConnected(ee.ParticipantMetadataChanged,o,r)}).on(se.ParticipantNameChanged,o=>{this.emitWhenConnected(ee.ParticipantNameChanged,o,r)}).on(se.AttributesChanged,o=>{this.emitWhenConnected(ee.ParticipantAttributesChanged,o,r)}).on(se.ConnectionQualityChanged,o=>{this.emitWhenConnected(ee.ConnectionQualityChanged,o,r)}).on(se.ParticipantPermissionsChanged,o=>{this.emitWhenConnected(ee.ParticipantPermissionsChanged,o,r)}).on(se.TrackSubscriptionStatusChanged,(o,a)=>{this.emitWhenConnected(ee.TrackSubscriptionStatusChanged,o,a,r)}).on(se.TrackSubscriptionFailed,(o,a)=>{this.emit(ee.TrackSubscriptionFailed,o,r,a)}).on(se.TrackSubscriptionPermissionChanged,(o,a)=>{this.emitWhenConnected(ee.TrackSubscriptionPermissionChanged,o,a,r)}).on(se.Active,()=>{this.emitWhenConnected(ee.ParticipantActive,r),r.kind===so.AGENT&&this.localParticipant.setActiveAgent(r)}),n&&r.updateInfo(n),r}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((r,o)=>(r.push(...o.getTrackPublications()),r),[]),n=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const n of e.videoTrackPublications.values())n.isSubscribed&&J_(n)&&n.emitTrackUpdate()}getRemoteParticipantBySid(e){const n=this.sidToIdentity.get(e);if(n)return this.remoteParticipants.get(n)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=bt.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,mn.STATE_MISMATCH))):e=0},sP)}clearConnectionReconcile(){this.connectionReconcileInterval&&bt.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(ee.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,r]=e;this.emit(n,...r)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(this.state===ze.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,r]);else if(this.state===ze.Connected)return this.emit(e,...r);return!1}simulateParticipants(e){return j(this,void 0,void 0,function*(){var n,r;const o=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),a=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new Rl({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Qe.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new er({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(ee.SignalConnected),this.emit(ee.Connected),this.setAndEmitConnectionState(ze.Connected),o.video){const l=new Xd(G.Kind.Video,new Dr({source:lt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:fn.AUDIO,name:"video-dummy"}),new hl(o.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Wg(160*((n=a.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit(se.LocalTrackPublished,l)}if(o.audio){const l=new Xd(G.Kind.Audio,new Dr({source:lt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:fn.AUDIO}),new dl(o.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Wu(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(l),this.localParticipant.emit(se.LocalTrackPublished,l)}for(let l=0;l<a.count-1;l+=1){let u=new er({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(l),state:Fr.ACTIVE,tracks:[],joinedAt:Qe.parse(Date.now())});const d=this.getOrCreateParticipant(u.identity,u);if(a.video){const f=Wg(160*((r=a.aspectRatios[l%a.aspectRatios.length])!==null&&r!==void 0?r:1),160,!1,!0),m=new Dr({source:lt.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:fn.AUDIO});d.addSubscribedMediaTrack(f,m.sid,new MediaStream([f]),new RTCRtpReceiver),u.tracks=[...u.tracks,m]}if(a.audio){const f=Wu(),m=new Dr({source:lt.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:fn.AUDIO});d.addSubscribedMediaTrack(f,m.sid,new MediaStream([f]),new RTCRtpReceiver),u.tracks=[...u.tracks,m]}d.updateInfo(u)}})}emit(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];if(e!==ee.ActiveSpeakersChanged&&e!==ee.TranscriptionReceived){const a=lb(r).filter(l=>l!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:a}))}return super.emit(e,...r)}}Gr.cleanupRegistry=typeof FinalizationRegistry<"u"&&new FinalizationRegistry(t=>{t()});function lb(t){return t.map(e=>{if(e)return Array.isArray(e)?lb(e):typeof e=="object"?"logContext"in e?e.logContext:void 0:e})}var hn;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(hn||(hn={}));class ji extends On.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=hn.IDLE,this.logs=[],this.options={},this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Gr(r.roomOptions),this.connectOptions=r.connectOptions,this.options=r}run(e){return j(this,void 0,void 0,function*(){if(this.status!==hn.IDLE)throw Error("check is running already");this.setStatus(hn.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.options.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==hn.SKIPPED&&this.setStatus(this.isSuccess()?hn.SUCCESS:hn.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(e){return j(this,void 0,void 0,function*(){return this.room.state===ze.Connected?this.room:(e||(e=this.url),yield this.room.connect(e,this.token,this.connectOptions),this.room)})}disconnect(){return j(this,void 0,void 0,function*(){this.room&&this.room.state!==ze.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(hn.SKIPPED)}switchProtocol(e){return j(this,void 0,void 0,function*(){let n=!1,r=!1;if(this.room.on(ee.Reconnecting,()=>{n=!0}),this.room.once(ee.Reconnected,()=>{r=!0}),this.room.simulateScenario("force-".concat(e)),yield new Promise(a=>setTimeout(a,1e3)),!n)return;const o=Date.now()+1e4;for(;Date.now()<o;){if(r)return;yield Bt(100)}throw new Error("Could not reconnect using ".concat(e," protocol after 10 seconds"))})}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}class oP extends ji{get description(){return"Cloud regions"}perform(){return j(this,void 0,void 0,function*(){const e=new Qd(this.url,this.token);if(!e.isCloud()){this.skip();return}const n=[],r=new Set;for(let a=0;a<3;a++){const l=yield e.getNextBestRegionUrl();if(!l)break;if(r.has(l))continue;r.add(l);const u=yield this.checkCloudRegion(l);this.appendMessage("".concat(u.region," RTT: ").concat(u.rtt,"ms, duration: ").concat(u.duration,"ms")),n.push(u)}n.sort((a,l)=>(a.duration-l.duration)*.5+(a.rtt-l.rtt)*.5);const o=n[0];this.bestStats=o,this.appendMessage("best Cloud region: ".concat(o.region))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkCloudRegion(e){return j(this,void 0,void 0,function*(){var n,r;yield this.connect(e),this.options.protocol==="tcp"&&(yield this.switchProtocol("tcp"));const o=(n=this.room.serverInfo)===null||n===void 0?void 0:n.region;if(!o)throw new Error("Region not found");const a=yield this.room.localParticipant.streamText({topic:"test"}),l=1e3,d=1e6/l,f="A".repeat(l),m=Date.now();for(let k=0;k<d;k++)yield a.write(f);yield a.close();const y=Date.now(),b=yield(r=this.room.engine.pcManager)===null||r===void 0?void 0:r.publisher.getStats(),S={region:o,rtt:1e4,duration:y-m};return b?.forEach(k=>{k.type==="candidate-pair"&&k.nominated&&(S.rtt=k.currentRoundTripTime*1e3)}),yield this.disconnect(),S})}}const td=1e4;class aP extends ji{get description(){return"Connection via UDP vs TCP"}perform(){return j(this,void 0,void 0,function*(){const e=yield this.checkConnectionProtocol("udp"),n=yield this.checkConnectionProtocol("tcp");this.bestStats=e,e.qualityLimitationDurations.bandwidth-n.qualityLimitationDurations.bandwidth>.5||(e.packetsLost-n.packetsLost)/e.packetsSent>.01?(this.appendMessage("best connection quality via tcp"),this.bestStats=n):this.appendMessage("best connection quality via udp");const r=this.bestStats;this.appendMessage("upstream bitrate: ".concat((r.bitrateTotal/r.count/1e3/1e3).toFixed(2)," mbps")),this.appendMessage("RTT: ".concat((r.rttTotal/r.count*1e3).toFixed(2)," ms")),this.appendMessage("jitter: ".concat((r.jitterTotal/r.count*1e3).toFixed(2)," ms")),r.packetsLost>0&&this.appendWarning("packets lost: ".concat((r.packetsLost/r.packetsSent*100).toFixed(2),"%")),r.qualityLimitationDurations.bandwidth>1&&this.appendWarning("bandwidth limited ".concat((r.qualityLimitationDurations.bandwidth/(td/1e3)*100).toFixed(2),"%")),r.qualityLimitationDurations.cpu>0&&this.appendWarning("cpu limited ".concat((r.qualityLimitationDurations.cpu/(td/1e3)*100).toFixed(2),"%"))})}getInfo(){const e=super.getInfo();return e.data=this.bestStats,e}checkConnectionProtocol(e){return j(this,void 0,void 0,function*(){yield this.connect(),e==="tcp"?yield this.switchProtocol("tcp"):yield this.switchProtocol("udp");const n=document.createElement("canvas");n.width=1280,n.height=720;const r=n.getContext("2d");if(!r)throw new Error("Could not get canvas context");let o=0;const a=()=>{o=(o+1)%360,r.fillStyle="hsl(".concat(o,", 100%, 50%)"),r.fillRect(0,0,n.width,n.height),requestAnimationFrame(a)};a();const u=n.captureStream(30).getVideoTracks()[0],f=(yield this.room.localParticipant.publishTrack(u,{simulcast:!1,degradationPreference:"maintain-resolution",videoEncoding:{maxBitrate:2e6}})).track,m={protocol:e,packetsLost:0,packetsSent:0,qualityLimitationDurations:{},rttTotal:0,jitterTotal:0,bitrateTotal:0,count:0},y=setInterval(()=>j(this,void 0,void 0,function*(){const b=yield f.getRTCStatsReport();b?.forEach(S=>{S.type==="outbound-rtp"?(m.packetsSent=S.packetsSent,m.qualityLimitationDurations=S.qualityLimitationDurations,m.bitrateTotal+=S.targetBitrate,m.count++):S.type==="remote-inbound-rtp"&&(m.packetsLost=S.packetsLost,m.rttTotal+=S.roundTripTime,m.jitterTotal+=S.jitter)})}),1e3);return yield new Promise(b=>setTimeout(b,td)),clearInterval(y),u.stop(),n.remove(),yield this.disconnect(),m})}}class lP extends ji{get description(){return"Can publish audio"}perform(){return j(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield eP();if(yield Ky(r,1e3))throw new Error("unable to detect audio from microphone");this.appendMessage("detected audio from microphone"),n.localParticipant.publishTrack(r),yield new Promise(u=>setTimeout(u,3e3));const a=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!a)throw new Error("Could not get RTCStats");let l=0;if(a.forEach(u=>{u.type==="outbound-rtp"&&(u.kind==="audio"||!u.kind&&u.mediaType==="audio")&&(l=u.packetsSent)}),l===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(l," audio packets"))})}}class cP extends ji{get description(){return"Can publish video"}perform(){return j(this,void 0,void 0,function*(){var e;const n=yield this.connect(),r=yield ZR();yield this.checkForVideo(r.mediaStreamTrack),n.localParticipant.publishTrack(r),yield new Promise(l=>setTimeout(l,5e3));const o=yield(e=r.sender)===null||e===void 0?void 0:e.getStats();if(!o)throw new Error("Could not get RTCStats");let a=0;if(o.forEach(l=>{l.type==="outbound-rtp"&&(l.kind==="video"||!l.kind&&l.mediaType==="video")&&(a+=l.packetsSent)}),a===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(a," video packets"))})}checkForVideo(e){return j(this,void 0,void 0,function*(){const n=new MediaStream;n.addTrack(e.clone());const r=document.createElement("video");r.srcObject=n,r.muted=!0,yield new Promise(o=>{r.onplay=()=>{setTimeout(()=>{var a,l,u,d;const f=document.createElement("canvas"),m=e.getSettings(),y=(l=(a=m.width)!==null&&a!==void 0?a:r.videoWidth)!==null&&l!==void 0?l:1280,b=(d=(u=m.height)!==null&&u!==void 0?u:r.videoHeight)!==null&&d!==void 0?d:720;f.width=y,f.height=b;const S=f.getContext("2d");S.drawImage(r,0,0);const T=S.getImageData(0,0,f.width,f.height).data;let C=!0;for(let w=0;w<T.length;w+=4)if(T[w]!==0||T[w+1]!==0||T[w+2]!==0){C=!1;break}C?this.appendError("camera appears to be producing only black frames"):this.appendMessage("received video frames"),o()},1e3)},r.play()}),n.getTracks().forEach(o=>o.stop()),r.remove()})}}class uP extends ji{get description(){return"Resuming connection after interruption"}perform(){return j(this,void 0,void 0,function*(){var e;const n=yield this.connect();let r=!1,o=!1,a;const l=new Promise(f=>{setTimeout(f,5e3),a=f}),u=()=>{r=!0};n.on(ee.SignalReconnecting,u).on(ee.Reconnecting,u).on(ee.Reconnected,()=>{o=!0,a(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const d=n.engine.client.onClose;if(d&&d(""),yield l,r){if(!o||n.state!==ze.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class dP extends ji{get description(){return"Can connect via TURN"}perform(){return j(this,void 0,void 0,function*(){var e,n;const r=new Th,o=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let a=!1,l=!1,u=!1;for(let d of o.iceServers)for(let f of d.urls)f.startsWith("turn:")?(l=!0,u=!0):f.startsWith("turns:")&&(l=!0,u=!0,a=!0),f.startsWith("stun:")&&(u=!0);u?l&&!a&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield r.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||l?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(d=>setTimeout(d,0)))})}}class hP extends ji{get description(){return"Establishing WebRTC connection"}perform(){return j(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(ee.SignalConnected,()=>{const r=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(o,a)=>{if(o.candidate){const l=new RTCIceCandidate(o);let u="".concat(l.protocol," ").concat(l.address,":").concat(l.port," ").concat(l.type);l.address&&(fP(l.address)?u+=" (private)":l.protocol==="tcp"&&l.tcpType==="passive"?(e=!0,u+=" (passive)"):l.protocol==="udp"&&(n=!0)),this.appendMessage(u)}r&&r(o,a)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=o=>{o instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(o.errorCode," ").concat(o.errorText," ").concat(o.url))})});try{yield this.connect(),De.info("now the room is connected")}catch(r){throw this.appendWarning("ports need to be open on firewall in order to connect."),r}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function fP(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class pP extends ji{get description(){return"Connecting to signal connection via WebSocket"}perform(){return j(this,void 0,void 0,function*(){var e,n,r;(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let o=new Th;const a=yield o.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(a.serverVersion,".")),((e=a.serverInfo)===null||e===void 0?void 0:e.edition)===Jv.Cloud&&(!((n=a.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((r=a.serverInfo)===null||r===void 0?void 0:r.region)),yield o.close()})}}class FP extends On.EventEmitter{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.options={},this.checkResults=new Map,this.url=e,this.token=n,this.options=r}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:hn.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==hn.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return j(this,void 0,void 0,function*(){const n=this.getNextCheckId(),r=new e(this.url,this.token,this.options),o=l=>{this.updateCheck(n,l)};r.on("update",o);const a=yield r.run();return r.off("update",o),a})}checkWebsocket(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(pP)})}checkWebRTC(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(hP)})}checkTURN(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(dP)})}checkReconnect(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(uP)})}checkPublishAudio(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(lP)})}checkPublishVideo(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(cP)})}checkConnectionProtocol(){return j(this,void 0,void 0,function*(){const e=yield this.createAndRunCheck(aP);if(e.data&&"protocol"in e.data){const n=e.data;this.options.protocol=n.protocol}return e})}checkCloudRegion(){return j(this,void 0,void 0,function*(){return this.createAndRunCheck(oP)})}}function Zd(t,e){return Zd=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},Zd(t,e)}var mP=new TextDecoder,Nh=function(t){var e,n;function r(){var a;return(a=t.call(this)||this).room=void 0,a.connected=!1,a.isAgentTalking=!1,a.analyzerComponent=void 0,a.captureAudioFrame=void 0,a}n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,Zd(e,n);var o=r.prototype;return o.startCall=function(a){try{var l=this,u=function(d,f){try{var m=(l.room=new Gr({audioCaptureDefaults:{autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,channelCount:1,deviceId:a.captureDeviceId,sampleRate:a.sampleRate},audioOutput:{deviceId:a.playbackDeviceId}}),l.handleRoomEvents(),l.handleAudioEvents(a),l.handleDataEvents(),Promise.resolve(l.room.connect("wss://retell-ai-4ihahnq7.livekit.cloud",a.accessToken)).then(function(){console.log("connected to room",l.room.name),l.room.localParticipant.setMicrophoneEnabled(!0),l.connected=!0,l.emit("call_started")}))}catch(y){return f(y)}return m&&m.then?m.then(void 0,f):m}(0,function(d){l.emit("error","Error starting call"),console.error("Error starting call",d),l.stopCall()});return Promise.resolve(u&&u.then?u.then(function(){}):void 0)}catch(d){return Promise.reject(d)}},o.startAudioPlayback=function(){try{return Promise.resolve(this.room.startAudio()).then(function(){})}catch(a){return Promise.reject(a)}},o.stopCall=function(){var a;this.connected&&(this.connected=!1,this.emit("call_ended"),(a=this.room)==null||a.disconnect(),this.isAgentTalking=!1,delete this.room,this.analyzerComponent&&(this.analyzerComponent.cleanup(),delete this.analyzerComponent),this.captureAudioFrame&&(window.cancelAnimationFrame(this.captureAudioFrame),delete this.captureAudioFrame))},o.mute=function(){this.connected&&this.room.localParticipant.setMicrophoneEnabled(!1)},o.unmute=function(){this.connected&&this.room.localParticipant.setMicrophoneEnabled(!0)},o.captureAudioSamples=function(){var a=this;if(this.connected&&this.analyzerComponent){var l=new Float32Array(this.analyzerComponent.analyser.fftSize);this.analyzerComponent.analyser.getFloatTimeDomainData(l),this.emit("audio",l),this.captureAudioFrame=window.requestAnimationFrame(function(){return a.captureAudioSamples()})}},o.handleRoomEvents=function(){var a=this;this.room.on(ee.ParticipantDisconnected,function(l){l?.identity==="server"&&setTimeout(function(){a.stopCall()},500)}),this.room.on(ee.Disconnected,function(){a.stopCall()})},o.handleAudioEvents=function(a){var l=this;this.room.on(ee.TrackSubscribed,function(u,d,f){u.kind===G.Kind.Audio&&u instanceof ob&&(d.trackName==="agent_audio"&&(l.emit("call_ready"),a.emitRawAudioSamples&&(l.analyzerComponent=H_(u),l.captureAudioFrame=window.requestAnimationFrame(function(){return l.captureAudioSamples()}))),u.attach())})},o.handleDataEvents=function(){var a=this;this.room.on(ee.DataReceived,function(l,u,d,f){try{if(u?.identity!=="server")return;var m=mP.decode(l),y=JSON.parse(m);y.event_type==="update"?a.emit("update",y):y.event_type==="metadata"?a.emit("metadata",y):y.event_type==="agent_start_talking"?(a.isAgentTalking=!0,a.emit("agent_start_talking")):y.event_type==="agent_stop_talking"?(a.isAgentTalking=!1,a.emit("agent_stop_talking")):y.event_type==="node_transition"&&a.emit("node_transition",y)}catch(b){console.error("Error decoding data received",b)}})},r}(Ew);console.log("=== RETELL: RetellWebClient import check ===");console.log("RetellWebClient:",Nh);console.log("RetellWebClient type:",typeof Nh);const gP=({agentId:t,onCallEnd:e,accessToken:n})=>{const[r,o]=N.useState("initializing"),[a,l]=N.useState(null),[u,d]=N.useState(null),[f,m]=N.useState(0);N.useRef(null),N.useEffect(()=>{if(console.log("=== RETELL: useEffect triggered ==="),console.log("Agent ID:",t),console.log("Access Token present:",!!n),console.log("Call status:",r),!t){console.log("ERROR: No agent ID provided");return}if(!n){console.log("ERROR: No access token provided"),l("Access token is required"),o("error");return}if(typeof n!="string"||n.length<10){console.log("ERROR: Invalid access token format"),console.log("Access token type:",typeof n),console.log("Access token length:",n?.length),l("Invalid access token format"),o("error");return}return(async()=>{try{console.log("=== RETELL: Initializing Retell web call ==="),console.log("Agent ID:",t),console.log("Access Token length:",n?.length),console.log("=== RETELL: Requesting microphone permissions ===");try{const C=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});console.log("=== RETELL: Microphone permission granted ==="),C.getTracks().forEach(w=>w.stop())}catch(C){console.error("=== RETELL: Microphone permission denied ==="),console.error("Permission error:",C),l("Microphone access is required for voice calls. Please allow microphone access and try again."),o("error");return}console.log("=== RETELL: Getting available audio devices ===");const k=(await navigator.mediaDevices.enumerateDevices()).filter(C=>C.kind==="audioinput");if(console.log("Available audio devices:",k),k.length===0){console.error("=== RETELL: No audio devices found ==="),l("No microphone devices found. Please connect a microphone and try again."),o("error");return}console.log("=== RETELL: Using audio device:",k[0].label||k[0].deviceId);const T=new Nh;console.log("RetellWebClient created successfully"),d(T),T.on("call_started",()=>{console.log("=== RETELL: Call started event received ==="),o("active")}),T.on("call_ended",()=>{console.log("=== RETELL: Call ended event received ==="),e&&e()}),T.on("error",C=>{console.error("=== RETELL: Call error event received ==="),console.error("Error details:",C),l(C.message||"An error occurred during the call"),o("error")}),console.log("=== RETELL: Waiting for client initialization... ==="),await new Promise(C=>setTimeout(C,1e3)),console.log("=== RETELL: Starting call with access token ==="),await T.startCall({accessToken:n}),console.log("=== RETELL: Call start initiated successfully ===")}catch(S){console.error("=== RETELL: Failed to initialize Retell call ==="),console.error("Error details:",S),console.error("Error message:",S.message),console.error("Error stack:",S.stack),l(S.message||"Failed to initialize voice call"),o("error")}})(),()=>{console.log("=== RETELL: Cleanup function called ==="),u&&(console.log("Stopping Retell call..."),u.stopCall())}},[t,n,e,f]);const y=()=>{u&&u.stopCall(),o("ending"),setTimeout(()=>{e&&e()},1e3)};return r==="initializing"?p.jsxs("div",{className:"w-full h-full flex flex-col",children:[p.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 border-b",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Voice Interview in Progress"}),p.jsx("button",{onClick:y,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"End Call"})]}),p.jsx("div",{className:"flex-1 w-full bg-gray-50 flex items-center justify-center",style:{minHeight:"500px"},children:p.jsxs("div",{className:"text-center",children:[p.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-purple-500 mx-auto mb-6"}),p.jsx("p",{className:"text-gray-600 text-lg mb-2",children:"Initializing voice call..."}),p.jsx("p",{className:"text-gray-500 text-sm",children:"Setting up your interview session"})]})})]}):r==="active"?p.jsxs("div",{className:"w-full h-full flex flex-col",children:[p.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 border-b",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Voice Interview Active"}),p.jsx("button",{onClick:y,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"End Call"})]}),p.jsx("div",{className:"flex-1 w-full bg-gray-50 flex items-center justify-center",style:{minHeight:"500px"},children:p.jsxs("div",{className:"text-center max-w-md",children:[p.jsx("div",{className:"w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-6 animate-pulse",children:p.jsx("svg",{className:"w-10 h-10 text-purple-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"})})}),p.jsx("h3",{className:"text-xl font-medium text-gray-800 mb-4",children:"Interview in Progress"}),p.jsx("p",{className:"text-gray-600 mb-4",children:"You are now speaking with the AI interviewer. Answer the questions clearly and take your time."}),p.jsx("div",{className:"bg-green-100 border border-green-200 rounded-lg p-4",children:p.jsxs("p",{className:"text-green-800 text-sm",children:[p.jsx("strong",{children:"Tip:"})," Speak clearly and provide detailed answers for better feedback."]})})]})})]}):r==="error"?p.jsxs("div",{className:"w-full h-full flex flex-col",children:[p.jsxs("div",{className:"flex justify-between items-center p-4 bg-gray-50 border-b",children:[p.jsx("h3",{className:"text-lg font-medium text-gray-800",children:"Voice Interview Error"}),p.jsx("button",{onClick:y,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Close"})]}),p.jsx("div",{className:"flex-1 w-full bg-gray-50",style:{minHeight:"500px"},children:p.jsx("div",{className:"w-full h-full flex items-center justify-center",children:p.jsxs("div",{className:"text-center max-w-md",children:[p.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:p.jsx("svg",{className:"w-10 h-10 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:p.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),p.jsx("h3",{className:"text-xl font-medium text-gray-800 mb-4",children:"Connection Error"}),p.jsx("p",{className:"text-gray-600 mb-4",children:"Unable to connect to the voice interview service. This could be due to:"}),p.jsxs("ul",{className:"text-sm text-gray-600 mb-4 space-y-1",children:[p.jsx("li",{children:" Invalid or expired access token"}),p.jsx("li",{children:" Network connectivity issues"}),p.jsx("li",{children:" Retell service temporarily unavailable"}),p.jsx("li",{children:" Microphone permissions not granted"})]}),a&&p.jsx("div",{className:"bg-red-100 border border-red-200 rounded-lg p-4 mb-4",children:p.jsxs("p",{className:"text-red-800 text-sm",children:[p.jsx("strong",{children:"Error:"})," ",a]})}),p.jsx("button",{onClick:()=>{console.log("=== RETELL: Retry button clicked ==="),console.log("Current agentId:",t),console.log("Current accessToken present:",!!n),o("initializing"),l(null),m(b=>b+1),console.log("Incrementing retry count to force re-initialization")},className:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors font-medium",children:"Retry Connection"})]})})})]}):null};function vP(){const[t,e]=N.useState({role:"",difficulty:"medium",questionCount:5}),[n,r]=N.useState([]),[o,a]=N.useState(0),[l,u]=N.useState([]),[d,f]=N.useState(""),[m,y]=N.useState(!1),[b,S]=N.useState(!1),[k,T]=N.useState(!1),[C,w]=N.useState(null),[A,P]=N.useState(0),[E,R]=N.useState(!1),[B,I]=N.useState("text"),[M,z]=N.useState(!1),[K,Q]=N.useState(null),[ie,ce]=N.useState(!1),[Te,Ae]=N.useState(null);N.useEffect(()=>(m&&setInterval(()=>{P(ae=>ae+1)},1e3),()=>clearInterval(ae=>ae+1)),[m]);const Se=ae=>{const ye=Math.floor(ae/60),_e=ae%60;return`${ye.toString().padStart(2,"0")}:${_e.toString().padStart(2,"0")}`},be=async()=>{if(!t.role){me.error("Please select a role");return}if(B==="voice"){await X();return}S(!0);try{const ae=localStorage.getItem("token"),ye=await we.get("http://localhost:8080/api/ai/mock-interview-questions",{params:{role:t.role,difficulty:t.difficulty},headers:{Authorization:`Bearer ${ae}`}});r(ye.data.questions.slice(0,t.questionCount)),u(new Array(ye.data.questions.slice(0,t.questionCount).length).fill("")),R(!0),me.success("Interview started!")}catch(ae){console.error("Interview error:",ae),me.error("Failed to start interview")}finally{S(!1)}},X=async()=>{console.log("=== FRONTEND: startVoiceInterview function called ==="),console.log("Interview config:",t),S(!0);try{const ae=localStorage.getItem("token");console.log("Token present:",!!ae);const ye={role:t.role,difficulty:t.difficulty,questionCount:t.questionCount,agentId:"agent_184c9ac8f97c6ea900460895cb"};console.log("Sending request to backend:",ye),console.log("Backend URL:","http://localhost:8080/api/retell/start-call");const _e=await we.post("http://localhost:8080/api/retell/start-call",ye,{headers:{Authorization:`Bearer ${ae}`}});console.log("=== FRONTEND: Backend response received ==="),console.log("Response status:",_e.status),console.log("Response data:",_e.data),z(!0),R(!0),_e.data.agentId?(console.log("Setting agent ID:",_e.data.agentId),Q(_e.data.agentId)):console.log("WARNING: No agent ID in response"),_e.data.accessToken?(console.log("Setting access token:",_e.data.accessToken?"PRESENT":"MISSING"),console.log("Access token value:",_e.data.accessToken),console.log("Access token type:",typeof _e.data.accessToken),console.log("Access token length:",_e.data.accessToken?.length),Ae(_e.data.accessToken)):console.log("WARNING: No access token in response"),me.success("Voice interview started! Connecting to AI agent..."),console.log("Final state - Agent ID:",_e.data.agentId),console.log("Final state - Call ID:",_e.data.callId),console.log("Final state - Access Token present:",!!_e.data.accessToken),console.log("=== FRONTEND: startVoiceInterview completed successfully ===")}catch(ae){console.error("=== FRONTEND: startVoiceInterview ERROR ==="),console.error("Error object:",ae),console.error("Error message:",ae.message),console.error("Error response:",ae.response?.data),console.error("Error status:",ae.response?.status),me.error("Failed to start voice interview")}finally{S(!1)}},pe=()=>{if(d.trim()){const ae=[...l];ae[o]=d,u(ae),f("")}o<n.length-1?a(o+1):oe()},oe=async()=>{if(d.trim()){const ae=[...l];ae[o]=d,u(ae)}S(!0);try{const ae=localStorage.getItem("token"),ye=await we.post("http://localhost:8080/api/ai/interview-feedback",{question:n[o],answer:d||l[o],role:t.role},{headers:{Authorization:`Bearer ${ae}`}});w(ye.data.feedback),T(!0)}catch(ae){console.error("Feedback error:",ae),me.error("Failed to get feedback")}finally{S(!1)}},L=()=>{r([]),a(0),u([]),f(""),y(!1),T(!1),w(null),P(0),R(!1)},W=()=>p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Interview Setup"}),p.jsxs("div",{className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role/Position"}),p.jsxs("select",{value:t.role,onChange:ae=>e({...t,role:ae.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[p.jsx("option",{value:"",children:"Select a role"}),p.jsx("option",{value:"software engineer",children:"Software Engineer"}),p.jsx("option",{value:"data scientist",children:"Data Scientist"}),p.jsx("option",{value:"product manager",children:"Product Manager"}),p.jsx("option",{value:"ui/ux designer",children:"UI/UX Designer"}),p.jsx("option",{value:"devops engineer",children:"DevOps Engineer"}),p.jsx("option",{value:"frontend developer",children:"Frontend Developer"}),p.jsx("option",{value:"backend developer",children:"Backend Developer"}),p.jsx("option",{value:"full stack developer",children:"Full Stack Developer"}),p.jsx("option",{value:"machine learning engineer",children:"Machine Learning Engineer"}),p.jsx("option",{value:"business analyst",children:"Business Analyst"}),p.jsx("option",{value:"project manager",children:"Project Manager"}),p.jsx("option",{value:"sales representative",children:"Sales Representative"}),p.jsx("option",{value:"customer success manager",children:"Customer Success Manager"}),p.jsx("option",{value:"human resources specialist",children:"Human Resources Specialist"}),p.jsx("option",{value:"financial analyst",children:"Financial Analyst"}),p.jsx("option",{value:"content writer",children:"Content Writer"}),p.jsx("option",{value:"digital marketing specialist",children:"Digital Marketing Specialist"}),p.jsx("option",{value:"general",children:"General Interview"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty Level"}),p.jsxs("select",{value:t.difficulty,onChange:ae=>e({...t,difficulty:ae.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[p.jsx("option",{value:"easy",children:"Easy"}),p.jsx("option",{value:"medium",children:"Medium"}),p.jsx("option",{value:"hard",children:"Hard"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Number of Questions"}),p.jsxs("select",{value:t.questionCount,onChange:ae=>e({...t,questionCount:parseInt(ae.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[p.jsx("option",{value:3,children:"3 Questions"}),p.jsx("option",{value:5,children:"5 Questions"}),p.jsx("option",{value:10,children:"10 Questions"})]})]}),p.jsxs("div",{children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Interview Mode"}),p.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[p.jsx("button",{onClick:()=>I("text"),className:`p-4 border-2 rounded-lg transition-colors ${B==="text"?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-300 bg-white text-gray-700 hover:border-gray-400"}`,children:p.jsxs("div",{className:"text-center",children:[p.jsx(rg,{className:"text-2xl mx-auto mb-2"}),p.jsx("div",{className:"font-medium",children:"Text Interview"}),p.jsx("div",{className:"text-sm opacity-75",children:"Type your answers"})]})}),p.jsx("button",{onClick:()=>I("voice"),className:`p-4 border-2 rounded-lg transition-colors ${B==="voice"?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-300 bg-white text-gray-700 hover:border-gray-400"}`,children:p.jsxs("div",{className:"text-center",children:[p.jsx(og,{className:"text-2xl mx-auto mb-2"}),p.jsx("div",{className:"font-medium",children:"Voice Interview"}),p.jsx("div",{className:"text-sm opacity-75",children:"Real-time AI conversation"})]})})]})]}),p.jsx("button",{onClick:be,disabled:b,className:"w-full bg-purple-500 text-white py-3 px-6 rounded-lg hover:bg-purple-600 disabled:opacity-50 transition-colors",children:b?"Starting Interview...":"Start Interview"})]})]}),ke=()=>B==="voice"?Ee():p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Mock Interview"}),p.jsxs("div",{className:"flex items-center gap-4",children:[p.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[p.jsx(v0,{}),p.jsx("span",{children:Se(A)})]}),p.jsxs("div",{className:"text-sm text-gray-600",children:["Question ",o+1," of ",n.length]})]})]}),p.jsx("div",{className:"mb-6",children:p.jsxs("div",{className:"flex items-start gap-3 mb-4",children:[p.jsx(g0,{className:"text-purple-500 text-xl mt-1"}),p.jsxs("div",{children:[p.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Question:"}),p.jsx("p",{className:"text-gray-700",children:n[o]})]})]})}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Answer:"}),p.jsx("textarea",{value:d,onChange:ae=>f(ae.target.value),placeholder:"Type your answer here...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",rows:"6"})]}),p.jsxs("div",{className:"flex justify-between",children:[p.jsxs("button",{onClick:()=>y(!m),className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${m?"bg-red-500 text-white hover:bg-red-600":"bg-gray-500 text-white hover:bg-gray-600"}`,children:[m?p.jsx(CC,{}):p.jsx(rg,{}),m?"Stop Recording":"Start Recording"]}),p.jsxs("button",{onClick:pe,disabled:!d.trim(),className:"flex items-center gap-2 bg-purple-500 text-white px-6 py-2 rounded-lg hover:bg-purple-600 disabled:opacity-50 transition-colors",children:[o<n.length-1?"Next Question":"Finish Interview",p.jsx($n,{})]})]})]}),Ee=()=>(console.log("=== FRONTEND: renderVoiceInterviewSession called ==="),console.log("isWebCallActive:",ie),console.log("voiceAgentId:",K),console.log("retellAccessToken present:",!!Te),console.log("retellAccessToken length:",Te?.length),ie?(console.log("Rendering RetellWebCall component"),p.jsx("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:p.jsx(gP,{agentId:K,accessToken:Te,onCallEnd:()=>{console.log("=== FRONTEND: Call ended callback triggered ==="),ce(!1),z(!1),me.success("Voice interview completed!")}})})):p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsxs("div",{className:"flex items-center justify-between mb-6",children:[p.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Voice Interview"}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx("div",{className:`w-3 h-3 rounded-full ${M?"bg-green-500":"bg-red-500"}`}),p.jsx("span",{className:"text-sm text-gray-600",children:M?"Connected":"Connecting..."})]})]}),p.jsxs("div",{className:"text-center mb-6",children:[p.jsx("div",{className:"w-20 h-20 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:p.jsx(og,{className:"text-3xl text-purple-600"})}),p.jsx("h3",{className:"text-lg font-medium text-gray-800 mb-2",children:"Voice Interview Ready"}),p.jsxs("p",{className:"text-gray-600 mb-4",children:["Your AI interview agent is ready to conduct a voice interview for the ",t.role," position."]}),p.jsxs("div",{className:"bg-green-50 p-4 rounded-lg mb-6",children:[p.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Interview Status:"}),p.jsxs("ul",{className:"text-sm text-green-700 space-y-1",children:[p.jsx("li",{children:" Voice agent connected and ready"}),p.jsxs("li",{children:[" Interview questions configured for ",t.role]}),p.jsxs("li",{children:[" Difficulty level: ",t.difficulty]}),p.jsxs("li",{children:[" Questions: ",t.questionCount]})]})]}),p.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-6",children:[p.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"How to Use:"}),p.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[p.jsx("li",{children:' Click "Start Voice Call" to begin the interview'}),p.jsx("li",{children:" Allow microphone access when prompted"}),p.jsx("li",{children:" Speak clearly when answering questions"}),p.jsx("li",{children:" The AI will conduct the interview based on your configuration"})]})]}),p.jsxs("div",{className:"flex justify-center gap-4",children:[p.jsxs("button",{onClick:()=>{console.log("=== FRONTEND: Start Voice Call button clicked ==="),console.log("Setting isWebCallActive to true"),console.log("Current voiceAgentId:",K),console.log("Current retellAccessToken present:",!!Te),ce(!0),me.success("Starting voice call...")},className:"flex items-center gap-2 bg-purple-500 text-white px-6 py-3 rounded-lg hover:bg-purple-600 transition-colors",children:[p.jsx(EC,{}),"Start Voice Call"]}),p.jsxs("button",{onClick:()=>{z(!1),Q(null),R(!1)},className:"flex items-center gap-2 bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 transition-colors",children:[p.jsx(gv,{}),"Cancel"]})]})]})]})),je=()=>p.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[p.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center gap-2",children:[p.jsx(m0,{className:"text-purple-500"}),"Interview Feedback"]}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium text-gray-800 mb-3",children:"Overall Score"}),p.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[p.jsx("div",{className:"text-3xl font-bold text-purple-600",children:C.score}),p.jsx("div",{className:"text-gray-600",children:"/ 100"})]}),p.jsx("div",{className:"flex gap-1",children:[...Array(5)].map((ae,ye)=>p.jsx(mv,{className:`text-xl ${ye<Math.floor(C.score/20)?"text-yellow-400":"text-gray-300"}`},ye))})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium text-gray-800 mb-3",children:"Interview Summary"}),p.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[p.jsxs("p",{children:["Duration: ",Se(A)]}),p.jsxs("p",{children:["Questions Answered: ",n.length]}),p.jsxs("p",{children:["Role: ",t.role.replace("_"," ")]})]})]})]}),C.communicationScore&&C.technicalScore&&C.confidenceScore&&p.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[p.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[p.jsx("div",{className:"text-2xl font-bold text-blue-600",children:C.communicationScore}),p.jsx("div",{className:"text-sm text-blue-700",children:"Communication"})]}),p.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[p.jsx("div",{className:"text-2xl font-bold text-green-600",children:C.technicalScore}),p.jsx("div",{className:"text-sm text-green-700",children:"Technical"})]}),p.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[p.jsx("div",{className:"text-2xl font-bold text-purple-600",children:C.confidenceScore}),p.jsx("div",{className:"text-sm text-purple-700",children:"Confidence"})]})]}),C.starMethodAnalysis&&p.jsxs("div",{className:"mt-6",children:[p.jsx("h3",{className:"font-medium text-gray-800 mb-3",children:"STAR Method Analysis"}),p.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[p.jsxs("div",{className:"p-3 bg-orange-50 rounded-lg",children:[p.jsx("div",{className:"text-sm font-medium text-orange-800 mb-1",children:"Situation"}),p.jsx("div",{className:"text-xs text-orange-700",children:C.starMethodAnalysis.situation})]}),p.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[p.jsx("div",{className:"text-sm font-medium text-blue-800 mb-1",children:"Task"}),p.jsx("div",{className:"text-xs text-blue-700",children:C.starMethodAnalysis.task})]}),p.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[p.jsx("div",{className:"text-sm font-medium text-green-800 mb-1",children:"Action"}),p.jsx("div",{className:"text-xs text-green-700",children:C.starMethodAnalysis.action})]}),p.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg",children:[p.jsx("div",{className:"text-sm font-medium text-purple-800 mb-1",children:"Result"}),p.jsx("div",{className:"text-xs text-purple-700",children:C.starMethodAnalysis.result})]})]})]}),p.jsxs("div",{className:"mt-6 space-y-4",children:[p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Strengths"}),p.jsx("ul",{className:"space-y-1",children:C.strengths.map((ae,ye)=>p.jsxs("li",{className:"flex items-center gap-2 text-sm text-green-700",children:[p.jsx(Ur,{className:"text-green-500"}),ae]},ye))})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Areas for Improvement"}),p.jsx("ul",{className:"space-y-1",children:C.areasForImprovement.map((ae,ye)=>p.jsxs("li",{className:"flex items-center gap-2 text-sm text-orange-700",children:[p.jsx($n,{className:"text-orange-500"}),ae]},ye))})]}),p.jsxs("div",{children:[p.jsx("h3",{className:"font-medium text-gray-800 mb-2",children:"Suggestions"}),p.jsx("ul",{className:"space-y-1",children:C.suggestions.map((ae,ye)=>p.jsxs("li",{className:"flex items-center gap-2 text-sm text-blue-700",children:[p.jsx($n,{className:"text-blue-500"}),ae]},ye))})]}),p.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[p.jsx("h3",{className:"font-medium text-blue-800 mb-2",children:"Overall Feedback"}),p.jsx("p",{className:"text-blue-700 text-sm",children:C.overallFeedback})]})]}),p.jsx("div",{className:"mt-6 flex gap-4",children:p.jsx("button",{onClick:L,className:"bg-gray-500 text-white px-6 py-2 rounded-lg hover:bg-gray-600 transition-colors",children:"Practice Again"})})]}),Pe=p.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:p.jsxs("div",{className:"max-w-6xl mx-auto",children:[p.jsxs("div",{className:"mb-8",children:[p.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Mock Interview Practice"}),p.jsx("p",{className:"text-gray-600",children:"Practice interviews with AI-generated questions and get personalized feedback"})]}),!E&&!k&&W(),E&&!k&&ke(),k&&je()]})});return p.jsx(Gt,{children:Pe})}function yP(){return p.jsxs(nS,{children:[p.jsx(B1,{children:p.jsxs(g1,{children:[p.jsx(Cn,{path:"/",element:p.jsx(bC,{})}),p.jsx(Cn,{path:"/Home",element:p.jsx(sS,{})}),p.jsx(Cn,{path:"/AlChat",element:p.jsx(yw,{})}),p.jsx(Cn,{path:"/LatestJobs",element:p.jsx(bw,{})}),p.jsx(Cn,{path:"/SkillsInformation",element:p.jsx(xw,{})}),p.jsx(Cn,{path:"/CareerRoadmap",element:p.jsx(kw,{})}),p.jsx(Cn,{path:"/ResumeAnalyzer",element:p.jsx(Sw,{})}),p.jsx(Cn,{path:"/SkillGapAnalyzer",element:p.jsx(Tw,{})}),p.jsx(Cn,{path:"/MockInterview",element:p.jsx(vP,{})})]})}),p.jsx(gw,{position:"top-right"})]})}const bP=fk.createRoot(document.getElementById("app"));bP.render(p.jsx(yP,{}));
